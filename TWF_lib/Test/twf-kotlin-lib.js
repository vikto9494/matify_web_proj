if (typeof kotlin === 'undefined') {
  throw new Error("Error loading module 'twf-kotlin-lib'. Its dependency 'kotlin' was not found. Please, check whether 'kotlin' is loaded prior to 'twf-kotlin-lib'.");
}
this['twf-kotlin-lib'] = function (_, Kotlin) {
  'use strict';
  var listOf = Kotlin.kotlin.collections.listOf_mh5how$;
  var split = Kotlin.kotlin.text.split_ip8yn$;
  var toSet = Kotlin.kotlin.collections.toSet_7wnvza$;
  var hashCode = Kotlin.hashCode;
  var setOf = Kotlin.kotlin.collections.setOf_mh5how$;
  var setOf_0 = Kotlin.kotlin.collections.setOf_i5x0yv$;
  var emptyMap = Kotlin.kotlin.collections.emptyMap_q3lmfv$;
  var copyToArray = Kotlin.kotlin.collections.copyToArray;
  var ArrayList_init = Kotlin.kotlin.collections.ArrayList_init_287e2$;
  var emptyList = Kotlin.kotlin.collections.emptyList_287e2$;
  var plus = Kotlin.kotlin.collections.plus_mydzjv$;
  var mutableListOf = Kotlin.kotlin.collections.mutableListOf_i5x0yv$;
  var isBlank = Kotlin.kotlin.text.isBlank_gw00vp$;
  var HashSet_init = Kotlin.kotlin.collections.HashSet_init_287e2$;
  var collectionSizeOrDefault = Kotlin.kotlin.collections.collectionSizeOrDefault_ba2ldo$;
  var ArrayList_init_0 = Kotlin.kotlin.collections.ArrayList_init_ww73n8$;
  var addAll = Kotlin.kotlin.collections.addAll_ipc267$;
  var endsWith = Kotlin.kotlin.text.endsWith_sgbm27$;
  var first = Kotlin.kotlin.collections.first_2p1efm$;
  var last = Kotlin.kotlin.collections.last_2p1efm$;
  var joinToString = Kotlin.kotlin.collections.joinToString_fmv235$;
  var subtract = Kotlin.kotlin.collections.subtract_q4559j$;
  var to = Kotlin.kotlin.to_ujzrz7$;
  var mapOf = Kotlin.kotlin.collections.mapOf_x2b85n$;
  var toDoubleOrNull = Kotlin.kotlin.text.toDoubleOrNull_pdl1vz$;
  var numberToInt = Kotlin.numberToInt;
  var Math_0 = Math;
  var intersect = Kotlin.kotlin.collections.intersect_q4559j$;
  var Kind_CLASS = Kotlin.Kind.CLASS;
  var Enum = Kotlin.kotlin.Enum;
  var throwISE = Kotlin.throwISE;
  var rangeTo = Kotlin.kotlin.ranges.rangeTo_38ydlf$;
  var Kind_OBJECT = Kotlin.Kind.OBJECT;
  var ensureNotNull = Kotlin.ensureNotNull;
  var equals = Kotlin.equals;
  var toDouble = Kotlin.kotlin.text.toDouble_pdl1vz$;
  var IllegalArgumentException_init = Kotlin.kotlin.IllegalArgumentException_init_pdl1vj$;
  var throwCCE = Kotlin.throwCCE;
  var Pair = Kotlin.kotlin.Pair;
  var mutableMapOf = Kotlin.kotlin.collections.mutableMapOf_qfcya0$;
  var mapOf_0 = Kotlin.kotlin.collections.mapOf_qfcya0$;
  var removeAll = Kotlin.kotlin.collections.removeAll_qafx1e$;
  var get_lastIndex = Kotlin.kotlin.collections.get_lastIndex_55thoc$;
  var math = Kotlin.kotlin.math;
  var log = Kotlin.kotlin.math.log_lu1900$;
  var listOf_0 = Kotlin.kotlin.collections.listOf_i5x0yv$;
  var mapCapacity = Kotlin.kotlin.collections.mapCapacity_za3lpa$;
  var coerceAtLeast = Kotlin.kotlin.ranges.coerceAtLeast_dqglrj$;
  var LinkedHashMap_init = Kotlin.kotlin.collections.LinkedHashMap_init_bwtc7$;
  var union = Kotlin.kotlin.collections.union_q4559j$;
  var compareBy = Kotlin.kotlin.comparisons.compareBy_bvgy4j$;
  var sortedWith = Kotlin.kotlin.collections.sortedWith_eknfly$;
  var IllegalStateException_init = Kotlin.kotlin.IllegalStateException_init;
  var toMutableSet = Kotlin.kotlin.collections.toMutableSet_bvy38s$;
  var plus_0 = Kotlin.kotlin.collections.plus_khz7k3$;
  var sorted = Kotlin.kotlin.collections.sorted_exjks8$;
  var asSequence = Kotlin.kotlin.collections.asSequence_7wnvza$;
  var filter = Kotlin.kotlin.sequences.filter_euau3h$;
  var firstOrNull = Kotlin.kotlin.sequences.firstOrNull_veqyi0$;
  var sortedDescending = Kotlin.kotlin.collections.sortedDescending_exjks8$;
  var sortedWith_0 = Kotlin.kotlin.sequences.sortedWith_vjgqpk$;
  var StringBuilder_init = Kotlin.kotlin.text.StringBuilder_init;
  var mutableSetOf = Kotlin.kotlin.collections.mutableSetOf_i5x0yv$;
  var Throwable = Error;
  var emptySet = Kotlin.kotlin.collections.emptySet_287e2$;
  var kotlin_js_internal_DoubleCompanionObject = Kotlin.kotlin.js.internal.DoubleCompanionObject;
  var toMutableMap = Kotlin.kotlin.collections.toMutableMap_abgq59$;
  var LinkedHashSet_init = Kotlin.kotlin.collections.LinkedHashSet_init_287e2$;
  var Collection = Kotlin.kotlin.collections.Collection;
  var NotImplementedError_init = Kotlin.kotlin.NotImplementedError;
  var LinkedHashMap_init_0 = Kotlin.kotlin.collections.LinkedHashMap_init_q3lmfv$;
  var toString = Kotlin.toString;
  var toIntOrNull = Kotlin.kotlin.text.toIntOrNull_pdl1vz$;
  var startsWith = Kotlin.kotlin.text.startsWith_7epoxm$;
  var toMap = Kotlin.kotlin.collections.toMap_6hr0sd$;
  var wrapFunction = Kotlin.wrapFunction;
  var Comparator = Kotlin.kotlin.Comparator;
  var toMutableList = Kotlin.kotlin.collections.toMutableList_4c7yge$;
  var UnsupportedOperationException_init = Kotlin.kotlin.UnsupportedOperationException_init_pdl1vj$;
  var throwUPAE = Kotlin.throwUPAE;
  var arrayListOf = Kotlin.kotlin.collections.arrayListOf_i5x0yv$;
  var isNaN_0 = Kotlin.kotlin.isNaN_yrwdxr$;
  var isFinite = Kotlin.kotlin.isFinite_yrwdxr$;
  var first_0 = Kotlin.kotlin.text.first_gw00vp$;
  var last_0 = Kotlin.kotlin.text.last_gw00vp$;
  var get_lastIndex_0 = Kotlin.kotlin.text.get_lastIndex_gw00vp$;
  var repeat = Kotlin.kotlin.text.repeat_94bcnn$;
  var sortWith = Kotlin.kotlin.collections.sortWith_nqfjgj$;
  var max = Kotlin.kotlin.collections.max_exjks8$;
  var contains = Kotlin.kotlin.collections.contains_mjy6jw$;
  var unboxChar = Kotlin.unboxChar;
  var StringBuilder = Kotlin.kotlin.text.StringBuilder;
  var get_indices = Kotlin.kotlin.text.get_indices_gw00vp$;
  var toBoxedChar = Kotlin.toBoxedChar;
  var get_lastIndex_1 = Kotlin.kotlin.collections.get_lastIndex_m7z4lg$;
  var firstOrNull_0 = Kotlin.kotlin.collections.firstOrNull_2p1efm$;
  var Unit = Kotlin.kotlin.Unit;
  var toList = Kotlin.kotlin.collections.toList_us0mfu$;
  var toMutableList_0 = Kotlin.kotlin.collections.toMutableList_us0mfu$;
  var indexOf = Kotlin.kotlin.collections.indexOf_bv23uc$;
  var reverse = Kotlin.kotlin.collections.reverse_vvxzk3$;
  var contains_0 = Kotlin.kotlin.text.contains_li3zpu$;
  var toInt = Kotlin.kotlin.text.toInt_pdl1vz$;
  var first_1 = Kotlin.kotlin.collections.first_us0mfu$;
  var Array_0 = Array;
  var iterator = Kotlin.kotlin.text.iterator_gw00vp$;
  var Kind_INTERFACE = Kotlin.Kind.INTERFACE;
  var replace = Kotlin.kotlin.text.replace_680rmw$;
  var isWhitespace = Kotlin.kotlin.text.isWhitespace_myv2d0$;
  var contains_1 = Kotlin.kotlin.text.contains_sgbm27$;
  var firstOrNull_1 = Kotlin.kotlin.text.firstOrNull_gw00vp$;
  var startsWith_0 = Kotlin.kotlin.text.startsWith_sgbm27$;
  var substringBefore = Kotlin.kotlin.text.substringBefore_8cymmc$;
  var endsWith_0 = Kotlin.kotlin.text.endsWith_7epoxm$;
  var lastIndexOfAny = Kotlin.kotlin.text.lastIndexOfAny_7utkvz$;
  var removeSuffix = Kotlin.kotlin.text.removeSuffix_gsj5wt$;
  var startsWith_1 = Kotlin.kotlin.text.startsWith_li3zpu$;
  var trim = Kotlin.kotlin.text.trim_gw00vp$;
  var sum = Kotlin.kotlin.collections.sum_l63kqw$;
  var checkCountOverflow = Kotlin.kotlin.collections.checkCountOverflow_za3lpa$;
  var first_2 = Kotlin.kotlin.collections.first_7wnvza$;
  var dropLast = Kotlin.kotlin.text.dropLast_94bcnn$;
  var binarySearch = Kotlin.kotlin.collections.binarySearch_jhx6be$;
  var toString_0 = Kotlin.kotlin.text.toString_dqglrj$;
  var MutableList = Kotlin.kotlin.collections.MutableList;
  var elementAt = Kotlin.kotlin.text.elementAt_94bcnn$;
  var lazy = Kotlin.kotlin.lazy_klfg04$;
  var replace_0 = Kotlin.kotlin.text.replace_r2fvfm$;
  var dropLast_0 = Kotlin.kotlin.collections.dropLast_yzln2o$;
  var StringBuilder_init_0 = Kotlin.kotlin.text.StringBuilder_init_6bul2c$;
  var substringAfterLast = Kotlin.kotlin.text.substringAfterLast_j4ogox$;
  var substringBeforeLast = Kotlin.kotlin.text.substringBeforeLast_j4ogox$;
  var reversed = Kotlin.kotlin.text.reversed_gw00vp$;
  var Regex_init = Kotlin.kotlin.text.Regex_init_61zpoe$;
  var IllegalStateException_init_0 = Kotlin.kotlin.IllegalStateException_init_pdl1vj$;
  var Comparable = Kotlin.kotlin.Comparable;
  var Exception_init = Kotlin.kotlin.Exception_init_pdl1vj$;
  var isInfinite = Kotlin.kotlin.isInfinite_yrwdxr$;
  var ArrayList = Kotlin.kotlin.collections.ArrayList;
  var Map = Kotlin.kotlin.collections.Map;
  var println = Kotlin.kotlin.io.println_s8jyv4$;
  var Random = Kotlin.kotlin.random.Random;
  var substringAfter = Kotlin.kotlin.text.substringAfter_j4ogox$;
  var substringBefore_0 = Kotlin.kotlin.text.substringBefore_j4ogox$;
  var toChar = Kotlin.toChar;
  var CharRange = Kotlin.kotlin.ranges.CharRange;
  var substringAfter_0 = Kotlin.kotlin.text.substringAfter_8cymmc$;
  var split_0 = Kotlin.kotlin.text.split_o64adg$;
  var indexOf_0 = Kotlin.kotlin.text.indexOf_l5u8uk$;
  var replaceFirst = Kotlin.kotlin.text.replaceFirst_680rmw$;
  var findAnyOf = Kotlin.kotlin.text.findAnyOf_7utkvz$;
  ComputationType.prototype = Object.create(Enum.prototype);
  ComputationType.prototype.constructor = ComputationType;
  EmptyDomainException.prototype = Object.create(Throwable.prototype);
  EmptyDomainException.prototype.constructor = EmptyDomainException;
  ComparisonType.prototype = Object.create(Enum.prototype);
  ComparisonType.prototype.constructor = ComparisonType;
  ErrorLevel.prototype = Object.create(Enum.prototype);
  ErrorLevel.prototype.constructor = ErrorLevel;
  StringDefinitionType.prototype = Object.create(Enum.prototype);
  StringDefinitionType.prototype.constructor = StringDefinitionType;
  NodeType.prototype = Object.create(Enum.prototype);
  NodeType.prototype.constructor = NodeType;
  NumberIntervalType.prototype = Object.create(Enum.prototype);
  NumberIntervalType.prototype.constructor = NumberIntervalType;
  SubstitutionInstanceVarType.prototype = Object.create(Enum.prototype);
  SubstitutionInstanceVarType.prototype.constructor = SubstitutionInstanceVarType;
  MathMlTagTreeNode$Type.prototype = Object.create(Enum.prototype);
  MathMlTagTreeNode$Type.prototype.constructor = MathMlTagTreeNode$Type;
  MathMlTagTreeNode$TexArgumentType.prototype = Object.create(Enum.prototype);
  MathMlTagTreeNode$TexArgumentType.prototype.constructor = MathMlTagTreeNode$TexArgumentType;
  ExpressionParserNode$Type.prototype = Object.create(Enum.prototype);
  ExpressionParserNode$Type.prototype.constructor = ExpressionParserNode$Type;
  ExpressionTreeParser$ParserState.prototype = Object.create(Enum.prototype);
  ExpressionTreeParser$ParserState.prototype.constructor = ExpressionTreeParser$ParserState;
  ExpressionTreeParser$TokenParserState.prototype = Object.create(Enum.prototype);
  ExpressionTreeParser$TokenParserState.prototype.constructor = ExpressionTreeParser$TokenParserState;
  ComparableTransformationPartType.prototype = Object.create(Enum.prototype);
  ComparableTransformationPartType.prototype.constructor = ComparableTransformationPartType;
  SubstitutionDirection.prototype = Object.create(Enum.prototype);
  SubstitutionDirection.prototype.constructor = SubstitutionDirection;
  TransformationChainParser$ParserState.prototype = Object.create(Enum.prototype);
  TransformationChainParser$ParserState.prototype.constructor = TransformationChainParser$ParserState;
  MessageType.prototype = Object.create(Enum.prototype);
  MessageType.prototype.constructor = MessageType;
  Form.prototype = Object.create(Enum.prototype);
  Form.prototype.constructor = Form;
  Case.prototype = Object.create(Enum.prototype);
  Case.prototype.constructor = Case;
  function createCompiledConfigurationFromExpressionSubstitutionsAndParams_JS(expressionSubstitutions, additionalParamsMap) {
    if (additionalParamsMap === void 0) {
      additionalParamsMap = emptyMap();
    }
    return createCompiledConfigurationFromExpressionSubstitutionsAndParams(expressionSubstitutions, additionalParamsMap);
  }
  function createConfigurationFromRulePacksAndParams_JS(rulePacks, additionalParamsMap) {
    if (rulePacks === void 0) {
      rulePacks = copyToArray(listOf('Algebra'));
    }
    if (additionalParamsMap === void 0) {
      additionalParamsMap = emptyMap();
    }
    return createConfigurationFromRulePacksAndParams(rulePacks, additionalParamsMap);
  }
  function getSubstitutionsByRulePacks_JS(rulePacks) {
    return copyToArray(getSubstitutionsByRulePacks(rulePacks));
  }
  function stringToExpression_JS(string, scope, isMathMl, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (isMathMl === void 0)
      isMathMl = false;
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    return stringToExpression(string, scope, isMathMl, functionConfiguration, compiledConfiguration);
  }
  function structureStringToExpression_JS(structureString, scope, functionConfiguration) {
    if (scope === void 0)
      scope = '';
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    return structureStringToExpression(structureString, scope, functionConfiguration);
  }
  function expressionToString_JS(expressionNode, characterEscapingDepth) {
    if (characterEscapingDepth === void 0)
      characterEscapingDepth = 1;
    return expressionToString(expressionNode, characterEscapingDepth);
  }
  function expressionToTexString_JS(expressionNode, characterEscapingDepth) {
    if (characterEscapingDepth === void 0)
      characterEscapingDepth = 1;
    return expressionToTexString(expressionNode, characterEscapingDepth);
  }
  function expressionToStructureString_JS(expressionNode) {
    return expressionToStructureString(expressionNode);
  }
  function expressionSubstitutionFromStrings(left, right, scope, basedOnTaskContext, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (basedOnTaskContext === void 0)
      basedOnTaskContext = false;
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    return expressionSubstitutionFromStrings_0(left, right, scope, basedOnTaskContext, void 0, void 0, void 0, void 0, void 0, functionConfiguration, compiledConfiguration);
  }
  function expressionSubstitutionFromStructureStrings_JS(leftStructureString, rightStructureString, basedOnTaskContext, matchJumbledAndNested, simpleAdditional, isExtending, priority, code, nameEn, nameRu) {
    if (leftStructureString === void 0)
      leftStructureString = '';
    if (rightStructureString === void 0)
      rightStructureString = '';
    if (basedOnTaskContext === void 0)
      basedOnTaskContext = false;
    if (matchJumbledAndNested === void 0)
      matchJumbledAndNested = false;
    if (simpleAdditional === void 0)
      simpleAdditional = false;
    if (isExtending === void 0)
      isExtending = false;
    if (priority === void 0)
      priority = 50;
    if (code === void 0)
      code = '';
    if (nameEn === void 0)
      nameEn = '';
    if (nameRu === void 0)
      nameRu = '';
    return expressionSubstitutionFromStructureStrings(leftStructureString, rightStructureString, basedOnTaskContext, matchJumbledAndNested, simpleAdditional, isExtending, priority, code, nameEn, nameRu);
  }
  function findApplicableSubstitutionsInSelectedPlace_JS(expression, selectedNodeIds, compiledConfiguration, simplifyNotSelectedTopArguments, withReadyApplicationResult) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = true;
    return findApplicableSubstitutionsInSelectedPlace(expression, selectedNodeIds, compiledConfiguration, simplifyNotSelectedTopArguments, withReadyApplicationResult);
  }
  function findSubstitutionPlacesInExpression(expression, substitution) {
    return findSubstitutionPlacesInExpression_0(expression, substitution);
  }
  function applySubstitution(expression, substitution, substitutionPlaces) {
    return applySubstitution_0(expression, substitution, substitutionPlaces);
  }
  function generateTask(expressionSubstitutions, stepsCount, originalExpressions) {
    return generateTask_0(expressionSubstitutions, stepsCount, originalExpressions);
  }
  function checkSolutionInTex_JS(originalTexSolution, startExpressionIdentifier, targetFactPattern, additionalFactsIdentifiers, endExpressionIdentifier, targetFactIdentifier, wellKnownFunctions, wellKnownFunctionsString, unlimitedWellKnownFunctions, unlimitedWellKnownFunctionsString, expressionTransformationRules, expressionTransformationRulesString, taskContextExpressionTransformationRules, rulePacks, maxExpressionTransformationWeight, maxDistBetweenDiffSteps, scopeFilter, shortErrorDescription) {
    if (startExpressionIdentifier === void 0)
      startExpressionIdentifier = '';
    if (targetFactPattern === void 0)
      targetFactPattern = '';
    if (additionalFactsIdentifiers === void 0)
      additionalFactsIdentifiers = '';
    if (endExpressionIdentifier === void 0)
      endExpressionIdentifier = '';
    if (targetFactIdentifier === void 0)
      targetFactIdentifier = '';
    if (wellKnownFunctions === void 0) {
      wellKnownFunctions = emptyList();
    }
    if (wellKnownFunctionsString === void 0)
      wellKnownFunctionsString = '+;;;-1;;;-;;;-1;;;*;;;-1;;;/;;;-1';
    if (unlimitedWellKnownFunctions === void 0)
      unlimitedWellKnownFunctions = wellKnownFunctions;
    if (unlimitedWellKnownFunctionsString === void 0)
      unlimitedWellKnownFunctionsString = wellKnownFunctionsString;
    if (expressionTransformationRules === void 0) {
      expressionTransformationRules = emptyList();
    }
    if (expressionTransformationRulesString === void 0)
      expressionTransformationRulesString = 'S(i, a, a, f(i));;;f(a);;;S(i, a, b, f(i));;;S(i, a, b-1, f(i)) + f(b)';
    if (taskContextExpressionTransformationRules === void 0)
      taskContextExpressionTransformationRules = '';
    if (rulePacks === void 0) {
      rulePacks = copyToArray(emptyList());
    }
    if (maxExpressionTransformationWeight === void 0)
      maxExpressionTransformationWeight = '1.0';
    if (maxDistBetweenDiffSteps === void 0)
      maxDistBetweenDiffSteps = '';
    if (scopeFilter === void 0)
      scopeFilter = '';
    if (shortErrorDescription === void 0)
      shortErrorDescription = '0';
    return checkSolutionInTex(originalTexSolution, startExpressionIdentifier, targetFactPattern, additionalFactsIdentifiers, endExpressionIdentifier, targetFactIdentifier, wellKnownFunctions, wellKnownFunctionsString, unlimitedWellKnownFunctions, unlimitedWellKnownFunctionsString, expressionTransformationRules, expressionTransformationRulesString, taskContextExpressionTransformationRules, rulePacks, maxExpressionTransformationWeight, maxDistBetweenDiffSteps, scopeFilter, shortErrorDescription);
  }
  function getParsedExpressionByMathML(mathML) {
    var expressionTreeParser = new ExpressionTreeParser(mathML);
    expressionTreeParser.parse();
    var root = expressionTreeParser.root;
    return root.toString();
  }
  function checkFactsInMathML(brushedMathML, wellKnownFunctions, expressionTransformationRules, targetFactIdentifier, targetVariablesNames, additionalFactsIdentifiers, maxExpressionTransformationWeight) {
    if (wellKnownFunctions === void 0)
      wellKnownFunctions = '+;;;-1;;;-;;;-1;;;*;;;-1;;;/;;;-1';
    if (expressionTransformationRules === void 0)
      expressionTransformationRules = 'S(i, a, a, f(i));;;f(a);;;S(i, a, b, f(i));;;S(i, a, b-1, f(i)) + f(b)';
    if (targetFactIdentifier === void 0)
      targetFactIdentifier = '';
    if (targetVariablesNames === void 0)
      targetVariablesNames = '';
    if (additionalFactsIdentifiers === void 0)
      additionalFactsIdentifiers = '';
    if (maxExpressionTransformationWeight === void 0)
      maxExpressionTransformationWeight = '1.0';
    return checkFactsInMathML_0(brushedMathML, wellKnownFunctions, expressionTransformationRules, targetFactIdentifier, targetVariablesNames, additionalFactsIdentifiers, maxExpressionTransformationWeight);
  }
  function getUserLogInPlainText() {
    return log_1.getLogInPlainText_ouivre$(MessageType$USER_getInstance());
  }
  function getUserLogInJson() {
    return log_1.getLogInJson_gbs7d8$(MessageType$USER_getInstance());
  }
  function getAllLogInPlainText() {
    return log_1.getLogInPlainText_ouivre$();
  }
  function getAllLogInJson() {
    return log_1.getLogInJson_gbs7d8$();
  }
  function encryptSolution(solution) {
    return hashCode(solution).toString() + '_' + solution.length;
  }
  function encryptResult(result, solution) {
    return result + ' ' + hashCode(solution) + '_' + solution.length;
  }
  function compareWithoutSubstitutions(left, right, scope, notChangesOnVariablesFunction, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = setOf('');
    if (notChangesOnVariablesFunction === void 0)
      notChangesOnVariablesFunction = setOf_0(['+', '-', '*', '/', '^']);
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration(scope, notChangesOnVariablesFunction);
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    return compareWithoutSubstitutions_0(left, right, scope, notChangesOnVariablesFunction, functionConfiguration, compiledConfiguration);
  }
  function createConfigurationFromRulePacksAndParams(rulePacks, additionalParamsMap) {
    if (rulePacks === void 0) {
      rulePacks = copyToArray(listOf('Algebra'));
    }
    if (additionalParamsMap === void 0) {
      additionalParamsMap = emptyMap();
    }
    var expressionSubstitutions = getSubstitutionsByRulePacks(rulePacks);
    var destination = ArrayList_init_0(collectionSizeOrDefault(expressionSubstitutions, 10));
    var tmp$;
    tmp$ = expressionSubstitutions.iterator();
    while (tmp$.hasNext()) {
      var item = tmp$.next();
      destination.add_11rb$(item.code);
    }
    var destination_0 = ArrayList_init();
    var tmp$_0;
    tmp$_0 = destination.iterator();
    while (tmp$_0.hasNext()) {
      var element = tmp$_0.next();
      if (!isBlank(element))
        destination_0.add_11rb$(element);
    }
    var simpleComputationRuleCodesCandidates = toSet(destination_0);
    var $receiver = new CompiledConfiguration(void 0, void 0, void 0, void 0, void 0, void 0, additionalParamsMap, simpleComputationRuleCodesCandidates);
    var tmp$_1;
    $receiver.compiledExpressionTreeTransformationRules.clear();
    $receiver.compiledExpressionSimpleAdditionalTreeTransformationRules.clear();
    var handledCodesHashSet = HashSet_init();
    tmp$_1 = expressionSubstitutions.iterator();
    while (tmp$_1.hasNext()) {
      var substitution = tmp$_1.next();
      if (handledCodesHashSet.contains_11rb$(substitution.code))
        continue;
      handledCodesHashSet.add_11rb$(substitution.code);
      if (substitution.left.nodeType === NodeType$EMPTY_getInstance() || substitution.right.nodeType === NodeType$EMPTY_getInstance()) {
        if (substitution.code.length > 0) {
          $receiver.expressionTreeAutogeneratedTransformationRuleIdentifiers.put_xwzc9p$(substitution.code, substitution);
        }
      }
       else {
        $receiver.compiledExpressionTreeTransformationRules.add_11rb$(substitution);
        if (substitution.simpleAdditional) {
          $receiver.compiledExpressionSimpleAdditionalTreeTransformationRules.add_11rb$(substitution);
        }
      }
    }
    return $receiver;
  }
  function getSubstitutionsByRulePacks(rulePacks) {
    var tmp$, tmp$_0;
    var result = ArrayList_init();
    for (tmp$ = 0; tmp$ !== rulePacks.length; ++tmp$) {
      var rulePack = rulePacks[tmp$];
      switch (rulePack) {
        case 'Algebra':
          tmp$_0 = getAllAlgebraSubstitutions();
          break;
        case 'ArithmeticPositiveAddition':
          tmp$_0 = getArithmeticPositiveAdditionSubstitutions();
          break;
        case 'ArithmeticAddition':
          tmp$_0 = getArithmeticAdditionSubstitutions();
          break;
        case 'ArithmeticMultiplication':
          tmp$_0 = getArithmeticMultiplicationSubstitutions();
          break;
        case 'ArithmeticDivision':
          tmp$_0 = getArithmeticDivisionSubstitutions();
          break;
        case 'ArithmeticPow':
          tmp$_0 = getArithmeticPowSubstitutions();
          break;
        case 'ArithmeticPowExtension':
          tmp$_0 = getArithmeticPowExtensionSubstitutions();
          break;
        case 'ShortMultiplication':
          tmp$_0 = getShortMultiplicationSubstitutions();
          break;
        case 'Logarithm':
          tmp$_0 = getLogarithmSubstitutions();
          break;
        case 'FactorialRecurrent':
          tmp$_0 = getFactorialSubstitutions();
          break;
        case 'Combinatorics':
          tmp$_0 = getCombinatoricsSubstitutions();
          break;
        case 'Trigonometry':
          tmp$_0 = getTrigonometrySubstitutions();
          break;
        case 'TrigonometryZk':
          tmp$_0 = getTrigonometryZkSubstitutions();
          break;
        case 'TrigonometryCompleteTgCtg':
          tmp$_0 = getTrigonometryCompleteTgCtgSubstitutions();
          break;
        case 'Set':
          tmp$_0 = getSetBaseSubstitutions();
          break;
        case 'SetAbsorption':
          tmp$_0 = getSetAbsorptionLawSubstitutions();
          break;
        case 'SetResolution':
          tmp$_0 = getSetResolutionSubstitutions();
          break;
        case 'PhysicsSimpleMoving':
          tmp$_0 = getPhysicsSimpleMovingSubstitutions();
          break;
        case 'PhysicsCircleMoving':
          tmp$_0 = getPhysicsCircleMovingSubstitutions();
          break;
        case 'PhysicsNuclear':
          tmp$_0 = getPhysicsNuclearSubstitutions();
          break;
        case 'PhysicsMolecular':
          tmp$_0 = getPhysicsMolecularSubstitutions();
          break;
        case 'PhysicsElectrodynamics':
          tmp$_0 = getPhysicsElectrodynamicsSubstitutions();
          break;
        default:tmp$_0 = emptyList();
          break;
      }
      var newRules = tmp$_0;
      addAll(result, newRules);
    }
    var tmp$_1;
    var set = HashSet_init();
    var list = ArrayList_init();
    tmp$_1 = result.iterator();
    while (tmp$_1.hasNext()) {
      var e = tmp$_1.next();
      var key = e.code;
      if (set.add_11rb$(key))
        list.add_11rb$(e);
    }
    return list;
  }
  function getAllAlgebraSubstitutions() {
    return plus(plus(getLogarithmSubstitutions(), getFactorialSubstitutions()), getTrigonometryCompleteTgCtgSubstitutions());
  }
  function getArithmeticPositiveAdditionSubstitutions() {
    return mutableListOf([expressionSubstitutionFromStructureStrings('(+(a))', '(a)', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(+(a;b))', '(+(b;a))', false, false, false, true, 20, ''), expressionSubstitutionFromStructureStrings('(a)', '(+(a;0))', false, false, false, true, 35, ''), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 5, 'SimpleComputation'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 5, 'ZeroComputation'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 20, 'PositiveNumberPlusMinus1'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 30, 'ParentBracketsExpansion'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 40, 'ArgumentsSwap'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 40, 'ArgumentsPermutation'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 41, 'ArgumentsPermutationInOriginalOrder')]);
  }
  function getArithmeticAdditionSubstitutions() {
    return mutableListOf([expressionSubstitutionFromStructureStrings('(+(a))', '(a)', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(+(a;b))', '(+(b;a))', false, false, false, true, 20, ''), expressionSubstitutionFromStructureStrings('(a)', '(+(a;0))', false, false, false, true, 90, ''), expressionSubstitutionFromStructureStrings('(+(-(+(-(a)))))', '(a)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(-(+(-(a))))', '(a)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(-(-(a)))', '(a)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(a)', '(-(+(-(a))))', false, false, false, true, 95, ''), expressionSubstitutionFromStructureStrings('(+(a;-(a)))', '(0)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(+(-(a);a))', '(0)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(+(a;+(-(a))))', '(0)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(+(+(-(a));a))', '(0)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 5, 'SimpleComputation'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 5, 'ZeroComputation'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 20, 'NumberPlusMinus1'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 31, 'MinusInOutBrackets'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 30, 'ParentBracketsExpansion'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 40, 'ArgumentsSwap'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 40, 'ArgumentsPermutation'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 41, 'ArgumentsPermutationInOriginalOrder'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 92, 'AdditiveComplicatingExtension')]);
  }
  function getArithmeticMultiplicationSubstitutions() {
    return plus(getArithmeticAdditionSubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(*(a;0))', '(0)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(*(0;a))', '(0)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(0)', '(*(a;0))', false, false, false, true, 35, ''), expressionSubstitutionFromStructureStrings('(*(a;1))', '(a)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(*(1;a))', '(a)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(a)', '(*(a;1))', false, false, false, true, 35, ''), expressionSubstitutionFromStructureStrings('(*(a;b))', '(*(b;a))', false, false, false, true, 20, ''), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 30, 'OpeningBrackets'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 10, 'ReduceArithmetic'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 10, 'TwoSidesArithmeticReduce'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 15, 'MultiplicationFactorization'), expressionSubstitutionFromStructureStrings('(+(a;a))', '(*(2;a))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(a;+(a)))', '(*(2;a))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(+(a);a))', '(*(2;a))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(2;a))', '(+(a;a))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(a;*(a;n)))', '(*(a;+(n;1)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(a;+(n;1)))', '(+(a;*(a;n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(*(a;n);a))', '(*(a;+(1;n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(a;+(1;n)))', '(+(*(a;n);a))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(-(*(A;C)))', '(*(+(-(A));C))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(-(A);C))', '(+(-(*(A;C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(-(*(A;C)))', '(*(A;+(-(C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(A;-(C)))', '(+(-(*(A;C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(A;-(C)))', '(*(+(-(A);C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(-(A);C))', '(*(A;+(-(C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(-(*(A;C))))', '(*(+(-(A));C))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(+(-(A));C))', '(+(-(*(A;C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(-(*(A;C))))', '(*(A;+(-(C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(A;+(-(C))))', '(+(-(*(A;C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(A;+(-(C))))', '(*(+(-(A));C))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(+(-(A));C))', '(*(A;+(-(C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(-(A);-(B)))', '(*(A;B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(A;B))', '(*(+(-(A));+(-(B))))', false, false, false, true, 80, ''), expressionSubstitutionFromStructureStrings('(*(+(-(A));+(-(B))))', '(*(A;B))', false, false, false, false, 35, '')]));
  }
  function getArithmeticDivisionSubstitutions() {
    return plus(getArithmeticMultiplicationSubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(/(0;a))', '(0)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(/(a;1))', '(a)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(/(a;a))', '(1)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(*(/(1;a);a))', '(1)', false, false, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(/(1;/(1;a)))', '(a)', false, true, false, false, 4, ''), expressionSubstitutionFromStructureStrings('(a)', '(/(1;/(1;a)))', false, false, false, true, 90, ''), expressionSubstitutionFromStructureStrings('(0.5)', '(/(1;2))', false, false, true, false, 15, ''), expressionSubstitutionFromStructureStrings('(/(1;2))', '(0.5)', false, false, true, false, 5, ''), expressionSubstitutionFromStructureStrings('(/(a;b))', '(/(*(a;b);*(b;b)))', false, false, false, true, 90, ''), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 92, 'MultiplicativeComplicatingExtension'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 10, 'ReduceFraction'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 15, 'DecimalToFraction'), expressionSubstitutionFromStructureStrings('(/(*(a;n);a))', '(*(a;+(n;-(1))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(a;+(n;-(1))))', '(/(*(a;n);a))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(-(/(A;C)))', '(/(+(-(A);C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(-(A);C))', '(+(-(/(A;C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(-(/(A;C)))', '(/(A;+(-(C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;-(C)))', '(+(-(/(A;C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;-(C)))', '(/(+(-(A);C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(-(A);C))', '(/(A;+(-(C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(-(/(A;C))))', '(/(+(-(A));C))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(+(-(A));C))', '(+(-(/(A;C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(-(/(A;C))))', '(/(A;+(-(C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;+(-(C))))', '(+(-(/(A;C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;+(-(C))))', '(/(+(-(A));C))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(+(-(A));C))', '(/(A;+(-(C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(-(A);-(B)))', '(/(A;B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;B))', '(/(+(-(A));+(-(B))))', false, false, false, true, 80, ''), expressionSubstitutionFromStructureStrings('(/(+(-(A));+(-(B))))', '(/(A;B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(/(B;C);/(A;D)))', '(/(+(*(B;D);*(C;A));*(C;D)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(/(B;C);-(/(A;D))))', '(/(+(*(B;D);-(*(C;A)));*(C;D)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(A;/(B;A)))', '(B)', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(/(B;A);A))', '(B)', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(A;/(B;C)))', '(/(*(A;B);C))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(/(B;C);A))', '(/(*(A;B);C))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(/(B;C);A))', '(*(/(B;A);C))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;B))', '(/(1;/(B;A)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(1;/(B;A)))', '(/(A;B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(A;B);C))', '(*(A;/(B;C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(/(B;C);A))', '(/(B;*(A;C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(B;*(A;C)))', '(/(/(B;C);A))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;/(B;C)))', '(/(*(A;C);B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(A;C);B))', '(/(A;/(B;C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;*(B;C)))', '(*(/(A;B);/(1;C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;*(B;C)))', '(*(/(1;B);/(A;C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(/(A;B);/(1;C)))', '(/(A;*(B;C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(/(1;B);/(A;C)))', '(/(A;*(B;C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(/(D;B);/(A;C)))', '(/(*(D;A);*(B;C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(D;A);*(B;C)))', '(*(/(D;B);/(A;C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(D;A);*(B;A)))', '(/(D;B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(D;A);*(D;C)))', '(/(A;C))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(D;A);D))', '(A)', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(A;D);D))', '(A)', false, false, false, false, 35, '')]));
  }
  function getArithmeticPowSubstitutions() {
    return plus(getArithmeticDivisionSubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(a)', '(^(a;1))', false, false, true, true, 95, ''), expressionSubstitutionFromStructureStrings('(1)', '(^(1;2))', false, false, true, true, 95, ''), expressionSubstitutionFromStructureStrings('(1)', '(^(1;3))', false, false, true, true, 95, ''), expressionSubstitutionFromStructureStrings('(/(1;a))', '(^(a;+(-(1))))', false, false, false, false, 80, ''), expressionSubstitutionFromStructureStrings('(^(a;+(-(1))))', '(/(1;a))', false, false, false, false, 40, ''), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 15, 'PowFactorization'), expressionSubstitutionFromStructureStrings('(^(a;+(b;-(c))))', '(/(^(a;b);^(a;c)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(^(a;b);^(a;c)))', '(^(a;+(b;-(c))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(B;^(A;C)))', '(*(B;^(A;+(-(C)))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(B;^(A;+(-(C)))))', '(/(B;^(A;C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(1;^(A;C)))', '(^(A;+(-(C))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(A;+(-(C))))', '(/(1;^(A;C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;B))', '(^(/(B;A);+(-(1))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(/(B;A);+(-(1))))', '(/(A;B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(A;0))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(^(1;A))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(^(A;1))', '(A)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(^(0;A))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(*(a;a))', '(^(a;2))', false, false, true, false, 40, ''), expressionSubstitutionFromStructureStrings('(^(a;2))', '(*(a;a))', false, false, true, false, 40, ''), expressionSubstitutionFromStructureStrings('(*(a;^(a;n)))', '(^(a;+(n;1)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(a;+(n;1)))', '(*(a;^(a;n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(^(a;n);a))', '(^(a;+(1;n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(a;+(1;n)))', '(*(^(a;n);a))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(^(a;n);a))', '(^(a;+(n;-(1))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(a;+(n;-(1))))', '(/(^(a;n);a))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(A;*(B;C)))', '(^(^(A;B);C))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(^(A;B);C))', '(^(A;*(B;C)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(/(B;C);A))', '(/(^(B;A);^(C;A)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(^(B;A);^(C;A)))', '(^(/(B;C);A))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(-(A);*(2;n)))', '(^(A;*(2;n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(-(A);2))', '(^(A;2))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(+(-(A));*(2;n)))', '(^(A;*(2;n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(+(-(A));2))', '(^(A;2))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(a;*(2;n)))', '(^(+(-(a));*(2;n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(a;2))', '(^(+(-(a));2))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(^(a;b);/(1;b)))', '(a)', false, false, false, false, 5, '')]));
  }
  function getArithmeticPowExtensionSubstitutions() {
    return plus(getArithmeticPowSubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(a)', '(^(^(a;2);/(1;2)))', false, false, false, false, 96, ''), expressionSubstitutionFromStructureStrings('(a)', '(^(^(a;/(1;2));2))', false, false, false, false, 96, ''), expressionSubstitutionFromStructureStrings('(a)', '(^(^(a;3);/(1;3)))', false, false, false, false, 96, ''), expressionSubstitutionFromStructureStrings('(a)', '(^(^(a;/(1;3));3))', false, false, false, false, 96, '')]));
  }
  function getShortMultiplicationSubstitutions() {
    return plus(getArithmeticPowSubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(+(^(a;2);-(^(b;2))))', '(*(+(a;-(b));+(a;b)))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(*(+(a;-(b));+(a;b)))', '(+(^(a;2);-(^(b;2))))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(^(+(a;b);2))', '(+(^(a;2);*(2;a;b);^(b;2)))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(^(a;2);*(2;a;b);^(b;2)))', '(^(+(a;b);2))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(^(a;2);*(2;a);1))', '(^(+(a;1);2))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(^(+(a;-(b));2))', '(+(^(a;2);-(*(2;a;b));^(b;2)))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(^(a;2);-(*(2;a;b));^(b;2)))', '(^(+(a;-(b));2))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(^(a;2);-(*(2;a));1))', '(^(+(a;-(1));2))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(^(+(a;b);3))', '(+(^(a;3);*(3;^(a;2);b);*(3;a;^(b;2));^(b;3)))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(^(a;3);*(3;^(a;2);b);*(3;a;^(b;2));^(b;3)))', '(^(+(a;b);3))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(^(a;3);*(3;^(a;2));*(3;a);1))', '(^(+(a;1);3))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(^(+(a;-(b));3))', '(+(^(a;3);-(*(3;^(a;2);b));*(3;a;^(b;2));-(^(b;3))))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(^(a;3);-(*(3;^(a;2);b));*(3;a;^(b;2));-(^(b;3))))', '(^(+(a;-(b));3))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(^(a;3);-(*(3;^(a;2)));*(3;a);-(1)))', '(^(+(a;-(1));3))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(^(a;3);-(^(b;3))))', '(*(+(a;-(b));+(^(a;2);*(a;b);^(b;2))))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(*(+(a;-(b));+(^(a;2);*(a;b);^(b;2))))', '(+(^(a;3);-(^(b;3))))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(*(+(a;-(1));+(^(a;2);a;1)))', '(+(^(a;3);-(^(1;3))))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(^(a;3);^(b;3)))', '(*(+(a;b);+(^(a;2);-(*(a;b));^(b;2))))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(*(+(a;b);+(^(a;2);-(*(a;b));^(b;2))))', '(+(^(a;3);^(b;3)))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(*(+(a;1);+(^(a;2);-(a);1)))', '(+(^(a;3);^(1;3)))', false, true, false, false, 25, '')]));
  }
  function getLogarithmSubstitutions() {
    return plus(getShortMultiplicationSubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(^(a;log(b;a)))', '(b)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(log(1;A))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(log(A;A))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(log(*(b;c);a))', '(+(log(b;a);log(c;a)))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(log(b;a);log(c;a)))', '(log(*(b;c);a))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(log(*(b;c;d);a))', '(+(log(b;a);log(c;a);log(d;a)))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(log(b;a);log(c;a);log(d;a)))', '(log(*(b;c;d);a))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(log(*(b;c;d;e);a))', '(+(log(b;a);log(c;a);log(d;a);log(e;a)))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(log(b;a);log(c;a);log(d;a);log(e;a)))', '(log(*(b;c;d;e);a))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(log(/(b;c);a))', '(+(log(b;a);-(log(c;a))))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(log(b;a);-(log(c;a))))', '(log(/(b;c);a))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(log(^(b;c);a))', '(*(c;log(b;a)))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(*(c;log(b;a)))', '(log(^(b;c);a))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(*(log(b;a);c))', '(log(^(b;c);a))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(log(b;^(a;k)))', '(/(log(b;a);k))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(/(log(b;a);k))', '(log(b;^(a;k)))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(/(1;log(b;a)))', '(log(a;b))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(log(a;b))', '(/(1;log(b;a)))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(/(log(c;a);log(b;a)))', '(log(c;b))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(log(/(b;c);a))', '(+(-(log(/(c;b);a))))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(-(log(/(c;b);a))))', '(log(/(b;c);a))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(log(b;a))', '(+(-(log(/(1;b);a))))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(-(log(/(1;b);a))))', '(log(b;a))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(log(/(1;b);a))', '(+(-(log(b;a))))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(-(log(b;a))))', '(log(/(1;b);a))', false, false, false, false, 25, '')]));
  }
  function getFactorialSubstitutions() {
    return plus(getArithmeticPowSubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(factorial(+(n;1)))', '(*(factorial(n);+(n;1)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(factorial(n);+(n;1)))', '(factorial(+(n;1)))', false, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(factorial(+(n;1));+(n;1)))', '(factorial(n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(factorial(n))', '(/(factorial(+(n;1));+(n;1)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(factorial(+(n;1));factorial(n)))', '(+(n;1))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(n;1))', '(/(factorial(+(n;1));factorial(n)))', false, false, false, true, 80, ''), expressionSubstitutionFromStructureStrings('(factorial(n))', '(*(factorial(+(n;-(1)));n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(factorial(+(n;-(1)));n))', '(factorial(n))', false, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(factorial(n);n))', '(factorial(+(n;-(1))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(factorial(+(n;-(1))))', '(/(factorial(n);n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(factorial(n);factorial(+(n;-(1)))))', '(n)', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(n)', '(/(factorial(n);factorial(+(n;-(1)))))', false, false, false, true, 85, '')]));
  }
  function getCombinatoricsSubstitutions() {
    return plus(getFactorialSubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(U(m;n))', '(^(m;n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(m;n))', '(U(m;n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(P(n))', '(factorial(n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(factorial(n))', '(P(n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(A(n;n))', '(P(n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(P(n))', '(A(n;n))', false, false, false, true, 70, ''), expressionSubstitutionFromStructureStrings('(*(C(m;n);P(n)))', '(A(m;n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(A(m;n))', '(*(C(m;n);P(n)))', false, false, false, true, 80, ''), expressionSubstitutionFromStructureStrings('(/(A(m;n);P(n)))', '(C(m;n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(C(m;n))', '(/(A(m;n);P(n)))', false, false, false, true, 80, ''), expressionSubstitutionFromStructureStrings('(/(A(m;n);C(m;n)))', '(P(n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(P(n))', '(/(A(m;n);C(m;n)))', false, false, false, true, 80, ''), expressionSubstitutionFromStructureStrings('(V(+(m;1);n))', '(/(factorial(+(m;n));*(factorial(m);factorial(n))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(factorial(+(m;n));*(factorial(m);factorial(n))))', '(V(+(m;1);n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(factorial(+(m;n)))', '(*(V(+(m;1);n);*(factorial(m);factorial(n))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(V(+(m;1);n);*(factorial(m);factorial(n))))', '(factorial(+(m;n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(factorial(m);factorial(n)))', '(/(factorial(+(m;n));V(+(m;1);n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(factorial(+(m;n));V(+(m;1);n)))', '(*(factorial(m);factorial(n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(C(+(m;n);n))', '(/(factorial(+(m;n));*(factorial(m);factorial(n))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(C(+(m;n);n))', '(V(+(m;1);n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(V(+(m;1);n))', '(C(+(m;n);n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(A(+(m;n);n))', '(/(factorial(+(m;n));factorial(m)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(factorial(+(m;n));factorial(m)))', '(A(+(m;n);n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(factorial(+(m;n)))', '(*(A(+(m;n);n);factorial(m)))', false, false, false, true, 80, ''), expressionSubstitutionFromStructureStrings('(*(A(+(m;n);n);factorial(m)))', '(factorial(+(m;n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(factorial(m);A(+(m;n);n)))', '(factorial(+(m;n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(factorial(m))', '(/(factorial(+(m;n));A(+(m;n);n)))', false, false, false, true, 80, ''), expressionSubstitutionFromStructureStrings('(/(factorial(+(m;n));A(+(m;n);n)))', '(factorial(m))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(S1(m;n))', '(*(factorial(n);S2(m;n)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(factorial(n);S2(m;n)))', '(S1(m;n))', false, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(factorial(n))', '(/(S1(m;n);S2(m;n)))', false, false, false, true, 80, ''), expressionSubstitutionFromStructureStrings('(/(S1(m;n);S2(m;n)))', '(factorial(n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(S2(m;n))', '(/(S1(m;n);factorial(n)))', false, false, false, true, 80, ''), expressionSubstitutionFromStructureStrings('(/(S1(m;n);factorial(n)))', '(S2(m;n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(S2(+(m;1);+(n;1)))', '(+(S2(m;n);*(n;S2(m;+(n;1)))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(S2(m;n);*(n;S2(m;+(n;1)))))', '(S2(+(m;1);+(n;1)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(S2(m;m))', '(1)', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(1)', '(S2(m;n))', false, false, false, true, 90, ''), expressionSubstitutionFromStructureStrings('(C(*(2;n);n))', '(*(C(n);+(n;1)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(C(n);+(n;1)))', '(C(*(2;n);n))', false, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(C(n))', '(/(C(*(2;n);n);+(n;1)))', false, false, false, true, 80, ''), expressionSubstitutionFromStructureStrings('(/(C(*(2;n);n);+(n;1)))', '(C(n))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(+(n;1))', '(/(C(*(2;n);n);C(n)))', false, false, false, true, 80, ''), expressionSubstitutionFromStructureStrings('(/(C(*(2;n);n);C(n)))', '(+(n;1))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(C(0))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(1)', '(C(0))', false, false, false, true, 90, '')]));
  }
  function getTrigonometrySubstitutions() {
    return plus(getArithmeticPowSubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(+(^(sin(a);2);^(cos(a);2)))', '(1)', false, true, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(+(1;-(^(sin(a);2))))', '(^(cos(a);2))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(^(cos(a);2))', '(+(1;-(^(sin(a);2))))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(cos(a))', '(^(+(1;-(^(sin(a);2)));0.5))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(1;-(^(cos(a);2))))', '(^(sin(a);2))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(^(sin(a);2))', '(+(1;-(^(cos(a);2))))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(sin(a))', '(^(+(1;-(^(cos(a);2)));0.5))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(/(1;^(cos(a);2)))', '(+(1;^(tg(a);2)))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(1;^(tg(a);2)))', '(/(1;^(cos(a);2)))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(/(1;^(sin(a);2)))', '(+(1;^(ctg(a);2)))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(+(1;^(ctg(a);2)))', '(/(1;^(sin(a);2)))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(/(1;+(1;^(tg(a);2))))', '(^(cos(a);2))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(^(cos(a);2))', '(/(1;+(1;^(tg(a);2))))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(/(1;+(1;^(ctg(a);2))))', '(^(sin(a);2))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(^(sin(a);2))', '(/(1;+(1;^(ctg(a);2))))', false, true, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(*(tg(a);ctg(a)))', '(1)', false, true, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(/(sin(a);cos(a)))', '(tg(a))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(tg(a))', '(/(sin(a);cos(a)))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(/(cos(a);sin(a)))', '(ctg(a))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(ctg(a))', '(/(cos(a);sin(a)))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(/(1;ctg(a)))', '(tg(a))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(tg(a))', '(/(1;ctg(a)))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(/(1;tg(a)))', '(ctg(a))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(ctg(a))', '(/(1;tg(a)))', false, false, false, false, 25, ''), expressionSubstitutionFromStructureStrings('(sin(+(a;b)))', '(+(*(sin(a);cos(b));*(sin(b);cos(a))))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(+(*(sin(a);cos(b));*(sin(b);cos(a))))', '(sin(+(a;b)))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(sin(+(a;-(b))))', '(+(*(sin(a);cos(b));-(*(sin(b);cos(a)))))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(+(*(sin(a);cos(b));-(*(sin(b);cos(a)))))', '(sin(+(a;-(b))))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(cos(+(a;b)))', '(+(*(cos(a);cos(b));-(*(sin(b);sin(a)))))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(+(*(cos(a);cos(b));-(*(sin(b);sin(a)))))', '(cos(+(a;b)))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(cos(+(a;-(b))))', '(+(*(cos(a);cos(b));*(sin(b);sin(a))))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(+(*(cos(a);cos(b));*(sin(b);sin(a))))', '(cos(+(a;-(b))))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(sin(*(2;a)))', '(*(2;sin(a);cos(a)))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(*(2;sin(a);cos(a)))', '(sin(*(2;a)))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(cos(*(2;a)))', '(+(^(cos(a);2);-(^(sin(a);2))))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(+(^(cos(a);2);-(^(sin(a);2))))', '(cos(*(2;a)))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(+(-(^(sin(a);2));^(cos(a);2)))', '(cos(*(2;a)))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(cos(*(2;a)))', '(+(1;-(*(2;^(sin(a);2)))))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(+(1;-(*(2;^(sin(a);2)))))', '(cos(*(2;a)))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(+(-(*(2;^(sin(a);2)));1))', '(cos(*(2;a)))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(cos(*(2;a)))', '(+(*(2;^(cos(a);2));-(1)))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(+(*(2;^(cos(a);2));-(1)))', '(cos(*(2;a)))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(+(-(1);*(2;^(cos(a);2))))', '(cos(*(2;a)))', false, true, false, false, 24, ''), expressionSubstitutionFromStructureStrings('(+(sin(a);sin(b)))', '(*(2;sin(/(+(a;b);2));cos(/(+(a;-(b));2))))', false, true, false, false, 23, ''), expressionSubstitutionFromStructureStrings('(+(sin(a);-(sin(b))))', '(*(2;sin(/(+(a;-(b));2));cos(/(+(a;b);2))))', false, true, false, false, 23, ''), expressionSubstitutionFromStructureStrings('(+(cos(a);cos(b)))', '(*(2;cos(/(+(a;b);2));cos(/(+(a;-(b));2))))', false, true, false, false, 23, ''), expressionSubstitutionFromStructureStrings('(+(cos(a);-(cos(b))))', '(*(2;sin(/(+(a;-(b));2));sin(/(+(a;b);2))))', false, true, false, false, 23, ''), expressionSubstitutionFromStructureStrings('(*(sin(a);sin(b)))', '(/(+(cos(+(a;-(b)));-(cos(+(a;b))));2))', false, true, false, false, 23, ''), expressionSubstitutionFromStructureStrings('(*(sin(a);cos(b)))', '(/(+(sin(+(a;-(b)));sin(+(a;b)));2))', false, true, false, false, 23, ''), expressionSubstitutionFromStructureStrings('(*(cos(a);cos(b)))', '(/(+(cos(+(a;-(b)));cos(+(a;b)));2))', false, true, false, false, 23, ''), expressionSubstitutionFromStructureStrings('(sin(+(-(a))))', '(+(-(sin(a))))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(+(-(sin(a))))', '(sin(+(-(a))))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(-(sin(a)))', '(sin(+(-(a))))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(cos(+(-(a))))', '(cos(a))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(cos(a))', '(cos(+(-(a))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(cos(+(\u03C0;a)))', '(+(-(cos(-(a)))))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(cos(+(\u03C0;-(a))))', '(+(-(cos(a))))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(+(-(cos(a))))', '(cos(+(\u03C0;-(a))))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(-(cos(a)))', '(cos(+(\u03C0;-(a))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(sin(+(\u03C0;a)))', '(sin(+(-(a))))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(sin(+(\u03C0;-(a))))', '(sin(a))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(sin(a))', '(sin(+(\u03C0;-(a))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(sin(+(/(\u03C0;2);-(a))))', '(cos(a))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(sin(+(/(\u03C0;2);a)))', '(cos(+(-(a))))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(cos(a))', '(sin(+(/(\u03C0;2);-(a))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(cos(+(/(\u03C0;2);-(a))))', '(sin(a))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(cos(+(/(\u03C0;2);a)))', '(sin(+(-(a))))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(sin(a))', '(cos(+(/(\u03C0;2);-(a))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(sin(+(-(a))))', '(+(-(sin(a))))', false, false, false, false, 17, ''), expressionSubstitutionFromStructureStrings('(sin(-(a)))', '(+(-(sin(a))))', false, false, false, false, 17, ''), expressionSubstitutionFromStructureStrings('(+(-(sin(a))))', '(sin(+(-(a))))', false, false, false, false, 17, ''), expressionSubstitutionFromStructureStrings('(-(sin(a)))', '(sin(+(-(a))))', false, false, false, false, 17, ''), expressionSubstitutionFromStructureStrings('(sin(+(b;-(a))))', '(+(-(sin(+(a;-(b))))))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(+(-(sin(+(a;-(b))))))', '(sin(+(b;-(a))))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(cos(+(-(a))))', '(cos(a))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(cos(-(a)))', '(cos(a))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(cos(a))', '(cos(+(-(a))))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(cos(+(a;-(b))))', '(cos(+(b;-(a))))', false, false, false, false, 14, ''), expressionSubstitutionFromStructureStrings('(sin(0))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(0)', '(sin(0))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(sin(\u03C0))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(0)', '(sin(\u03C0))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(sin(/(\u03C0;2)))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(1)', '(sin(/(\u03C0;2)))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(cos(0))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(1)', '(cos(0))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(cos(\u03C0))', '(+(-(1)))', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(+(-(1)))', '(cos(\u03C0))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(-(1))', '(cos(\u03C0))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(cos(/(\u03C0;2)))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(0)', '(cos(/(\u03C0;2)))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(sin(/(\u03C0;6)))', '(/(1;2))', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(0.5)', '(sin(/(\u03C0;6)))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(sin(/(\u03C0;4)))', '(/(^(2;/(1;2));2))', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(/(^(2;0.5);2))', '(sin(/(\u03C0;4)))', false, false, false, false, 13, ''), expressionSubstitutionFromStructureStrings('(sin(/(\u03C0;3)))', '(/(^(3;/(1;2));2))', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(/(^(3;0.5);2))', '(sin(/(\u03C0;3)))', false, false, false, false, 13, ''), expressionSubstitutionFromStructureStrings('(cos(/(\u03C0;3)))', '(/(1;2))', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(0.5)', '(cos(/(\u03C0;3)))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(cos(/(\u03C0;4)))', '(/(^(2;/(1;2));2))', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(/(^(2;0.5);2))', '(cos(/(\u03C0;4)))', false, false, false, false, 13, ''), expressionSubstitutionFromStructureStrings('(cos(/(\u03C0;6)))', '(/(^(3;/(1;2));2))', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(/(^(3;0.5);2))', '(cos(/(\u03C0;6)))', false, false, false, false, 13, ''), expressionSubstitutionFromStructureStrings('(tg(/(\u03C0;4)))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(1)', '(tg(/(\u03C0;4)))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(ctg(/(\u03C0;4)))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(1)', '(ctg(/(\u03C0;4)))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(tg(0))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(0)', '(tg(0))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(ctg(/(\u03C0;2)))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(0)', '(ctg(/(\u03C0;2)))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(sin(a))', '(+(-(sin(+(a;\u03C0)))))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(sin(a))', '(+(-(sin(+(a;-(\u03C0))))))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(cos(a))', '(+(-(cos(+(a;\u03C0)))))', false, false, false, false, 89, ''), expressionSubstitutionFromStructureStrings('(cos(a))', '(+(-(cos(+(a;-(\u03C0))))))', false, false, false, false, 89, '')]));
  }
  function getTrigonometryZkSubstitutions() {
    return plus(getTrigonometrySubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(sin(+(a;*(2;\u03C0;k))))', '(sin(a))', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(cos(+(a;*(2;\u03C0;k))))', '(cos(a))', false, false, false, false, 30, '')]));
  }
  function getTrigonometryCompleteTgCtgSubstitutions() {
    return plus(getTrigonometrySubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(sin(*(2;a)))', '(/(*(2;tg(a));+(1;^(tg(a);2))))', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(/(*(2;tg(a));+(1;^(tg(a);2))))', '(sin(*(2;a)))', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(cos(*(2;a)))', '(/(+(1;-(^(tg(a);2)));+(1;^(tg(a);2))))', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(/(+(1;-(^(tg(a);2)));+(1;^(tg(a);2))))', '(cos(*(2;a)))', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(tg(+(a;b)))', '(/(+(tg(a);tg(b));+(1;-(*(tg(a);tg(b))))))', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(/(+(tg(a);tg(b));+(1;-(*(tg(a);tg(b))))))', '(tg(+(a;b)))', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(tg(+(a;-(b))))', '(/(+(tg(a);-(tg(b)));+(1;*(tg(a);tg(b)))))', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(/(+(tg(a);-(tg(b)));+(1;*(tg(a);tg(b)))))', '(tg(+(a;-(b))))', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(ctg(+(a;b)))', '(/(+(*(ctg(a);ctg(b));-(1));+(ctg(a);ctg(b))))', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(/(+(*(ctg(a);ctg(b));-(1));+(ctg(a);ctg(b))))', '(ctg(+(a;b)))', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(ctg(+(a;-(b))))', '(/(+(*(ctg(a);ctg(b));1);+(ctg(a);-(ctg(b)))))', false, false, false, false, 30, ''), expressionSubstitutionFromStructureStrings('(/(+(*(ctg(a);ctg(b));1);+(ctg(a);-(ctg(b)))))', '(ctg(+(a;-(b))))', false, false, false, false, 30, '')]));
  }
  function getSetBaseSubstitutions() {
    return mutableListOf([expressionSubstitutionFromStructureStrings('(not(and(A;B)))', '(or(not(A);not(B)))', false, false, false, false, 15, ''), expressionSubstitutionFromStructureStrings('(or(not(A);not(B)))', '(not(and(A;B)))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(not(or(A;B)))', '(and(not(A);not(B)))', false, false, false, false, 15, ''), expressionSubstitutionFromStructureStrings('(and(not(A);not(B)))', '(not(or(A;B)))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(not(not(a)))', '(a)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(a)', '(not(not(a)))', false, false, false, true, 89, ''), expressionSubstitutionFromStructureStrings('(or(a;a))', '(a)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(a)', '(or(a;a))', false, false, false, true, 90, ''), expressionSubstitutionFromStructureStrings('(and(a;a))', '(a)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(a)', '(and(a;a))', false, false, false, true, 90, ''), expressionSubstitutionFromStructureStrings('(and(a;b))', '(and(b;a))', false, false, false, true, 40, ''), expressionSubstitutionFromStructureStrings('(or(a;b))', '(or(b;a))', false, false, false, true, 40, ''), expressionSubstitutionFromStructureStrings('(a)', '(and(a;1))', false, false, false, true, 90, ''), expressionSubstitutionFromStructureStrings('(a)', '(or(a;0))', false, false, false, true, 90, ''), expressionSubstitutionFromStructureStrings('(or(A;not(A)))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(or(not(A);A))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(A;not(A)))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(not(A);A))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(or(A;1))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(or(1;A))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(A;1))', '(A)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(1;A))', '(A)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(or(A;0))', '(A)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(or(0;A))', '(A)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(A;0))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(0;A))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(not(0))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(not(1))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 5, 'SimpleComputation'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 5, 'ZeroComputation'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 92, 'SetComplicatingExtension'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 30, 'ParentBracketsExpansion'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 40, 'ArgumentsSwap'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 40, 'ArgumentsPermutation'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 30, 'OpeningBrackets'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 41, 'ArgumentsPermutationInOriginalOrder'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 10, 'ReduceArithmetic'), expressionSubstitutionFromStructureStrings('', '', false, false, false, false, 10, 'TwoSidesArithmeticReduce'), expressionSubstitutionFromStructureStrings('(or(not(A);B))', '(implic(A;B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(or(B;not(A)))', '(implic(A;B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(implic(A;B))', '(or(not(A);B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(and(A;not(B)))', '(set-(A;B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(and(not(B);A))', '(set-(A;B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(set-(A;B))', '(and(A;not(B)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(set-(A;B))', '(not(implic(A;B)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(not(implic(A;B)))', '(set-(A;B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(implic(A;B))', '(not(set-(A;B)))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(not(set-(A;B)))', '(implic(A;B))', false, false, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(set-(A;0))', '(A)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(set-(A;1))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(set-(0;A))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(set-(1;A))', '(not(A))', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(implic(0;A))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(implic(A;1))', '(1)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(implic(A;0))', '(not(A))', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(implic(1;A))', '(A)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(A)', '(set-(A;0))', false, false, false, true, 91, ''), expressionSubstitutionFromStructureStrings('(A)', '(implic(1;A))', false, false, false, true, 91, '')]);
  }
  function getSetAbsorptionLawSubstitutions() {
    return plus(getSetBaseSubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(and(A;or(A;B)))', '(A)', false, false, false, false, 6, ''), expressionSubstitutionFromStructureStrings('(or(A;and(A;B)))', '(A)', false, false, false, false, 6, ''), expressionSubstitutionFromStructureStrings('(and(A;or(B;A)))', '(A)', false, false, false, false, 6, ''), expressionSubstitutionFromStructureStrings('(or(A;and(B;A)))', '(A)', false, false, false, false, 6, ''), expressionSubstitutionFromStructureStrings('(and(or(A;B);A))', '(A)', false, false, false, false, 6, ''), expressionSubstitutionFromStructureStrings('(or(and(A;B);A))', '(A)', false, false, false, false, 6, ''), expressionSubstitutionFromStructureStrings('(and(or(B;A);A))', '(A)', false, false, false, false, 6, ''), expressionSubstitutionFromStructureStrings('(or(and(B;A);A))', '(A)', false, false, false, false, 6, ''), expressionSubstitutionFromStructureStrings('(A)', '(and(A;or(A;B)))', false, false, false, true, 90, ''), expressionSubstitutionFromStructureStrings('(A)', '(or(A;and(A;B)))', false, false, false, true, 90, '')]));
  }
  function getSetResolutionSubstitutions() {
    return plus(getSetBaseSubstitutions(), mutableListOf([expressionSubstitutionFromStructureStrings('(and(not(A);A))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(A;not(A)))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);not(A)))', '(and(X;or(A;X);not(A)))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);or(A;X)))', '(and(X;not(A);or(A;X)))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);A))', '(and(X;or(not(A);X);A))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(A;or(not(A);X)))', '(and(X;A;or(not(A);X)))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);or(not(A);Y)))', '(and(or(X;Y);or(A;X);or(not(A);Y)))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);or(A;Y)))', '(and(or(X;Y);or(not(A);X);or(A;Y)))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);A;C))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(A;not(A);C))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);not(A);C))', '(and(X;or(A;X);not(A);C))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);or(A;X);C))', '(and(X;not(A);or(A;X);C))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);A;C))', '(and(X;or(not(A);X);A;C))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(A;or(not(A);X);C))', '(and(X;A;or(not(A);X);C))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);or(not(A);Y);C))', '(and(or(X;Y);or(A;X);or(not(A);Y);C))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);or(A;Y);C))', '(and(or(X;Y);or(not(A);X);or(A;Y);C))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);A;C;D))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(A;not(A);C;D))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);not(A);C;D))', '(and(X;or(A;X);not(A);C;D))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);or(A;X);C;D))', '(and(X;not(A);or(A;X);C;D))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);A;C;D))', '(and(X;or(not(A);X);A;C;D))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(A;or(not(A);X);C;D))', '(and(X;A;or(not(A);X);C;D))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);or(not(A);Y);C;D))', '(and(or(X;Y);or(A;X);or(not(A);Y);C;D))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);or(A;Y);C;D))', '(and(or(X;Y);or(not(A);X);or(A;Y);C;D))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);A;C;D;E))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(A;not(A);C;D;E))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);not(A);C;D;E))', '(and(X;or(A;X);not(A);C;D;E))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);or(A;X);C;D;E))', '(and(X;not(A);or(A;X);C;D;E))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);A;C;D;E))', '(and(X;or(not(A);X);A;C;D;E))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(A;or(not(A);X);C;D;E))', '(and(X;A;or(not(A);X);C;D;E))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);or(not(A);Y);C;D;E))', '(and(or(X;Y);or(A;X);or(not(A);Y);C;D;E))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);or(A;Y);C;D;E))', '(and(or(X;Y);or(not(A);X);or(A;Y);C;D;E))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);A;C;D;E;F))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(A;not(A);C;D;E;F))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);not(A);C;D;E;F))', '(and(X;or(A;X);not(A);C;D;E;F))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);or(A;X);C;D;E;F))', '(and(X;not(A);or(A;X);C;D;E;F))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);A;C;D;E;F))', '(and(X;or(not(A);X);A;C;D;E;F))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(A;or(not(A);X);C;D;E;F))', '(and(X;A;or(not(A);X);C;D;E;F))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);or(not(A);Y);C;D;E;F))', '(and(or(X;Y);or(A;X);or(not(A);Y);C;D;E;F))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);or(A;Y);C;D;E;F))', '(and(or(X;Y);or(not(A);X);or(A;Y);C;D;E;F))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);A;C;D;E;F;G))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(A;not(A);C;D;E;F;G))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);not(A);C;D;E;F;G))', '(and(X;or(A;X);not(A);C;D;E;F;G))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);or(A;X);C;D;E;F;G))', '(and(X;not(A);or(A;X);C;D;E;F;G))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);A;C;D;E;F;G))', '(and(X;or(not(A);X);A;C;D;E;F;G))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(A;or(not(A);X);C;D;E;F;G))', '(and(X;A;or(not(A);X);C;D;E;F;G))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);or(not(A);Y);C;D;E;F;G))', '(and(or(X;Y);or(A;X);or(not(A);Y);C;D;E;F;G))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);or(A;Y);C;D;E;F;G))', '(and(or(X;Y);or(not(A);X);or(A;Y);C;D;E;F;G))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);A;C;D;E;F;G;H))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(A;not(A);C;D;E;F;G;H))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);not(A);C;D;E;F;G;H))', '(and(X;or(A;X);not(A);C;D;E;F;G;H))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);or(A;X);C;D;E;F;G;H))', '(and(X;not(A);or(A;X);C;D;E;F;G;H))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);A;C;D;E;F;G;H))', '(and(X;or(not(A);X);A;C;D;E;F;G;H))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(A;or(not(A);X);C;D;E;F;G;H))', '(and(X;A;or(not(A);X);C;D;E;F;G;H))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);or(not(A);Y);C;D;E;F;G;H))', '(and(or(X;Y);or(A;X);or(not(A);Y);C;D;E;F;G;H))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);or(A;Y);C;D;E;F;G;H))', '(and(or(X;Y);or(not(A);X);or(A;Y);C;D;E;F;G;H))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);A;C;D;E;F;G;H;I))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(A;not(A);C;D;E;F;G;H;I))', '(0)', false, false, false, false, 5, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);not(A);C;D;E;F;G;H;I))', '(and(X;or(A;X);not(A);C;D;E;F;G;H;I))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(not(A);or(A;X);C;D;E;F;G;H;I))', '(and(X;not(A);or(A;X);C;D;E;F;G;H;I))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);A;C;D;E;F;G;H;I))', '(and(X;or(not(A);X);A;C;D;E;F;G;H;I))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(A;or(not(A);X);C;D;E;F;G;H;I))', '(and(X;A;or(not(A);X);C;D;E;F;G;H;I))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(A;X);or(not(A);Y);C;D;E;F;G;H;I))', '(and(or(X;Y);or(A;X);or(not(A);Y);C;D;E;F;G;H;I))', false, false, false, false, 10, ''), expressionSubstitutionFromStructureStrings('(and(or(not(A);X);or(A;Y);C;D;E;F;G;H;I))', '(and(or(X;Y);or(not(A);X);or(A;Y);C;D;E;F;G;H;I))', false, false, false, false, 10, '')]));
  }
  function getPhysicsNuclearSubstitutions() {
    return mutableListOf([expressionSubstitutionFromStructureStrings('(m)', '(/(E;^(c;2)))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(E;^(c;2)))', '(m)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(c)', '(^(/(E;m);/(1;2)))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(/(E;m);0.5))', '(c)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(E)', '(*(m;^(c;2)))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(m;^(c;2)))', '(E)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(h)', '(/(E;\u03BD))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(E;\u03BD))', '(h)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(\u03BD)', '(/(E;h))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(E;h))', '(\u03BD)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(E)', '(*(h;\u03BD))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(h;\u03BD))', '(E)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(\u03BB)', '(/(c;\u03BD))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(c;\u03BD))', '(\u03BB)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(\u03BD)', '(/(c;\u03BB))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(c;\u03BB))', '(\u03BD)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(c)', '(*(\u03BB;\u03BD))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(\u03BB;\u03BD))', '(c)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(c)', '(/(p;m))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(p;m))', '(c)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(m)', '(/(p;c))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(p;c))', '(m)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(p)', '(*(m;c))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(m;c))', '(p)', true, true, false, false, 35, '')]);
  }
  function getPhysicsCircleMovingSubstitutions() {
    return mutableListOf([expressionSubstitutionFromStructureStrings('(\u03C9)', '(/(*(2;\u03C0);T))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(2;\u03C0);T))', '(\u03C9)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(T)', '(/(*(2;\u03C0);\u03C9))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(2;\u03C0);\u03C9))', '(T)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(\u03C9)', '(*(2;\u03C0;v))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(2;\u03C0;v))', '(\u03C9)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(v)', '(/(\u03C9;*(2;\u03C0)))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(\u03C9;*(2;\u03C0)))', '(v)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(\u03C9)', '(/(v;R))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(v;R))', '(\u03C9)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(R)', '(/(v;\u03C9))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(v;\u03C9))', '(R)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(v)', '(*(\u03C9;R))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(\u03C9;R))', '(v)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(a)', '(/(^(v;2);R))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(^(v;2);R))', '(a)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(R)', '(/(^(v;2);a))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(^(v;2);a))', '(R)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(v)', '(^(*(a;R);/(1;2)))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(*(a;R);0.5))', '(v)', true, true, false, false, 35, '')]);
  }
  function getPhysicsMolecularSubstitutions() {
    return mutableListOf([expressionSubstitutionFromStructureStrings('(P)', '(/(F;S))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(F;S))', '(P)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(S)', '(/(F;P))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(F;P))', '(S)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(F)', '(*(P;S))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(P;S))', '(F)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(m)', '(/(F;a))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(F;a))', '(m)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(a)', '(/(F;P))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(F;m))', '(a)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(F)', '(*(m;a))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(m;a))', '(F)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(\u03BD)', '(/(m;\u03BC))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(m;\u03BC))', '(\u03BD)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(\u03BC)', '(/(m;\u03BD))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(m;\u03BD))', '(\u03BC)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(m)', '(*(\u03BD;\u03BC))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(\u03BD;\u03BC))', '(m)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(\u03BD)', '(/(N;N\u2090))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(N;N\u2090))', '(\u03BD)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(N\u2090)', '(/(N;\u03BD))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(N;\u03BD))', '(N\u2090)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(N)', '(*(\u03BD;N\u2090))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(\u03BD;N\u2090))', '(N)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(k)', '(/(R;N\u2090))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(R;N\u2090))', '(k)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(N\u2090)', '(/(R;k))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(R;k))', '(N\u2090)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(R)', '(*(k;N\u2090))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(k;N\u2090))', '(R)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(n)', '(/(N;V))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(N;V))', '(n)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(V)', '(/(N;n))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(N;n))', '(V)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(N)', '(*(n;V))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(n;V))', '(N)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(P)', '(*(n;k;T))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(n;k;T))', '(P)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(T)', '(/(*(n;k);P))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(n;k);P))', '(T)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(P;V))', '(*(\u03BD;R;T))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(\u03BD;R;T))', '(*(P;V))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(P)', '(/(*(\u03BD;R;T);V))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(\u03BD;R;T);V))', '(P)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(V)', '(/(*(\u03BD;R;T);P))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(\u03BD;R;T);P))', '(V)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(T)', '(/(*(P;V);*(\u03BD;R)))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(P;V);*(\u03BD;R)))', '(T)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(U)', '(*(N;/(3;2);k;T))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(N;/(3;2);k;T))', '(U)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(U)', '(*(/(3;2);\u03BD;R;T))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(/(3;2);\u03BD;R;T))', '(U)', true, true, false, false, 35, '')]);
  }
  function getPhysicsSimpleMovingSubstitutions() {
    return mutableListOf([expressionSubstitutionFromStructureStrings('(s)', '(/(v;t))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(s;t))', '(v)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(t)', '(/(s;v))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(s;v))', '(t)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(s)', '(*(v;t))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(v;t))', '(s)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(a)', '(/(v;t))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(v;t))', '(a)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(t)', '(/(v;a))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(v;a))', '(t)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(v)', '(*(a;t))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(a;t))', '(v)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(s)', '(/(*(a;^(t;2));2))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(a;^(t;2));2))', '(s)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(a)', '(/(*(2;s);^(t;2)))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(2;s);^(t;2)))', '(a)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(t)', '(^(/(*(2;s);a);0.5))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(^(/(*(2;s);a);0.5))', '(t)', true, true, false, false, 35, '')]);
  }
  function getPhysicsElectrodynamicsSubstitutions() {
    return mutableListOf([expressionSubstitutionFromStructureStrings('(I)', '(/(q;t))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(q;t))', '(I)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(t)', '(/(q;I))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(q;I))', '(t)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(q)', '(*(I;t))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(I;t))', '(q)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(q)', '(/(A;U))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;U))', '(q)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(U)', '(/(A;q))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;q))', '(U)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(A)', '(*(U;q))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(U;q))', '(A)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(S)', '(/(*(\u03C1;l);R))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(\u03C1;l);R))', '(S)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(R)', '(/(*(\u03C1;l);S))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(\u03C1;l);S))', '(R)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(l)', '(/(*(S;R);\u03C1))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(S;R);\u03C1))', '(l)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(\u03C1)', '(/(*(S;R);l))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(S;R);l))', '(\u03C1)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(S;R))', '(*(\u03C1;l))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(\u03C1;l))', '(*(S;R))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(I)', '(/(U;R))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(U;R))', '(I)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(R)', '(/(U;I))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(U;I))', '(R)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(U)', '(*(I;R))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(I;R))', '(U)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(P)', '(/(A;t))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;t))', '(P)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(t)', '(/(A;P))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(A;P))', '(t)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(A)', '(*(P;t))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(P;t))', '(A)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(U)', '(/(P;I))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(P;I))', '(U)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(I)', '(/(P;U))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(P;U))', '(I)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(P)', '(*(I;U))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(I;U))', '(P)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(Q)', '(A)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(A)', '(Q)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(P)', '(/(Q;t))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(Q;t))', '(P)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(t)', '(/(Q;P))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(Q;P))', '(t)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(Q)', '(*(P;t))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(P;t))', '(Q)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(C)', '(/(q;U))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(q;U))', '(C)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(U)', '(/(q;C))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(q;C))', '(U)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(q)', '(*(U;C))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(U;C))', '(q)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(W)', '(/(*(C;^(U;2));2))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(C;^(U;2));2))', '(W)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(C)', '(/(*(2;W);^(U;2)))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(2;W);^(U;2)))', '(C)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(W)', '(/(*(L;^(I;2));2))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(L;^(I;2));2))', '(W)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(L)', '(/(*(2;W);^(I;2)))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(*(2;W);^(I;2)))', '(L)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(I)', '(/(\u03A8;L))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(\u03A8;L))', '(I)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(L)', '(/(\u03A8;I))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(\u03A8;I))', '(L)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(\u03A8)', '(*(I;L))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(I;L))', '(\u03A8)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(I)', '(/(F\u2090;*(B;l;sin(\u03C6))))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(F\u2090;*(B;l;sin(\u03C6))))', '(I)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(B)', '(/(F\u2090;*(I;l;sin(\u03C6))))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(F\u2090;*(I;l;sin(\u03C6))))', '(B)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(l)', '(/(F\u2090;*(B;I;sin(\u03C6))))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(F\u2090;*(B;I;sin(\u03C6))))', '(l)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(F\u2090)', '(*(I;B;l;sin(\u03C6)))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(I;B;l;sin(\u03C6)))', '(F\u2090)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(B)', '(/(\u03A8;*(S;cos(\u03C6))))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(\u03A8;*(S;cos(\u03C6))))', '(B)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(S)', '(/(\u03A8;*(B;cos(\u03C6))))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(\u03A8;*(B;cos(\u03C6))))', '(S)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(\u03A8)', '(*(B;S;cos(\u03C6)))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(B;S;cos(\u03C6)))', '(\u03A8)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(E)', '(/(F;q))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(F;q))', '(E)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(q)', '(/(F;E))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(F;E))', '(q)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(F)', '(*(E;q))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(E;q))', '(F)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(d)', '(/(U;E))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(U;E))', '(d)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(E)', '(/(U;d))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(/(U;d))', '(E)', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(U)', '(*(E;d))', true, true, false, false, 35, ''), expressionSubstitutionFromStructureStrings('(*(E;d))', '(U)', true, true, false, false, 35, '')]);
  }
  function normalizeExpressionToUsualForm(expression, compiledConfiguration) {
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration();
    var topExpressionNode = expression.getTopNode();
    topExpressionNode.normalizeNullWeightCommutativeFunctions();
    topExpressionNode.reduceExtraSigns_9jge9g$(setOf('+'), setOf('-'));
    topExpressionNode.normilizeSubtructions_hee78y$(compiledConfiguration.functionConfiguration);
    topExpressionNode.normalizeParentLinks();
    topExpressionNode.computeNodeIdsAsNumbersInDirectTraversalAndDistancesToRoot_ydzd23$();
    topExpressionNode.normalizeFunctionStringDefinitions_hee78y$(compiledConfiguration.functionConfiguration);
    topExpressionNode.computeIdentifier_t6ztn0$();
  }
  function compareWithoutSubstitutions_0(left, right, scope, notChangesOnVariablesFunction, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = setOf('');
    if (notChangesOnVariablesFunction === void 0)
      notChangesOnVariablesFunction = setOf_0(['+', '-', '*', '/', '^']);
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration(scope, notChangesOnVariablesFunction);
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    return compiledConfiguration.factComporator.expressionComporator.compareWithoutSubstitutions_15tjed$(left, right);
  }
  function compareByPattern(expression, pattern) {
    return checkExpressionStructure(expression, pattern);
  }
  function compareWithoutSubstitutions_1(left, right, scope, notChangesOnVariablesFunction, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (notChangesOnVariablesFunction === void 0)
      notChangesOnVariablesFunction = '+;-;*;/;^';
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      var tmp$_0 = toSet(destination);
      var $receiver_0 = split(notChangesOnVariablesFunction, [';']);
      var destination_0 = ArrayList_init();
      var tmp$_1;
      tmp$_1 = $receiver_0.iterator();
      while (tmp$_1.hasNext()) {
        var element_0 = tmp$_1.next();
        if (element_0.length > 0)
          destination_0.add_11rb$(element_0);
      }
      functionConfiguration = new FunctionConfiguration(tmp$_0, toSet(destination_0));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    return compareWithoutSubstitutions_0(stringToExpression(left, void 0, void 0, void 0, compiledConfiguration), stringToExpression(right, void 0, void 0, void 0, compiledConfiguration), void 0, void 0, void 0, compiledConfiguration);
  }
  function compareByPattern_0(expression, pattern, scope, notChangesOnVariablesFunction, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (notChangesOnVariablesFunction === void 0)
      notChangesOnVariablesFunction = '+;-;*;/;^';
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      var tmp$_0 = toSet(destination);
      var $receiver_0 = split(notChangesOnVariablesFunction, [';']);
      var destination_0 = ArrayList_init();
      var tmp$_1;
      tmp$_1 = $receiver_0.iterator();
      while (tmp$_1.hasNext()) {
        var element_0 = tmp$_1.next();
        if (element_0.length > 0)
          destination_0.add_11rb$(element_0);
      }
      functionConfiguration = new FunctionConfiguration(tmp$_0, toSet(destination_0));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    return compareByPattern(stringToExpression(expression, void 0, void 0, void 0, compiledConfiguration), stringToExpressionStructurePattern(pattern, void 0, functionConfiguration));
  }
  function compareWithoutSubstitutionsStructureStrings(leftStructureString, rightStructureString, scope, notChangesOnVariablesFunction, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (notChangesOnVariablesFunction === void 0)
      notChangesOnVariablesFunction = '+;-;*;/;^';
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      var tmp$_0 = toSet(destination);
      var $receiver_0 = split(notChangesOnVariablesFunction, [';']);
      var destination_0 = ArrayList_init();
      var tmp$_1;
      tmp$_1 = $receiver_0.iterator();
      while (tmp$_1.hasNext()) {
        var element_0 = tmp$_1.next();
        if (element_0.length > 0)
          destination_0.add_11rb$(element_0);
      }
      functionConfiguration = new FunctionConfiguration(tmp$_0, toSet(destination_0));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    return compareWithoutSubstitutions_0(structureStringToExpression(leftStructureString), structureStringToExpression(rightStructureString), void 0, void 0, void 0, compiledConfiguration);
  }
  function stringToExpression(string, scope, isMathMl, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (isMathMl === void 0)
      isMathMl = false;
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    var expressionTreeParser = new ExpressionTreeParser(string, void 0, compiledConfiguration.functionConfiguration, compiledConfiguration.compiledImmediateVariableReplacements, isMathMl);
    expressionTreeParser.parse();
    return expressionTreeParser.root;
  }
  function expressionToString(expressionNode, characterEscapingDepth) {
    if (characterEscapingDepth === void 0)
      characterEscapingDepth = 1;
    return escapeCharacters(expressionNode.toPlainTextView_odr8sm$(), characterEscapingDepth);
  }
  function expressionToTexString(expressionNode, characterEscapingDepth) {
    if (characterEscapingDepth === void 0)
      characterEscapingDepth = 1;
    return escapeCharacters(expressionNode.toTexView_odr8sm$(), characterEscapingDepth);
  }
  function structureStringToExpression(structureString, scope, functionConfiguration) {
    if (scope === void 0)
      scope = '';
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    var expressionNodeConstructor = new ExpressionNodeConstructor(functionConfiguration);
    var result = expressionNodeConstructor.construct_61zpoe$(structureString);
    result.computeNodeIdsAsNumbersInDirectTraversalAndDistancesToRoot_ydzd23$();
    result.computeIdentifier_t6ztn0$();
    return result;
  }
  function expressionToStructureString(expressionNode) {
    return expressionNode.toString();
  }
  function stringToStructureString(string, scope, isMathMl, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (isMathMl === void 0)
      isMathMl = false;
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    return expressionToStructureString(stringToExpression(string, scope, isMathMl, functionConfiguration, compiledConfiguration));
  }
  function stringToExpressionStructurePattern(string, scope, functionConfiguration) {
    if (scope === void 0)
      scope = '';
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    var expressionStructureConditionConstructor = new ExpressionStructureConditionConstructor();
    return expressionStructureConditionConstructor.parse_61zpoe$(string);
  }
  function investigateIfExpressionFormIsStructureString(expression) {
    if (!endsWith(expression, 41)) {
      return false;
    }
    return true;
  }
  function generateTask_0(expressionSubstitutions, stepsCount, originalExpressions) {
    return generateExpressionTask(expressionSubstitutions, stepsCount, originalExpressions);
  }
  function generateTaskInJSON$lambda(it) {
    return '{' + '"' + 'left' + '"' + ':' + '"' + expressionToString(it.left) + '"' + ',' + '"' + 'right' + '"' + ':' + '"' + expressionToString(it.right) + '"' + '}';
  }
  function generateTaskInJSON$lambda_0(it) {
    return '{' + '"' + 'left' + '"' + ':' + '"' + expressionToString(it.left) + '"' + ',' + '"' + 'right' + '"' + ':' + '"' + expressionToString(it.right) + '"' + '}';
  }
  function generateTaskInJSON(expressionSubstitutions, stepsCount, originalExpressions, scope, characterEscapingDepth, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (characterEscapingDepth === void 0)
      characterEscapingDepth = 1;
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    var $receiver_0 = split(expressionSubstitutions, [';']);
    var destination_0 = ArrayList_init_0(collectionSizeOrDefault($receiver_0, 10));
    var tmp$_0;
    tmp$_0 = $receiver_0.iterator();
    while (tmp$_0.hasNext()) {
      var item = tmp$_0.next();
      var tmp$_1 = destination_0.add_11rb$;
      var parts = split(item, ['=']);
      tmp$_1.call(destination_0, expressionSubstitutionFromStrings_0(first(parts), last(parts), void 0, void 0, void 0, void 0, void 0, void 0, void 0, void 0, compiledConfiguration));
    }
    var $receiver_1 = split(originalExpressions, [';']);
    var destination_1 = ArrayList_init_0(collectionSizeOrDefault($receiver_1, 10));
    var tmp$_2;
    tmp$_2 = $receiver_1.iterator();
    while (tmp$_2.hasNext()) {
      var item_0 = tmp$_2.next();
      destination_1.add_11rb$(stringToExpression(item_0, void 0, void 0, void 0, compiledConfiguration));
    }
    var expressionTask = generateTask_0(destination_0, stepsCount, destination_1);
    return escapeCharacters('{' + ('"' + 'originalExpression' + '"' + ':' + '"' + expressionToString(expressionTask.originalExpression) + '"' + ',') + ('"' + 'finalExpression' + '"' + ':' + '"' + expressionToString(expressionTask.finalExpression) + '"' + ',') + ('"' + 'requiredSubstitutions' + '"' + ':[' + joinToString(expressionTask.requiredSubstitutions, ',', void 0, void 0, void 0, void 0, generateTaskInJSON$lambda) + '],') + ('"' + 'allSubstitutions' + '"' + ':[' + joinToString(expressionTask.allSubstitutions, ',', void 0, void 0, void 0, void 0, generateTaskInJSON$lambda_0) + ']') + '}', characterEscapingDepth);
  }
  function generateTaskByStructureStringsSubstitutionsInJSON$lambda(it) {
    return '{' + '"' + 'left' + '"' + ':' + '"' + expressionToString(it.left) + '"' + ',' + '"' + 'right' + '"' + ':' + '"' + expressionToString(it.right) + '"' + '}';
  }
  function generateTaskByStructureStringsSubstitutionsInJSON$lambda_0(it) {
    return '{' + '"' + 'left' + '"' + ':' + '"' + expressionToString(it.left) + '"' + ',' + '"' + 'right' + '"' + ':' + '"' + expressionToString(it.right) + '"' + '}';
  }
  function generateTaskByStructureStringsSubstitutionsInJSON(expressionSubstitutions, stepsCount, originalExpressions, scope, characterEscapingDepth, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (characterEscapingDepth === void 0)
      characterEscapingDepth = 1;
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    var $receiver_0 = split(expressionSubstitutions, [';']);
    var destination_0 = ArrayList_init_0(collectionSizeOrDefault($receiver_0, 10));
    var tmp$_0;
    tmp$_0 = $receiver_0.iterator();
    while (tmp$_0.hasNext()) {
      var item = tmp$_0.next();
      var tmp$_1 = destination_0.add_11rb$;
      var parts = split(item, ['=']);
      tmp$_1.call(destination_0, expressionSubstitutionFromStructureStrings(first(parts), last(parts)));
    }
    var $receiver_1 = split(originalExpressions, [';']);
    var destination_1 = ArrayList_init_0(collectionSizeOrDefault($receiver_1, 10));
    var tmp$_2;
    tmp$_2 = $receiver_1.iterator();
    while (tmp$_2.hasNext()) {
      var item_0 = tmp$_2.next();
      destination_1.add_11rb$(stringToExpression(item_0, void 0, void 0, void 0, compiledConfiguration));
    }
    var expressionTask = generateTask_0(destination_0, stepsCount, destination_1);
    return escapeCharacters('{' + ('"' + 'originalExpression' + '"' + ':' + '"' + expressionToString(expressionTask.originalExpression) + '"' + ',') + ('"' + 'finalExpression' + '"' + ':' + '"' + expressionToString(expressionTask.finalExpression) + '"' + ',') + ('"' + 'requiredSubstitutions' + '"' + ':[' + joinToString(expressionTask.requiredSubstitutions, ',', void 0, void 0, void 0, void 0, generateTaskByStructureStringsSubstitutionsInJSON$lambda) + '],') + ('"' + 'allSubstitutions' + '"' + ':[' + joinToString(expressionTask.allSubstitutions, ',', void 0, void 0, void 0, void 0, generateTaskByStructureStringsSubstitutionsInJSON$lambda_0) + ']') + '}', characterEscapingDepth);
  }
  function optGenerateSimpleComputationRule(expressionPartOriginal, simpleComputationRuleParams) {
    var tmp$, tmp$_0;
    var result = ArrayList_init();
    var tmp$_1 = !simpleComputationRuleParams.isIncluded || calcComplexity(expressionPartOriginal) > 4;
    if (!tmp$_1) {
      tmp$_1 = !subtract(expressionPartOriginal.getContainedFunctions(), simpleComputationRuleParams.operationsMap.keys).isEmpty();
    }
    if (tmp$_1) {
      return result;
    }
    var expressionPart = expressionPartOriginal.clone();
    expressionPart.variableReplacement_y0zsll$(mapOf(to('\u03C0', '3.1415926535897932384626433832795')));
    if (expressionPart.getContainedVariables().isEmpty()) {
      if (!expressionPart.children.isEmpty()) {
        tmp$ = computeNodeIfSimple(expressionPart, simpleComputationRuleParams);
        if (tmp$ == null) {
          return result;
        }
        var computed = tmp$;
        result.add_11rb$(new ExpressionSubstitution(addRootNodeToExpression(expressionPart.clone()), addRootNodeToExpression(new ExpressionNode(NodeType$VARIABLE_getInstance(), toShortString(computed)))));
      }
       else if (toDoubleOrNull(expressionPart.value) != null) {
        tmp$_0 = toDoubleOrNull(expressionPart.value);
        if (tmp$_0 == null) {
          return result;
        }
        var currentValue = tmp$_0;
        var plusTreeNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '+');
        plusTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), toShortString(currentValue - 1)));
        plusTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
        result.add_11rb$(new ExpressionSubstitution(addRootNodeToExpression(expressionPart.clone()), addRootNodeToExpression(plusTreeNode)));
        var minusTreeNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '+');
        minusTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), toShortString(currentValue + 1)));
        minusTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '-'));
        last(minusTreeNode.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
        result.add_11rb$(new ExpressionSubstitution(addRootNodeToExpression(expressionPart.clone()), addRootNodeToExpression(minusTreeNode)));
        var intCurrentValue = numberToInt(currentValue);
        if (1 < intCurrentValue && intCurrentValue < 145 && toReal_0(intCurrentValue - currentValue).additivelyEqualToZero()) {
          var sqrtValue = numberToInt(Math_0.sqrt(currentValue));
          for (var i = 2; i <= sqrtValue; i++) {
            var div = intCurrentValue / i | 0;
            if (intCurrentValue === Kotlin.imul(i, div)) {
              var mulTreeNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '*');
              mulTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), i.toString()));
              mulTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), div.toString()));
              result.add_11rb$(new ExpressionSubstitution(addRootNodeToExpression(expressionPart.clone()), addRootNodeToExpression(mulTreeNode)));
            }
          }
        }
      }
    }
    return result;
  }
  function expressionSubstitutionFromStrings_0(left, right, scope, basedOnTaskContext, matchJumbledAndNested, priority, code, nameEn, nameRu, functionConfiguration, compiledConfiguration) {
    if (left === void 0)
      left = '';
    if (right === void 0)
      right = '';
    if (scope === void 0)
      scope = '';
    if (basedOnTaskContext === void 0)
      basedOnTaskContext = false;
    if (matchJumbledAndNested === void 0)
      matchJumbledAndNested = false;
    if (priority === void 0)
      priority = 50;
    if (code === void 0)
      code = '';
    if (nameEn === void 0)
      nameEn = '';
    if (nameRu === void 0)
      nameRu = '';
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    return new ExpressionSubstitution(!isBlank(left) ? stringToExpression(left, void 0, void 0, void 0, compiledConfiguration) : new ExpressionNode(NodeType$EMPTY_getInstance(), ''), !isBlank(right) ? stringToExpression(right, void 0, void 0, void 0, compiledConfiguration) : new ExpressionNode(NodeType$EMPTY_getInstance(), ''), void 0, basedOnTaskContext, !isBlank(code) ? code : "'" + stringToStructureString(left, void 0, void 0, void 0, compiledConfiguration) + "'->'" + stringToStructureString(right, void 0, void 0, void 0, compiledConfiguration) + "'", nameEn, nameRu, void 0, void 0, matchJumbledAndNested, priority);
  }
  function expressionSubstitutionFromStructureStrings(leftStructureString, rightStructureString, basedOnTaskContext, matchJumbledAndNested, simpleAdditional, isExtending, priority, code, nameEn, nameRu) {
    if (leftStructureString === void 0)
      leftStructureString = '';
    if (rightStructureString === void 0)
      rightStructureString = '';
    if (basedOnTaskContext === void 0)
      basedOnTaskContext = false;
    if (matchJumbledAndNested === void 0)
      matchJumbledAndNested = false;
    if (simpleAdditional === void 0)
      simpleAdditional = false;
    if (isExtending === void 0)
      isExtending = false;
    if (priority === void 0)
      priority = 50;
    if (code === void 0)
      code = '';
    if (nameEn === void 0)
      nameEn = '';
    if (nameRu === void 0)
      nameRu = '';
    return new ExpressionSubstitution(!isBlank(leftStructureString) ? structureStringToExpression(leftStructureString) : new ExpressionNode(NodeType$EMPTY_getInstance(), ''), !isBlank(rightStructureString) ? structureStringToExpression(rightStructureString) : new ExpressionNode(NodeType$EMPTY_getInstance(), ''), void 0, basedOnTaskContext, !isBlank(code) ? code : "'" + leftStructureString + "'->'" + rightStructureString + "'", nameEn, nameRu, void 0, void 0, matchJumbledAndNested, priority, void 0, simpleAdditional, isExtending);
  }
  function findSubstitutionPlacesInExpression_0(expression, substitution) {
    if (!substitution.leftFunctions.isEmpty() && intersect(substitution.leftFunctions, expression.getContainedFunctions()).isEmpty() && intersect(substitution.left.getContainedVariables(), expression.getContainedVariables()).isEmpty()) {
      return ArrayList_init();
    }
    var expr = expression;
    var result = substitution.findAllPossibleSubstitutionPlaces_6718cy$(expression);
    if (result.isEmpty() && substitution.matchJumbledAndNested && expression.containsNestedSameFunctions()) {
      expr = expression.cloneWithExpandingNestedSameFunctions();
      result = substitution.findAllPossibleSubstitutionPlaces_6718cy$(expr);
    }
    if (result.isEmpty()) {
      expr = expr.cloneAndSimplifyByComputeSimplePlaces_ky12w7$();
      result = substitution.findAllPossibleSubstitutionPlaces_6718cy$(expr);
    }
    return result;
  }
  function applySubstitution_0(expression, substitution, substitutionPlaces) {
    substitution.applySubstitution_55nkop$(substitutionPlaces);
    expression.getTopNode().reduceExtraSigns_9jge9g$(setOf('+'), setOf('-'));
    expression.getTopNode().normilizeSubtructions_hee78y$(new FunctionConfiguration());
    expression.getTopNode().computeNodeIdsAsNumbersInDirectTraversalAndDistancesToRoot_ydzd23$();
    expression.normalizeParentLinks();
    return expression;
  }
  function createCompiledConfigurationFromExpressionSubstitutionsAndParams(expressionSubstitutions, additionalParamsMap) {
    if (additionalParamsMap === void 0) {
      additionalParamsMap = emptyMap();
    }
    var destination = ArrayList_init_0(expressionSubstitutions.length);
    var tmp$;
    for (tmp$ = 0; tmp$ !== expressionSubstitutions.length; ++tmp$) {
      var item = expressionSubstitutions[tmp$];
      destination.add_11rb$(item.code);
    }
    var destination_0 = ArrayList_init();
    var tmp$_0;
    tmp$_0 = destination.iterator();
    while (tmp$_0.hasNext()) {
      var element = tmp$_0.next();
      if (!isBlank(element))
        destination_0.add_11rb$(element);
    }
    var simpleComputationRuleCodesCandidates = toSet(destination_0);
    var $receiver = new CompiledConfiguration(void 0, void 0, void 0, void 0, void 0, void 0, additionalParamsMap, simpleComputationRuleCodesCandidates);
    var tmp$_1;
    $receiver.compiledExpressionTreeTransformationRules.clear();
    $receiver.compiledExpressionSimpleAdditionalTreeTransformationRules.clear();
    var handledCodesHashSet = HashSet_init();
    for (tmp$_1 = 0; tmp$_1 !== expressionSubstitutions.length; ++tmp$_1) {
      var substitution = expressionSubstitutions[tmp$_1];
      if (handledCodesHashSet.contains_11rb$(substitution.code))
        continue;
      handledCodesHashSet.add_11rb$(substitution.code);
      if (substitution.left.nodeType === NodeType$EMPTY_getInstance() || substitution.right.nodeType === NodeType$EMPTY_getInstance()) {
        if (substitution.code.length > 0) {
          $receiver.expressionTreeAutogeneratedTransformationRuleIdentifiers.put_xwzc9p$(substitution.code, substitution);
        }
      }
       else {
        $receiver.compiledExpressionTreeTransformationRules.add_11rb$(substitution);
        if (substitution.simpleAdditional) {
          $receiver.compiledExpressionSimpleAdditionalTreeTransformationRules.add_11rb$(substitution);
        }
      }
    }
    return $receiver;
  }
  function findApplicableSubstitutionsInSelectedPlace(expression, selectedNodeIds, compiledConfiguration, simplifyNotSelectedTopArguments, withReadyApplicationResult) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = true;
    return generateSubstitutionsBySelectedNodes(new SubstitutionSelectionData(expression, selectedNodeIds, compiledConfiguration), void 0, withReadyApplicationResult);
  }
  function applySubstitutionInSelectedPlace(expression, selectedNodeIds, substitution, compiledConfiguration, simplifyNotSelectedTopArguments) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    var substitutionSelectionData = new SubstitutionSelectionData(expression, selectedNodeIds, compiledConfiguration);
    fillSubstitutionSelectionData(substitutionSelectionData);
    return applySubstitution_1(substitutionSelectionData, substitution, simplifyNotSelectedTopArguments);
  }
  function findLowestSubtreeTopOfSelectedNodesInExpression(node, selectedNodes) {
    return findLowestSubtreeTopOfNodes(node, selectedNodes);
  }
  function SubstitutionPlaceOfflineData(parentStartPosition, parentEndPosition, startPosition, endPosition) {
    this.parentStartPosition = parentStartPosition;
    this.parentEndPosition = parentEndPosition;
    this.startPosition = startPosition;
    this.endPosition = endPosition;
  }
  SubstitutionPlaceOfflineData.prototype.toJSON = function () {
    return '{' + ('"' + 'parentStartPosition' + '"' + ':' + '"' + this.parentStartPosition + '"' + ',') + ('"' + 'parentEndPosition' + '"' + ':' + '"' + this.parentEndPosition + '"' + ',') + ('"' + 'startPosition' + '"' + ':' + '"' + this.startPosition + '"' + ',') + ('"' + 'endPosition' + '"' + ':' + '"' + this.endPosition + '"') + '}';
  };
  SubstitutionPlaceOfflineData.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'SubstitutionPlaceOfflineData',
    interfaces: []
  };
  SubstitutionPlaceOfflineData.prototype.component1 = function () {
    return this.parentStartPosition;
  };
  SubstitutionPlaceOfflineData.prototype.component2 = function () {
    return this.parentEndPosition;
  };
  SubstitutionPlaceOfflineData.prototype.component3 = function () {
    return this.startPosition;
  };
  SubstitutionPlaceOfflineData.prototype.component4 = function () {
    return this.endPosition;
  };
  SubstitutionPlaceOfflineData.prototype.copy_tjonv8$ = function (parentStartPosition, parentEndPosition, startPosition, endPosition) {
    return new SubstitutionPlaceOfflineData(parentStartPosition === void 0 ? this.parentStartPosition : parentStartPosition, parentEndPosition === void 0 ? this.parentEndPosition : parentEndPosition, startPosition === void 0 ? this.startPosition : startPosition, endPosition === void 0 ? this.endPosition : endPosition);
  };
  SubstitutionPlaceOfflineData.prototype.toString = function () {
    return 'SubstitutionPlaceOfflineData(parentStartPosition=' + Kotlin.toString(this.parentStartPosition) + (', parentEndPosition=' + Kotlin.toString(this.parentEndPosition)) + (', startPosition=' + Kotlin.toString(this.startPosition)) + (', endPosition=' + Kotlin.toString(this.endPosition)) + ')';
  };
  SubstitutionPlaceOfflineData.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.parentStartPosition) | 0;
    result = result * 31 + Kotlin.hashCode(this.parentEndPosition) | 0;
    result = result * 31 + Kotlin.hashCode(this.startPosition) | 0;
    result = result * 31 + Kotlin.hashCode(this.endPosition) | 0;
    return result;
  };
  SubstitutionPlaceOfflineData.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.parentStartPosition, other.parentStartPosition) && Kotlin.equals(this.parentEndPosition, other.parentEndPosition) && Kotlin.equals(this.startPosition, other.startPosition) && Kotlin.equals(this.endPosition, other.endPosition)))));
  };
  function findSubstitutionPlacesCoordinatesInExpressionJSON$lambda(it) {
    return it.toJSON();
  }
  function findSubstitutionPlacesCoordinatesInExpressionJSON(expression, substitutionLeft, substitutionRight, scope, basedOnTaskContext, matchJumbledAndNested, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (basedOnTaskContext === void 0)
      basedOnTaskContext = false;
    if (matchJumbledAndNested === void 0)
      matchJumbledAndNested = false;
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    var substitutionPlaces = findSubstitutionPlacesInExpression_0(stringToExpression(expression, void 0, void 0, void 0, compiledConfiguration), expressionSubstitutionFromStrings_0(substitutionLeft, substitutionRight, void 0, basedOnTaskContext, matchJumbledAndNested, void 0, void 0, void 0, void 0, void 0, compiledConfiguration));
    var destination_0 = ArrayList_init_0(collectionSizeOrDefault(substitutionPlaces, 10));
    var tmp$_0;
    tmp$_0 = substitutionPlaces.iterator();
    while (tmp$_0.hasNext()) {
      var item = tmp$_0.next();
      destination_0.add_11rb$(new SubstitutionPlaceOfflineData(item.nodeParent.startPosition, item.nodeParent.endPosition, item.nodeParent.children.get_za3lpa$(item.nodeChildIndex).startPosition, item.nodeParent.children.get_za3lpa$(item.nodeChildIndex).endPosition));
    }
    var data = joinToString(destination_0, ',', void 0, void 0, void 0, void 0, findSubstitutionPlacesCoordinatesInExpressionJSON$lambda);
    return '{' + '"' + 'substitutionPlaces' + '"' + ':[' + data + ']}';
  }
  function findStructureStringsSubstitutionPlacesCoordinatesInExpressionJSON$lambda(it) {
    return it.toJSON();
  }
  function findStructureStringsSubstitutionPlacesCoordinatesInExpressionJSON(expression, substitutionLeftStructureString, substitutionRightStructureString, scope, basedOnTaskContext, matchJumbledAndNested, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (basedOnTaskContext === void 0)
      basedOnTaskContext = false;
    if (matchJumbledAndNested === void 0)
      matchJumbledAndNested = false;
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    var substitutionPlaces = findSubstitutionPlacesInExpression_0(stringToExpression(expression, void 0, void 0, void 0, compiledConfiguration), expressionSubstitutionFromStructureStrings(substitutionLeftStructureString, substitutionRightStructureString, basedOnTaskContext, matchJumbledAndNested));
    var destination_0 = ArrayList_init_0(collectionSizeOrDefault(substitutionPlaces, 10));
    var tmp$_0;
    tmp$_0 = substitutionPlaces.iterator();
    while (tmp$_0.hasNext()) {
      var item = tmp$_0.next();
      destination_0.add_11rb$(new SubstitutionPlaceOfflineData(item.nodeParent.startPosition, item.nodeParent.endPosition, item.nodeParent.children.get_za3lpa$(item.nodeChildIndex).startPosition, item.nodeParent.children.get_za3lpa$(item.nodeChildIndex).endPosition));
    }
    var data = joinToString(destination_0, ',', void 0, void 0, void 0, void 0, findStructureStringsSubstitutionPlacesCoordinatesInExpressionJSON$lambda);
    return '{' + '"' + 'substitutionPlaces' + '"' + ':[' + data + ']}';
  }
  function applyExpressionBySubstitutionPlaceCoordinates(expression, substitutionLeft, substitutionRight, parentStartPosition, parentEndPosition, startPosition, endPosition, scope, basedOnTaskContext, matchJumbledAndNested, characterEscapingDepth, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (basedOnTaskContext === void 0)
      basedOnTaskContext = false;
    if (matchJumbledAndNested === void 0)
      matchJumbledAndNested = false;
    if (characterEscapingDepth === void 0)
      characterEscapingDepth = 1;
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    var tmp$_0;
    var actualExpression = stringToExpression(expression, void 0, void 0, void 0, compiledConfiguration);
    var actualSubstitution = expressionSubstitutionFromStrings_0(substitutionLeft, substitutionRight, void 0, basedOnTaskContext, matchJumbledAndNested, void 0, void 0, void 0, void 0, void 0, compiledConfiguration);
    var substitutionPlaces = findSubstitutionPlacesInExpression_0(actualExpression, actualSubstitution);
    var destination_0 = ArrayList_init();
    var tmp$_1;
    tmp$_1 = substitutionPlaces.iterator();
    while (tmp$_1.hasNext()) {
      var element_0 = tmp$_1.next();
      if (element_0.nodeParent.startPosition === parentStartPosition && element_0.nodeParent.endPosition === parentEndPosition && element_0.nodeParent.children.get_za3lpa$(element_0.nodeChildIndex).startPosition === startPosition && element_0.nodeParent.children.get_za3lpa$(element_0.nodeChildIndex).endPosition === endPosition)
        destination_0.add_11rb$(element_0);
    }
    var actualPlace = destination_0;
    if (!actualPlace.isEmpty()) {
      tmp$_0 = applySubstitution_0(actualExpression, actualSubstitution, actualPlace);
    }
     else {
      tmp$_0 = actualExpression;
    }
    var result = tmp$_0;
    return escapeCharacters(expressionToString(result), characterEscapingDepth);
  }
  function applyExpressionByStructureStringsSubstitutionPlaceCoordinates(expression, substitutionLeftStructureString, substitutionRightStructureString, parentStartPosition, parentEndPosition, startPosition, endPosition, scope, basedOnTaskContext, matchJumbledAndNested, characterEscapingDepth, functionConfiguration, compiledConfiguration) {
    if (scope === void 0)
      scope = '';
    if (basedOnTaskContext === void 0)
      basedOnTaskContext = false;
    if (matchJumbledAndNested === void 0)
      matchJumbledAndNested = false;
    if (characterEscapingDepth === void 0)
      characterEscapingDepth = 1;
    if (functionConfiguration === void 0) {
      var $receiver = split(scope, [';']);
      var destination = ArrayList_init();
      var tmp$;
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.length > 0)
          destination.add_11rb$(element);
      }
      functionConfiguration = new FunctionConfiguration(toSet(destination));
    }
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    var tmp$_0;
    var actualExpression = stringToExpression(expression, void 0, void 0, void 0, compiledConfiguration);
    var actualSubstitution = expressionSubstitutionFromStructureStrings(substitutionLeftStructureString, substitutionRightStructureString, basedOnTaskContext, matchJumbledAndNested);
    var substitutionPlaces = findSubstitutionPlacesInExpression_0(actualExpression, actualSubstitution);
    var destination_0 = ArrayList_init();
    var tmp$_1;
    tmp$_1 = substitutionPlaces.iterator();
    while (tmp$_1.hasNext()) {
      var element_0 = tmp$_1.next();
      if (element_0.nodeParent.startPosition === parentStartPosition && element_0.nodeParent.endPosition === parentEndPosition && element_0.nodeParent.children.get_za3lpa$(element_0.nodeChildIndex).startPosition === startPosition && element_0.nodeParent.children.get_za3lpa$(element_0.nodeChildIndex).endPosition === endPosition)
        destination_0.add_11rb$(element_0);
    }
    var actualPlace = destination_0;
    if (!actualPlace.isEmpty()) {
      tmp$_0 = applySubstitution_0(actualExpression, actualSubstitution, actualPlace);
    }
     else {
      tmp$_0 = actualExpression;
    }
    var result = tmp$_0;
    return escapeCharacters(expressionToString(result), characterEscapingDepth);
  }
  function checkSolutionInTex(originalTexSolution, startExpressionIdentifier, targetFactPattern, additionalFactsIdentifiers, endExpressionIdentifier, targetFactIdentifier, wellKnownFunctions, wellKnownFunctionsString, unlimitedWellKnownFunctions, unlimitedWellKnownFunctionsString, expressionTransformationRules, expressionTransformationRulesString, taskContextExpressionTransformationRules, rulePacks, maxExpressionTransformationWeight, maxDistBetweenDiffSteps, scopeFilter, shortErrorDescription) {
    if (startExpressionIdentifier === void 0)
      startExpressionIdentifier = '';
    if (targetFactPattern === void 0)
      targetFactPattern = '';
    if (additionalFactsIdentifiers === void 0)
      additionalFactsIdentifiers = '';
    if (endExpressionIdentifier === void 0)
      endExpressionIdentifier = '';
    if (targetFactIdentifier === void 0)
      targetFactIdentifier = '';
    if (wellKnownFunctions === void 0) {
      wellKnownFunctions = emptyList();
    }
    if (wellKnownFunctionsString === void 0)
      wellKnownFunctionsString = '+;;;-1;;;-;;;-1;;;*;;;-1;;;/;;;-1';
    if (unlimitedWellKnownFunctions === void 0)
      unlimitedWellKnownFunctions = wellKnownFunctions;
    if (unlimitedWellKnownFunctionsString === void 0)
      unlimitedWellKnownFunctionsString = wellKnownFunctionsString;
    if (expressionTransformationRules === void 0) {
      expressionTransformationRules = emptyList();
    }
    if (expressionTransformationRulesString === void 0)
      expressionTransformationRulesString = 'S(i, a, a, f(i));;;f(a);;;S(i, a, b, f(i));;;S(i, a, b-1, f(i)) + f(b)';
    if (taskContextExpressionTransformationRules === void 0)
      taskContextExpressionTransformationRules = '';
    if (rulePacks === void 0) {
      rulePacks = copyToArray(emptyList());
    }
    if (maxExpressionTransformationWeight === void 0)
      maxExpressionTransformationWeight = '1.0';
    if (maxDistBetweenDiffSteps === void 0)
      maxDistBetweenDiffSteps = '';
    if (scopeFilter === void 0)
      scopeFilter = '';
    if (shortErrorDescription === void 0)
      shortErrorDescription = '0';
    var compiledConfiguration = compiledConfigurationBySettings(wellKnownFunctionsString, expressionTransformationRulesString, maxExpressionTransformationWeight, unlimitedWellKnownFunctionsString, taskContextExpressionTransformationRules, maxDistBetweenDiffSteps, scopeFilter, wellKnownFunctions, unlimitedWellKnownFunctions, expressionTransformationRules);
    if (!(rulePacks.length === 0)) {
      var expressionSubstitutions = getSubstitutionsByRulePacks(rulePacks);
      var tmp$;
      compiledConfiguration.compiledExpressionTreeTransformationRules.clear();
      compiledConfiguration.compiledExpressionSimpleAdditionalTreeTransformationRules.clear();
      var handledCodesHashSet = HashSet_init();
      tmp$ = expressionSubstitutions.iterator();
      while (tmp$.hasNext()) {
        var substitution = tmp$.next();
        if (handledCodesHashSet.contains_11rb$(substitution.code))
          continue;
        handledCodesHashSet.add_11rb$(substitution.code);
        if (substitution.left.nodeType === NodeType$EMPTY_getInstance() || substitution.right.nodeType === NodeType$EMPTY_getInstance()) {
          if (substitution.code.length > 0) {
            compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.put_xwzc9p$(substitution.code, substitution);
          }
        }
         else {
          compiledConfiguration.compiledExpressionTreeTransformationRules.add_11rb$(substitution);
          if (substitution.simpleAdditional) {
            compiledConfiguration.compiledExpressionSimpleAdditionalTreeTransformationRules.add_11rb$(substitution);
          }
        }
      }
    }
    return checkFactsInTex(originalTexSolution, startExpressionIdentifier, endExpressionIdentifier, targetFactIdentifier, targetFactPattern, additionalFactsIdentifiers, shortErrorDescription, compiledConfiguration);
  }
  function BaseNumber(number) {
    this.number = number;
  }
  BaseNumber.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'BaseNumber',
    interfaces: []
  };
  function BaseOperationDefinitionWithDomain(baseOp, generalValuesDomain, generalDefinitionDomain, funcToCall) {
    this.baseOp = baseOp;
    this.generalValuesDomain = generalValuesDomain;
    this.generalDefinitionDomain = generalDefinitionDomain;
    this.funcToCall = funcToCall;
  }
  BaseOperationDefinitionWithDomain.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'BaseOperationDefinitionWithDomain',
    interfaces: []
  };
  BaseOperationDefinitionWithDomain.prototype.component1 = function () {
    return this.baseOp;
  };
  BaseOperationDefinitionWithDomain.prototype.component2 = function () {
    return this.generalValuesDomain;
  };
  BaseOperationDefinitionWithDomain.prototype.component3 = function () {
    return this.generalDefinitionDomain;
  };
  BaseOperationDefinitionWithDomain.prototype.component4 = function () {
    return this.funcToCall;
  };
  BaseOperationDefinitionWithDomain.prototype.copy_x5fl6t$ = function (baseOp, generalValuesDomain, generalDefinitionDomain, funcToCall) {
    return new BaseOperationDefinitionWithDomain(baseOp === void 0 ? this.baseOp : baseOp, generalValuesDomain === void 0 ? this.generalValuesDomain : generalValuesDomain, generalDefinitionDomain === void 0 ? this.generalDefinitionDomain : generalDefinitionDomain, funcToCall === void 0 ? this.funcToCall : funcToCall);
  };
  BaseOperationDefinitionWithDomain.prototype.toString = function () {
    return 'BaseOperationDefinitionWithDomain(baseOp=' + Kotlin.toString(this.baseOp) + (', generalValuesDomain=' + Kotlin.toString(this.generalValuesDomain)) + (', generalDefinitionDomain=' + Kotlin.toString(this.generalDefinitionDomain)) + (', funcToCall=' + Kotlin.toString(this.funcToCall)) + ')';
  };
  BaseOperationDefinitionWithDomain.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.baseOp) | 0;
    result = result * 31 + Kotlin.hashCode(this.generalValuesDomain) | 0;
    result = result * 31 + Kotlin.hashCode(this.generalDefinitionDomain) | 0;
    result = result * 31 + Kotlin.hashCode(this.funcToCall) | 0;
    return result;
  };
  BaseOperationDefinitionWithDomain.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.baseOp, other.baseOp) && Kotlin.equals(this.generalValuesDomain, other.generalValuesDomain) && Kotlin.equals(this.generalDefinitionDomain, other.generalDefinitionDomain) && Kotlin.equals(this.funcToCall, other.funcToCall)))));
  };
  function ComputationType(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function ComputationType_initFields() {
    ComputationType_initFields = function () {
    };
    ComputationType$COMPLEX_instance = new ComputationType('COMPLEX', 0);
    ComputationType$DOUBLE_instance = new ComputationType('DOUBLE', 1);
  }
  var ComputationType$COMPLEX_instance;
  function ComputationType$COMPLEX_getInstance() {
    ComputationType_initFields();
    return ComputationType$COMPLEX_instance;
  }
  var ComputationType$DOUBLE_instance;
  function ComputationType$DOUBLE_getInstance() {
    ComputationType_initFields();
    return ComputationType$DOUBLE_instance;
  }
  ComputationType.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ComputationType',
    interfaces: [Enum]
  };
  function ComputationType$values() {
    return [ComputationType$COMPLEX_getInstance(), ComputationType$DOUBLE_getInstance()];
  }
  ComputationType.values = ComputationType$values;
  function ComputationType$valueOf(name) {
    switch (name) {
      case 'COMPLEX':
        return ComputationType$COMPLEX_getInstance();
      case 'DOUBLE':
        return ComputationType$DOUBLE_getInstance();
      default:throwISE('No enum constant baseoperations.ComputationType.' + name);
    }
  }
  ComputationType.valueOf_61zpoe$ = ComputationType$valueOf;
  function BaseOperationsComputation(computationType) {
    BaseOperationsComputation$Companion_getInstance();
    this.computationType_0 = computationType;
    this.baseComputationOperations_0 = mapOf_0([to(ComputationType$COMPLEX_getInstance(), mapOf_0([to('', BaseOperationsComputation$baseComputationOperations$lambda(this)), to('+', BaseOperationsComputation$baseComputationOperations$lambda_0(this)), to('*', BaseOperationsComputation$baseComputationOperations$lambda_1(this)), to('-', BaseOperationsComputation$baseComputationOperations$lambda_2(this)), to('/', BaseOperationsComputation$baseComputationOperations$lambda_3(this)), to('^', BaseOperationsComputation$baseComputationOperations$lambda_4(this)), to('mod', BaseOperationsComputation$baseComputationOperations$lambda_5(this)), to('and', BaseOperationsComputation$baseComputationOperations$lambda_6(this)), to('or', BaseOperationsComputation$baseComputationOperations$lambda_7(this)), to('xor', BaseOperationsComputation$baseComputationOperations$lambda_8(this)), to('alleq', BaseOperationsComputation$baseComputationOperations$lambda_9(this)), to('not', BaseOperationsComputation$baseComputationOperations$lambda_10(this)), to('sin', BaseOperationsComputation$baseComputationOperations$lambda_11(this)), to('cos', BaseOperationsComputation$baseComputationOperations$lambda_12(this)), to('tg', BaseOperationsComputation$baseComputationOperations$lambda_13(this)), to('sh', BaseOperationsComputation$baseComputationOperations$lambda_14(this)), to('ch', BaseOperationsComputation$baseComputationOperations$lambda_15(this)), to('th', BaseOperationsComputation$baseComputationOperations$lambda_16(this)), to('asin', BaseOperationsComputation$baseComputationOperations$lambda_17(this)), to('acos', BaseOperationsComputation$baseComputationOperations$lambda_18(this)), to('atg', BaseOperationsComputation$baseComputationOperations$lambda_19(this)), to('actg', BaseOperationsComputation$baseComputationOperations$lambda_20(this)), to('pow', BaseOperationsComputation$baseComputationOperations$lambda_21(this)), to('ln', BaseOperationsComputation$baseComputationOperations$lambda_22(this)), to('exp', BaseOperationsComputation$baseComputationOperations$lambda_23(this)), to('abs', BaseOperationsComputation$baseComputationOperations$lambda_24(this)), to('sqrt', BaseOperationsComputation$baseComputationOperations$lambda_25(this))])), to(ComputationType$DOUBLE_getInstance(), mapOf_0([to('', BaseOperationsComputation$baseComputationOperations$lambda_26(this)), to('+', BaseOperationsComputation$baseComputationOperations$lambda_27(this)), to('*', BaseOperationsComputation$baseComputationOperations$lambda_28(this)), to('-', BaseOperationsComputation$baseComputationOperations$lambda_29(this)), to('/', BaseOperationsComputation$baseComputationOperations$lambda_30(this)), to('^', BaseOperationsComputation$baseComputationOperations$lambda_31(this)), to('mod', BaseOperationsComputation$baseComputationOperations$lambda_32(this)), to('and', BaseOperationsComputation$baseComputationOperations$lambda_33(this)), to('or', BaseOperationsComputation$baseComputationOperations$lambda_34(this)), to('xor', BaseOperationsComputation$baseComputationOperations$lambda_35(this)), to('alleq', BaseOperationsComputation$baseComputationOperations$lambda_36(this)), to('not', BaseOperationsComputation$baseComputationOperations$lambda_37(this)), to('sin', BaseOperationsComputation$baseComputationOperations$lambda_38(this)), to('cos', BaseOperationsComputation$baseComputationOperations$lambda_39(this)), to('tg', BaseOperationsComputation$baseComputationOperations$lambda_40(this)), to('sh', BaseOperationsComputation$baseComputationOperations$lambda_41(this)), to('ch', BaseOperationsComputation$baseComputationOperations$lambda_42(this)), to('th', BaseOperationsComputation$baseComputationOperations$lambda_43(this)), to('asin', BaseOperationsComputation$baseComputationOperations$lambda_44(this)), to('acos', BaseOperationsComputation$baseComputationOperations$lambda_45(this)), to('atg', BaseOperationsComputation$baseComputationOperations$lambda_46(this)), to('actg', BaseOperationsComputation$baseComputationOperations$lambda_47(this)), to('pow', BaseOperationsComputation$baseComputationOperations$lambda_48(this)), to('ln', BaseOperationsComputation$baseComputationOperations$lambda_49(this)), to('exp', BaseOperationsComputation$baseComputationOperations$lambda_50(this)), to('abs', BaseOperationsComputation$baseComputationOperations$lambda_51(this)), to('sqrt', BaseOperationsComputation$baseComputationOperations$lambda_52(this))]))]);
    this.baseComputationComplex = mapOf_0([to('+', BaseOperationsComputation$baseComputationComplex$lambda), to('*', BaseOperationsComputation$baseComputationComplex$lambda_0), to('-', BaseOperationsComputation$baseComputationComplex$lambda_1), to('/', BaseOperationsComputation$baseComputationComplex$lambda_2), to('^', BaseOperationsComputation$baseComputationComplex$lambda_3), to('mod', BaseOperationsComputation$baseComputationComplex$lambda_4), to('and', BaseOperationsComputation$baseComputationComplex$lambda_5), to('or', BaseOperationsComputation$baseComputationComplex$lambda_6), to('xor', BaseOperationsComputation$baseComputationComplex$lambda_7), to('alleq', BaseOperationsComputation$baseComputationComplex$lambda_8), to('not', BaseOperationsComputation$baseComputationComplex$lambda_9), to('sin', BaseOperationsComputation$baseComputationComplex$lambda_10), to('cos', BaseOperationsComputation$baseComputationComplex$lambda_11), to('tg', BaseOperationsComputation$baseComputationComplex$lambda_12), to('sh', BaseOperationsComputation$baseComputationComplex$lambda_13), to('ch', BaseOperationsComputation$baseComputationComplex$lambda_14), to('th', BaseOperationsComputation$baseComputationComplex$lambda_15), to('asin', BaseOperationsComputation$baseComputationComplex$lambda_16), to('acos', BaseOperationsComputation$baseComputationComplex$lambda_17), to('atg', BaseOperationsComputation$baseComputationComplex$lambda_18), to('actg', BaseOperationsComputation$baseComputationComplex$lambda_19), to('pow', BaseOperationsComputation$baseComputationComplex$lambda_20), to('ln', BaseOperationsComputation$baseComputationComplex$lambda_21), to('exp', BaseOperationsComputation$baseComputationComplex$lambda_22), to('abs', BaseOperationsComputation$baseComputationComplex$lambda_23), to('sqrt', BaseOperationsComputation$baseComputationComplex$lambda_24)]);
    this.baseComputationDouble = mapOf_0([to('+', BaseOperationsComputation$baseComputationDouble$lambda), to('*', BaseOperationsComputation$baseComputationDouble$lambda_0), to('-', BaseOperationsComputation$baseComputationDouble$lambda_1), to('/', BaseOperationsComputation$baseComputationDouble$lambda_2), to('^', BaseOperationsComputation$baseComputationDouble$lambda_3), to('mod', BaseOperationsComputation$baseComputationDouble$lambda_4), to('and', BaseOperationsComputation$baseComputationDouble$lambda_5), to('or', BaseOperationsComputation$baseComputationDouble$lambda_6), to('xor', BaseOperationsComputation$baseComputationDouble$lambda_7), to('alleq', BaseOperationsComputation$baseComputationDouble$lambda_8), to('not', BaseOperationsComputation$baseComputationDouble$lambda_9), to('sin', BaseOperationsComputation$baseComputationDouble$lambda_10), to('cos', BaseOperationsComputation$baseComputationDouble$lambda_11), to('tg', BaseOperationsComputation$baseComputationDouble$lambda_12), to('sh', BaseOperationsComputation$baseComputationDouble$lambda_13), to('ch', BaseOperationsComputation$baseComputationDouble$lambda_14), to('th', BaseOperationsComputation$baseComputationDouble$lambda_15), to('asin', BaseOperationsComputation$baseComputationDouble$lambda_16), to('acos', BaseOperationsComputation$baseComputationDouble$lambda_17), to('atg', BaseOperationsComputation$baseComputationDouble$lambda_18), to('actg', BaseOperationsComputation$baseComputationDouble$lambda_19), to('pow', BaseOperationsComputation$baseComputationDouble$lambda_20), to('ln', BaseOperationsComputation$baseComputationDouble$lambda_21), to('exp', BaseOperationsComputation$baseComputationDouble$lambda_22), to('abs', BaseOperationsComputation$baseComputationDouble$lambda_23), to('sqrt', BaseOperationsComputation$baseComputationDouble$lambda_24)]);
  }
  function BaseOperationsComputation$FoldedExpression(nameOfZVariable, from, to, expression) {
    this.nameOfZVariable = nameOfZVariable;
    this.from = from;
    this.to = to;
    this.expression = expression;
  }
  BaseOperationsComputation$FoldedExpression.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FoldedExpression',
    interfaces: []
  };
  function BaseOperationsComputation$Companion() {
    BaseOperationsComputation$Companion_instance = this;
    this.epsilon = 1.19E-6;
  }
  BaseOperationsComputation$Companion.prototype.additivelyEqualTo_0 = function ($receiver, number) {
    return rangeTo(-this.epsilon, this.epsilon).contains_mef7kx$($receiver - number);
  };
  BaseOperationsComputation$Companion.prototype.additivelyEqualToZero_0 = function ($receiver) {
    return rangeTo(-this.epsilon, this.epsilon).contains_mef7kx$($receiver);
  };
  BaseOperationsComputation$Companion.prototype.additivelyEqual_lu1900$ = function (l, r) {
    return l === r || this.additivelyEqualTo_0(l, r);
  };
  BaseOperationsComputation$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var BaseOperationsComputation$Companion_instance = null;
  function BaseOperationsComputation$Companion_getInstance() {
    if (BaseOperationsComputation$Companion_instance === null) {
      new BaseOperationsComputation$Companion();
    }
    return BaseOperationsComputation$Companion_instance;
  }
  BaseOperationsComputation.prototype.complexFunctionToAny_0 = function (listOfArgs, baseOperation) {
    return baseOperation(this.parseComplexNumbers_0(listOfArgs));
  };
  BaseOperationsComputation.prototype.complexFunctionToComplex_0 = function (listOfArgs, baseOperation) {
    return baseOperation(this.parseComplexNumbers_0(listOfArgs));
  };
  BaseOperationsComputation.prototype.doubleFunctionToAny_0 = function (listOfArgs, baseOperation) {
    return baseOperation(this.parseDoubleNumbers_0(listOfArgs));
  };
  BaseOperationsComputation.prototype.compute_6718cy$ = function (expressionNode) {
    var tmp$, tmp$_0;
    if (expressionNode.children.isEmpty()) {
      tmp$_0 = this.stringToNumber_0(expressionNode.value);
    }
     else {
      if (this.isFoldedExpression_0(expressionNode)) {
        return this.calculateFoldedExpression_0(expressionNode);
      }
      var listOfArgs = ArrayList_init();
      tmp$ = expressionNode.children.iterator();
      while (tmp$.hasNext()) {
        var childNode = tmp$.next();
        listOfArgs.add_11rb$(this.compute_6718cy$(childNode));
      }
      if (ensureNotNull(this.baseComputationOperations_0.get_11rb$(this.computationType_0)).containsKey_11rb$(expressionNode.value)) {
        tmp$_0 = ensureNotNull(ensureNotNull(this.baseComputationOperations_0.get_11rb$(this.computationType_0)).get_11rb$(expressionNode.value))(listOfArgs);
      }
       else {
        tmp$_0 = this.stringToNumber_0(defaultRandom().toString());
      }
    }
    return tmp$_0;
  };
  BaseOperationsComputation.prototype.calculatePenaltyForNode_aloovy$ = function (value, operatorType) {
    if (operatorType === void 0)
      operatorType = '';
    if (equals(operatorType, 'ln') || equals(operatorType, 'asin') || equals(operatorType, 'acos')) {
      var re = abs_0(value.getReal().value);
      var im = abs_0(value.getImaginary().value);
      return re * im;
    }
    return abs_0(value.getImaginary().value);
  };
  BaseOperationsComputation.prototype.computePenalty_jutbsk$ = function (treeNodes) {
    var tmp$, tmp$_0;
    var penalty = 0.0;
    tmp$ = treeNodes.iterator();
    while (tmp$.hasNext()) {
      var node = tmp$.next();
      if (node.children.isEmpty() || equals(node.func, '')) {
        node.subtreeValue = node.value;
      }
       else {
        var listOfArgs = ArrayList_init();
        tmp$_0 = node.children.iterator();
        while (tmp$_0.hasNext()) {
          var child = tmp$_0.next();
          listOfArgs.add_11rb$(child.subtreeValue);
        }
        if (node.func.length > 0) {
          node.subtreeValue = ensureNotNull(node.functor)(listOfArgs);
          penalty += this.calculatePenaltyForNode_aloovy$(node.subtreeValue, node.func);
        }
      }
    }
    return penalty;
  };
  BaseOperationsComputation.prototype.computeValue_6l7j1$ = function (treeNodes) {
    var tmp$, tmp$_0;
    tmp$ = treeNodes.iterator();
    while (tmp$.hasNext()) {
      var node = tmp$.next();
      if (node.children.isEmpty() && equals(node.func, ''))
        continue;
      else {
        if (!node.children.isEmpty() && !equals(node.func, '')) {
          var listOfArgs = ArrayList_init();
          tmp$_0 = node.children.iterator();
          while (tmp$_0.hasNext()) {
            var child = tmp$_0.next();
            listOfArgs.add_11rb$(child.value);
          }
          node.value = ensureNotNull(node.functor)(listOfArgs);
        }
         else if (node.children.size === 1 && equals(node.func, ''))
          node.value = node.children.get_za3lpa$(0).value;
      }
    }
  };
  BaseOperationsComputation.prototype.stringToNumber_0 = function (arg) {
    var tmp$;
    switch (this.computationType_0.name) {
      case 'DOUBLE':
        tmp$ = toDouble(arg);
        break;
      case 'COMPLEX':
        tmp$ = toComplex_1(arg);
        break;
      default:tmp$ = Kotlin.noWhenBranchMatched();
        break;
    }
    return tmp$;
  };
  BaseOperationsComputation.prototype.isFoldedExpression_0 = function (expression) {
    return equals(expression.value, 'P') || equals(expression.value, 'S');
  };
  BaseOperationsComputation.prototype.calculateFoldedExpression_0 = function (expression) {
    var tmp$;
    switch (expression.value) {
      case 'S':
        tmp$ = this.sumN_0(expression);
        break;
      case 'P':
        tmp$ = this.prodN_0(expression);
        break;
      default:throw IllegalArgumentException_init("Given expression's type " + expression.value + ' is not folded');
    }
    return tmp$;
  };
  BaseOperationsComputation.prototype.parseComplexNumbers_0 = function (listOfArgs) {
    var tmp$;
    var listOfNumbers = ArrayList_init();
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (Kotlin.isType(arg, Complex)) {
        listOfNumbers.add_11rb$(arg);
      }
       else {
        throw IllegalArgumentException_init('List contains element, which is not a complex number');
      }
    }
    return listOfNumbers;
  };
  BaseOperationsComputation.prototype.parseDoubleNumbers_0 = function (listOfArgs) {
    var tmp$;
    var listOfNumbers = ArrayList_init();
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (typeof arg === 'number') {
        listOfNumbers.add_11rb$(arg);
      }
       else {
        throw IllegalArgumentException_init('List contains element, which is not a complex number');
      }
    }
    return listOfNumbers;
  };
  BaseOperationsComputation.prototype.brackets_0 = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Not one argument in brackets.');
    }
     else {
      return listOfArgs.get_za3lpa$(0);
    }
  };
  BaseOperationsComputation.prototype.plus_0 = function (listOfArgs) {
    return ensureNotNull(ensureNotNull(this.baseComputationOperations_0.get_11rb$(this.computationType_0)).get_11rb$('+'))(listOfArgs);
  };
  BaseOperationsComputation.prototype.mul_0 = function (listOfArgs) {
    return ensureNotNull(ensureNotNull(this.baseComputationOperations_0.get_11rb$(this.computationType_0)).get_11rb$('*'))(listOfArgs);
  };
  BaseOperationsComputation.prototype.sumN_0 = function (expression) {
    var deploymentOfSum = this.unfold_0(this.convertToFoldedExpression_0(expression));
    return this.plus_0(deploymentOfSum);
  };
  BaseOperationsComputation.prototype.convertToFoldedExpression_0 = function (expression) {
    if (!this.isFoldedExpression_0(expression)) {
      throw IllegalArgumentException_init(expression.value + ' is not folded');
    }
    var from = this.compute_6718cy$(expression.children.get_za3lpa$(1));
    var to = this.compute_6718cy$(expression.children.get_za3lpa$(2));
    return new BaseOperationsComputation$FoldedExpression(expression.children.get_za3lpa$(0).value, this.convertToDouble_0(from), this.convertToDouble_0(to), expression.children.get_za3lpa$(3));
  };
  BaseOperationsComputation.prototype.convertToDouble_0 = function (value) {
    var tmp$, tmp$_0, tmp$_1;
    switch (this.computationType_0.name) {
      case 'DOUBLE':
        tmp$_1 = typeof (tmp$ = value) === 'number' ? tmp$ : throwCCE();
        break;
      case 'COMPLEX':
        tmp$_1 = (Kotlin.isType(tmp$_0 = value, Complex) ? tmp$_0 : throwCCE()).toDouble();
        break;
      default:tmp$_1 = Kotlin.noWhenBranchMatched();
        break;
    }
    return tmp$_1;
  };
  BaseOperationsComputation.prototype.unfold_0 = function (foldedExpression) {
    var deployedArguments = ArrayList_init();
    var iter = foldedExpression.from;
    while (iter <= foldedExpression.to) {
      var expression = foldedExpression.expression.cloneWithVariableReplacement_y0zsll$(mutableMapOf([new Pair(foldedExpression.nameOfZVariable, iter.toString())]));
      deployedArguments.add_11rb$(this.compute_6718cy$(expression));
      iter = iter + 1;
    }
    return deployedArguments;
  };
  BaseOperationsComputation.prototype.prodN_0 = function (expression) {
    var deploymentOfProd = this.unfold_0(this.convertToFoldedExpression_0(expression));
    return this.mul_0(deploymentOfProd);
  };
  function BaseOperationsComputation$baseComputationOperations$lambda(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.brackets_0(listOfArgs);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda(args) {
    return ComplexBaseOperation$Companion_getInstance().plus_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_0(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_0(args) {
    return ComplexBaseOperation$Companion_getInstance().mul_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_1(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_0);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_1(args) {
    return ComplexBaseOperation$Companion_getInstance().minus_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_2(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_1);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_2(args) {
    return ComplexBaseOperation$Companion_getInstance().div_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_3(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_2);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_3(args) {
    return ComplexBaseOperation$Companion_getInstance().pow_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_4(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_3);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_4(args) {
    return ComplexBaseOperation$Companion_getInstance().mod_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_5(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_4);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_5(args) {
    return ComplexBaseOperation$Companion_getInstance().and_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_6(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_5);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_6(args) {
    return ComplexBaseOperation$Companion_getInstance().or_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_7(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_6);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_7(args) {
    return ComplexBaseOperation$Companion_getInstance().xor_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_8(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_7);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_8(args) {
    return ComplexBaseOperation$Companion_getInstance().alleq_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_9(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_8);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_9(args) {
    return ComplexBaseOperation$Companion_getInstance().not_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_10(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_9);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_10(args) {
    return ComplexBaseOperation$Companion_getInstance().sin_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_11(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_10);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_11(args) {
    return ComplexBaseOperation$Companion_getInstance().cos_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_12(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_11);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_12(args) {
    return ComplexBaseOperation$Companion_getInstance().tan_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_13(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_12);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_13(args) {
    return ComplexBaseOperation$Companion_getInstance().sinh_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_14(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_13);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_14(args) {
    return ComplexBaseOperation$Companion_getInstance().cosh_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_15(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_14);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_15(args) {
    return ComplexBaseOperation$Companion_getInstance().tanh_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_16(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_15);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_16(args) {
    return ComplexBaseOperation$Companion_getInstance().asin_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_17(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_16);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_17(args) {
    return ComplexBaseOperation$Companion_getInstance().acos_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_18(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_17);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_18(args) {
    return ComplexBaseOperation$Companion_getInstance().atan_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_19(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_18);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_19(args) {
    return ComplexBaseOperation$Companion_getInstance().actan_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_20(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_19);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_20(args) {
    return ComplexBaseOperation$Companion_getInstance().pow_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_21(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_20);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_21(args) {
    return ComplexBaseOperation$Companion_getInstance().ln_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_22(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_21);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_22(args) {
    return ComplexBaseOperation$Companion_getInstance().exp_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_23(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_22);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_23(args) {
    return ComplexBaseOperation$Companion_getInstance().abs_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_24(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_23);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_24(args) {
    return ComplexBaseOperation$Companion_getInstance().sqrt_lc9fqz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_25(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.complexFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_24);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_26(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.brackets_0(listOfArgs);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_25(args) {
    return DoubleBaseOperation$Companion_getInstance().plus_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_27(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_25);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_26(args) {
    return DoubleBaseOperation$Companion_getInstance().mul_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_28(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_26);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_27(args) {
    return DoubleBaseOperation$Companion_getInstance().minus_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_29(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_27);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_28(args) {
    return DoubleBaseOperation$Companion_getInstance().div_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_30(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_28);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_29(args) {
    return DoubleBaseOperation$Companion_getInstance().pow_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_31(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_29);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_30(args) {
    return DoubleBaseOperation$Companion_getInstance().mod_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_32(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_30);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_31(args) {
    return DoubleBaseOperation$Companion_getInstance().and_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_33(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_31);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_32(args) {
    return DoubleBaseOperation$Companion_getInstance().or_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_34(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_32);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_33(args) {
    return DoubleBaseOperation$Companion_getInstance().xor_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_35(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_33);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_34(args) {
    return DoubleBaseOperation$Companion_getInstance().alleq_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_36(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_34);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_35(args) {
    return DoubleBaseOperation$Companion_getInstance().not_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_37(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_35);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_36(args) {
    return DoubleBaseOperation$Companion_getInstance().sin_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_38(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_36);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_37(args) {
    return DoubleBaseOperation$Companion_getInstance().cos_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_39(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_37);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_38(args) {
    return DoubleBaseOperation$Companion_getInstance().tan_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_40(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_38);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_39(args) {
    return DoubleBaseOperation$Companion_getInstance().sinh_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_41(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_39);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_40(args) {
    return DoubleBaseOperation$Companion_getInstance().cosh_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_42(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_40);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_41(args) {
    return DoubleBaseOperation$Companion_getInstance().tanh_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_43(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_41);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_42(args) {
    return DoubleBaseOperation$Companion_getInstance().asin_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_44(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_42);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_43(args) {
    return DoubleBaseOperation$Companion_getInstance().acos_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_45(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_43);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_44(args) {
    return DoubleBaseOperation$Companion_getInstance().atan_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_46(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_44);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_45(args) {
    return DoubleBaseOperation$Companion_getInstance().actan_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_47(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_45);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_46(args) {
    return DoubleBaseOperation$Companion_getInstance().pow_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_48(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_46);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_47(args) {
    return DoubleBaseOperation$Companion_getInstance().ln_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_49(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_47);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_48(args) {
    return DoubleBaseOperation$Companion_getInstance().exp_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_50(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_48);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_49(args) {
    return DoubleBaseOperation$Companion_getInstance().abs_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_51(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_49);
    };
  }
  function BaseOperationsComputation$baseComputationOperations$lambda$lambda_50(args) {
    return DoubleBaseOperation$Companion_getInstance().sqrt_d3e2cz$(args);
  }
  function BaseOperationsComputation$baseComputationOperations$lambda_52(this$BaseOperationsComputation) {
    return function (listOfArgs) {
      return this$BaseOperationsComputation.doubleFunctionToAny_0(listOfArgs, BaseOperationsComputation$baseComputationOperations$lambda$lambda_50);
    };
  }
  function BaseOperationsComputation$baseComputationComplex$lambda(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().plus_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_0(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().mul_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_1(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().minus_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_2(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().div_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_3(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().pow_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_4(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().mod_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_5(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().and_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_6(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().or_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_7(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().xor_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_8(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().alleq_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_9(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().not_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_10(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().sin_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_11(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().cos_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_12(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().tan_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_13(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().sinh_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_14(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().cosh_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_15(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().tanh_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_16(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().asin_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_17(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().acos_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_18(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().atan_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_19(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().actan_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_20(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().pow_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_21(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().ln_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_22(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().exp_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_23(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().abs_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationComplex$lambda_24(listOfArgs) {
    return ComplexBaseOperation$Companion_getInstance().sqrt_lc9fqz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().plus_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_0(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().mul_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_1(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().minus_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_2(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().div_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_3(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().pow_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_4(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().mod_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_5(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().and_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_6(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().or_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_7(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().xor_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_8(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().alleq_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_9(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().not_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_10(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().sin_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_11(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().cos_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_12(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().tan_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_13(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().sinh_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_14(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().cosh_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_15(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().tanh_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_16(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().asin_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_17(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().acos_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_18(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().atan_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_19(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().actan_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_20(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().pow_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_21(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().ln_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_22(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().exp_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_23(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().abs_d3e2cz$(listOfArgs);
  }
  function BaseOperationsComputation$baseComputationDouble$lambda_24(listOfArgs) {
    return DoubleBaseOperation$Companion_getInstance().sqrt_d3e2cz$(listOfArgs);
  }
  BaseOperationsComputation.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'BaseOperationsComputation',
    interfaces: []
  };
  function BaseOperationsDefinition(name, numberOfArguments, calculatingFunction) {
    this.name = name;
    this.numberOfArguments = numberOfArguments;
    this.calculatingFunction = calculatingFunction;
  }
  BaseOperationsDefinition.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'BaseOperationsDefinition',
    interfaces: []
  };
  BaseOperationsDefinition.prototype.component1 = function () {
    return this.name;
  };
  BaseOperationsDefinition.prototype.component2 = function () {
    return this.numberOfArguments;
  };
  BaseOperationsDefinition.prototype.component3 = function () {
    return this.calculatingFunction;
  };
  BaseOperationsDefinition.prototype.copy_9rahfg$ = function (name, numberOfArguments, calculatingFunction) {
    return new BaseOperationsDefinition(name === void 0 ? this.name : name, numberOfArguments === void 0 ? this.numberOfArguments : numberOfArguments, calculatingFunction === void 0 ? this.calculatingFunction : calculatingFunction);
  };
  BaseOperationsDefinition.prototype.toString = function () {
    return 'BaseOperationsDefinition(name=' + Kotlin.toString(this.name) + (', numberOfArguments=' + Kotlin.toString(this.numberOfArguments)) + (', calculatingFunction=' + Kotlin.toString(this.calculatingFunction)) + ')';
  };
  BaseOperationsDefinition.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.name) | 0;
    result = result * 31 + Kotlin.hashCode(this.numberOfArguments) | 0;
    result = result * 31 + Kotlin.hashCode(this.calculatingFunction) | 0;
    return result;
  };
  BaseOperationsDefinition.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.name, other.name) && Kotlin.equals(this.numberOfArguments, other.numberOfArguments) && Kotlin.equals(this.calculatingFunction, other.calculatingFunction)))));
  };
  function BaseOperationsDefinitions(epsilon) {
    if (epsilon === void 0)
      epsilon = 1.19E-5;
    this.epsilon = epsilon;
    this.baseOperationsDefinitions = listOf_0([new BaseOperationsDefinition('', 0, BaseOperationsDefinitions$baseOperationsDefinitions$lambda(this)), new BaseOperationsDefinition('', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_0(this)), new BaseOperationsDefinition('+', -1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_1(this)), new BaseOperationsDefinition('*', -1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_2(this)), new BaseOperationsDefinition('-', -1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_3(this)), new BaseOperationsDefinition('/', -1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_4(this)), new BaseOperationsDefinition('^', -1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_5(this)), new BaseOperationsDefinition('mod', 2, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_6(this)), new BaseOperationsDefinition('S', 4, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_7(this)), new BaseOperationsDefinition('P', 4, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_8(this)), new BaseOperationsDefinition('and', -1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_9(this)), new BaseOperationsDefinition('or', -1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_10(this)), new BaseOperationsDefinition('xor', -1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_11(this)), new BaseOperationsDefinition('alleq', -1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_12(this)), new BaseOperationsDefinition('not', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_13(this)), new BaseOperationsDefinition('sin', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_14(this)), new BaseOperationsDefinition('cos', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_15(this)), new BaseOperationsDefinition('sh', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_16(this)), new BaseOperationsDefinition('ch', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_17(this)), new BaseOperationsDefinition('tg', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_18(this)), new BaseOperationsDefinition('th', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_19(this)), new BaseOperationsDefinition('asin', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_20(this)), new BaseOperationsDefinition('acos', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_21(this)), new BaseOperationsDefinition('atg', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_22(this)), new BaseOperationsDefinition('actg', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_23(this)), new BaseOperationsDefinition('exp', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_24(this)), new BaseOperationsDefinition('ln', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_25(this)), new BaseOperationsDefinition('abs', 1, BaseOperationsDefinitions$baseOperationsDefinitions$lambda_26(this))]);
    var $receiver = this.baseOperationsDefinitions;
    var capacity = coerceAtLeast(mapCapacity(collectionSizeOrDefault($receiver, 10)), 16);
    var destination = LinkedHashMap_init(capacity);
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      destination.put_xwzc9p$(FunctionIdentifier$Companion_getInstance().getIdentifier_bm4lxs$(element.name, element.numberOfArguments), element);
    }
    this.mapNameAndArgsNumberToOperation = destination;
    this.definedFunctionNameNumberOfArgsSet = toSet(this.mapNameAndArgsNumberToOperation.keys);
  }
  BaseOperationsDefinitions.prototype.getOperation_bm4lxs$ = function (name, numberOfArguments) {
    var baseOperationsDefinition = this.mapNameAndArgsNumberToOperation.get_11rb$(FunctionIdentifier$Companion_getInstance().getIdentifier_bm4lxs$(name, numberOfArguments));
    if (baseOperationsDefinition == null)
      return this.mapNameAndArgsNumberToOperation.get_11rb$(FunctionIdentifier$Companion_getInstance().getIdentifier_bm4lxs$(name, -1));
    else
      return baseOperationsDefinition;
  };
  BaseOperationsDefinitions.prototype.applyOperationToExpressionNode_6718cy$ = function (node) {
    if (node.value.length === 0) {
      var operation = this.getOperation_bm4lxs$(node.value, node.children.size);
      if (operation != null) {
        return operation.calculatingFunction(node);
      }
    }
    if (node.children.size > 0) {
      var operation_0 = this.getOperation_bm4lxs$(node.value, node.children.size);
      if (operation_0 != null) {
        return operation_0.calculatingFunction(node);
      }
    }
    return node;
  };
  BaseOperationsDefinitions.prototype.computeExpressionTree_6718cy$ = function (node) {
    var tmp$;
    tmp$ = node.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      this.computeExpressionTree_6718cy$(child);
    }
    return this.applyOperationToExpressionNode_6718cy$(node);
  };
  BaseOperationsDefinitions.prototype.sumN_6718cy$ = function (argsParentNode) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(1).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var low = tmp$;
    tmp$_0 = toDoubleOrNull(argsParentNode.children.get_za3lpa$(2).value);
    if (tmp$_0 == null) {
      return argsParentNode;
    }
    var up = tmp$_0;
    if (up < low) {
      argsParentNode.setVariable_61zpoe$('0.0');
    }
     else {
      var counterName = argsParentNode.children.get_za3lpa$(0).value;
      var result = 0.0;
      while (low <= up) {
        var expr = argsParentNode.children.get_za3lpa$(3).cloneWithVariableReplacement_y0zsll$(mutableMapOf([new Pair(counterName, low.toString())]));
        tmp$_2 = result;
        tmp$_1 = toDoubleOrNull(this.computeExpressionTree_6718cy$(expr).value);
        if (tmp$_1 == null) {
          return argsParentNode;
        }
        result = tmp$_2 + tmp$_1;
        low += 1.0;
      }
      argsParentNode.setVariable_61zpoe$(result.toString());
    }
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.prodN_6718cy$ = function (argsParentNode) {
    var tmp$, tmp$_0;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(1).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var low = tmp$;
    tmp$_0 = toDoubleOrNull(argsParentNode.children.get_za3lpa$(2).value);
    if (tmp$_0 == null) {
      return argsParentNode;
    }
    var up = tmp$_0;
    if (up < low) {
      argsParentNode.setVariable_61zpoe$('1.0');
    }
     else {
      var counterName = argsParentNode.children.get_za3lpa$(0).value;
      var result = 1.0;
      var flagHasVariable = false;
      while (low <= up) {
        var expr = argsParentNode.children.get_za3lpa$(3).cloneWithVariableReplacement_y0zsll$(mutableMapOf([new Pair(counterName, low.toString())]));
        var arg = toDoubleOrNull(this.computeExpressionTree_6718cy$(expr).value);
        if (arg == null) {
          flagHasVariable = true;
        }
         else {
          result *= arg;
          if (this.additivelyEqualToZero_0(result)) {
            argsParentNode.setVariable_61zpoe$('0.0');
            break;
          }
        }
        low += 1.0;
      }
      if (!flagHasVariable)
        argsParentNode.setVariable_61zpoe$(result.toString());
    }
    return argsParentNode;
  };
  function BaseOperationsDefinitions$plus$lambda(it) {
    return it.nodeType === NodeType$EMPTY_getInstance();
  }
  BaseOperationsDefinitions.prototype.plus_6718cy$ = function (argsParentNode) {
    var tmp$;
    var startSize = argsParentNode.children.size;
    var result = 0.0;
    tmp$ = argsParentNode.children.iterator();
    while (tmp$.hasNext()) {
      var argNode = tmp$.next();
      if (!argNode.children.isEmpty())
        continue;
      var argValue = toDoubleOrNull(argNode.value);
      if (argValue != null) {
        result += argValue;
        argNode.nodeType = NodeType$EMPTY_getInstance();
      }
    }
    removeAll(argsParentNode.children, BaseOperationsDefinitions$plus$lambda);
    if (argsParentNode.children.size === 0)
      argsParentNode.setVariable_61zpoe$(result.toString());
    else if (this.additivelyEqualToZero_0(result)) {
      if (argsParentNode.children.size === 1)
        argsParentNode.setNode_6718cy$(argsParentNode.children.get_za3lpa$(0));
    }
     else if (startSize > argsParentNode.children.size)
      argsParentNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), result.toString()));
    return argsParentNode;
  };
  function BaseOperationsDefinitions$minus$lambda(it) {
    return it.nodeType === NodeType$EMPTY_getInstance();
  }
  BaseOperationsDefinitions.prototype.minus_6718cy$ = function (argsParentNode) {
    var tmp$;
    var startSize = argsParentNode.children.size;
    var result = 0.0;
    var first = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    var firstIsNumber = first != null && argsParentNode.children.get_za3lpa$(0).children.size === 0;
    if (firstIsNumber)
      result = ensureNotNull(first);
    if (argsParentNode.children.size === 1) {
      if (firstIsNumber)
        argsParentNode.setVariable_61zpoe$((-result).toString());
      return argsParentNode;
    }
     else {
      tmp$ = argsParentNode.children.size;
      for (var i = 1; i < tmp$; i++) {
        if (!argsParentNode.children.get_za3lpa$(i).children.isEmpty())
          continue;
        var argValue = toDoubleOrNull(argsParentNode.children.get_za3lpa$(i).value);
        if (argValue != null) {
          if (firstIsNumber)
            result -= argValue;
          else
            result += argValue;
          argsParentNode.children.get_za3lpa$(i).nodeType = NodeType$EMPTY_getInstance();
        }
      }
    }
    removeAll(argsParentNode.children, BaseOperationsDefinitions$minus$lambda);
    if (argsParentNode.children.size === 1) {
      if (firstIsNumber)
        argsParentNode.setVariable_61zpoe$(result.toString());
      else if (startSize > argsParentNode.children.size)
        argsParentNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), result.toString()));
    }
     else {
      if (firstIsNumber)
        argsParentNode.children.get_za3lpa$(0).setVariable_61zpoe$(result.toString());
      else if (!this.additivelyEqualToZero_0(result) && startSize > argsParentNode.children.size)
        argsParentNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), result.toString()));
    }
    return argsParentNode;
  };
  function BaseOperationsDefinitions$and$lambda(it) {
    return it.nodeType === NodeType$EMPTY_getInstance();
  }
  BaseOperationsDefinitions.prototype.and_6718cy$ = function (argsParentNode) {
    var tmp$;
    var startSize = argsParentNode.children.size;
    var result = 1.0;
    tmp$ = argsParentNode.children.iterator();
    while (tmp$.hasNext()) {
      var argNode = tmp$.next();
      if (!argNode.children.isEmpty())
        continue;
      var argValue = toDoubleOrNull(argNode.value);
      if (argValue != null) {
        result *= argValue;
        argNode.nodeType = NodeType$EMPTY_getInstance();
        if (this.additivelyEqualToZero_0(result)) {
          argsParentNode.setVariable_61zpoe$('0.0');
          return argsParentNode;
        }
      }
    }
    removeAll(argsParentNode.children, BaseOperationsDefinitions$and$lambda);
    if (argsParentNode.children.size === 0)
      argsParentNode.setVariable_61zpoe$(result.toString());
    else if (this.additivelyEqualTo_0(result, 1.0)) {
      if (argsParentNode.children.size === 1)
        argsParentNode.setNode_6718cy$(argsParentNode.children.get_za3lpa$(0));
    }
    return argsParentNode;
  };
  function BaseOperationsDefinitions$or$lambda(it) {
    return it.nodeType === NodeType$EMPTY_getInstance();
  }
  BaseOperationsDefinitions.prototype.or_6718cy$ = function (argsParentNode) {
    var tmp$;
    var startSize = argsParentNode.children.size;
    var result = 0.0;
    tmp$ = argsParentNode.children.iterator();
    while (tmp$.hasNext()) {
      var argNode = tmp$.next();
      if (!argNode.children.isEmpty())
        continue;
      var argValue = toDoubleOrNull(argNode.value);
      if (argValue != null) {
        result += argValue;
        argNode.nodeType = NodeType$EMPTY_getInstance();
        if (!this.additivelyEqualToZero_0(result)) {
          argsParentNode.setVariable_61zpoe$('1.0');
          return argsParentNode;
        }
      }
    }
    removeAll(argsParentNode.children, BaseOperationsDefinitions$or$lambda);
    if (argsParentNode.children.size === 0)
      argsParentNode.setVariable_61zpoe$(result.toString());
    else if (this.additivelyEqualTo_0(result, 1.0)) {
      if (argsParentNode.children.size === 1)
        argsParentNode.setNode_6718cy$(argsParentNode.children.get_za3lpa$(0));
    }
    return argsParentNode;
  };
  function BaseOperationsDefinitions$xor$lambda(it) {
    return it.nodeType === NodeType$EMPTY_getInstance();
  }
  BaseOperationsDefinitions.prototype.xor_6718cy$ = function (argsParentNode) {
    var tmp$;
    var startSize = argsParentNode.children.size;
    var result = 0.0;
    tmp$ = argsParentNode.children.iterator();
    while (tmp$.hasNext()) {
      var argNode = tmp$.next();
      if (!argNode.children.isEmpty())
        continue;
      var argValue = toDoubleOrNull(argNode.value);
      if (argValue != null) {
        this.addMod2_38ydlf$(result, argValue);
        argNode.nodeType = NodeType$EMPTY_getInstance();
      }
    }
    removeAll(argsParentNode.children, BaseOperationsDefinitions$xor$lambda);
    if (argsParentNode.children.size === 0)
      argsParentNode.setVariable_61zpoe$(result.toString());
    else if (this.additivelyEqualToZero_0(result)) {
      if (argsParentNode.children.size === 1)
        argsParentNode.setNode_6718cy$(argsParentNode.children.get_za3lpa$(0));
    }
     else if (startSize > argsParentNode.children.size)
      argsParentNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), result.toString()));
    return argsParentNode;
  };
  function BaseOperationsDefinitions$alleq$lambda(it) {
    return it.nodeType === NodeType$EMPTY_getInstance();
  }
  BaseOperationsDefinitions.prototype.alleq_6718cy$ = function (argsParentNode) {
    var tmp$;
    var startSize = argsParentNode.children.size;
    var result = 0.5;
    tmp$ = argsParentNode.children.iterator();
    while (tmp$.hasNext()) {
      var argNode = tmp$.next();
      if (!argNode.children.isEmpty())
        continue;
      var argValue = toDoubleOrNull(argNode.value);
      if (argValue != null) {
        var addArg = this.additivelyEqualToZero_0(argValue) ? 0.0 : 1.0;
        if (result === 0.5)
          result = addArg;
        else if (!this.additivelyEqualTo_0(result, addArg)) {
          argsParentNode.setVariable_61zpoe$('0.0');
          return argsParentNode;
        }
        argNode.nodeType = NodeType$EMPTY_getInstance();
      }
    }
    removeAll(argsParentNode.children, BaseOperationsDefinitions$alleq$lambda);
    if (argsParentNode.children.size === 0)
      argsParentNode.setVariable_61zpoe$(result.toString());
    else if (this.additivelyEqualToZero_0(result)) {
      if (argsParentNode.children.size === 1)
        argsParentNode.setNode_6718cy$(argsParentNode.children.get_za3lpa$(0));
    }
     else if (startSize > argsParentNode.children.size)
      argsParentNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), result.toString()));
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.addMod2_38ydlf$ = function ($receiver, arg) {
    if (this.additivelyEqualToZero_0($receiver))
      return arg;
    else
      return this.not_yrwdxr$(arg);
  };
  function BaseOperationsDefinitions$mul$lambda(it) {
    return it.nodeType === NodeType$EMPTY_getInstance();
  }
  BaseOperationsDefinitions.prototype.mul_6718cy$ = function (argsParentNode) {
    var tmp$;
    var startSize = argsParentNode.children.size;
    var result = 1.0;
    tmp$ = argsParentNode.children.iterator();
    while (tmp$.hasNext()) {
      var argNode = tmp$.next();
      if (!argNode.children.isEmpty())
        continue;
      var argValue = toDoubleOrNull(argNode.value);
      if (argValue != null) {
        result *= argValue;
        argNode.nodeType = NodeType$EMPTY_getInstance();
        if (this.additivelyEqualToZero_0(result)) {
          argsParentNode.setVariable_61zpoe$('0.0');
          return argsParentNode;
        }
      }
    }
    removeAll(argsParentNode.children, BaseOperationsDefinitions$mul$lambda);
    if (argsParentNode.children.size === 0)
      argsParentNode.setVariable_61zpoe$(result.toString());
    else if (this.additivelyEqualTo_0(result, 1.0)) {
      if (argsParentNode.children.size === 1)
        argsParentNode.setNode_6718cy$(argsParentNode.children.get_za3lpa$(0));
    }
     else if (startSize > argsParentNode.children.size)
      argsParentNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), result.toString()));
    return argsParentNode;
  };
  function BaseOperationsDefinitions$div$lambda(it) {
    return it.nodeType === NodeType$EMPTY_getInstance();
  }
  BaseOperationsDefinitions.prototype.div_6718cy$ = function (argsParentNode) {
    var tmp$;
    var startSize = argsParentNode.children.size;
    var result = 1.0;
    var first = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    var firstIsNumber = first != null && argsParentNode.children.get_za3lpa$(0).children.size === 0;
    if (firstIsNumber)
      result = ensureNotNull(first);
    if (argsParentNode.children.size === 1) {
      if (firstIsNumber)
        argsParentNode.setVariable_61zpoe$((1 / result).toString());
      return argsParentNode;
    }
     else {
      tmp$ = argsParentNode.children.size;
      for (var i = 1; i < tmp$; i++) {
        if (!argsParentNode.children.get_za3lpa$(i).children.isEmpty())
          continue;
        var argValue = toDoubleOrNull(argsParentNode.children.get_za3lpa$(i).value);
        if (argValue != null) {
          if (firstIsNumber)
            result /= argValue;
          else
            result *= argValue;
          argsParentNode.children.get_za3lpa$(i).nodeType = NodeType$EMPTY_getInstance();
        }
      }
    }
    removeAll(argsParentNode.children, BaseOperationsDefinitions$div$lambda);
    if (argsParentNode.children.size === 1) {
      if (firstIsNumber)
        argsParentNode.setVariable_61zpoe$(result.toString());
      else if (startSize > argsParentNode.children.size)
        argsParentNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), result.toString()));
    }
     else {
      if (firstIsNumber)
        argsParentNode.children.get_za3lpa$(0).setVariable_61zpoe$(result.toString());
      else if (!this.additivelyEqualTo_0(result, 1.0) && startSize > argsParentNode.children.size)
        argsParentNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), result.toString()));
    }
    return argsParentNode;
  };
  function BaseOperationsDefinitions$pow$lambda(it) {
    return it.nodeType === NodeType$EMPTY_getInstance();
  }
  BaseOperationsDefinitions.prototype.pow_6718cy$ = function (argsParentNode) {
    var startSize = argsParentNode.children.size;
    var result = 1.0;
    for (var i = get_lastIndex(argsParentNode.children); i >= 0; i--) {
      if (!argsParentNode.children.get_za3lpa$(i).children.isEmpty()) {
        break;
      }
      var argValue = toDoubleOrNull(argsParentNode.children.get_za3lpa$(i).value);
      if (argValue != null) {
        var x = result;
        result = Math_0.pow(argValue, x);
        argsParentNode.children.get_za3lpa$(i).nodeType = NodeType$EMPTY_getInstance();
      }
       else if (this.additivelyEqualToZero_0(result)) {
        result = 1.0;
        argsParentNode.children.get_za3lpa$(i).nodeType = NodeType$EMPTY_getInstance();
      }
       else
        break;
    }
    removeAll(argsParentNode.children, BaseOperationsDefinitions$pow$lambda);
    if (argsParentNode.children.size === 0)
      argsParentNode.setVariable_61zpoe$(result.toString());
    else if (this.additivelyEqualToZero_0(result)) {
      if (argsParentNode.children.size === 1)
        argsParentNode.setVariable_61zpoe$('1.0');
    }
     else if (!this.additivelyEqualTo_0(result, 1.0))
      if (startSize > argsParentNode.children.size)
        argsParentNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), result.toString()));
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.mod_6718cy$ = function (argsParentNode) {
    var tmp$, tmp$_0;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    var secondArg;
    if (this.additivelyEqualToZero_0(firstArg)) {
      argsParentNode.setVariable_61zpoe$('0.0');
    }
     else {
      tmp$_0 = toDoubleOrNull(argsParentNode.children.get_za3lpa$(1).value);
      if (tmp$_0 == null) {
        return argsParentNode;
      }
      secondArg = tmp$_0;
      argsParentNode.setVariable_61zpoe$((firstArg % secondArg).toString());
    }
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.sin_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(Math_0.sin(firstArg).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.cos_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(Math_0.cos(firstArg).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.tan_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(Math_0.tan(firstArg).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.asin_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(Math_0.asin(firstArg).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.acos_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(Math_0.acos(firstArg).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.atan_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(Math_0.atan(firstArg).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.actan_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    var x = 1.0 / firstArg;
    argsParentNode.setVariable_61zpoe$(Math_0.atan(x).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.sinh_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(Math_0.sinh(firstArg).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.cosh_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(Math_0.cosh(firstArg).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.tanh_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(Math_0.tanh(firstArg).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.exp_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(Math_0.exp(firstArg).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.ln_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(log(firstArg, math.E).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.abs_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(Math_0.abs(firstArg).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.not_6718cy$ = function (argsParentNode) {
    var tmp$;
    tmp$ = toDoubleOrNull(argsParentNode.children.get_za3lpa$(0).value);
    if (tmp$ == null) {
      return argsParentNode;
    }
    var firstArg = tmp$;
    argsParentNode.setVariable_61zpoe$(this.not_yrwdxr$(firstArg).toString());
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.not_yrwdxr$ = function ($receiver) {
    return this.additivelyEqualToZero_0($receiver) ? 1.0 : 0.0;
  };
  BaseOperationsDefinitions.prototype.brackets_6718cy$ = function (argsParentNode) {
    if (argsParentNode.children.get_za3lpa$(0).children.size === 0) {
      argsParentNode.setVariable_61zpoe$(argsParentNode.children.get_za3lpa$(0).value);
      return argsParentNode;
    }
     else {
      return argsParentNode.children.get_za3lpa$(0);
    }
  };
  BaseOperationsDefinitions.prototype.emptyBrackets_6718cy$ = function (argsParentNode) {
    argsParentNode.setVariable_61zpoe$('0');
    return argsParentNode;
  };
  BaseOperationsDefinitions.prototype.additivelyEqualTo_0 = function ($receiver, number) {
    return this.additivelyEqualToZero_0($receiver - number);
  };
  BaseOperationsDefinitions.prototype.additivelyEqualToZero_0 = function ($receiver) {
    return rangeTo(-this.epsilon, this.epsilon).contains_mef7kx$($receiver);
  };
  BaseOperationsDefinitions.prototype.additivelyEqual_lu1900$ = function (l, r) {
    return l === r || this.additivelyEqualTo_0(l, r);
  };
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.emptyBrackets_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_0(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.brackets_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_1(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.plus_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_2(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.mul_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_3(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.minus_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_4(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.div_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_5(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.pow_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_6(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.mod_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_7(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.sumN_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_8(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.prodN_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_9(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.and_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_10(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.or_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_11(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.xor_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_12(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.alleq_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_13(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.not_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_14(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.sin_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_15(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.cos_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_16(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.sinh_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_17(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.cosh_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_18(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.tan_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_19(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.tanh_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_20(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.asin_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_21(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.acos_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_22(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.atan_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_23(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.actan_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_24(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.exp_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_25(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.ln_6718cy$(argsParentNode);
    };
  }
  function BaseOperationsDefinitions$baseOperationsDefinitions$lambda_26(this$BaseOperationsDefinitions) {
    return function (argsParentNode) {
      return this$BaseOperationsDefinitions.abs_6718cy$(argsParentNode);
    };
  }
  BaseOperationsDefinitions.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'BaseOperationsDefinitions',
    interfaces: []
  };
  function BaseSimpleNumbersComputation() {
    BaseSimpleNumbersComputation$Companion_getInstance();
    this.baseComputationOperations_0 = mapOf_0([to('', BaseSimpleNumbersComputation$baseComputationOperations$lambda(this)), to('+', BaseSimpleNumbersComputation$baseComputationOperations$lambda_0(this)), to('*', BaseSimpleNumbersComputation$baseComputationOperations$lambda_1(this)), to('-', BaseSimpleNumbersComputation$baseComputationOperations$lambda_2(this)), to('/', BaseSimpleNumbersComputation$baseComputationOperations$lambda_3(this)), to('^', BaseSimpleNumbersComputation$baseComputationOperations$lambda_4(this)), to('mod', BaseSimpleNumbersComputation$baseComputationOperations$lambda_5(this)), to('and', BaseSimpleNumbersComputation$baseComputationOperations$lambda_6(this)), to('or', BaseSimpleNumbersComputation$baseComputationOperations$lambda_7(this)), to('xor', BaseSimpleNumbersComputation$baseComputationOperations$lambda_8(this)), to('alleq', BaseSimpleNumbersComputation$baseComputationOperations$lambda_9(this)), to('not', BaseSimpleNumbersComputation$baseComputationOperations$lambda_10(this)), to('sin', BaseSimpleNumbersComputation$baseComputationOperations$lambda_11(this)), to('cos', BaseSimpleNumbersComputation$baseComputationOperations$lambda_12(this)), to('tg', BaseSimpleNumbersComputation$baseComputationOperations$lambda_13(this)), to('sh', BaseSimpleNumbersComputation$baseComputationOperations$lambda_14(this)), to('ch', BaseSimpleNumbersComputation$baseComputationOperations$lambda_15(this)), to('th', BaseSimpleNumbersComputation$baseComputationOperations$lambda_16(this)), to('asin', BaseSimpleNumbersComputation$baseComputationOperations$lambda_17(this)), to('acos', BaseSimpleNumbersComputation$baseComputationOperations$lambda_18(this)), to('atg', BaseSimpleNumbersComputation$baseComputationOperations$lambda_19(this)), to('actg', BaseSimpleNumbersComputation$baseComputationOperations$lambda_20(this)), to('pow', BaseSimpleNumbersComputation$baseComputationOperations$lambda_21(this)), to('ln', BaseSimpleNumbersComputation$baseComputationOperations$lambda_22(this)), to('exp', BaseSimpleNumbersComputation$baseComputationOperations$lambda_23(this)), to('abs', BaseSimpleNumbersComputation$baseComputationOperations$lambda_24(this)), to('sqrt', BaseSimpleNumbersComputation$baseComputationOperations$lambda_25(this))]);
  }
  function BaseSimpleNumbersComputation$FoldedExpression(nameOfZVariable, from, to, expression) {
    this.nameOfZVariable = nameOfZVariable;
    this.from = from;
    this.to = to;
    this.expression = expression;
  }
  BaseSimpleNumbersComputation$FoldedExpression.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FoldedExpression',
    interfaces: []
  };
  function BaseSimpleNumbersComputation$Companion() {
    BaseSimpleNumbersComputation$Companion_instance = this;
    this.epsilon = 1.19E-6;
  }
  BaseSimpleNumbersComputation$Companion.prototype.additivelyEqualTo_0 = function ($receiver, number) {
    return rangeTo(-this.epsilon, this.epsilon).contains_mef7kx$($receiver - number);
  };
  BaseSimpleNumbersComputation$Companion.prototype.additivelyEqualToZero_0 = function ($receiver) {
    return rangeTo(-this.epsilon, this.epsilon).contains_mef7kx$($receiver);
  };
  BaseSimpleNumbersComputation$Companion.prototype.additivelyEqual_lu1900$ = function (l, r) {
    return l === r || this.additivelyEqualTo_0(l, r);
  };
  BaseSimpleNumbersComputation$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var BaseSimpleNumbersComputation$Companion_instance = null;
  function BaseSimpleNumbersComputation$Companion_getInstance() {
    if (BaseSimpleNumbersComputation$Companion_instance === null) {
      new BaseSimpleNumbersComputation$Companion();
    }
    return BaseSimpleNumbersComputation$Companion_instance;
  }
  BaseSimpleNumbersComputation.prototype.doubleFunctionToAny_0 = function (listOfArgs, baseOperation) {
    return baseOperation(this.parseDoubleNumbers_0(listOfArgs));
  };
  BaseSimpleNumbersComputation.prototype.compute_6718cy$ = function (expressionNode) {
    var tmp$, tmp$_0;
    if (expressionNode.children.isEmpty()) {
      tmp$_0 = this.stringToNumber_0(expressionNode.value);
    }
     else {
      if (this.isFoldedExpression_0(expressionNode)) {
        return this.calculateFoldedExpression_0(expressionNode);
      }
      var listOfArgs = ArrayList_init();
      tmp$ = expressionNode.children.iterator();
      while (tmp$.hasNext()) {
        var childNode = tmp$.next();
        listOfArgs.add_11rb$(this.compute_6718cy$(childNode));
      }
      tmp$_0 = ensureNotNull(this.baseComputationOperations_0.get_11rb$(expressionNode.value))(listOfArgs);
    }
    return tmp$_0;
  };
  BaseSimpleNumbersComputation.prototype.stringToNumber_0 = function (arg) {
    return toDouble(arg);
  };
  BaseSimpleNumbersComputation.prototype.isFoldedExpression_0 = function (expression) {
    return equals(expression.value, 'P') || equals(expression.value, 'S');
  };
  BaseSimpleNumbersComputation.prototype.calculateFoldedExpression_0 = function (expression) {
    var tmp$;
    switch (expression.value) {
      case 'S':
        tmp$ = this.sumN_0(expression);
        break;
      case 'P':
        tmp$ = this.prodN_0(expression);
        break;
      default:throw IllegalArgumentException_init("Given expression's type " + expression.value + ' is not folded');
    }
    return tmp$;
  };
  BaseSimpleNumbersComputation.prototype.parseComplexNumbers_0 = function (listOfArgs) {
    var tmp$;
    var listOfNumbers = ArrayList_init();
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (Kotlin.isType(arg, Complex)) {
        listOfNumbers.add_11rb$(arg);
      }
       else {
        throw IllegalArgumentException_init('List contains element, which is not a complex number');
      }
    }
    return listOfNumbers;
  };
  BaseSimpleNumbersComputation.prototype.parseDoubleNumbers_0 = function (listOfArgs) {
    var tmp$;
    var listOfNumbers = ArrayList_init();
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (typeof arg === 'number') {
        listOfNumbers.add_11rb$(arg);
      }
       else {
        throw IllegalArgumentException_init('List contains element, which is not a complex number');
      }
    }
    return listOfNumbers;
  };
  BaseSimpleNumbersComputation.prototype.brackets_0 = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Not one argument in brackets.');
    }
     else {
      return listOfArgs.get_za3lpa$(0);
    }
  };
  BaseSimpleNumbersComputation.prototype.plus_0 = function (listOfArgs) {
    return ensureNotNull(this.baseComputationOperations_0.get_11rb$('+'))(listOfArgs);
  };
  BaseSimpleNumbersComputation.prototype.mul_0 = function (listOfArgs) {
    return ensureNotNull(this.baseComputationOperations_0.get_11rb$('*'))(listOfArgs);
  };
  BaseSimpleNumbersComputation.prototype.sumN_0 = function (expression) {
    var deploymentOfSum = this.unfold_0(this.convertToFoldedExpression_0(expression));
    return this.plus_0(deploymentOfSum);
  };
  BaseSimpleNumbersComputation.prototype.convertToFoldedExpression_0 = function (expression) {
    if (!this.isFoldedExpression_0(expression)) {
      throw IllegalArgumentException_init(expression.value + ' is not folded');
    }
    var from = this.compute_6718cy$(expression.children.get_za3lpa$(1));
    var to = this.compute_6718cy$(expression.children.get_za3lpa$(2));
    return new BaseSimpleNumbersComputation$FoldedExpression(expression.children.get_za3lpa$(0).value, this.convertToDouble_0(from), this.convertToDouble_0(to), expression.children.get_za3lpa$(3));
  };
  BaseSimpleNumbersComputation.prototype.convertToDouble_0 = function (value) {
    var tmp$;
    return typeof (tmp$ = value) === 'number' ? tmp$ : throwCCE();
  };
  BaseSimpleNumbersComputation.prototype.unfold_0 = function (foldedExpression) {
    var deployedArguments = ArrayList_init();
    var iter = foldedExpression.from;
    while (iter <= foldedExpression.to) {
      var expression = foldedExpression.expression.cloneWithVariableReplacement_y0zsll$(mutableMapOf([new Pair(foldedExpression.nameOfZVariable, iter.toString())]));
      deployedArguments.add_11rb$(this.compute_6718cy$(expression));
      iter = iter + 1;
    }
    return deployedArguments;
  };
  BaseSimpleNumbersComputation.prototype.prodN_0 = function (expression) {
    var deploymentOfProd = this.unfold_0(this.convertToFoldedExpression_0(expression));
    return this.mul_0(deploymentOfProd);
  };
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.brackets_0(listOfArgs);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda(args) {
    return DoubleBaseOperation$Companion_getInstance().plus_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_0(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_0(args) {
    return DoubleBaseOperation$Companion_getInstance().mul_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_1(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_0);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_1(args) {
    return DoubleBaseOperation$Companion_getInstance().minus_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_2(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_1);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_2(args) {
    return DoubleBaseOperation$Companion_getInstance().div_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_3(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_2);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_3(args) {
    return DoubleBaseOperation$Companion_getInstance().pow_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_4(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_3);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_4(args) {
    return DoubleBaseOperation$Companion_getInstance().mod_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_5(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_4);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_5(args) {
    return DoubleBaseOperation$Companion_getInstance().and_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_6(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_5);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_6(args) {
    return DoubleBaseOperation$Companion_getInstance().or_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_7(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_6);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_7(args) {
    return DoubleBaseOperation$Companion_getInstance().xor_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_8(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_7);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_8(args) {
    return DoubleBaseOperation$Companion_getInstance().alleq_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_9(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_8);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_9(args) {
    return DoubleBaseOperation$Companion_getInstance().not_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_10(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_9);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_10(args) {
    return DoubleBaseOperation$Companion_getInstance().sin_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_11(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_10);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_11(args) {
    return DoubleBaseOperation$Companion_getInstance().cos_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_12(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_11);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_12(args) {
    return DoubleBaseOperation$Companion_getInstance().tan_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_13(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_12);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_13(args) {
    return DoubleBaseOperation$Companion_getInstance().sinh_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_14(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_13);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_14(args) {
    return DoubleBaseOperation$Companion_getInstance().cosh_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_15(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_14);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_15(args) {
    return DoubleBaseOperation$Companion_getInstance().tanh_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_16(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_15);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_16(args) {
    return DoubleBaseOperation$Companion_getInstance().asin_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_17(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_16);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_17(args) {
    return DoubleBaseOperation$Companion_getInstance().acos_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_18(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_17);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_18(args) {
    return DoubleBaseOperation$Companion_getInstance().atan_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_19(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_18);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_19(args) {
    return DoubleBaseOperation$Companion_getInstance().actan_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_20(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_19);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_20(args) {
    return DoubleBaseOperation$Companion_getInstance().pow_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_21(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_20);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_21(args) {
    return DoubleBaseOperation$Companion_getInstance().ln_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_22(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_21);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_22(args) {
    return DoubleBaseOperation$Companion_getInstance().exp_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_23(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_22);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_23(args) {
    return DoubleBaseOperation$Companion_getInstance().abs_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_24(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_23);
    };
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_24(args) {
    return DoubleBaseOperation$Companion_getInstance().sqrt_d3e2cz$(args);
  }
  function BaseSimpleNumbersComputation$baseComputationOperations$lambda_25(this$BaseSimpleNumbersComputation) {
    return function (listOfArgs) {
      return this$BaseSimpleNumbersComputation.doubleFunctionToAny_0(listOfArgs, BaseSimpleNumbersComputation$baseComputationOperations$lambda$lambda_24);
    };
  }
  BaseSimpleNumbersComputation.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'BaseSimpleNumbersComputation',
    interfaces: []
  };
  function ComplexBaseOperation() {
    ComplexBaseOperation$Companion_getInstance();
  }
  function ComplexBaseOperation$Companion() {
    ComplexBaseOperation$Companion_instance = this;
  }
  ComplexBaseOperation$Companion.prototype.plus_lc9fqz$ = function (listOfArgs) {
    var tmp$;
    var result = toComplex(0);
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      result.plusAssign_i6s3kk$(arg);
    }
    return result;
  };
  ComplexBaseOperation$Companion.prototype.minus_lc9fqz$ = function (listOfArgs) {
    var tmp$;
    if (listOfArgs.isEmpty()) {
      throw IllegalArgumentException_init('Given list is empty');
    }
    var result = toComplex(0);
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      result.minusAssign_i6s3kk$(arg);
    }
    return result;
  };
  ComplexBaseOperation$Companion.prototype.mul_lc9fqz$ = function (listOfArgs) {
    var tmp$;
    var result = toComplex(1);
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      result.timesAssign_i6s3kk$(arg);
    }
    return result;
  };
  ComplexBaseOperation$Companion.prototype.div_lc9fqz$ = function (listOfArgs) {
    var tmp$;
    if (listOfArgs.isEmpty()) {
      throw IllegalArgumentException_init('Given list is empty');
    }
    var result = listOfArgs.get_za3lpa$(0);
    var isFirstElement = true;
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (isFirstElement) {
        isFirstElement = false;
      }
       else {
        result.divAssign_i6s3kk$(arg);
      }
    }
    return result;
  };
  ComplexBaseOperation$Companion.prototype.mod_lc9fqz$ = function (listOfArgs) {
    return toComplex(0);
  };
  ComplexBaseOperation$Companion.prototype.pow_lc9fqz$ = function (listOfArgs) {
    var index = listOfArgs.size - 1 | 0;
    var currentPow = toComplex(1);
    while (index >= 0) {
      currentPow = listOfArgs.get_za3lpa$(index).pow_i6s3kk$(currentPow);
      index = index - 1 | 0;
    }
    return currentPow;
  };
  ComplexBaseOperation$Companion.prototype.and_lc9fqz$ = function (listOfArgs) {
    var tmp$;
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (arg.equals_i6s3kk$(toComplex(0))) {
        return toComplex(0);
      }
    }
    return toComplex(1);
  };
  ComplexBaseOperation$Companion.prototype.or_lc9fqz$ = function (listOfArgs) {
    var tmp$;
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (!arg.equals_i6s3kk$(toComplex(0))) {
        return toComplex(1);
      }
    }
    return toComplex(0);
  };
  ComplexBaseOperation$Companion.prototype.xor_lc9fqz$ = function (listOfArgs) {
    var tmp$;
    var counter = 0;
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (!arg.equals_i6s3kk$(toComplex(0))) {
        counter = counter + 1 | 0;
      }
    }
    return toComplex(counter % 2);
  };
  ComplexBaseOperation$Companion.prototype.alleq_lc9fqz$ = function (listOfArgs) {
    var tmp$;
    if (listOfArgs.isEmpty()) {
      return toComplex(1);
    }
    var firstArg = listOfArgs.get_za3lpa$(0);
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (!arg.equals_i6s3kk$(firstArg)) {
        return toComplex(0);
      }
    }
    return toComplex(1);
  };
  ComplexBaseOperation$Companion.prototype.not_lc9fqz$ = function (listOfArgs) {
    var tmp$;
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('List size is not equals to 1');
    }
     else {
      if (listOfArgs.get_za3lpa$(0).equals_i6s3kk$(toComplex(0))) {
        tmp$ = toComplex(1);
      }
       else {
        tmp$ = toComplex(0);
      }
    }
    return tmp$;
  };
  ComplexBaseOperation$Companion.prototype.sin_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex$Companion_getInstance().sin_i6s3kk$(listOfArgs.get_za3lpa$(0));
  };
  ComplexBaseOperation$Companion.prototype.cos_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex$Companion_getInstance().cos_i6s3kk$(listOfArgs.get_za3lpa$(0));
  };
  ComplexBaseOperation$Companion.prototype.sinh_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex$Companion_getInstance().sinh_i6s3kk$(listOfArgs.get_za3lpa$(0));
  };
  ComplexBaseOperation$Companion.prototype.cosh_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex$Companion_getInstance().cosh_i6s3kk$(listOfArgs.get_za3lpa$(0));
  };
  ComplexBaseOperation$Companion.prototype.tan_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex$Companion_getInstance().tan_i6s3kk$(listOfArgs.get_za3lpa$(0));
  };
  ComplexBaseOperation$Companion.prototype.tanh_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex$Companion_getInstance().tanh_i6s3kk$(listOfArgs.get_za3lpa$(0));
  };
  ComplexBaseOperation$Companion.prototype.asin_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex$Companion_getInstance().asin_i6s3kk$(listOfArgs.get_za3lpa$(0));
  };
  ComplexBaseOperation$Companion.prototype.acos_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex$Companion_getInstance().acos_i6s3kk$(listOfArgs.get_za3lpa$(0));
  };
  ComplexBaseOperation$Companion.prototype.atan_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex$Companion_getInstance().atan_i6s3kk$(listOfArgs.get_za3lpa$(0));
  };
  ComplexBaseOperation$Companion.prototype.actan_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var args = listOf_0([Complex_init(new Real(1.0), new Real(0.0), Form$ALGEBRAIC_getInstance()), listOfArgs.get_za3lpa$(0)]);
    return Complex$Companion_getInstance().atan_i6s3kk$(this.div_lc9fqz$(args));
  };
  ComplexBaseOperation$Companion.prototype.exp_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex$Companion_getInstance().exp_i6s3kk$(listOfArgs.get_za3lpa$(0));
  };
  ComplexBaseOperation$Companion.prototype.ln_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex$Companion_getInstance().ln_i6s3kk$(listOfArgs.get_za3lpa$(0));
  };
  ComplexBaseOperation$Companion.prototype.abs_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex_init(Complex$Companion_getInstance().abs_i6s3kk$(listOfArgs.get_za3lpa$(0)), Real_init(0), Form$ALGEBRAIC_getInstance());
  };
  ComplexBaseOperation$Companion.prototype.sqrt_lc9fqz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    return Complex$Companion_getInstance().sqrt_i6s3kk$(listOfArgs.get_za3lpa$(0));
  };
  ComplexBaseOperation$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var ComplexBaseOperation$Companion_instance = null;
  function ComplexBaseOperation$Companion_getInstance() {
    if (ComplexBaseOperation$Companion_instance === null) {
      new ComplexBaseOperation$Companion();
    }
    return ComplexBaseOperation$Companion_instance;
  }
  ComplexBaseOperation.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ComplexBaseOperation',
    interfaces: []
  };
  function DoubleBaseOperation() {
    DoubleBaseOperation$Companion_getInstance();
  }
  function DoubleBaseOperation$Companion() {
    DoubleBaseOperation$Companion_instance = this;
  }
  DoubleBaseOperation$Companion.prototype.plus_d3e2cz$ = function (listOfArgs) {
    var tmp$;
    var result = 0.0;
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      result += arg;
    }
    return result;
  };
  DoubleBaseOperation$Companion.prototype.minus_d3e2cz$ = function (listOfArgs) {
    var tmp$;
    if (listOfArgs.isEmpty()) {
      throw IllegalArgumentException_init('Given list is empty');
    }
    var result = 0.0;
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      result -= arg;
    }
    return result;
  };
  DoubleBaseOperation$Companion.prototype.mul_d3e2cz$ = function (listOfArgs) {
    var tmp$;
    var result = 1.0;
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      result *= arg;
    }
    return result;
  };
  DoubleBaseOperation$Companion.prototype.div_d3e2cz$ = function (listOfArgs) {
    var tmp$;
    if (listOfArgs.isEmpty()) {
      throw IllegalArgumentException_init('Given list is empty');
    }
    var result = listOfArgs.get_za3lpa$(0);
    var isFirstElement = true;
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (isFirstElement) {
        isFirstElement = false;
      }
       else {
        result /= arg;
      }
    }
    return result;
  };
  DoubleBaseOperation$Companion.prototype.mod_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 2) {
      throw IllegalArgumentException_init('list size not equals 2');
    }
     else {
      return listOfArgs.get_za3lpa$(0) % listOfArgs.get_za3lpa$(1);
    }
  };
  DoubleBaseOperation$Companion.prototype.pow_d3e2cz$ = function (listOfArgs) {
    var index = listOfArgs.size - 1 | 0;
    var currentPow = 1.0;
    while (index >= 0) {
      var $receiver = listOfArgs.get_za3lpa$(index);
      var x = currentPow;
      currentPow = Math_0.pow($receiver, x);
      index = index - 1 | 0;
    }
    return currentPow;
  };
  DoubleBaseOperation$Companion.prototype.and_d3e2cz$ = function (listOfArgs) {
    var tmp$;
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (arg === 0.0) {
        return 0.0;
      }
    }
    return 1.0;
  };
  DoubleBaseOperation$Companion.prototype.not_d3e2cz$ = function (listOfArgs) {
    var tmp$;
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('List size is not equals to 1');
    }
     else {
      if (BaseOperationsComputation$Companion_getInstance().additivelyEqual_lu1900$(0.0, listOfArgs.get_za3lpa$(0))) {
        tmp$ = 1.0;
      }
       else {
        tmp$ = 0.0;
      }
    }
    return tmp$;
  };
  DoubleBaseOperation$Companion.prototype.or_d3e2cz$ = function (listOfArgs) {
    var tmp$;
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (arg !== 0.0) {
        return 1.0;
      }
    }
    return 0.0;
  };
  DoubleBaseOperation$Companion.prototype.xor_d3e2cz$ = function (listOfArgs) {
    var tmp$;
    var counter = 0;
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (arg !== 0.0) {
        counter = counter + 1 | 0;
      }
    }
    return counter % 2;
  };
  DoubleBaseOperation$Companion.prototype.alleq_d3e2cz$ = function (listOfArgs) {
    var tmp$;
    if (listOfArgs.isEmpty()) {
      return 1.0;
    }
    var firstArg = listOfArgs.get_za3lpa$(0);
    tmp$ = listOfArgs.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      if (arg !== firstArg) {
        return 0.0;
      }
    }
    return 1.0;
  };
  DoubleBaseOperation$Companion.prototype.sin_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.sin(x);
  };
  DoubleBaseOperation$Companion.prototype.cos_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.cos(x);
  };
  DoubleBaseOperation$Companion.prototype.sinh_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.sinh(x);
  };
  DoubleBaseOperation$Companion.prototype.cosh_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.cosh(x);
  };
  DoubleBaseOperation$Companion.prototype.tan_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.tan(x);
  };
  DoubleBaseOperation$Companion.prototype.tanh_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.tanh(x);
  };
  DoubleBaseOperation$Companion.prototype.asin_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.asin(x);
  };
  DoubleBaseOperation$Companion.prototype.acos_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.acos(x);
  };
  DoubleBaseOperation$Companion.prototype.atan_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.atan(x);
  };
  DoubleBaseOperation$Companion.prototype.actan_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = 1.0 / listOfArgs.get_za3lpa$(0);
    return Math_0.atan(x);
  };
  DoubleBaseOperation$Companion.prototype.exp_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.exp(x);
  };
  DoubleBaseOperation$Companion.prototype.ln_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.log(x);
  };
  DoubleBaseOperation$Companion.prototype.abs_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.abs(x);
  };
  DoubleBaseOperation$Companion.prototype.sqrt_d3e2cz$ = function (listOfArgs) {
    if (listOfArgs.size !== 1) {
      throw IllegalArgumentException_init('Given list contains not one argument');
    }
    var x = listOfArgs.get_za3lpa$(0);
    return Math_0.sqrt(x);
  };
  DoubleBaseOperation$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var DoubleBaseOperation$Companion_instance = null;
  function DoubleBaseOperation$Companion_getInstance() {
    if (DoubleBaseOperation$Companion_instance === null) {
      new DoubleBaseOperation$Companion();
    }
    return DoubleBaseOperation$Companion_instance;
  }
  DoubleBaseOperation.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'DoubleBaseOperation',
    interfaces: []
  };
  function DomainSegment(leftBorder, leftBorderInc, rightBorder, rightBorderInc) {
    DomainSegment$Companion_getInstance();
    this.leftBorder = leftBorder;
    this.leftBorderInc = leftBorderInc;
    this.rightBorder = rightBorder;
    this.rightBorderInc = rightBorderInc;
  }
  DomainSegment.prototype.contains_14dthe$ = function (point) {
    return (this.leftBorder < point || (this.leftBorderInc && point === this.leftBorder)) && (point < this.rightBorder || (this.rightBorderInc && point === this.rightBorder));
  };
  DomainSegment.prototype.shiftBy_14dthe$ = function (shift) {
    return new DomainSegment(this.leftBorder + shift, this.leftBorderInc, this.rightBorder + shift, this.rightBorderInc);
  };
  DomainSegment.prototype.scaleBy_14dthe$ = function (scale) {
    return new DomainSegment(this.leftBorder * scale, this.leftBorderInc, this.rightBorder * scale, this.rightBorderInc);
  };
  DomainSegment.prototype.generateRandomPoint = function () {
    var from = this.leftBorder;
    if (!this.leftBorderInc) {
      from += 1.0E-9;
    }
    var to = this.rightBorder;
    if (this.rightBorderInc) {
      to += 1.0E-9;
    }
    return random_0(from, to);
  };
  function DomainSegment$Companion() {
    DomainSegment$Companion_instance = this;
  }
  DomainSegment$Companion.prototype.inclusive_lu1900$ = function (left, right) {
    return new DomainSegment(left, true, right, true);
  };
  DomainSegment$Companion.prototype.intersect_8tvd3o$ = function (a, b) {
    var isIntersecting = a.leftBorder <= b.rightBorder && b.leftBorder <= a.rightBorder;
    if (!isIntersecting)
      return null;
    var a_0 = a.leftBorder;
    var b_0 = b.leftBorder;
    var newLeft = Math_0.max(a_0, b_0);
    var a_1 = a.rightBorder;
    var b_1 = b.rightBorder;
    var newRight = Math_0.min(a_1, b_1);
    var leftIncl = newLeft === a.leftBorder ? a.leftBorderInc : b.leftBorderInc;
    var rightIncl = newRight === a.rightBorder ? a.rightBorderInc : b.rightBorderInc;
    return new DomainSegment(newLeft, leftIncl, newRight, rightIncl);
  };
  function DomainSegment$Companion$intersectSegments$lambda(it) {
    return it.leftBorder;
  }
  function DomainSegment$Companion$intersectSegments$lambda_0(it) {
    return it.rightBorder;
  }
  DomainSegment$Companion.prototype.intersectSegments_mwrnge$ = function (a, b) {
    return toSet(sortedWith(union(a, b), compareBy([DomainSegment$Companion$intersectSegments$lambda, DomainSegment$Companion$intersectSegments$lambda_0])));
  };
  DomainSegment$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var DomainSegment$Companion_instance = null;
  function DomainSegment$Companion_getInstance() {
    if (DomainSegment$Companion_instance === null) {
      new DomainSegment$Companion();
    }
    return DomainSegment$Companion_instance;
  }
  DomainSegment.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'DomainSegment',
    interfaces: []
  };
  DomainSegment.prototype.component1 = function () {
    return this.leftBorder;
  };
  DomainSegment.prototype.component2 = function () {
    return this.leftBorderInc;
  };
  DomainSegment.prototype.component3 = function () {
    return this.rightBorder;
  };
  DomainSegment.prototype.component4 = function () {
    return this.rightBorderInc;
  };
  DomainSegment.prototype.copy_xl1p70$ = function (leftBorder, leftBorderInc, rightBorder, rightBorderInc) {
    return new DomainSegment(leftBorder === void 0 ? this.leftBorder : leftBorder, leftBorderInc === void 0 ? this.leftBorderInc : leftBorderInc, rightBorder === void 0 ? this.rightBorder : rightBorder, rightBorderInc === void 0 ? this.rightBorderInc : rightBorderInc);
  };
  DomainSegment.prototype.toString = function () {
    return 'DomainSegment(leftBorder=' + Kotlin.toString(this.leftBorder) + (', leftBorderInc=' + Kotlin.toString(this.leftBorderInc)) + (', rightBorder=' + Kotlin.toString(this.rightBorder)) + (', rightBorderInc=' + Kotlin.toString(this.rightBorderInc)) + ')';
  };
  DomainSegment.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.leftBorder) | 0;
    result = result * 31 + Kotlin.hashCode(this.leftBorderInc) | 0;
    result = result * 31 + Kotlin.hashCode(this.rightBorder) | 0;
    result = result * 31 + Kotlin.hashCode(this.rightBorderInc) | 0;
    return result;
  };
  DomainSegment.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.leftBorder, other.leftBorder) && Kotlin.equals(this.leftBorderInc, other.leftBorderInc) && Kotlin.equals(this.rightBorder, other.rightBorder) && Kotlin.equals(this.rightBorderInc, other.rightBorderInc)))));
  };
  function DefinitionDomain(points, excludedPoints, segments) {
    DefinitionDomain$Companion_getInstance();
    if (points === void 0) {
      points = LinkedHashSet_init();
    }
    if (excludedPoints === void 0) {
      excludedPoints = LinkedHashSet_init();
    }
    if (segments === void 0) {
      segments = LinkedHashSet_init();
    }
    this.points = points;
    this.excludedPoints = excludedPoints;
    this.segments = segments;
  }
  DefinitionDomain.prototype.isInDomain_14dthe$ = function (point) {
    var tmp$ = !this.excludedPoints.contains_11rb$(point);
    if (tmp$) {
      var tmp$_0 = this.points.contains_11rb$(point);
      if (!tmp$_0) {
        var $receiver = this.segments;
        var any$result;
        any$break: do {
          var tmp$_1;
          if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
            any$result = false;
            break any$break;
          }
          tmp$_1 = $receiver.iterator();
          while (tmp$_1.hasNext()) {
            var element = tmp$_1.next();
            if (element.contains_14dthe$(point)) {
              any$result = true;
              break any$break;
            }
          }
          any$result = false;
        }
         while (false);
        tmp$_0 = any$result;
      }
      tmp$ = tmp$_0;
    }
    return tmp$;
  };
  DefinitionDomain.prototype.generateNewPoint = function () {
    if (this.points.isEmpty() && this.segments.isEmpty()) {
      throw new EmptyDomainException();
    }
    var generated = this.unsafeGenerateNewPoint_0();
    while (this.excludedPoints.contains_11rb$(generated))
      generated = this.unsafeGenerateNewPoint_0();
    return generated;
  };
  DefinitionDomain.prototype.unsafeGenerateNewPoint_0 = function () {
    if (this.points.isEmpty()) {
      return this.generateFromSegments_0();
    }
     else if (this.segments.isEmpty()) {
      return this.generateFromPoints_0();
    }
     else {
      return defaultRandom() < 0.6 ? this.generateFromSegments_0() : this.generateFromPoints_0();
    }
  };
  DefinitionDomain.prototype.generateFromPoints_0 = function () {
    var tmp$;
    var randnum = randomInt(0, this.points.size);
    var got = 0;
    while (got < randnum) {
      tmp$ = this.points.iterator();
      while (tmp$.hasNext()) {
        var p = tmp$.next();
        got = got + 1 | 0;
        if (got > randnum)
          return p;
      }
    }
    throw IllegalStateException_init();
  };
  DefinitionDomain.prototype.generateFromSegments_0 = function () {
    var tmp$;
    var randnum = randomInt(0, this.segments.size);
    var got = 0;
    while (got < randnum) {
      tmp$ = this.segments.iterator();
      while (tmp$.hasNext()) {
        var p = tmp$.next();
        got = got + 1 | 0;
        if (got > randnum)
          return p.generateRandomPoint();
      }
    }
    throw IllegalStateException_init();
  };
  DefinitionDomain.prototype.intersectWith_1ggb54$ = function (other) {
    return new DefinitionDomain(intersect(this.points, other.points), union(this.excludedPoints, other.excludedPoints), DomainSegment$Companion_getInstance().intersectSegments_mwrnge$(this.segments, other.segments));
  };
  DefinitionDomain.prototype.shiftBy_14dthe$ = function (shift) {
    var $receiver = this.points;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var item = tmp$.next();
      destination.add_11rb$(item + shift);
    }
    var tmp$_0 = toSet(destination);
    var $receiver_0 = this.excludedPoints;
    var destination_0 = ArrayList_init_0(collectionSizeOrDefault($receiver_0, 10));
    var tmp$_1;
    tmp$_1 = $receiver_0.iterator();
    while (tmp$_1.hasNext()) {
      var item_0 = tmp$_1.next();
      destination_0.add_11rb$(item_0 + shift);
    }
    var tmp$_2 = toSet(destination_0);
    var $receiver_1 = this.segments;
    var destination_1 = ArrayList_init_0(collectionSizeOrDefault($receiver_1, 10));
    var tmp$_3;
    tmp$_3 = $receiver_1.iterator();
    while (tmp$_3.hasNext()) {
      var item_1 = tmp$_3.next();
      destination_1.add_11rb$(item_1.shiftBy_14dthe$(shift));
    }
    return new DefinitionDomain(tmp$_0, tmp$_2, toSet(destination_1));
  };
  DefinitionDomain.prototype.scaleBy_14dthe$ = function (scale) {
    var $receiver = this.points;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var item = tmp$.next();
      destination.add_11rb$(item * scale);
    }
    var tmp$_0 = toSet(destination);
    var $receiver_0 = this.excludedPoints;
    var destination_0 = ArrayList_init_0(collectionSizeOrDefault($receiver_0, 10));
    var tmp$_1;
    tmp$_1 = $receiver_0.iterator();
    while (tmp$_1.hasNext()) {
      var item_0 = tmp$_1.next();
      destination_0.add_11rb$(item_0 * scale);
    }
    var tmp$_2 = toSet(destination_0);
    var $receiver_1 = this.segments;
    var destination_1 = ArrayList_init_0(collectionSizeOrDefault($receiver_1, 10));
    var tmp$_3;
    tmp$_3 = $receiver_1.iterator();
    while (tmp$_3.hasNext()) {
      var item_1 = tmp$_3.next();
      destination_1.add_11rb$(item_1.scaleBy_14dthe$(scale));
    }
    return new DefinitionDomain(tmp$_0, tmp$_2, toSet(destination_1));
  };
  DefinitionDomain.prototype.except_yqxtqz$ = function (newPoints) {
    return new DefinitionDomain(this.points, plus_0(toMutableSet(newPoints), this.excludedPoints), this.segments);
  };
  function DefinitionDomain$rightMostElement$lambda(a, b) {
    return Math_0.max(a, b);
  }
  DefinitionDomain.prototype.rightMostElement = function () {
    return this.funcOrNull_0(DefinitionDomain$rightMostElement$lambda, this.rightMostPoint_0(), this.rightMostFromSequence_0());
  };
  function DefinitionDomain$leftMostElement$lambda(a, b) {
    return Math_0.min(a, b);
  }
  DefinitionDomain.prototype.leftMostElement = function () {
    return this.funcOrNull_0(DefinitionDomain$leftMostElement$lambda, this.leftMostPoint_0(), this.leftMostFromSequence_0());
  };
  DefinitionDomain.prototype.funcOrNull_0 = function (func, p, r) {
    var tmp$;
    if (p == null && r == null) {
      throw new EmptyDomainException();
    }
     else if (p == null && r != null) {
      tmp$ = r;
    }
     else if (r == null && p != null) {
      tmp$ = p;
    }
     else if (r != null && p != null) {
      tmp$ = func(p, r);
    }
     else {
      throw IllegalStateException_init();
    }
    return tmp$;
  };
  function DefinitionDomain$leftMostPoint$lambda(this$DefinitionDomain) {
    return function (it) {
      return !this$DefinitionDomain.excludedPoints.contains_11rb$(it);
    };
  }
  DefinitionDomain.prototype.leftMostPoint_0 = function () {
    return firstOrNull(filter(asSequence(sorted(this.points)), DefinitionDomain$leftMostPoint$lambda(this)));
  };
  function DefinitionDomain$rightMostPoint$lambda(this$DefinitionDomain) {
    return function (it) {
      return !this$DefinitionDomain.excludedPoints.contains_11rb$(it);
    };
  }
  DefinitionDomain.prototype.rightMostPoint_0 = function () {
    return firstOrNull(filter(asSequence(sortedDescending(this.points)), DefinitionDomain$rightMostPoint$lambda(this)));
  };
  function DefinitionDomain$leftMostFromSequence$lambda(it) {
    return it.leftBorder;
  }
  function DefinitionDomain$leftMostFromSequence$lambda_0(it) {
    return it.rightBorder;
  }
  DefinitionDomain.prototype.leftMostFromSequence_0 = function () {
    var tmp$;
    return (tmp$ = firstOrNull(sortedWith_0(asSequence(this.segments), compareBy([DefinitionDomain$leftMostFromSequence$lambda, DefinitionDomain$leftMostFromSequence$lambda_0])))) != null ? tmp$.leftBorder : null;
  };
  function DefinitionDomain$rightMostFromSequence$lambda(it) {
    return -it.rightBorder;
  }
  function DefinitionDomain$rightMostFromSequence$lambda_0(it) {
    return -it.leftBorder;
  }
  DefinitionDomain.prototype.rightMostFromSequence_0 = function () {
    var tmp$;
    return (tmp$ = firstOrNull(sortedWith_0(asSequence(this.segments), compareBy([DefinitionDomain$rightMostFromSequence$lambda, DefinitionDomain$rightMostFromSequence$lambda_0])))) != null ? tmp$.rightBorder : null;
  };
  DefinitionDomain.prototype.toString = function () {
    return StringBuilder_init().append_gw00v9$('DefinitionDomain(points=').append_s8jyv4$(this.points).append_gw00v9$(', excludedPoints=').append_s8jyv4$(this.excludedPoints).append_gw00v9$(', segments=').append_s8jyv4$(this.segments).append_gw00v9$(')').toString();
  };
  DefinitionDomain.prototype.equals = function (other) {
    var tmp$;
    if (this === other)
      return true;
    Kotlin.isType(tmp$ = other, DefinitionDomain) ? tmp$ : throwCCE();
    if (!equals(this.points, other.points))
      return false;
    if (!equals(this.excludedPoints, other.excludedPoints))
      return false;
    if (!equals(this.segments, other.segments))
      return false;
    return true;
  };
  DefinitionDomain.prototype.hashCode = function () {
    var result = hashCode(this.points);
    result = (31 * result | 0) + hashCode(this.excludedPoints) | 0;
    result = (31 * result | 0) + hashCode(this.segments) | 0;
    return result;
  };
  function DefinitionDomain$Companion() {
    DefinitionDomain$Companion_instance = this;
  }
  DefinitionDomain$Companion.prototype.inclusive_lu1900$ = function (left, right) {
    return new DefinitionDomain(void 0, void 0, mutableSetOf([DomainSegment$Companion_getInstance().inclusive_lu1900$(left, right)]));
  };
  DefinitionDomain$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var DefinitionDomain$Companion_instance = null;
  function DefinitionDomain$Companion_getInstance() {
    if (DefinitionDomain$Companion_instance === null) {
      new DefinitionDomain$Companion();
    }
    return DefinitionDomain$Companion_instance;
  }
  DefinitionDomain.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'DefinitionDomain',
    interfaces: []
  };
  function EmptyDomainException() {
    Throwable.call(this);
    this.message_onshim$_0 = void 0;
    this.cause_7aui28$_0 = null;
    Kotlin.captureStack(Throwable, this);
    this.name = 'EmptyDomainException';
  }
  Object.defineProperty(EmptyDomainException.prototype, 'message', {
    get: function () {
      return this.message_onshim$_0;
    }
  });
  Object.defineProperty(EmptyDomainException.prototype, 'cause', {
    get: function () {
      return this.cause_7aui28$_0;
    }
  });
  EmptyDomainException.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'EmptyDomainException',
    interfaces: [Throwable]
  };
  function AnalyticallyDefinedDomain(predicates) {
    this.predicates = predicates;
  }
  AnalyticallyDefinedDomain.prototype.isInDomain_14dthe$ = function (point) {
    var $receiver = this.predicates;
    var all$result;
    all$break: do {
      var tmp$;
      if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
        all$result = true;
        break all$break;
      }
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (!element(point)) {
          all$result = false;
          break all$break;
        }
      }
      all$result = true;
    }
     while (false);
    return all$result;
  };
  AnalyticallyDefinedDomain.prototype.generateNewPoint = function () {
    throw new NotImplementedError_init();
  };
  AnalyticallyDefinedDomain.prototype.intersectWith_z3uz13$ = function (other) {
    return new AnalyticallyDefinedDomain(plus(this.predicates, other.predicates));
  };
  AnalyticallyDefinedDomain.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'AnalyticallyDefinedDomain',
    interfaces: []
  };
  var DomainAll;
  var DomainNil;
  function MultivariateDefinitionDomain(expression) {
    this.expression = expression;
    var $receiver = this.expression.getVariableNames();
    var result = LinkedHashMap_init(coerceAtLeast(mapCapacity(collectionSizeOrDefault($receiver, 10)), 16));
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      result.put_xwzc9p$(element, DomainAll);
    }
    this.variables = toMutableMap(result);
  }
  MultivariateDefinitionDomain.prototype.set_7y87zu$ = function (varname, vardomain) {
    if (this.variables.containsKey_11rb$(varname)) {
      this.variables.put_xwzc9p$(varname, vardomain);
    }
  };
  MultivariateDefinitionDomain.prototype.get_61zpoe$ = function (varname) {
    return this.variables.get_11rb$(varname);
  };
  MultivariateDefinitionDomain.prototype.generateNewPoint = function () {
    var $receiver = this.variables;
    var destination = LinkedHashMap_init(mapCapacity($receiver.size));
    var tmp$;
    tmp$ = $receiver.entries.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      destination.put_xwzc9p$(element.key, element.value.generateNewPoint());
    }
    return destination;
  };
  MultivariateDefinitionDomain.prototype.intersect_3x6ap$ = function (other) {
    var $receiver = union(this.variables.keys, other.variables.keys);
    var result = LinkedHashMap_init(coerceAtLeast(mapCapacity(collectionSizeOrDefault($receiver, 10)), 16));
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      result.put_xwzc9p$(element, ensureNotNull(this.variables.get_11rb$(element)).intersectWith_1ggb54$(ensureNotNull(other.variables.get_11rb$(element))));
    }
    return result;
  };
  MultivariateDefinitionDomain.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'MultivariateDefinitionDomain',
    interfaces: []
  };
  function Segment(leftBorder, rightBorder, point, isLeftBorderIncluded, isRightBorderIncluded) {
    if (leftBorder === void 0)
      leftBorder = null;
    if (rightBorder === void 0)
      rightBorder = null;
    if (point === void 0)
      point = null;
    if (isLeftBorderIncluded === void 0)
      isLeftBorderIncluded = true;
    if (isRightBorderIncluded === void 0)
      isRightBorderIncluded = true;
    this.leftBorder = leftBorder;
    this.rightBorder = rightBorder;
    this.point = point;
    this.isLeftBorderIncluded = isLeftBorderIncluded;
    this.isRightBorderIncluded = isRightBorderIncluded;
  }
  Segment.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'Segment',
    interfaces: []
  };
  Segment.prototype.component1 = function () {
    return this.leftBorder;
  };
  Segment.prototype.component2 = function () {
    return this.rightBorder;
  };
  Segment.prototype.component3 = function () {
    return this.point;
  };
  Segment.prototype.component4 = function () {
    return this.isLeftBorderIncluded;
  };
  Segment.prototype.component5 = function () {
    return this.isRightBorderIncluded;
  };
  Segment.prototype.copy_r1ee8j$ = function (leftBorder, rightBorder, point, isLeftBorderIncluded, isRightBorderIncluded) {
    return new Segment(leftBorder === void 0 ? this.leftBorder : leftBorder, rightBorder === void 0 ? this.rightBorder : rightBorder, point === void 0 ? this.point : point, isLeftBorderIncluded === void 0 ? this.isLeftBorderIncluded : isLeftBorderIncluded, isRightBorderIncluded === void 0 ? this.isRightBorderIncluded : isRightBorderIncluded);
  };
  Segment.prototype.toString = function () {
    return 'Segment(leftBorder=' + Kotlin.toString(this.leftBorder) + (', rightBorder=' + Kotlin.toString(this.rightBorder)) + (', point=' + Kotlin.toString(this.point)) + (', isLeftBorderIncluded=' + Kotlin.toString(this.isLeftBorderIncluded)) + (', isRightBorderIncluded=' + Kotlin.toString(this.isRightBorderIncluded)) + ')';
  };
  Segment.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.leftBorder) | 0;
    result = result * 31 + Kotlin.hashCode(this.rightBorder) | 0;
    result = result * 31 + Kotlin.hashCode(this.point) | 0;
    result = result * 31 + Kotlin.hashCode(this.isLeftBorderIncluded) | 0;
    result = result * 31 + Kotlin.hashCode(this.isRightBorderIncluded) | 0;
    return result;
  };
  Segment.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.leftBorder, other.leftBorder) && Kotlin.equals(this.rightBorder, other.rightBorder) && Kotlin.equals(this.point, other.point) && Kotlin.equals(this.isLeftBorderIncluded, other.isLeftBorderIncluded) && Kotlin.equals(this.isRightBorderIncluded, other.isRightBorderIncluded)))));
  };
  function SegmentsUnion(segmentsUnion) {
    if (segmentsUnion === void 0) {
      segmentsUnion = ArrayList_init();
    }
    this.segmentsUnion = segmentsUnion;
  }
  SegmentsUnion.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'SegmentsUnion',
    interfaces: []
  };
  SegmentsUnion.prototype.component1 = function () {
    return this.segmentsUnion;
  };
  SegmentsUnion.prototype.copy_sve6fy$ = function (segmentsUnion) {
    return new SegmentsUnion(segmentsUnion === void 0 ? this.segmentsUnion : segmentsUnion);
  };
  SegmentsUnion.prototype.toString = function () {
    return 'SegmentsUnion(segmentsUnion=' + Kotlin.toString(this.segmentsUnion) + ')';
  };
  SegmentsUnion.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.segmentsUnion) | 0;
    return result;
  };
  SegmentsUnion.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && Kotlin.equals(this.segmentsUnion, other.segmentsUnion))));
  };
  function VariableProperties(name, segmentsUnionsIntersection, unableToCompute) {
    if (segmentsUnionsIntersection === void 0) {
      segmentsUnionsIntersection = ArrayList_init();
    }
    if (unableToCompute === void 0)
      unableToCompute = false;
    this.name = name;
    this.segmentsUnionsIntersection = segmentsUnionsIntersection;
    this.unableToCompute = unableToCompute;
  }
  VariableProperties.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'VariableProperties',
    interfaces: []
  };
  VariableProperties.prototype.component1 = function () {
    return this.name;
  };
  VariableProperties.prototype.component2 = function () {
    return this.segmentsUnionsIntersection;
  };
  VariableProperties.prototype.component3 = function () {
    return this.unableToCompute;
  };
  VariableProperties.prototype.copy_6l4fbr$ = function (name, segmentsUnionsIntersection, unableToCompute) {
    return new VariableProperties(name === void 0 ? this.name : name, segmentsUnionsIntersection === void 0 ? this.segmentsUnionsIntersection : segmentsUnionsIntersection, unableToCompute === void 0 ? this.unableToCompute : unableToCompute);
  };
  VariableProperties.prototype.toString = function () {
    return 'VariableProperties(name=' + Kotlin.toString(this.name) + (', segmentsUnionsIntersection=' + Kotlin.toString(this.segmentsUnionsIntersection)) + (', unableToCompute=' + Kotlin.toString(this.unableToCompute)) + ')';
  };
  VariableProperties.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.name) | 0;
    result = result * 31 + Kotlin.hashCode(this.segmentsUnionsIntersection) | 0;
    result = result * 31 + Kotlin.hashCode(this.unableToCompute) | 0;
    return result;
  };
  VariableProperties.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.name, other.name) && Kotlin.equals(this.segmentsUnionsIntersection, other.segmentsUnionsIntersection) && Kotlin.equals(this.unableToCompute, other.unableToCompute)))));
  };
  function PointGenerator(baseOperationsDefinitions, expressions, maxValueMultiplier) {
    if (baseOperationsDefinitions === void 0)
      baseOperationsDefinitions = new BaseOperationsDefinitions();
    if (expressions === void 0) {
      expressions = ArrayList_init();
    }
    if (maxValueMultiplier === void 0)
      maxValueMultiplier = 10.0;
    this.baseOperationsDefinitions = baseOperationsDefinitions;
    this.expressions = expressions;
    this.maxValueMultiplier = maxValueMultiplier;
    this.border = 0;
    this.variablesSet = LinkedHashSet_init();
    var tmp$;
    var variablesNamesSet = LinkedHashSet_init();
    var maxConstant = 1.0;
    tmp$ = this.expressions.iterator();
    while (tmp$.hasNext()) {
      var expression = tmp$.next();
      variablesNamesSet.addAll_brywnq$(expression.getVariableNames());
      var a = expression.getMaxConstant();
      var b = maxConstant;
      maxConstant = Math_0.max(a, b);
    }
    var tmp$_0;
    tmp$_0 = variablesNamesSet.iterator();
    while (tmp$_0.hasNext()) {
      var element = tmp$_0.next();
      this.variablesSet.add_11rb$(new VariableProperties(element));
    }
    this.border = maxConstant * this.maxValueMultiplier;
  }
  PointGenerator.prototype.generateNewPoint = function () {
    var tmp$;
    var result = LinkedHashMap_init_0();
    tmp$ = this.variablesSet.iterator();
    while (tmp$.hasNext()) {
      var variable = tmp$.next();
      if (variable.segmentsUnionsIntersection.isEmpty()) {
        result.put_xwzc9p$(variable.name, random_0(-this.border, this.border).toString());
      }
       else {
        throw new NotImplementedError_init();
      }
    }
    return result;
  };
  PointGenerator.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'PointGenerator',
    interfaces: []
  };
  function CheckedFactColor(checkedFactBackgroundColor, correctFactColor, unconfirmedFactColor, factNotHelpFactColor, factHelpFactColor, wrongFactColor, wrongTransformationFactColor) {
    if (checkedFactBackgroundColor === void 0)
      checkedFactBackgroundColor = '7F00FF';
    if (correctFactColor === void 0)
      correctFactColor = '007F00';
    if (unconfirmedFactColor === void 0)
      unconfirmedFactColor = 'FF00FF';
    if (factNotHelpFactColor === void 0)
      factNotHelpFactColor = 'FF00FF';
    if (factHelpFactColor === void 0)
      factHelpFactColor = '007F00';
    if (wrongFactColor === void 0)
      wrongFactColor = 'FF0000';
    if (wrongTransformationFactColor === void 0)
      wrongTransformationFactColor = 'FF0000';
    this.checkedFactBackgroundColor = checkedFactBackgroundColor;
    this.correctFactColor = correctFactColor;
    this.unconfirmedFactColor = unconfirmedFactColor;
    this.factNotHelpFactColor = factNotHelpFactColor;
    this.factHelpFactColor = factHelpFactColor;
    this.wrongFactColor = wrongFactColor;
    this.wrongTransformationFactColor = wrongTransformationFactColor;
  }
  CheckedFactColor.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'CheckedFactColor',
    interfaces: []
  };
  CheckedFactColor.prototype.component1 = function () {
    return this.checkedFactBackgroundColor;
  };
  CheckedFactColor.prototype.component2 = function () {
    return this.correctFactColor;
  };
  CheckedFactColor.prototype.component3 = function () {
    return this.unconfirmedFactColor;
  };
  CheckedFactColor.prototype.component4 = function () {
    return this.factNotHelpFactColor;
  };
  CheckedFactColor.prototype.component5 = function () {
    return this.factHelpFactColor;
  };
  CheckedFactColor.prototype.component6 = function () {
    return this.wrongFactColor;
  };
  CheckedFactColor.prototype.component7 = function () {
    return this.wrongTransformationFactColor;
  };
  CheckedFactColor.prototype.copy_blz5pm$ = function (checkedFactBackgroundColor, correctFactColor, unconfirmedFactColor, factNotHelpFactColor, factHelpFactColor, wrongFactColor, wrongTransformationFactColor) {
    return new CheckedFactColor(checkedFactBackgroundColor === void 0 ? this.checkedFactBackgroundColor : checkedFactBackgroundColor, correctFactColor === void 0 ? this.correctFactColor : correctFactColor, unconfirmedFactColor === void 0 ? this.unconfirmedFactColor : unconfirmedFactColor, factNotHelpFactColor === void 0 ? this.factNotHelpFactColor : factNotHelpFactColor, factHelpFactColor === void 0 ? this.factHelpFactColor : factHelpFactColor, wrongFactColor === void 0 ? this.wrongFactColor : wrongFactColor, wrongTransformationFactColor === void 0 ? this.wrongTransformationFactColor : wrongTransformationFactColor);
  };
  CheckedFactColor.prototype.toString = function () {
    return 'CheckedFactColor(checkedFactBackgroundColor=' + Kotlin.toString(this.checkedFactBackgroundColor) + (', correctFactColor=' + Kotlin.toString(this.correctFactColor)) + (', unconfirmedFactColor=' + Kotlin.toString(this.unconfirmedFactColor)) + (', factNotHelpFactColor=' + Kotlin.toString(this.factNotHelpFactColor)) + (', factHelpFactColor=' + Kotlin.toString(this.factHelpFactColor)) + (', wrongFactColor=' + Kotlin.toString(this.wrongFactColor)) + (', wrongTransformationFactColor=' + Kotlin.toString(this.wrongTransformationFactColor)) + ')';
  };
  CheckedFactColor.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.checkedFactBackgroundColor) | 0;
    result = result * 31 + Kotlin.hashCode(this.correctFactColor) | 0;
    result = result * 31 + Kotlin.hashCode(this.unconfirmedFactColor) | 0;
    result = result * 31 + Kotlin.hashCode(this.factNotHelpFactColor) | 0;
    result = result * 31 + Kotlin.hashCode(this.factHelpFactColor) | 0;
    result = result * 31 + Kotlin.hashCode(this.wrongFactColor) | 0;
    result = result * 31 + Kotlin.hashCode(this.wrongTransformationFactColor) | 0;
    return result;
  };
  CheckedFactColor.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.checkedFactBackgroundColor, other.checkedFactBackgroundColor) && Kotlin.equals(this.correctFactColor, other.correctFactColor) && Kotlin.equals(this.unconfirmedFactColor, other.unconfirmedFactColor) && Kotlin.equals(this.factNotHelpFactColor, other.factNotHelpFactColor) && Kotlin.equals(this.factHelpFactColor, other.factHelpFactColor) && Kotlin.equals(this.wrongFactColor, other.wrongFactColor) && Kotlin.equals(this.wrongTransformationFactColor, other.wrongTransformationFactColor)))));
  };
  function CheckedFactAccentuation(checkedFactColor) {
    if (checkedFactColor === void 0)
      checkedFactColor = new CheckedFactColor();
    this.checkedFactColor = checkedFactColor;
  }
  CheckedFactAccentuation.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'CheckedFactAccentuation',
    interfaces: []
  };
  CheckedFactAccentuation.prototype.component1 = function () {
    return this.checkedFactColor;
  };
  CheckedFactAccentuation.prototype.copy_5u2i0s$ = function (checkedFactColor) {
    return new CheckedFactAccentuation(checkedFactColor === void 0 ? this.checkedFactColor : checkedFactColor);
  };
  CheckedFactAccentuation.prototype.toString = function () {
    return 'CheckedFactAccentuation(checkedFactColor=' + Kotlin.toString(this.checkedFactColor) + ')';
  };
  CheckedFactAccentuation.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.checkedFactColor) | 0;
    return result;
  };
  CheckedFactAccentuation.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && Kotlin.equals(this.checkedFactColor, other.checkedFactColor))));
  };
  function CheckingKeyWords() {
    CheckingKeyWords$Companion_getInstance();
  }
  function CheckingKeyWords$Companion() {
    CheckingKeyWords$Companion_instance = this;
    this.notFound = 'NOT_FOUND';
    this.transformationNotFound = 'TRANSFORMATION_NOT_FOUND';
    this.verificationFailed = 'VERIFICATION_FAILED';
    this.isNotExpressionRule = 'CANNOT_BE_APPLIED_TO_EXPRESSIONS';
    this.comparisonTypesConflict = 'COMPARISON_SIGNS_CONFLICT';
    this.expressionChainVerified = 'EXPRESSION_CHAIN_VERIFIED';
    this.factChainVerified = 'FACT_CHAIN_VERIFIED';
    this.transformationVerified = 'TRANSFORMATION_VERIFIED';
    this.transformationFound = 'TRANSFORMATION_FOUND';
    this.comparisonStart = 'COMPARISON_START';
    this.expressionSubstitution = 'EXPRESSION_RULE';
    this.factSubstitution = 'FACT_RULE';
    this.inTaskContext = 'IN_TASK_CONTEXT';
    this.notInTaskContext = 'OUT_OF_TASK_CONTEXT';
    this.taskContextFactUsed = 'TASK_CONTEXT_FACT_USED';
    this.expressionChain = 'EXPRESSION_CHAIN';
    this.expressionComparison = 'EXPRESSION_COMPARISON';
    this.factChain = 'FACT_CHAIN';
    this.rule = 'RULE';
    this.ruleReference = 'RULE_REFERENCE';
    this.mainLineNode = 'CONTEXT';
    this.ruleAddedInContext = 'ADDED';
    this.inFact = 'KNOWN_FACT';
    this.factTransformation = 'FACT_TRANSFORMATION';
    this.expressionTransformation = 'EXPRESSION_TRANSFORMATION';
    this.comparisonWithoutSubstitutions = 'COMPARISON_WITHOUT_SUBSTITUTIONS';
  }
  CheckingKeyWords$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var CheckingKeyWords$Companion_instance = null;
  function CheckingKeyWords$Companion_getInstance() {
    if (CheckingKeyWords$Companion_instance === null) {
      new CheckingKeyWords$Companion();
    }
    return CheckingKeyWords$Companion_instance;
  }
  CheckingKeyWords.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'CheckingKeyWords',
    interfaces: []
  };
  function ComparisonType(name, ordinal, string) {
    Enum.call(this);
    this.string = string;
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function ComparisonType_initFields() {
    ComparisonType_initFields = function () {
    };
    ComparisonType$LEFT_MORE_OR_EQUAL_instance = new ComparisonType('LEFT_MORE_OR_EQUAL', 0, '>=');
    ComparisonType$LEFT_LESS_OR_EQUAL_instance = new ComparisonType('LEFT_LESS_OR_EQUAL', 1, '<=');
    ComparisonType$EQUAL_instance = new ComparisonType('EQUAL', 2, '=');
    ComparisonType$LEFT_MORE_instance = new ComparisonType('LEFT_MORE', 3, '>');
    ComparisonType$LEFT_LESS_instance = new ComparisonType('LEFT_LESS', 4, '<');
  }
  var ComparisonType$LEFT_MORE_OR_EQUAL_instance;
  function ComparisonType$LEFT_MORE_OR_EQUAL_getInstance() {
    ComparisonType_initFields();
    return ComparisonType$LEFT_MORE_OR_EQUAL_instance;
  }
  var ComparisonType$LEFT_LESS_OR_EQUAL_instance;
  function ComparisonType$LEFT_LESS_OR_EQUAL_getInstance() {
    ComparisonType_initFields();
    return ComparisonType$LEFT_LESS_OR_EQUAL_instance;
  }
  var ComparisonType$EQUAL_instance;
  function ComparisonType$EQUAL_getInstance() {
    ComparisonType_initFields();
    return ComparisonType$EQUAL_instance;
  }
  var ComparisonType$LEFT_MORE_instance;
  function ComparisonType$LEFT_MORE_getInstance() {
    ComparisonType_initFields();
    return ComparisonType$LEFT_MORE_instance;
  }
  var ComparisonType$LEFT_LESS_instance;
  function ComparisonType$LEFT_LESS_getInstance() {
    ComparisonType_initFields();
    return ComparisonType$LEFT_LESS_instance;
  }
  ComparisonType.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ComparisonType',
    interfaces: [Enum]
  };
  function ComparisonType$values() {
    return [ComparisonType$LEFT_MORE_OR_EQUAL_getInstance(), ComparisonType$LEFT_LESS_OR_EQUAL_getInstance(), ComparisonType$EQUAL_getInstance(), ComparisonType$LEFT_MORE_getInstance(), ComparisonType$LEFT_LESS_getInstance()];
  }
  ComparisonType.values = ComparisonType$values;
  function ComparisonType$valueOf(name) {
    switch (name) {
      case 'LEFT_MORE_OR_EQUAL':
        return ComparisonType$LEFT_MORE_OR_EQUAL_getInstance();
      case 'LEFT_LESS_OR_EQUAL':
        return ComparisonType$LEFT_LESS_OR_EQUAL_getInstance();
      case 'EQUAL':
        return ComparisonType$EQUAL_getInstance();
      case 'LEFT_MORE':
        return ComparisonType$LEFT_MORE_getInstance();
      case 'LEFT_LESS':
        return ComparisonType$LEFT_LESS_getInstance();
      default:throwISE('No enum constant config.ComparisonType.' + name);
    }
  }
  ComparisonType.valueOf_61zpoe$ = ComparisonType$valueOf;
  function strictComparison(comp) {
    return comp === ComparisonType$LEFT_LESS_getInstance() || comp === ComparisonType$LEFT_MORE_getInstance();
  }
  function valueOfComparisonType(value) {
    switch (value) {
      case '>=':
        return ComparisonType$LEFT_MORE_OR_EQUAL_getInstance();
      case '<=':
        return ComparisonType$LEFT_LESS_OR_EQUAL_getInstance();
      case '=':
        return ComparisonType$EQUAL_getInstance();
      case '>':
        return ComparisonType$LEFT_MORE_getInstance();
      case '<':
        return ComparisonType$LEFT_LESS_getInstance();
      default:return ComparisonType$EQUAL_getInstance();
    }
  }
  function valueFromMathMLString(value) {
    switch (value) {
      case '<mo>=<\/mo>':
        return ComparisonType$EQUAL_getInstance();
      case '<mo>&#x2265;<\/mo>':
        return ComparisonType$LEFT_MORE_OR_EQUAL_getInstance();
      case '<mo>&#x2A7E;<\/mo>':
        return ComparisonType$LEFT_MORE_OR_EQUAL_getInstance();
      case '<mo>&#x2264;<\/mo>':
        return ComparisonType$LEFT_LESS_OR_EQUAL_getInstance();
      case '<mo>&#x2A7D;<\/mo>':
        return ComparisonType$LEFT_LESS_OR_EQUAL_getInstance();
      case '<mo>&gt;<\/mo>':
        return ComparisonType$LEFT_MORE_getInstance();
      case '<mo>&lt;<\/mo>':
        return ComparisonType$LEFT_LESS_getInstance();
      case '<mo>&gt;<\/mo><mo>=<\/mo>':
        return ComparisonType$LEFT_MORE_OR_EQUAL_getInstance();
      case '<mo>&lt;<\/mo><mo>=<\/mo>':
        return ComparisonType$LEFT_LESS_OR_EQUAL_getInstance();
      default:return ComparisonType$EQUAL_getInstance();
    }
  }
  function getAllComparisonTypeMathML() {
    return listOf_0(['=', '<mo>=<\/mo>', '<mo>&gt;<\/mo><mo>=<\/mo>', '<mo>&lt;<\/mo><mo>=<\/mo>', '<mo>&gt;<\/mo>', '<mo>&lt;<\/mo>', '<mo>&#x2265;<\/mo>', '<mo>&#x2A7E;<\/mo>', '<mo>&#x2264;<\/mo>', '<mo>&#x2A7D;<\/mo>']);
  }
  function ComparisonSettings(maxTransformationWeight, maxBustCount, maxExpressionTransformationWeight, maxExpressionBustCount, isComparisonWithRules, compareExpressionsWithProbabilityRulesWhenComparingExpressions, compareExpressionsWithProbabilityRulesWhenComparingFacts, compareExpressionsAndFactsWithProbabilityRules, useTestingToCompareFunctionArgumentsInProbabilityComparison, useOldSimpleProbabilityTesting, defaultComparisonType, minNumberOfPointsForEquality, justInDomainsIntersection, allowedPartOfErrorTests, testWithUndefinedResultIncreasingCoef, maxDistBetweenDiffSteps) {
    if (maxTransformationWeight === void 0)
      maxTransformationWeight = 1.0;
    if (maxBustCount === void 0)
      maxBustCount = 4096;
    if (maxExpressionTransformationWeight === void 0)
      maxExpressionTransformationWeight = 1.0;
    if (maxExpressionBustCount === void 0)
      maxExpressionBustCount = 4096;
    if (isComparisonWithRules === void 0)
      isComparisonWithRules = true;
    if (compareExpressionsWithProbabilityRulesWhenComparingExpressions === void 0)
      compareExpressionsWithProbabilityRulesWhenComparingExpressions = true;
    if (compareExpressionsWithProbabilityRulesWhenComparingFacts === void 0)
      compareExpressionsWithProbabilityRulesWhenComparingFacts = true;
    if (compareExpressionsAndFactsWithProbabilityRules === void 0)
      compareExpressionsAndFactsWithProbabilityRules = false;
    if (useTestingToCompareFunctionArgumentsInProbabilityComparison === void 0)
      useTestingToCompareFunctionArgumentsInProbabilityComparison = true;
    if (useOldSimpleProbabilityTesting === void 0)
      useOldSimpleProbabilityTesting = true;
    if (defaultComparisonType === void 0)
      defaultComparisonType = ComparisonType$EQUAL_getInstance();
    if (minNumberOfPointsForEquality === void 0)
      minNumberOfPointsForEquality = 4;
    if (justInDomainsIntersection === void 0)
      justInDomainsIntersection = false;
    if (allowedPartOfErrorTests === void 0)
      allowedPartOfErrorTests = 0.7;
    if (testWithUndefinedResultIncreasingCoef === void 0)
      testWithUndefinedResultIncreasingCoef = 0.67;
    if (maxDistBetweenDiffSteps === void 0)
      maxDistBetweenDiffSteps = 1.0;
    this.maxTransformationWeight = maxTransformationWeight;
    this.maxBustCount = maxBustCount;
    this.maxExpressionTransformationWeight = maxExpressionTransformationWeight;
    this.maxExpressionBustCount = maxExpressionBustCount;
    this.isComparisonWithRules = isComparisonWithRules;
    this.compareExpressionsWithProbabilityRulesWhenComparingExpressions = compareExpressionsWithProbabilityRulesWhenComparingExpressions;
    this.compareExpressionsWithProbabilityRulesWhenComparingFacts = compareExpressionsWithProbabilityRulesWhenComparingFacts;
    this.compareExpressionsAndFactsWithProbabilityRules = compareExpressionsAndFactsWithProbabilityRules;
    this.useTestingToCompareFunctionArgumentsInProbabilityComparison = useTestingToCompareFunctionArgumentsInProbabilityComparison;
    this.useOldSimpleProbabilityTesting = useOldSimpleProbabilityTesting;
    this.defaultComparisonType = defaultComparisonType;
    this.minNumberOfPointsForEquality = minNumberOfPointsForEquality;
    this.justInDomainsIntersection = justInDomainsIntersection;
    this.allowedPartOfErrorTests = allowedPartOfErrorTests;
    this.testWithUndefinedResultIncreasingCoef = testWithUndefinedResultIncreasingCoef;
    this.maxDistBetweenDiffSteps = maxDistBetweenDiffSteps;
  }
  ComparisonSettings.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ComparisonSettings',
    interfaces: []
  };
  ComparisonSettings.prototype.component1 = function () {
    return this.maxTransformationWeight;
  };
  ComparisonSettings.prototype.component2 = function () {
    return this.maxBustCount;
  };
  ComparisonSettings.prototype.component3 = function () {
    return this.maxExpressionTransformationWeight;
  };
  ComparisonSettings.prototype.component4 = function () {
    return this.maxExpressionBustCount;
  };
  ComparisonSettings.prototype.component5 = function () {
    return this.isComparisonWithRules;
  };
  ComparisonSettings.prototype.component6 = function () {
    return this.compareExpressionsWithProbabilityRulesWhenComparingExpressions;
  };
  ComparisonSettings.prototype.component7 = function () {
    return this.compareExpressionsWithProbabilityRulesWhenComparingFacts;
  };
  ComparisonSettings.prototype.component8 = function () {
    return this.compareExpressionsAndFactsWithProbabilityRules;
  };
  ComparisonSettings.prototype.component9 = function () {
    return this.useTestingToCompareFunctionArgumentsInProbabilityComparison;
  };
  ComparisonSettings.prototype.component10 = function () {
    return this.useOldSimpleProbabilityTesting;
  };
  ComparisonSettings.prototype.component11 = function () {
    return this.defaultComparisonType;
  };
  ComparisonSettings.prototype.component12 = function () {
    return this.minNumberOfPointsForEquality;
  };
  ComparisonSettings.prototype.component13 = function () {
    return this.justInDomainsIntersection;
  };
  ComparisonSettings.prototype.component14 = function () {
    return this.allowedPartOfErrorTests;
  };
  ComparisonSettings.prototype.component15 = function () {
    return this.testWithUndefinedResultIncreasingCoef;
  };
  ComparisonSettings.prototype.component16 = function () {
    return this.maxDistBetweenDiffSteps;
  };
  ComparisonSettings.prototype.copy_d3lc5e$ = function (maxTransformationWeight, maxBustCount, maxExpressionTransformationWeight, maxExpressionBustCount, isComparisonWithRules, compareExpressionsWithProbabilityRulesWhenComparingExpressions, compareExpressionsWithProbabilityRulesWhenComparingFacts, compareExpressionsAndFactsWithProbabilityRules, useTestingToCompareFunctionArgumentsInProbabilityComparison, useOldSimpleProbabilityTesting, defaultComparisonType, minNumberOfPointsForEquality, justInDomainsIntersection, allowedPartOfErrorTests, testWithUndefinedResultIncreasingCoef, maxDistBetweenDiffSteps) {
    return new ComparisonSettings(maxTransformationWeight === void 0 ? this.maxTransformationWeight : maxTransformationWeight, maxBustCount === void 0 ? this.maxBustCount : maxBustCount, maxExpressionTransformationWeight === void 0 ? this.maxExpressionTransformationWeight : maxExpressionTransformationWeight, maxExpressionBustCount === void 0 ? this.maxExpressionBustCount : maxExpressionBustCount, isComparisonWithRules === void 0 ? this.isComparisonWithRules : isComparisonWithRules, compareExpressionsWithProbabilityRulesWhenComparingExpressions === void 0 ? this.compareExpressionsWithProbabilityRulesWhenComparingExpressions : compareExpressionsWithProbabilityRulesWhenComparingExpressions, compareExpressionsWithProbabilityRulesWhenComparingFacts === void 0 ? this.compareExpressionsWithProbabilityRulesWhenComparingFacts : compareExpressionsWithProbabilityRulesWhenComparingFacts, compareExpressionsAndFactsWithProbabilityRules === void 0 ? this.compareExpressionsAndFactsWithProbabilityRules : compareExpressionsAndFactsWithProbabilityRules, useTestingToCompareFunctionArgumentsInProbabilityComparison === void 0 ? this.useTestingToCompareFunctionArgumentsInProbabilityComparison : useTestingToCompareFunctionArgumentsInProbabilityComparison, useOldSimpleProbabilityTesting === void 0 ? this.useOldSimpleProbabilityTesting : useOldSimpleProbabilityTesting, defaultComparisonType === void 0 ? this.defaultComparisonType : defaultComparisonType, minNumberOfPointsForEquality === void 0 ? this.minNumberOfPointsForEquality : minNumberOfPointsForEquality, justInDomainsIntersection === void 0 ? this.justInDomainsIntersection : justInDomainsIntersection, allowedPartOfErrorTests === void 0 ? this.allowedPartOfErrorTests : allowedPartOfErrorTests, testWithUndefinedResultIncreasingCoef === void 0 ? this.testWithUndefinedResultIncreasingCoef : testWithUndefinedResultIncreasingCoef, maxDistBetweenDiffSteps === void 0 ? this.maxDistBetweenDiffSteps : maxDistBetweenDiffSteps);
  };
  ComparisonSettings.prototype.toString = function () {
    return 'ComparisonSettings(maxTransformationWeight=' + Kotlin.toString(this.maxTransformationWeight) + (', maxBustCount=' + Kotlin.toString(this.maxBustCount)) + (', maxExpressionTransformationWeight=' + Kotlin.toString(this.maxExpressionTransformationWeight)) + (', maxExpressionBustCount=' + Kotlin.toString(this.maxExpressionBustCount)) + (', isComparisonWithRules=' + Kotlin.toString(this.isComparisonWithRules)) + (', compareExpressionsWithProbabilityRulesWhenComparingExpressions=' + Kotlin.toString(this.compareExpressionsWithProbabilityRulesWhenComparingExpressions)) + (', compareExpressionsWithProbabilityRulesWhenComparingFacts=' + Kotlin.toString(this.compareExpressionsWithProbabilityRulesWhenComparingFacts)) + (', compareExpressionsAndFactsWithProbabilityRules=' + Kotlin.toString(this.compareExpressionsAndFactsWithProbabilityRules)) + (', useTestingToCompareFunctionArgumentsInProbabilityComparison=' + Kotlin.toString(this.useTestingToCompareFunctionArgumentsInProbabilityComparison)) + (', useOldSimpleProbabilityTesting=' + Kotlin.toString(this.useOldSimpleProbabilityTesting)) + (', defaultComparisonType=' + Kotlin.toString(this.defaultComparisonType)) + (', minNumberOfPointsForEquality=' + Kotlin.toString(this.minNumberOfPointsForEquality)) + (', justInDomainsIntersection=' + Kotlin.toString(this.justInDomainsIntersection)) + (', allowedPartOfErrorTests=' + Kotlin.toString(this.allowedPartOfErrorTests)) + (', testWithUndefinedResultIncreasingCoef=' + Kotlin.toString(this.testWithUndefinedResultIncreasingCoef)) + (', maxDistBetweenDiffSteps=' + Kotlin.toString(this.maxDistBetweenDiffSteps)) + ')';
  };
  ComparisonSettings.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.maxTransformationWeight) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxBustCount) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxExpressionTransformationWeight) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxExpressionBustCount) | 0;
    result = result * 31 + Kotlin.hashCode(this.isComparisonWithRules) | 0;
    result = result * 31 + Kotlin.hashCode(this.compareExpressionsWithProbabilityRulesWhenComparingExpressions) | 0;
    result = result * 31 + Kotlin.hashCode(this.compareExpressionsWithProbabilityRulesWhenComparingFacts) | 0;
    result = result * 31 + Kotlin.hashCode(this.compareExpressionsAndFactsWithProbabilityRules) | 0;
    result = result * 31 + Kotlin.hashCode(this.useTestingToCompareFunctionArgumentsInProbabilityComparison) | 0;
    result = result * 31 + Kotlin.hashCode(this.useOldSimpleProbabilityTesting) | 0;
    result = result * 31 + Kotlin.hashCode(this.defaultComparisonType) | 0;
    result = result * 31 + Kotlin.hashCode(this.minNumberOfPointsForEquality) | 0;
    result = result * 31 + Kotlin.hashCode(this.justInDomainsIntersection) | 0;
    result = result * 31 + Kotlin.hashCode(this.allowedPartOfErrorTests) | 0;
    result = result * 31 + Kotlin.hashCode(this.testWithUndefinedResultIncreasingCoef) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxDistBetweenDiffSteps) | 0;
    return result;
  };
  ComparisonSettings.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.maxTransformationWeight, other.maxTransformationWeight) && Kotlin.equals(this.maxBustCount, other.maxBustCount) && Kotlin.equals(this.maxExpressionTransformationWeight, other.maxExpressionTransformationWeight) && Kotlin.equals(this.maxExpressionBustCount, other.maxExpressionBustCount) && Kotlin.equals(this.isComparisonWithRules, other.isComparisonWithRules) && Kotlin.equals(this.compareExpressionsWithProbabilityRulesWhenComparingExpressions, other.compareExpressionsWithProbabilityRulesWhenComparingExpressions) && Kotlin.equals(this.compareExpressionsWithProbabilityRulesWhenComparingFacts, other.compareExpressionsWithProbabilityRulesWhenComparingFacts) && Kotlin.equals(this.compareExpressionsAndFactsWithProbabilityRules, other.compareExpressionsAndFactsWithProbabilityRules) && Kotlin.equals(this.useTestingToCompareFunctionArgumentsInProbabilityComparison, other.useTestingToCompareFunctionArgumentsInProbabilityComparison) && Kotlin.equals(this.useOldSimpleProbabilityTesting, other.useOldSimpleProbabilityTesting) && Kotlin.equals(this.defaultComparisonType, other.defaultComparisonType) && Kotlin.equals(this.minNumberOfPointsForEquality, other.minNumberOfPointsForEquality) && Kotlin.equals(this.justInDomainsIntersection, other.justInDomainsIntersection) && Kotlin.equals(this.allowedPartOfErrorTests, other.allowedPartOfErrorTests) && Kotlin.equals(this.testWithUndefinedResultIncreasingCoef, other.testWithUndefinedResultIncreasingCoef) && Kotlin.equals(this.maxDistBetweenDiffSteps, other.maxDistBetweenDiffSteps)))));
  };
  function GradientDescentComparisonConfiguration(startPointsCount, iterationCount, ternarySearchLeftBorder, ternarySearchRightBorder, ternarySearchIterationCount, ternarySearchAlpha, ternarySearchBeta) {
    if (startPointsCount === void 0)
      startPointsCount = 1;
    if (iterationCount === void 0)
      iterationCount = 20;
    if (ternarySearchLeftBorder === void 0)
      ternarySearchLeftBorder = 1.0E-9;
    if (ternarySearchRightBorder === void 0)
      ternarySearchRightBorder = 1.0E9;
    if (ternarySearchIterationCount === void 0)
      ternarySearchIterationCount = 100;
    if (ternarySearchAlpha === void 0)
      ternarySearchAlpha = 1.57;
    if (ternarySearchBeta === void 0)
      ternarySearchBeta = 1.0;
    this.startPointsCount = startPointsCount;
    this.iterationCount = iterationCount;
    this.ternarySearchLeftBorder = ternarySearchLeftBorder;
    this.ternarySearchRightBorder = ternarySearchRightBorder;
    this.ternarySearchIterationCount = ternarySearchIterationCount;
    this.ternarySearchAlpha = ternarySearchAlpha;
    this.ternarySearchBeta = ternarySearchBeta;
  }
  GradientDescentComparisonConfiguration.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'GradientDescentComparisonConfiguration',
    interfaces: []
  };
  GradientDescentComparisonConfiguration.prototype.component1 = function () {
    return this.startPointsCount;
  };
  GradientDescentComparisonConfiguration.prototype.component2 = function () {
    return this.iterationCount;
  };
  GradientDescentComparisonConfiguration.prototype.component3 = function () {
    return this.ternarySearchLeftBorder;
  };
  GradientDescentComparisonConfiguration.prototype.component4 = function () {
    return this.ternarySearchRightBorder;
  };
  GradientDescentComparisonConfiguration.prototype.component5 = function () {
    return this.ternarySearchIterationCount;
  };
  GradientDescentComparisonConfiguration.prototype.component6 = function () {
    return this.ternarySearchAlpha;
  };
  GradientDescentComparisonConfiguration.prototype.component7 = function () {
    return this.ternarySearchBeta;
  };
  GradientDescentComparisonConfiguration.prototype.copy_8k1e3m$ = function (startPointsCount, iterationCount, ternarySearchLeftBorder, ternarySearchRightBorder, ternarySearchIterationCount, ternarySearchAlpha, ternarySearchBeta) {
    return new GradientDescentComparisonConfiguration(startPointsCount === void 0 ? this.startPointsCount : startPointsCount, iterationCount === void 0 ? this.iterationCount : iterationCount, ternarySearchLeftBorder === void 0 ? this.ternarySearchLeftBorder : ternarySearchLeftBorder, ternarySearchRightBorder === void 0 ? this.ternarySearchRightBorder : ternarySearchRightBorder, ternarySearchIterationCount === void 0 ? this.ternarySearchIterationCount : ternarySearchIterationCount, ternarySearchAlpha === void 0 ? this.ternarySearchAlpha : ternarySearchAlpha, ternarySearchBeta === void 0 ? this.ternarySearchBeta : ternarySearchBeta);
  };
  GradientDescentComparisonConfiguration.prototype.toString = function () {
    return 'GradientDescentComparisonConfiguration(startPointsCount=' + Kotlin.toString(this.startPointsCount) + (', iterationCount=' + Kotlin.toString(this.iterationCount)) + (', ternarySearchLeftBorder=' + Kotlin.toString(this.ternarySearchLeftBorder)) + (', ternarySearchRightBorder=' + Kotlin.toString(this.ternarySearchRightBorder)) + (', ternarySearchIterationCount=' + Kotlin.toString(this.ternarySearchIterationCount)) + (', ternarySearchAlpha=' + Kotlin.toString(this.ternarySearchAlpha)) + (', ternarySearchBeta=' + Kotlin.toString(this.ternarySearchBeta)) + ')';
  };
  GradientDescentComparisonConfiguration.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.startPointsCount) | 0;
    result = result * 31 + Kotlin.hashCode(this.iterationCount) | 0;
    result = result * 31 + Kotlin.hashCode(this.ternarySearchLeftBorder) | 0;
    result = result * 31 + Kotlin.hashCode(this.ternarySearchRightBorder) | 0;
    result = result * 31 + Kotlin.hashCode(this.ternarySearchIterationCount) | 0;
    result = result * 31 + Kotlin.hashCode(this.ternarySearchAlpha) | 0;
    result = result * 31 + Kotlin.hashCode(this.ternarySearchBeta) | 0;
    return result;
  };
  GradientDescentComparisonConfiguration.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.startPointsCount, other.startPointsCount) && Kotlin.equals(this.iterationCount, other.iterationCount) && Kotlin.equals(this.ternarySearchLeftBorder, other.ternarySearchLeftBorder) && Kotlin.equals(this.ternarySearchRightBorder, other.ternarySearchRightBorder) && Kotlin.equals(this.ternarySearchIterationCount, other.ternarySearchIterationCount) && Kotlin.equals(this.ternarySearchAlpha, other.ternarySearchAlpha) && Kotlin.equals(this.ternarySearchBeta, other.ternarySearchBeta)))));
  };
  function CompiledConfiguration(variableConfiguration, functionConfiguration, comparisonSettings, checkedFactAccentuation, factsLogicConfiguration, gradientDescentComparisonConfiguration, additionalParamsMap, simpleComputationRuleCodesCandidates, simpleComputationRuleParams) {
    if (variableConfiguration === void 0)
      variableConfiguration = new VariableConfiguration();
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration(setOf_0(['', 'subfactorial']));
    if (comparisonSettings === void 0)
      comparisonSettings = new ComparisonSettings();
    if (checkedFactAccentuation === void 0)
      checkedFactAccentuation = new CheckedFactAccentuation();
    if (factsLogicConfiguration === void 0)
      factsLogicConfiguration = new FactsLogicConfiguration();
    if (gradientDescentComparisonConfiguration === void 0)
      gradientDescentComparisonConfiguration = new GradientDescentComparisonConfiguration();
    if (additionalParamsMap === void 0) {
      additionalParamsMap = emptyMap();
    }
    if (simpleComputationRuleCodesCandidates === void 0) {
      simpleComputationRuleCodesCandidates = emptySet();
    }
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = new SimpleComputationRuleParams(simpleComputationRuleCodesCandidates, true);
    this.variableConfiguration = variableConfiguration;
    this.functionConfiguration = functionConfiguration;
    this.comparisonSettings = comparisonSettings;
    this.checkedFactAccentuation = checkedFactAccentuation;
    this.factsLogicConfiguration = factsLogicConfiguration;
    this.gradientDescentComparisonConfiguration = gradientDescentComparisonConfiguration;
    this.additionalParamsMap = additionalParamsMap;
    this.simpleComputationRuleCodesCandidates = simpleComputationRuleCodesCandidates;
    this.simpleComputationRuleParams = simpleComputationRuleParams;
    var $receiver = this.variableConfiguration.variableImmediateReplacementRules;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var item = tmp$.next();
      destination.add_11rb$(new Pair(item.left, item.right));
    }
    this.compiledImmediateVariableReplacements = mapOf_0(copyToArray(destination).slice());
    this.compiledExpressionTreeTransformationRules = ArrayList_init();
    this.compiledExpressionSimpleAdditionalTreeTransformationRules = ArrayList_init();
    this.expressionTreeAutogeneratedTransformationRuleIdentifiers = LinkedHashMap_init_0();
    this.compiledFactTreeTransformationRules = ArrayList_init();
    this.compiledImmediateTreeTransformationRules = ArrayList_init();
    this.compiledFunctionDefinitions = ArrayList_init();
    this.definedFunctionNameNumberOfArgsSet = LinkedHashSet_init();
    this.noTransformationDefinedFunctionNameNumberOfArgsSet = LinkedHashSet_init();
    this.configurationErrors = ArrayList_init();
    this.factComporator = null;
    var tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11, tmp$_12;
    this.factComporator = new FactComporator();
    this.factComporator.init_dvfgl$(this);
    var tmp$_13;
    tmp$_13 = this.functionConfiguration.notChangesOnVariablesInComparisonFunction.iterator();
    while (tmp$_13.hasNext()) {
      var element = tmp$_13.next();
      this.definedFunctionNameNumberOfArgsSet.add_11rb$(element.getIdentifier());
    }
    var tmp$_14;
    tmp$_14 = this.functionConfiguration.notChangesOnVariablesInComparisonFunctionWithoutTransformations.iterator();
    while (tmp$_14.hasNext()) {
      var element_0 = tmp$_14.next();
      this.noTransformationDefinedFunctionNameNumberOfArgsSet.add_11rb$(element_0.getIdentifier());
    }
    var compiledSubstitutions = LinkedHashMap_init_0();
    tmp$_0 = this.functionConfiguration.functionDefinitions.iterator();
    while (tmp$_0.hasNext()) {
      var functionDefinition = tmp$_0.next();
      var leftTree = this.parseStringExpression_ivxn3r$(functionDefinition.definitionLeftExpression, true);
      var rightTree = this.parseStringExpression_ivxn3r$(functionDefinition.definitionRightExpression, true);
      if (leftTree != null && rightTree != null) {
        if (leftTree.children.isEmpty() || rightTree.children.isEmpty()) {
          this.configurationErrors.add_11rb$(new ConfigurationError('function definition rule is empty', 'TreeTransformationRule', "values: '" + functionDefinition.definitionLeftExpression + "' and '" + functionDefinition.definitionRightExpression + "'", -1));
        }
         else {
          leftTree.variableReplacement_y0zsll$(this.compiledImmediateVariableReplacements);
          rightTree.variableReplacement_y0zsll$(this.compiledImmediateVariableReplacements);
          applyAllFunctionSubstitutions(rightTree, compiledSubstitutions);
          var newSubstitution = new ExpressionSubstitution(leftTree, rightTree);
          this.compiledFunctionDefinitions.add_11rb$(newSubstitution);
          var definitionIdentifier = leftTree.children.get_za3lpa$(0).value + '_' + toString(leftTree.children.get_za3lpa$(0).children.size);
          compiledSubstitutions.put_xwzc9p$(definitionIdentifier, newSubstitution);
        }
      }
    }
    tmp$_1 = this.functionConfiguration.treeTransformationRules.iterator();
    while (tmp$_1.hasNext()) {
      var treeTransformationRule = tmp$_1.next();
      var leftTree_0 = this.parseStringExpression_ivxn3r$(treeTransformationRule.definitionLeftExpression, true);
      var rightTree_0 = this.parseStringExpression_ivxn3r$(treeTransformationRule.definitionRightExpression, true);
      if (leftTree_0 != null && rightTree_0 != null) {
        leftTree_0.variableReplacement_y0zsll$(this.compiledImmediateVariableReplacements);
        rightTree_0.variableReplacement_y0zsll$(this.compiledImmediateVariableReplacements);
        var newSubstitution_0 = new ExpressionSubstitution(leftTree_0, rightTree_0, treeTransformationRule.weight);
        if (treeTransformationRule.isImmediate)
          this.compiledImmediateTreeTransformationRules.add_11rb$(newSubstitution_0);
        else {
          this.compiledExpressionTreeTransformationRules.add_11rb$(newSubstitution_0);
          if (newSubstitution_0.simpleAdditional) {
            this.compiledExpressionSimpleAdditionalTreeTransformationRules.add_11rb$(newSubstitution_0);
          }
        }
      }
    }
    tmp$_2 = this.functionConfiguration.taskContextTreeTransformationRules.iterator();
    while (tmp$_2.hasNext()) {
      var treeTransformationRule_0 = tmp$_2.next();
      var leftTree_1 = this.parseStringExpression_ivxn3r$(treeTransformationRule_0.definitionLeftExpression, true);
      var rightTree_1 = this.parseStringExpression_ivxn3r$(treeTransformationRule_0.definitionRightExpression, true);
      if (leftTree_1 != null && rightTree_1 != null) {
        leftTree_1.variableReplacement_y0zsll$(this.compiledImmediateVariableReplacements);
        rightTree_1.variableReplacement_y0zsll$(this.compiledImmediateVariableReplacements);
        var newSubstitution_1 = new ExpressionSubstitution(leftTree_1, rightTree_1, treeTransformationRule_0.weight, true);
        if (treeTransformationRule_0.isImmediate)
          this.compiledImmediateTreeTransformationRules.add_11rb$(newSubstitution_1);
        else {
          this.compiledExpressionTreeTransformationRules.add_11rb$(newSubstitution_1);
          if (newSubstitution_1.simpleAdditional) {
            this.compiledExpressionSimpleAdditionalTreeTransformationRules.add_11rb$(newSubstitution_1);
          }
        }
      }
    }
    tmp$_3 = this.factsLogicConfiguration.factsTransformationRules.iterator();
    while (tmp$_3.hasNext()) {
      var factTransformation = tmp$_3.next();
      var leftTree_2 = parseFromFactIdentifier(factTransformation.definitionLeftFactTree, void 0, this.functionConfiguration);
      var rightTree_2 = parseFromFactIdentifier(factTransformation.definitionRightFactTree, void 0, this.functionConfiguration);
      if (leftTree_2 != null && rightTree_2 != null) {
        leftTree_2.variableReplacement_y0zsll$(this.compiledImmediateVariableReplacements);
        rightTree_2.variableReplacement_y0zsll$(this.compiledImmediateVariableReplacements);
        this.compiledFactTreeTransformationRules.add_11rb$(new FactSubstitution(leftTree_2, rightTree_2, factTransformation.weight, void 0, factTransformation.direction, void 0, this.factComporator));
        if (!factTransformation.isOneDirection) {
          this.compiledFactTreeTransformationRules.add_11rb$(new FactSubstitution(rightTree_2, leftTree_2, factTransformation.weight, void 0, factTransformation.direction, void 0, this.factComporator));
        }
      }
    }
    if (!this.additionalParamsMap.isEmpty()) {
      var simpleComputationRuleParamsMaxCalcComplexity = (tmp$_4 = this.additionalParamsMap.get_11rb$('simpleComputationRuleParamsMaxCalcComplexity')) != null ? toIntOrNull(tmp$_4) : null;
      if (simpleComputationRuleParamsMaxCalcComplexity != null) {
        this.simpleComputationRuleParams.maxCalcComplexity = simpleComputationRuleParamsMaxCalcComplexity;
      }
      var simpleComputationRuleParamsMaxTenPowIterations = (tmp$_5 = this.additionalParamsMap.get_11rb$('simpleComputationRuleParamsMaxTenPowIterations')) != null ? toIntOrNull(tmp$_5) : null;
      if (simpleComputationRuleParamsMaxTenPowIterations != null) {
        this.simpleComputationRuleParams.maxTenPowIterations = simpleComputationRuleParamsMaxTenPowIterations;
      }
      var simpleComputationRuleParamsMaxPlusArgRounded = (tmp$_6 = this.additionalParamsMap.get_11rb$('simpleComputationRuleParamsMaxPlusArgRounded')) != null ? toIntOrNull(tmp$_6) : null;
      if (simpleComputationRuleParamsMaxPlusArgRounded != null) {
        this.simpleComputationRuleParams.maxPlusArgRounded = simpleComputationRuleParamsMaxPlusArgRounded;
      }
      var simpleComputationRuleParamsMaxMulArgRounded = (tmp$_7 = this.additionalParamsMap.get_11rb$('simpleComputationRuleParamsMaxMulArgRounded')) != null ? toIntOrNull(tmp$_7) : null;
      if (simpleComputationRuleParamsMaxMulArgRounded != null) {
        this.simpleComputationRuleParams.maxMulArgRounded = simpleComputationRuleParamsMaxMulArgRounded;
      }
      var simpleComputationRuleParamsMaxDivBaseRounded = (tmp$_8 = this.additionalParamsMap.get_11rb$('simpleComputationRuleParamsMaxDivBaseRounded')) != null ? toIntOrNull(tmp$_8) : null;
      if (simpleComputationRuleParamsMaxDivBaseRounded != null) {
        this.simpleComputationRuleParams.maxDivBaseRounded = simpleComputationRuleParamsMaxDivBaseRounded;
      }
      var simpleComputationRuleParamsMaxPowBaseRounded = (tmp$_9 = this.additionalParamsMap.get_11rb$('simpleComputationRuleParamsMaxPowBaseRounded')) != null ? toIntOrNull(tmp$_9) : null;
      if (simpleComputationRuleParamsMaxPowBaseRounded != null) {
        this.simpleComputationRuleParams.maxPowBaseRounded = simpleComputationRuleParamsMaxPowBaseRounded;
      }
      var simpleComputationRuleParamsMaxPowDegRounded = (tmp$_10 = this.additionalParamsMap.get_11rb$('simpleComputationRuleParamsMaxPowDegRounded')) != null ? toIntOrNull(tmp$_10) : null;
      if (simpleComputationRuleParamsMaxPowDegRounded != null) {
        this.simpleComputationRuleParams.maxPowDegRounded = simpleComputationRuleParamsMaxPowDegRounded;
      }
      var simpleComputationRuleParamsMaxLogBaseRounded = (tmp$_11 = this.additionalParamsMap.get_11rb$('simpleComputationRuleParamsMaxLogBaseRounded')) != null ? toIntOrNull(tmp$_11) : null;
      if (simpleComputationRuleParamsMaxLogBaseRounded != null) {
        this.simpleComputationRuleParams.maxLogBaseRounded = simpleComputationRuleParamsMaxLogBaseRounded;
      }
      var simpleComputationRuleParamsMaxResRounded = (tmp$_12 = this.additionalParamsMap.get_11rb$('simpleComputationRuleParamsMaxResRounded')) != null ? toIntOrNull(tmp$_12) : null;
      if (simpleComputationRuleParamsMaxResRounded != null) {
        this.simpleComputationRuleParams.maxResRounded = simpleComputationRuleParamsMaxResRounded;
      }
    }
  }
  CompiledConfiguration.prototype.parseStringExpression_ivxn3r$ = function (expression, nameForRuleDesignationsPossible) {
    if (nameForRuleDesignationsPossible === void 0)
      nameForRuleDesignationsPossible = false;
    var expressionTreeParser = new ExpressionTreeParser(expression, nameForRuleDesignationsPossible, this.functionConfiguration, this.compiledImmediateVariableReplacements);
    var error = expressionTreeParser.parse();
    if (error != null) {
      this.configurationErrors.add_11rb$(new ConfigurationError(error.description, 'TreeTransformationRule', expression, error.position));
      return null;
    }
     else {
      return expressionTreeParser.root;
    }
  };
  CompiledConfiguration.prototype.createExpressionFunctionNode_bm4lxs$ = function (function_0, numberOfArgs) {
    return new ExpressionNode(NodeType$FUNCTION_getInstance(), function_0, void 0, void 0, void 0, void 0, this.functionConfiguration.fastFindStringDefinitionByNameAndNumberOfArguments_bm4lxs$(function_0, numberOfArgs));
  };
  CompiledConfiguration.prototype.createExpressionVariableNode_14dthe$ = function (value) {
    if (value >= 0) {
      return new ExpressionNode(NodeType$VARIABLE_getInstance(), toShortString(value));
    }
     else {
      var plusNode = this.createExpressionFunctionNode_bm4lxs$('+', -1);
      plusNode.addChild_6718cy$(this.createExpressionFunctionNode_bm4lxs$('-', -1));
      last(plusNode.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), toShortString(-value)));
      return plusNode;
    }
  };
  CompiledConfiguration.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'CompiledConfiguration',
    interfaces: []
  };
  function ErrorLevel(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function ErrorLevel_initFields() {
    ErrorLevel_initFields = function () {
    };
    ErrorLevel$INFO_instance = new ErrorLevel('INFO', 0);
    ErrorLevel$WARNING_instance = new ErrorLevel('WARNING', 1);
    ErrorLevel$ERROR_instance = new ErrorLevel('ERROR', 2);
    ErrorLevel$FATAL_ERROR_instance = new ErrorLevel('FATAL_ERROR', 3);
  }
  var ErrorLevel$INFO_instance;
  function ErrorLevel$INFO_getInstance() {
    ErrorLevel_initFields();
    return ErrorLevel$INFO_instance;
  }
  var ErrorLevel$WARNING_instance;
  function ErrorLevel$WARNING_getInstance() {
    ErrorLevel_initFields();
    return ErrorLevel$WARNING_instance;
  }
  var ErrorLevel$ERROR_instance;
  function ErrorLevel$ERROR_getInstance() {
    ErrorLevel_initFields();
    return ErrorLevel$ERROR_instance;
  }
  var ErrorLevel$FATAL_ERROR_instance;
  function ErrorLevel$FATAL_ERROR_getInstance() {
    ErrorLevel_initFields();
    return ErrorLevel$FATAL_ERROR_instance;
  }
  ErrorLevel.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ErrorLevel',
    interfaces: [Enum]
  };
  function ErrorLevel$values() {
    return [ErrorLevel$INFO_getInstance(), ErrorLevel$WARNING_getInstance(), ErrorLevel$ERROR_getInstance(), ErrorLevel$FATAL_ERROR_getInstance()];
  }
  ErrorLevel.values = ErrorLevel$values;
  function ErrorLevel$valueOf(name) {
    switch (name) {
      case 'INFO':
        return ErrorLevel$INFO_getInstance();
      case 'WARNING':
        return ErrorLevel$WARNING_getInstance();
      case 'ERROR':
        return ErrorLevel$ERROR_getInstance();
      case 'FATAL_ERROR':
        return ErrorLevel$FATAL_ERROR_getInstance();
      default:throwISE('No enum constant config.ErrorLevel.' + name);
    }
  }
  ErrorLevel.valueOf_61zpoe$ = ErrorLevel$valueOf;
  function ConfigurationError(description, objectType, objectValue, positionInObject, errorLevel) {
    if (errorLevel === void 0)
      errorLevel = ErrorLevel$ERROR_getInstance();
    this.description = description;
    this.objectType = objectType;
    this.objectValue = objectValue;
    this.positionInObject = positionInObject;
    this.errorLevel = errorLevel;
  }
  ConfigurationError.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ConfigurationError',
    interfaces: []
  };
  ConfigurationError.prototype.component1 = function () {
    return this.description;
  };
  ConfigurationError.prototype.component2 = function () {
    return this.objectType;
  };
  ConfigurationError.prototype.component3 = function () {
    return this.objectValue;
  };
  ConfigurationError.prototype.component4 = function () {
    return this.positionInObject;
  };
  ConfigurationError.prototype.component5 = function () {
    return this.errorLevel;
  };
  ConfigurationError.prototype.copy_47vi7c$ = function (description, objectType, objectValue, positionInObject, errorLevel) {
    return new ConfigurationError(description === void 0 ? this.description : description, objectType === void 0 ? this.objectType : objectType, objectValue === void 0 ? this.objectValue : objectValue, positionInObject === void 0 ? this.positionInObject : positionInObject, errorLevel === void 0 ? this.errorLevel : errorLevel);
  };
  ConfigurationError.prototype.toString = function () {
    return 'ConfigurationError(description=' + Kotlin.toString(this.description) + (', objectType=' + Kotlin.toString(this.objectType)) + (', objectValue=' + Kotlin.toString(this.objectValue)) + (', positionInObject=' + Kotlin.toString(this.positionInObject)) + (', errorLevel=' + Kotlin.toString(this.errorLevel)) + ')';
  };
  ConfigurationError.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.description) | 0;
    result = result * 31 + Kotlin.hashCode(this.objectType) | 0;
    result = result * 31 + Kotlin.hashCode(this.objectValue) | 0;
    result = result * 31 + Kotlin.hashCode(this.positionInObject) | 0;
    result = result * 31 + Kotlin.hashCode(this.errorLevel) | 0;
    return result;
  };
  ConfigurationError.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.description, other.description) && Kotlin.equals(this.objectType, other.objectType) && Kotlin.equals(this.objectValue, other.objectValue) && Kotlin.equals(this.positionInObject, other.positionInObject) && Kotlin.equals(this.errorLevel, other.errorLevel)))));
  };
  function FactTransformationRule(definitionLeftFactTree, definitionRightFactTree, immediate, weight, direction, isOneDirection) {
    if (immediate === void 0)
      immediate = false;
    if (weight === void 0)
      weight = 1.0;
    if (direction === void 0)
      direction = SubstitutionDirection$ALL_TO_ALL_getInstance();
    if (isOneDirection === void 0)
      isOneDirection = false;
    this.definitionLeftFactTree = definitionLeftFactTree;
    this.definitionRightFactTree = definitionRightFactTree;
    this.immediate = immediate;
    this.weight = weight;
    this.direction = direction;
    this.isOneDirection = isOneDirection;
  }
  FactTransformationRule.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FactTransformationRule',
    interfaces: []
  };
  FactTransformationRule.prototype.component1 = function () {
    return this.definitionLeftFactTree;
  };
  FactTransformationRule.prototype.component2 = function () {
    return this.definitionRightFactTree;
  };
  FactTransformationRule.prototype.component3 = function () {
    return this.immediate;
  };
  FactTransformationRule.prototype.component4 = function () {
    return this.weight;
  };
  FactTransformationRule.prototype.component5 = function () {
    return this.direction;
  };
  FactTransformationRule.prototype.component6 = function () {
    return this.isOneDirection;
  };
  FactTransformationRule.prototype.copy_lkwvgz$ = function (definitionLeftFactTree, definitionRightFactTree, immediate, weight, direction, isOneDirection) {
    return new FactTransformationRule(definitionLeftFactTree === void 0 ? this.definitionLeftFactTree : definitionLeftFactTree, definitionRightFactTree === void 0 ? this.definitionRightFactTree : definitionRightFactTree, immediate === void 0 ? this.immediate : immediate, weight === void 0 ? this.weight : weight, direction === void 0 ? this.direction : direction, isOneDirection === void 0 ? this.isOneDirection : isOneDirection);
  };
  FactTransformationRule.prototype.toString = function () {
    return 'FactTransformationRule(definitionLeftFactTree=' + Kotlin.toString(this.definitionLeftFactTree) + (', definitionRightFactTree=' + Kotlin.toString(this.definitionRightFactTree)) + (', immediate=' + Kotlin.toString(this.immediate)) + (', weight=' + Kotlin.toString(this.weight)) + (', direction=' + Kotlin.toString(this.direction)) + (', isOneDirection=' + Kotlin.toString(this.isOneDirection)) + ')';
  };
  FactTransformationRule.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.definitionLeftFactTree) | 0;
    result = result * 31 + Kotlin.hashCode(this.definitionRightFactTree) | 0;
    result = result * 31 + Kotlin.hashCode(this.immediate) | 0;
    result = result * 31 + Kotlin.hashCode(this.weight) | 0;
    result = result * 31 + Kotlin.hashCode(this.direction) | 0;
    result = result * 31 + Kotlin.hashCode(this.isOneDirection) | 0;
    return result;
  };
  FactTransformationRule.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.definitionLeftFactTree, other.definitionLeftFactTree) && Kotlin.equals(this.definitionRightFactTree, other.definitionRightFactTree) && Kotlin.equals(this.immediate, other.immediate) && Kotlin.equals(this.weight, other.weight) && Kotlin.equals(this.direction, other.direction) && Kotlin.equals(this.isOneDirection, other.isOneDirection)))));
  };
  function FactsLogicConfiguration() {
    this.signsPointersOnNotEndedExpression = listOf_0(['+', '-', '*', '/', '^', '%', '&', '|', ',', '&#xD7;', '&#xF7;', '&#x2265;', '&#x2264;', '=', '&gt;', '&lt;', '&#x2A7E;', '&#x2A7D;', '&#x2261;']);
    this.alwaysLetTwoPartsComparisonsAsExpressionComparisons = true;
    this.factsTransformationRules = mutableListOf([new FactTransformationRule('a+c;ec;>;ec;b+c', 'a;ec;>;ec;b', void 0, void 0, void 0, true), new FactTransformationRule('a+c;ec;>=;ec;b+c', 'a;ec;>=;ec;b', void 0, void 0, void 0, true), new FactTransformationRule('a+c;ec;=;ec;b+c', 'a;ec;=;ec;b', void 0, void 0, void 0, true), new FactTransformationRule('AND_NODE(a*c;ec;=;ec;b*c;mn;c;ec;>;ec;0)', 'AND_NODE(a;ec;=;ec;b)', void 0, void 0, void 0, true), new FactTransformationRule('AND_NODE(a/c;ec;=;ec;b/c;mn;c;ec;>;ec;0)', 'AND_NODE(a;ec;=;ec;b)', void 0, void 0, void 0, true), new FactTransformationRule('AND_NODE(OR_NODE(a;mn;b);mn;c)', 'OR_NODE(AND_NODE(a;mn;c);mn;AND_NODE(b;mn;c))'), new FactTransformationRule('OR_NODE(AND_NODE(a;mn;b);mn;c)', 'AND_NODE(OR_NODE(a;mn;c);mn;OR_NODE(b;mn;c))')]);
  }
  FactsLogicConfiguration.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FactsLogicConfiguration',
    interfaces: []
  };
  function Comparator$ObjectLiteral(closure$comparison) {
    this.closure$comparison = closure$comparison;
  }
  Comparator$ObjectLiteral.prototype.compare = function (a, b) {
    return this.closure$comparison(a, b);
  };
  Comparator$ObjectLiteral.$metadata$ = {kind: Kind_CLASS, interfaces: [Comparator]};
  var compareByDescending$lambda = wrapFunction(function () {
    var compareValues = Kotlin.kotlin.comparisons.compareValues_s00gnj$;
    return function (closure$selector) {
      return function (a, b) {
        var selector = closure$selector;
        return compareValues(selector(b), selector(a));
      };
    };
  });
  function StringDefinitionType(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function StringDefinitionType_initFields() {
    StringDefinitionType_initFields = function () {
    };
    StringDefinitionType$BINARY_OPERATION_instance = new StringDefinitionType('BINARY_OPERATION', 0);
    StringDefinitionType$UNARY_LEFT_OPERATION_instance = new StringDefinitionType('UNARY_LEFT_OPERATION', 1);
    StringDefinitionType$UNARY_RIGHT_OPERATION_instance = new StringDefinitionType('UNARY_RIGHT_OPERATION', 2);
    StringDefinitionType$FUNCTION_instance = new StringDefinitionType('FUNCTION', 3);
  }
  var StringDefinitionType$BINARY_OPERATION_instance;
  function StringDefinitionType$BINARY_OPERATION_getInstance() {
    StringDefinitionType_initFields();
    return StringDefinitionType$BINARY_OPERATION_instance;
  }
  var StringDefinitionType$UNARY_LEFT_OPERATION_instance;
  function StringDefinitionType$UNARY_LEFT_OPERATION_getInstance() {
    StringDefinitionType_initFields();
    return StringDefinitionType$UNARY_LEFT_OPERATION_instance;
  }
  var StringDefinitionType$UNARY_RIGHT_OPERATION_instance;
  function StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance() {
    StringDefinitionType_initFields();
    return StringDefinitionType$UNARY_RIGHT_OPERATION_instance;
  }
  var StringDefinitionType$FUNCTION_instance;
  function StringDefinitionType$FUNCTION_getInstance() {
    StringDefinitionType_initFields();
    return StringDefinitionType$FUNCTION_instance;
  }
  StringDefinitionType.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'StringDefinitionType',
    interfaces: [Enum]
  };
  function StringDefinitionType$values() {
    return [StringDefinitionType$BINARY_OPERATION_getInstance(), StringDefinitionType$UNARY_LEFT_OPERATION_getInstance(), StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance(), StringDefinitionType$FUNCTION_getInstance()];
  }
  StringDefinitionType.values = StringDefinitionType$values;
  function StringDefinitionType$valueOf(name) {
    switch (name) {
      case 'BINARY_OPERATION':
        return StringDefinitionType$BINARY_OPERATION_getInstance();
      case 'UNARY_LEFT_OPERATION':
        return StringDefinitionType$UNARY_LEFT_OPERATION_getInstance();
      case 'UNARY_RIGHT_OPERATION':
        return StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance();
      case 'FUNCTION':
        return StringDefinitionType$FUNCTION_getInstance();
      default:throwISE('No enum constant config.StringDefinitionType.' + name);
    }
  }
  StringDefinitionType.valueOf_61zpoe$ = StringDefinitionType$valueOf;
  function FunctionIdentifier(name, numberOfArguments) {
    FunctionIdentifier$Companion_getInstance();
    this.name = name;
    this.numberOfArguments = numberOfArguments;
  }
  function FunctionIdentifier$Companion() {
    FunctionIdentifier$Companion_instance = this;
  }
  FunctionIdentifier$Companion.prototype.getIdentifier_bm4lxs$ = function (name, numberOfArguments) {
    return name + '_' + numberOfArguments;
  };
  FunctionIdentifier$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var FunctionIdentifier$Companion_instance = null;
  function FunctionIdentifier$Companion_getInstance() {
    if (FunctionIdentifier$Companion_instance === null) {
      new FunctionIdentifier$Companion();
    }
    return FunctionIdentifier$Companion_instance;
  }
  FunctionIdentifier.prototype.getIdentifier = function () {
    return FunctionIdentifier$Companion_getInstance().getIdentifier_bm4lxs$(this.name, this.numberOfArguments);
  };
  FunctionIdentifier.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FunctionIdentifier',
    interfaces: []
  };
  FunctionIdentifier.prototype.component1 = function () {
    return this.name;
  };
  FunctionIdentifier.prototype.component2 = function () {
    return this.numberOfArguments;
  };
  FunctionIdentifier.prototype.copy_bm4lxs$ = function (name, numberOfArguments) {
    return new FunctionIdentifier(name === void 0 ? this.name : name, numberOfArguments === void 0 ? this.numberOfArguments : numberOfArguments);
  };
  FunctionIdentifier.prototype.toString = function () {
    return 'FunctionIdentifier(name=' + Kotlin.toString(this.name) + (', numberOfArguments=' + Kotlin.toString(this.numberOfArguments)) + ')';
  };
  FunctionIdentifier.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.name) | 0;
    result = result * 31 + Kotlin.hashCode(this.numberOfArguments) | 0;
    return result;
  };
  FunctionIdentifier.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.name, other.name) && Kotlin.equals(this.numberOfArguments, other.numberOfArguments)))));
  };
  function FunctionProperties(function_0, mainFunction, priority, numberOfArguments, isCommutativeWithNullWeight, mainFunctionIsCommutativeWithNullWeight, numberOfDefinitionArguments, isNameForRuleDesignations, plainTextRepresentation, texRepresentation, defaultStringDefinitionType, texStringDefinitionType, notObligateMainFunction, minNumberOfPointsForEquality, fieldAddZero, fieldMulZero) {
    if (isCommutativeWithNullWeight === void 0)
      isCommutativeWithNullWeight = false;
    if (mainFunctionIsCommutativeWithNullWeight === void 0)
      mainFunctionIsCommutativeWithNullWeight = false;
    if (numberOfDefinitionArguments === void 0)
      numberOfDefinitionArguments = 0;
    if (isNameForRuleDesignations === void 0)
      isNameForRuleDesignations = false;
    if (plainTextRepresentation === void 0)
      plainTextRepresentation = function_0;
    if (texRepresentation === void 0)
      texRepresentation = plainTextRepresentation;
    if (defaultStringDefinitionType === void 0)
      defaultStringDefinitionType = StringDefinitionType$FUNCTION_getInstance();
    if (texStringDefinitionType === void 0)
      texStringDefinitionType = defaultStringDefinitionType;
    if (notObligateMainFunction === void 0)
      notObligateMainFunction = null;
    if (minNumberOfPointsForEquality === void 0)
      minNumberOfPointsForEquality = 2;
    if (fieldAddZero === void 0)
      fieldAddZero = null;
    if (fieldMulZero === void 0)
      fieldMulZero = null;
    this.function = function_0;
    this.mainFunction = mainFunction;
    this.priority = priority;
    this.numberOfArguments = numberOfArguments;
    this.isCommutativeWithNullWeight = isCommutativeWithNullWeight;
    this.mainFunctionIsCommutativeWithNullWeight = mainFunctionIsCommutativeWithNullWeight;
    this.numberOfDefinitionArguments = numberOfDefinitionArguments;
    this.isNameForRuleDesignations = isNameForRuleDesignations;
    this.plainTextRepresentation = plainTextRepresentation;
    this.texRepresentation = texRepresentation;
    this.defaultStringDefinitionType = defaultStringDefinitionType;
    this.texStringDefinitionType = texStringDefinitionType;
    this.notObligateMainFunction_0 = notObligateMainFunction;
    this.minNumberOfPointsForEquality = minNumberOfPointsForEquality;
    this.fieldAddZero = fieldAddZero;
    this.fieldMulZero = fieldMulZero;
  }
  FunctionProperties.prototype.notObligateMainFunction = function () {
    var tmp$;
    return (tmp$ = this.notObligateMainFunction_0) != null ? tmp$ : this.mainFunction;
  };
  FunctionProperties.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FunctionProperties',
    interfaces: []
  };
  FunctionProperties.prototype.component1 = function () {
    return this.function;
  };
  FunctionProperties.prototype.component2 = function () {
    return this.mainFunction;
  };
  FunctionProperties.prototype.component3 = function () {
    return this.priority;
  };
  FunctionProperties.prototype.component4 = function () {
    return this.numberOfArguments;
  };
  FunctionProperties.prototype.component5 = function () {
    return this.isCommutativeWithNullWeight;
  };
  FunctionProperties.prototype.component6 = function () {
    return this.mainFunctionIsCommutativeWithNullWeight;
  };
  FunctionProperties.prototype.component7 = function () {
    return this.numberOfDefinitionArguments;
  };
  FunctionProperties.prototype.component8 = function () {
    return this.isNameForRuleDesignations;
  };
  FunctionProperties.prototype.component9 = function () {
    return this.plainTextRepresentation;
  };
  FunctionProperties.prototype.component10 = function () {
    return this.texRepresentation;
  };
  FunctionProperties.prototype.component11 = function () {
    return this.defaultStringDefinitionType;
  };
  FunctionProperties.prototype.component12 = function () {
    return this.texStringDefinitionType;
  };
  FunctionProperties.prototype.component13_0 = function () {
    return this.notObligateMainFunction_0;
  };
  FunctionProperties.prototype.component14 = function () {
    return this.minNumberOfPointsForEquality;
  };
  FunctionProperties.prototype.component15 = function () {
    return this.fieldAddZero;
  };
  FunctionProperties.prototype.component16 = function () {
    return this.fieldMulZero;
  };
  FunctionProperties.prototype.copy_67l01y$ = function (function_0, mainFunction, priority, numberOfArguments, isCommutativeWithNullWeight, mainFunctionIsCommutativeWithNullWeight, numberOfDefinitionArguments, isNameForRuleDesignations, plainTextRepresentation, texRepresentation, defaultStringDefinitionType, texStringDefinitionType, notObligateMainFunction, minNumberOfPointsForEquality, fieldAddZero, fieldMulZero) {
    return new FunctionProperties(function_0 === void 0 ? this.function : function_0, mainFunction === void 0 ? this.mainFunction : mainFunction, priority === void 0 ? this.priority : priority, numberOfArguments === void 0 ? this.numberOfArguments : numberOfArguments, isCommutativeWithNullWeight === void 0 ? this.isCommutativeWithNullWeight : isCommutativeWithNullWeight, mainFunctionIsCommutativeWithNullWeight === void 0 ? this.mainFunctionIsCommutativeWithNullWeight : mainFunctionIsCommutativeWithNullWeight, numberOfDefinitionArguments === void 0 ? this.numberOfDefinitionArguments : numberOfDefinitionArguments, isNameForRuleDesignations === void 0 ? this.isNameForRuleDesignations : isNameForRuleDesignations, plainTextRepresentation === void 0 ? this.plainTextRepresentation : plainTextRepresentation, texRepresentation === void 0 ? this.texRepresentation : texRepresentation, defaultStringDefinitionType === void 0 ? this.defaultStringDefinitionType : defaultStringDefinitionType, texStringDefinitionType === void 0 ? this.texStringDefinitionType : texStringDefinitionType, notObligateMainFunction === void 0 ? this.notObligateMainFunction_0 : notObligateMainFunction, minNumberOfPointsForEquality === void 0 ? this.minNumberOfPointsForEquality : minNumberOfPointsForEquality, fieldAddZero === void 0 ? this.fieldAddZero : fieldAddZero, fieldMulZero === void 0 ? this.fieldMulZero : fieldMulZero);
  };
  FunctionProperties.prototype.toString = function () {
    return 'FunctionProperties(function=' + Kotlin.toString(this.function) + (', mainFunction=' + Kotlin.toString(this.mainFunction)) + (', priority=' + Kotlin.toString(this.priority)) + (', numberOfArguments=' + Kotlin.toString(this.numberOfArguments)) + (', isCommutativeWithNullWeight=' + Kotlin.toString(this.isCommutativeWithNullWeight)) + (', mainFunctionIsCommutativeWithNullWeight=' + Kotlin.toString(this.mainFunctionIsCommutativeWithNullWeight)) + (', numberOfDefinitionArguments=' + Kotlin.toString(this.numberOfDefinitionArguments)) + (', isNameForRuleDesignations=' + Kotlin.toString(this.isNameForRuleDesignations)) + (', plainTextRepresentation=' + Kotlin.toString(this.plainTextRepresentation)) + (', texRepresentation=' + Kotlin.toString(this.texRepresentation)) + (', defaultStringDefinitionType=' + Kotlin.toString(this.defaultStringDefinitionType)) + (', texStringDefinitionType=' + Kotlin.toString(this.texStringDefinitionType)) + (', notObligateMainFunction=' + Kotlin.toString(this.notObligateMainFunction_0)) + (', minNumberOfPointsForEquality=' + Kotlin.toString(this.minNumberOfPointsForEquality)) + (', fieldAddZero=' + Kotlin.toString(this.fieldAddZero)) + (', fieldMulZero=' + Kotlin.toString(this.fieldMulZero)) + ')';
  };
  FunctionProperties.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.function) | 0;
    result = result * 31 + Kotlin.hashCode(this.mainFunction) | 0;
    result = result * 31 + Kotlin.hashCode(this.priority) | 0;
    result = result * 31 + Kotlin.hashCode(this.numberOfArguments) | 0;
    result = result * 31 + Kotlin.hashCode(this.isCommutativeWithNullWeight) | 0;
    result = result * 31 + Kotlin.hashCode(this.mainFunctionIsCommutativeWithNullWeight) | 0;
    result = result * 31 + Kotlin.hashCode(this.numberOfDefinitionArguments) | 0;
    result = result * 31 + Kotlin.hashCode(this.isNameForRuleDesignations) | 0;
    result = result * 31 + Kotlin.hashCode(this.plainTextRepresentation) | 0;
    result = result * 31 + Kotlin.hashCode(this.texRepresentation) | 0;
    result = result * 31 + Kotlin.hashCode(this.defaultStringDefinitionType) | 0;
    result = result * 31 + Kotlin.hashCode(this.texStringDefinitionType) | 0;
    result = result * 31 + Kotlin.hashCode(this.notObligateMainFunction_0) | 0;
    result = result * 31 + Kotlin.hashCode(this.minNumberOfPointsForEquality) | 0;
    result = result * 31 + Kotlin.hashCode(this.fieldAddZero) | 0;
    result = result * 31 + Kotlin.hashCode(this.fieldMulZero) | 0;
    return result;
  };
  FunctionProperties.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.function, other.function) && Kotlin.equals(this.mainFunction, other.mainFunction) && Kotlin.equals(this.priority, other.priority) && Kotlin.equals(this.numberOfArguments, other.numberOfArguments) && Kotlin.equals(this.isCommutativeWithNullWeight, other.isCommutativeWithNullWeight) && Kotlin.equals(this.mainFunctionIsCommutativeWithNullWeight, other.mainFunctionIsCommutativeWithNullWeight) && Kotlin.equals(this.numberOfDefinitionArguments, other.numberOfDefinitionArguments) && Kotlin.equals(this.isNameForRuleDesignations, other.isNameForRuleDesignations) && Kotlin.equals(this.plainTextRepresentation, other.plainTextRepresentation) && Kotlin.equals(this.texRepresentation, other.texRepresentation) && Kotlin.equals(this.defaultStringDefinitionType, other.defaultStringDefinitionType) && Kotlin.equals(this.texStringDefinitionType, other.texStringDefinitionType) && Kotlin.equals(this.notObligateMainFunction_0, other.notObligateMainFunction_0) && Kotlin.equals(this.minNumberOfPointsForEquality, other.minNumberOfPointsForEquality) && Kotlin.equals(this.fieldAddZero, other.fieldAddZero) && Kotlin.equals(this.fieldMulZero, other.fieldMulZero)))));
  };
  function FunctionStringDefinition(function_0, definitionType, definition, subAsLast, filter, definitionArgumentsCount, underlinedAsLast, powSeparatedAsPow) {
    if (subAsLast === void 0)
      subAsLast = false;
    if (filter === void 0)
      filter = '';
    if (definitionArgumentsCount === void 0)
      definitionArgumentsCount = -1;
    if (underlinedAsLast === void 0)
      underlinedAsLast = false;
    if (powSeparatedAsPow === void 0)
      powSeparatedAsPow = false;
    this.function = function_0;
    this.definitionType = definitionType;
    this.definition = definition;
    this.subAsLast = subAsLast;
    this.filter = filter;
    this.definitionArgumentsCount = definitionArgumentsCount;
    this.underlinedAsLast = underlinedAsLast;
    this.powSeparatedAsPow = powSeparatedAsPow;
  }
  FunctionStringDefinition.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FunctionStringDefinition',
    interfaces: []
  };
  FunctionStringDefinition.prototype.component1 = function () {
    return this.function;
  };
  FunctionStringDefinition.prototype.component2 = function () {
    return this.definitionType;
  };
  FunctionStringDefinition.prototype.component3 = function () {
    return this.definition;
  };
  FunctionStringDefinition.prototype.component4 = function () {
    return this.subAsLast;
  };
  FunctionStringDefinition.prototype.component5 = function () {
    return this.filter;
  };
  FunctionStringDefinition.prototype.component6 = function () {
    return this.definitionArgumentsCount;
  };
  FunctionStringDefinition.prototype.component7 = function () {
    return this.underlinedAsLast;
  };
  FunctionStringDefinition.prototype.component8 = function () {
    return this.powSeparatedAsPow;
  };
  FunctionStringDefinition.prototype.copy_om8i9o$ = function (function_0, definitionType, definition, subAsLast, filter, definitionArgumentsCount, underlinedAsLast, powSeparatedAsPow) {
    return new FunctionStringDefinition(function_0 === void 0 ? this.function : function_0, definitionType === void 0 ? this.definitionType : definitionType, definition === void 0 ? this.definition : definition, subAsLast === void 0 ? this.subAsLast : subAsLast, filter === void 0 ? this.filter : filter, definitionArgumentsCount === void 0 ? this.definitionArgumentsCount : definitionArgumentsCount, underlinedAsLast === void 0 ? this.underlinedAsLast : underlinedAsLast, powSeparatedAsPow === void 0 ? this.powSeparatedAsPow : powSeparatedAsPow);
  };
  FunctionStringDefinition.prototype.toString = function () {
    return 'FunctionStringDefinition(function=' + Kotlin.toString(this.function) + (', definitionType=' + Kotlin.toString(this.definitionType)) + (', definition=' + Kotlin.toString(this.definition)) + (', subAsLast=' + Kotlin.toString(this.subAsLast)) + (', filter=' + Kotlin.toString(this.filter)) + (', definitionArgumentsCount=' + Kotlin.toString(this.definitionArgumentsCount)) + (', underlinedAsLast=' + Kotlin.toString(this.underlinedAsLast)) + (', powSeparatedAsPow=' + Kotlin.toString(this.powSeparatedAsPow)) + ')';
  };
  FunctionStringDefinition.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.function) | 0;
    result = result * 31 + Kotlin.hashCode(this.definitionType) | 0;
    result = result * 31 + Kotlin.hashCode(this.definition) | 0;
    result = result * 31 + Kotlin.hashCode(this.subAsLast) | 0;
    result = result * 31 + Kotlin.hashCode(this.filter) | 0;
    result = result * 31 + Kotlin.hashCode(this.definitionArgumentsCount) | 0;
    result = result * 31 + Kotlin.hashCode(this.underlinedAsLast) | 0;
    result = result * 31 + Kotlin.hashCode(this.powSeparatedAsPow) | 0;
    return result;
  };
  FunctionStringDefinition.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.function, other.function) && Kotlin.equals(this.definitionType, other.definitionType) && Kotlin.equals(this.definition, other.definition) && Kotlin.equals(this.subAsLast, other.subAsLast) && Kotlin.equals(this.filter, other.filter) && Kotlin.equals(this.definitionArgumentsCount, other.definitionArgumentsCount) && Kotlin.equals(this.underlinedAsLast, other.underlinedAsLast) && Kotlin.equals(this.powSeparatedAsPow, other.powSeparatedAsPow)))));
  };
  function FunctionDefinition(definitionLeftExpression, definitionRightExpression) {
    this.definitionLeftExpression = definitionLeftExpression;
    this.definitionRightExpression = definitionRightExpression;
  }
  FunctionDefinition.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FunctionDefinition',
    interfaces: []
  };
  FunctionDefinition.prototype.component1 = function () {
    return this.definitionLeftExpression;
  };
  FunctionDefinition.prototype.component2 = function () {
    return this.definitionRightExpression;
  };
  FunctionDefinition.prototype.copy_puj7f4$ = function (definitionLeftExpression, definitionRightExpression) {
    return new FunctionDefinition(definitionLeftExpression === void 0 ? this.definitionLeftExpression : definitionLeftExpression, definitionRightExpression === void 0 ? this.definitionRightExpression : definitionRightExpression);
  };
  FunctionDefinition.prototype.toString = function () {
    return 'FunctionDefinition(definitionLeftExpression=' + Kotlin.toString(this.definitionLeftExpression) + (', definitionRightExpression=' + Kotlin.toString(this.definitionRightExpression)) + ')';
  };
  FunctionDefinition.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.definitionLeftExpression) | 0;
    result = result * 31 + Kotlin.hashCode(this.definitionRightExpression) | 0;
    return result;
  };
  FunctionDefinition.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.definitionLeftExpression, other.definitionLeftExpression) && Kotlin.equals(this.definitionRightExpression, other.definitionRightExpression)))));
  };
  function TreeTransformationRule(definitionLeftExpression, definitionRightExpression, isImmediate, weight) {
    if (isImmediate === void 0)
      isImmediate = false;
    if (weight === void 0)
      weight = 1.0;
    this.definitionLeftExpression = definitionLeftExpression;
    this.definitionRightExpression = definitionRightExpression;
    this.isImmediate = isImmediate;
    this.weight = weight;
  }
  TreeTransformationRule.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'TreeTransformationRule',
    interfaces: []
  };
  TreeTransformationRule.prototype.component1 = function () {
    return this.definitionLeftExpression;
  };
  TreeTransformationRule.prototype.component2 = function () {
    return this.definitionRightExpression;
  };
  TreeTransformationRule.prototype.component3 = function () {
    return this.isImmediate;
  };
  TreeTransformationRule.prototype.component4 = function () {
    return this.weight;
  };
  TreeTransformationRule.prototype.copy_m9kltj$ = function (definitionLeftExpression, definitionRightExpression, isImmediate, weight) {
    return new TreeTransformationRule(definitionLeftExpression === void 0 ? this.definitionLeftExpression : definitionLeftExpression, definitionRightExpression === void 0 ? this.definitionRightExpression : definitionRightExpression, isImmediate === void 0 ? this.isImmediate : isImmediate, weight === void 0 ? this.weight : weight);
  };
  TreeTransformationRule.prototype.toString = function () {
    return 'TreeTransformationRule(definitionLeftExpression=' + Kotlin.toString(this.definitionLeftExpression) + (', definitionRightExpression=' + Kotlin.toString(this.definitionRightExpression)) + (', isImmediate=' + Kotlin.toString(this.isImmediate)) + (', weight=' + Kotlin.toString(this.weight)) + ')';
  };
  TreeTransformationRule.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.definitionLeftExpression) | 0;
    result = result * 31 + Kotlin.hashCode(this.definitionRightExpression) | 0;
    result = result * 31 + Kotlin.hashCode(this.isImmediate) | 0;
    result = result * 31 + Kotlin.hashCode(this.weight) | 0;
    return result;
  };
  TreeTransformationRule.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.definitionLeftExpression, other.definitionLeftExpression) && Kotlin.equals(this.definitionRightExpression, other.definitionRightExpression) && Kotlin.equals(this.isImmediate, other.isImmediate) && Kotlin.equals(this.weight, other.weight)))));
  };
  function FunctionConfiguration(scopeFilter, notChangesOnVariablesInComparisonFunctionFilter) {
    if (scopeFilter === void 0)
      scopeFilter = setOf('');
    if (notChangesOnVariablesInComparisonFunctionFilter === void 0) {
      notChangesOnVariablesInComparisonFunctionFilter = emptySet();
    }
    this.scopeFilter = scopeFilter;
    this.notChangesOnVariablesInComparisonFunctionFilter = notChangesOnVariablesInComparisonFunctionFilter;
    var $receiver = mutableListOf([new FunctionIdentifier('', 0), new FunctionIdentifier('', 1), new FunctionIdentifier('+', -1), new FunctionIdentifier('-', -1), new FunctionIdentifier('*', -1), new FunctionIdentifier('/', -1), new FunctionIdentifier('^', -1), new FunctionIdentifier('mod', 2), new FunctionIdentifier('S', 4), new FunctionIdentifier('P', 4), new FunctionIdentifier('and', -1), new FunctionIdentifier('or', -1), new FunctionIdentifier('xor', -1), new FunctionIdentifier('alleq', -1), new FunctionIdentifier('not', 1), new FunctionIdentifier('sin', 1), new FunctionIdentifier('cos', 1), new FunctionIdentifier('sh', 1), new FunctionIdentifier('ch', 1), new FunctionIdentifier('th', 1), new FunctionIdentifier('tg', 1), new FunctionIdentifier('asin', 1), new FunctionIdentifier('acos', 1), new FunctionIdentifier('atg', 1), new FunctionIdentifier('exp', 1), new FunctionIdentifier('ln', 1), new FunctionIdentifier('abs', 1)]);
    var destination = ArrayList_init();
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      if (equals(element.name, '') || this.notChangesOnVariablesInComparisonFunctionFilter.isEmpty() || this.notChangesOnVariablesInComparisonFunctionFilter.contains_11rb$(element.name))
        destination.add_11rb$(element);
    }
    this.notChangesOnVariablesInComparisonFunction = destination;
    this.notChangesOnVariablesInComparisonFunctionWithoutTransformations = this.notChangesOnVariablesInComparisonFunction;
    this.functionDefinitions = mutableListOf([new FunctionDefinition('n!', 'P(i, 1, n, i)'), new FunctionDefinition('U(m,n)', 'm^n'), new FunctionDefinition('A(m,n)', 'm! / (m - n)!'), new FunctionDefinition('P(n)', 'n!'), new FunctionDefinition('C(m,n)', 'm! / (m - n)! / n!'), new FunctionDefinition('V(m,n)', '(m + n - 1)! / (m - 1)! / n!'), new FunctionDefinition('S1(n,k)', 'S(i,0,k,(-1)^(k-i) * i^n * k! / (k - i)! / i!)'), new FunctionDefinition('S2(n,k)', 'S1(n,k) / n!'), new FunctionDefinition('B(m)', 'S(n,0,m,S2(m,n))'), new FunctionDefinition('F(n)', '5^(-0.5) * (((1 + 5^0.5)/2)^(n+1) - ((1 - 5^0.5)/2)^(n+1))'), new FunctionDefinition('C(n)', '(2*n)! / (n!)^2 / (n+1)'), new FunctionDefinition('sec(x)', '1 / cos(x)'), new FunctionDefinition('csc(x)', '1 / sin(x)'), new FunctionDefinition('sech(x)', '1 / ch(x)'), new FunctionDefinition('csch(x)', '1 / sh(x)'), new FunctionDefinition('ctg(x)', '1 / tg(x)'), new FunctionDefinition('actg(x)', 'atg(1/x)'), new FunctionDefinition('cth(x)', '1 / th(x)'), new FunctionDefinition('log(b,a)', 'ln(a) / ln(b)')]);
    this.treeTransformationRules = mutableListOf([new TreeTransformationRule('sin(x)^2', '1 - cos(x)^2'), new TreeTransformationRule('sin(pi/2 - x)', 'cos(x)'), new TreeTransformationRule('sin(x)^2', '1 - cos(x)^2'), new TreeTransformationRule('S(i, a, a, f(i))', 'f(a)'), new TreeTransformationRule('S(i, a, b, f(i))', 'S(i, a, b-1, f(i)) + f(b)'), new TreeTransformationRule('S(i, a, b, f(i))', 'S(i, a+1, b, f(i)) + f(a)'), new TreeTransformationRule('S(i, a, c, f(i)) + S(i, c+1, b, f(i))', 'S(i, a, b, f(i))'), new TreeTransformationRule('P(i, a, a, f(i))', 'f(a)'), new TreeTransformationRule('P(i, a, b, f(i))', 'P(i, a, b-1, f(i)) * f(b)'), new TreeTransformationRule('P(i, a, b, f(i))', 'P(i, a+1, b, f(i)) * f(a)'), new TreeTransformationRule('P(i, a, c, f(i)) * P(i, c+1, b, f(i))', 'P(i, a, b, f(i))'), new TreeTransformationRule('U(m,n)', 'm^n'), new TreeTransformationRule('A(m,n)', 'm! / (m - n)!'), new TreeTransformationRule('P(n)', 'n!'), new TreeTransformationRule('P(n)', 'A(n,n)'), new TreeTransformationRule('C(m,n)', 'm! / (m - n)! / n!'), new TreeTransformationRule('V(m,n)', '(m + n - 1)! / (m - 1)! / n!'), new TreeTransformationRule('V(m,n)', 'C(m + n - 1, n)'), new TreeTransformationRule('S1(n,k)', 'S(i,0,k,(-1)^(k-i) * i^n * k! / (k - i)! / i!)'), new TreeTransformationRule('S2(n,k)', 'S1(n,k) / n!'), new TreeTransformationRule('S2(n,k)', 'S2(m-1,n-1) + n*S2(m-1,n)'), new TreeTransformationRule('B(m)', 'S(n,0,m,S2(m,n))'), new TreeTransformationRule('F(n)', '5^(-0.5) * (((1 + 5^0.5)/2)^(n+1) - ((1 - 5^0.5)/2)^(n+1))'), new TreeTransformationRule('F(n)', 'F(n-1) + F(n-2)'), new TreeTransformationRule('C(n)', '(2*n)! / (n!)^2 / (n+1)'), new TreeTransformationRule('a^(b+c)', 'a^b*a^c'), new TreeTransformationRule('sqrt(x)', 'x^0.5', true), new TreeTransformationRule('root(x,p)', 'x^(1/p)', true), new TreeTransformationRule('n!', 'P(i,1,n,i)', true), new TreeTransformationRule('d(expr)', 'd(expr,x)', true)]);
    this.taskContextTreeTransformationRules = ArrayList_init();
    this.functionProperties = mutableListOf([new FunctionProperties('+', '+', 1.0, -1, true, void 0, void 0, void 0, void 0, void 0, StringDefinitionType$BINARY_OPERATION_getInstance(), void 0, void 0, void 0, '0'), new FunctionProperties('-', '+', 1.0, -1, void 0, true, void 0, void 0, void 0, void 0, StringDefinitionType$UNARY_LEFT_OPERATION_getInstance(), void 0, '+'), new FunctionProperties('*', '*', 2.0, -1, true, true, void 0, void 0, void 0, '\\cdot', StringDefinitionType$BINARY_OPERATION_getInstance(), void 0, void 0, void 0, '1', '0'), new FunctionProperties('/', '/', 1.9, -1, void 0, true, void 0, void 0, void 0, '\\frac', StringDefinitionType$BINARY_OPERATION_getInstance(), void 0, '*'), new FunctionProperties('^', '^', 3.0, -1, void 0, void 0, void 0, void 0, void 0, void 0, StringDefinitionType$BINARY_OPERATION_getInstance()), new FunctionProperties('S', 'S', 5.0, 4, void 0, void 0, 1, void 0, void 0, void 0, void 0, void 0, void 0, 2147483647), new FunctionProperties('P', 'P', 5.0, 4, void 0, void 0, 1, void 0, void 0, void 0, void 0, void 0, void 0, 2147483647), new FunctionProperties('sin', 'sin', 5.0, 1), new FunctionProperties('cos', 'cos', 5.0, 1), new FunctionProperties('sh', 'sh', 5.0, 1), new FunctionProperties('ch', 'ch', 5.0, 1), new FunctionProperties('sec', 'sec', 5.0, 1), new FunctionProperties('csc', 'csc', 5.0, 1), new FunctionProperties('tg', 'tg', 5.0, 1), new FunctionProperties('ctg', 'ctg', 5.0, 1), new FunctionProperties('th', 'th', 5.0, 1), new FunctionProperties('cth', 'cth', 5.0, 1), new FunctionProperties('sech', 'sech', 5.0, 1), new FunctionProperties('csch', 'csch', 5.0, 1), new FunctionProperties('asin', 'asin', 5.0, 1), new FunctionProperties('acos', 'acos', 5.0, 1), new FunctionProperties('atg', 'atg', 5.0, 1), new FunctionProperties('actg', 'actg', 5.0, 1), new FunctionProperties('exp', 'exp', 5.0, 1), new FunctionProperties('ln', 'ln', 5.0, 1), new FunctionProperties('abs', 'abs', 5.0, 1, void 0, void 0, void 0, void 0, void 0, void 0, void 0, void 0, void 0, 2147483647), new FunctionProperties('log', 'log', 5.0, 2, void 0, void 0, void 0, void 0, void 0, void 0, void 0, StringDefinitionType$BINARY_OPERATION_getInstance()), new FunctionProperties('mod', 'mod', 5.0, 2), new FunctionProperties('and', 'and', 0.7, -1, true, true, void 0, void 0, '&', '\\land', StringDefinitionType$BINARY_OPERATION_getInstance(), void 0, void 0, void 0, '1', '0'), new FunctionProperties('or', 'or', 0.6, -1, true, true, void 0, void 0, '|', '\\lor', StringDefinitionType$BINARY_OPERATION_getInstance(), void 0, void 0, void 0, '0', '1'), new FunctionProperties('xor', 'xor', 0.6, -1, true, true, void 0, void 0, '^', '\\oplus', StringDefinitionType$BINARY_OPERATION_getInstance(), void 0, void 0, void 0, '0'), new FunctionProperties('alleq', 'alleq', 0.4, -1, true, true, void 0, void 0, void 0, void 0, StringDefinitionType$BINARY_OPERATION_getInstance()), new FunctionProperties('not', 'not', 5.0, 1, void 0, void 0, void 0, void 0, '!', '\\neg', StringDefinitionType$UNARY_LEFT_OPERATION_getInstance()), new FunctionProperties('implic', 'implic', 0.5, -1, void 0, void 0, void 0, void 0, '->', '\\implies', StringDefinitionType$BINARY_OPERATION_getInstance()), new FunctionProperties('set-', 'set-', 0.5, -1, void 0, void 0, void 0, void 0, '\\', '\\setminus', StringDefinitionType$BINARY_OPERATION_getInstance()), new FunctionProperties('sqrt', 'sqrt', 5.0, 1, void 0, void 0, void 0, void 0, void 0, void 0, void 0, StringDefinitionType$BINARY_OPERATION_getInstance()), new FunctionProperties('root', 'root', 5.0, 2), new FunctionProperties('mfenced', 'mfenced', 5.0, 1), new FunctionProperties('U', 'U', 5.0, 2), new FunctionProperties('P', 'P', 5.0, 1), new FunctionProperties('A', 'A', 5.0, 2), new FunctionProperties('C', 'C', 5.0, 2), new FunctionProperties('V', 'V', 5.0, 2), new FunctionProperties('B', 'B', 5.0, 1), new FunctionProperties('S1', 'S1', 5.0, 2), new FunctionProperties('S2', 'S2', 5.0, 2), new FunctionProperties('F', 'F', 5.0, 1), new FunctionProperties('C', 'C', 5.0, 1), new FunctionProperties('factorial', 'factorial', 4.0, 1, void 0, void 0, void 0, void 0, '!', void 0, StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance()), new FunctionProperties('double_factorial', 'factorial', 4.0, 1, void 0, void 0, void 0, void 0, '!!', void 0, StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance()), new FunctionProperties('subfactorial', 'subfactorial', 4.0, 1, void 0, void 0, void 0, void 0, '!', void 0, StringDefinitionType$UNARY_LEFT_OPERATION_getInstance()), new FunctionProperties('partial_differential', 'partial_differential', 0.5, 1), new FunctionProperties('d', 'd', 0.5, 2), new FunctionProperties('d', 'd', 0.5, 1), new FunctionProperties('f', 'f', 0.5, 1, void 0, void 0, void 0, true), new FunctionProperties('g', 'g', 0.5, 1, void 0, void 0, void 0, true)]);
    this.boolFunctions = setOf_0(['and', 'or', 'not', 'alleq', 'xor', 'implic', 'set-']);
    var $receiver_0 = this.functionProperties;
    var capacity = coerceAtLeast(mapCapacity(collectionSizeOrDefault($receiver_0, 10)), 16);
    var destination_0 = LinkedHashMap_init(capacity);
    var tmp$_0;
    tmp$_0 = $receiver_0.iterator();
    while (tmp$_0.hasNext()) {
      var element_0 = tmp$_0.next();
      destination_0.put_xwzc9p$(element_0.function + '_' + toString(element_0.numberOfArguments), element_0);
    }
    this.functionPropertiesByName = destination_0;
    this.stringDefinitions = mutableListOf([new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('+_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '+'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('+_-1')), StringDefinitionType$FUNCTION_getInstance(), '+'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('+_-1')), StringDefinitionType$FUNCTION_getInstance(), 'add'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('-_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '-'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('-_-1')), StringDefinitionType$FUNCTION_getInstance(), '-'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('-_-1')), StringDefinitionType$FUNCTION_getInstance(), 'sub'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('factorial_1')), StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance(), '!'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('double_factorial_1')), StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance(), '!!'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('subfactorial_1')), StringDefinitionType$UNARY_LEFT_OPERATION_getInstance(), '!', void 0, 'subfactorial'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('factorial_1')), StringDefinitionType$FUNCTION_getInstance(), 'factorial'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('double_factorial_1')), StringDefinitionType$FUNCTION_getInstance(), 'double_factorial'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('subfactorial_1')), StringDefinitionType$FUNCTION_getInstance(), 'subfactorial'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('*_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '*'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('*_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '&#xD7'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('*_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '&#xB7'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('*_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\cdot'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('*_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\times'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('*_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\ast'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('*_-1')), StringDefinitionType$FUNCTION_getInstance(), '*'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('*_-1')), StringDefinitionType$FUNCTION_getInstance(), 'mul'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('/_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '/'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('/_-1')), StringDefinitionType$FUNCTION_getInstance(), '/'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('/_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\div'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('/_-1')), StringDefinitionType$FUNCTION_getInstance(), 'div'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('/_-1')), StringDefinitionType$FUNCTION_getInstance(), 'mfrac'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('/_-1')), StringDefinitionType$FUNCTION_getInstance(), '\\frac', void 0, void 0, 2), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('^_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '^'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('^_-1')), StringDefinitionType$FUNCTION_getInstance(), '^'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('^_-1')), StringDefinitionType$FUNCTION_getInstance(), 'pow'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('^_-1')), StringDefinitionType$FUNCTION_getInstance(), 'msup'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('mod_2')), StringDefinitionType$FUNCTION_getInstance(), 'mod'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('and_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '&amp'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('and_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '&'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('and_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\cap'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('and_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\wedge'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('and_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\land'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('or_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '|'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('or_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\cup'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('or_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\vee'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('or_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\lor'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('and_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '/\\'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('or_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\/'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('and_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '&#x2227'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('or_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '&#x2228'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('xor_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '^', void 0, 'setTheory'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('xor_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '&#x2295'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('xor_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\oplus'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('not_1')), StringDefinitionType$UNARY_LEFT_OPERATION_getInstance(), '&#xAC'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('not_1')), StringDefinitionType$UNARY_LEFT_OPERATION_getInstance(), '\\neg'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('not_1')), StringDefinitionType$UNARY_LEFT_OPERATION_getInstance(), '!', void 0, 'setTheory'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('implic_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '&#x2192'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('implic_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '->'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('implic_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '-<\/mo><mo>&gt;'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('implic_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\rightarrow'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('implic_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\Rightarrow'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('implic_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\to'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('implic_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\implies'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('set-_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('set-_-1')), StringDefinitionType$BINARY_OPERATION_getInstance(), '\\setminus'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('and_-1')), StringDefinitionType$FUNCTION_getInstance(), 'and'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('or_-1')), StringDefinitionType$FUNCTION_getInstance(), 'or'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('xor_-1')), StringDefinitionType$FUNCTION_getInstance(), 'xor'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('alleq_-1')), StringDefinitionType$FUNCTION_getInstance(), 'alleq'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('not_1')), StringDefinitionType$FUNCTION_getInstance(), 'not'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('implic_-1')), StringDefinitionType$FUNCTION_getInstance(), 'implic'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('set-_-1')), StringDefinitionType$FUNCTION_getInstance(), 'setsub'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('partial_differential_1')), StringDefinitionType$UNARY_LEFT_OPERATION_getInstance(), '&#x2202'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('d_1')), StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance(), "'"), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('d_2')), StringDefinitionType$FUNCTION_getInstance(), "msubsup'"), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('d_1')), StringDefinitionType$FUNCTION_getInstance(), 'd'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('d_2')), StringDefinitionType$FUNCTION_getInstance(), 'd'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('d_1')), StringDefinitionType$FUNCTION_getInstance(), 'diff'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('d_2')), StringDefinitionType$FUNCTION_getInstance(), 'diff'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('S_4')), StringDefinitionType$FUNCTION_getInstance(), 'munderover&#x2211'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('P_4')), StringDefinitionType$FUNCTION_getInstance(), 'munderover&#x220F'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('S_4')), StringDefinitionType$FUNCTION_getInstance(), 'S'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('P_4')), StringDefinitionType$FUNCTION_getInstance(), 'P'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('S_4')), StringDefinitionType$FUNCTION_getInstance(), '\\sum', void 0, void 0, 4), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('P_4')), StringDefinitionType$FUNCTION_getInstance(), '\\prod', void 0, void 0, 4), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('sin_1')), StringDefinitionType$FUNCTION_getInstance(), 'sin'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('cos_1')), StringDefinitionType$FUNCTION_getInstance(), 'cos'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('tg_1')), StringDefinitionType$FUNCTION_getInstance(), 'tg'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('ctg_1')), StringDefinitionType$FUNCTION_getInstance(), 'ctg'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('tg_1')), StringDefinitionType$FUNCTION_getInstance(), 'tan'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('ctg_1')), StringDefinitionType$FUNCTION_getInstance(), 'cot'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('sin_1')), StringDefinitionType$FUNCTION_getInstance(), '\\sin', void 0, void 0, 1, void 0, true), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('cos_1')), StringDefinitionType$FUNCTION_getInstance(), '\\cos', void 0, void 0, 1, void 0, true), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('tg_1')), StringDefinitionType$FUNCTION_getInstance(), '\\tan', void 0, void 0, 1, void 0, true), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('ctg_1')), StringDefinitionType$FUNCTION_getInstance(), '\\cot', void 0, void 0, 1, void 0, true), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('asin_1')), StringDefinitionType$FUNCTION_getInstance(), 'asin'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('acos_1')), StringDefinitionType$FUNCTION_getInstance(), 'acos'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('atg_1')), StringDefinitionType$FUNCTION_getInstance(), 'atg'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('atg_1')), StringDefinitionType$FUNCTION_getInstance(), 'atan'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('actg_1')), StringDefinitionType$FUNCTION_getInstance(), 'actg'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('asin_1')), StringDefinitionType$FUNCTION_getInstance(), 'arcsin'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('acos_1')), StringDefinitionType$FUNCTION_getInstance(), 'arccos'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('atg_1')), StringDefinitionType$FUNCTION_getInstance(), 'arctg'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('actg_1')), StringDefinitionType$FUNCTION_getInstance(), 'arcctg'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('sh_1')), StringDefinitionType$FUNCTION_getInstance(), 'sh'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('ch_1')), StringDefinitionType$FUNCTION_getInstance(), 'ch'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('th_1')), StringDefinitionType$FUNCTION_getInstance(), 'th'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('cth_1')), StringDefinitionType$FUNCTION_getInstance(), 'cth'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('sec_1')), StringDefinitionType$FUNCTION_getInstance(), 'sec'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('sec_1')), StringDefinitionType$FUNCTION_getInstance(), '\\sec', void 0, void 0, 1), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('csc_1')), StringDefinitionType$FUNCTION_getInstance(), 'cosec'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('csc_1')), StringDefinitionType$FUNCTION_getInstance(), 'csc'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('csc_1')), StringDefinitionType$FUNCTION_getInstance(), '\\csc', void 0, void 0, 1), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('sech_1')), StringDefinitionType$FUNCTION_getInstance(), 'sech'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('csch_1')), StringDefinitionType$FUNCTION_getInstance(), 'csch'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('exp_1')), StringDefinitionType$FUNCTION_getInstance(), 'exp'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('ln_1')), StringDefinitionType$FUNCTION_getInstance(), 'ln'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('ln_1')), StringDefinitionType$FUNCTION_getInstance(), '\\ln', void 0, void 0, 1), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('ln_1')), StringDefinitionType$FUNCTION_getInstance(), 'log'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('log_2')), StringDefinitionType$FUNCTION_getInstance(), 'log'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('log_2')), StringDefinitionType$FUNCTION_getInstance(), '{log}', true), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('log_2')), StringDefinitionType$FUNCTION_getInstance(), '\\log', void 0, void 0, 2, true, true), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('abs_1')), StringDefinitionType$FUNCTION_getInstance(), 'abs'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('abs_1')), StringDefinitionType$FUNCTION_getInstance(), 'mfenced_|__|'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('sqrt_1')), StringDefinitionType$FUNCTION_getInstance(), 'msqrt'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('root_2')), StringDefinitionType$FUNCTION_getInstance(), 'mroot'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('sqrt_1')), StringDefinitionType$FUNCTION_getInstance(), 'sqrt'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('sqrt_1')), StringDefinitionType$FUNCTION_getInstance(), '\\sqrt', void 0, void 0, 1), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('root_2')), StringDefinitionType$FUNCTION_getInstance(), 'root'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('mfenced_1')), StringDefinitionType$FUNCTION_getInstance(), 'mfenced'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('U_2')), StringDefinitionType$FUNCTION_getInstance(), 'U'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('P_1')), StringDefinitionType$FUNCTION_getInstance(), 'P'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('A_2')), StringDefinitionType$FUNCTION_getInstance(), 'A'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('C_2')), StringDefinitionType$FUNCTION_getInstance(), 'C'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('V_2')), StringDefinitionType$FUNCTION_getInstance(), 'V'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('B_1')), StringDefinitionType$FUNCTION_getInstance(), 'B'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('S1_2')), StringDefinitionType$FUNCTION_getInstance(), 'S1'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('S2_2')), StringDefinitionType$FUNCTION_getInstance(), 'S2'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('F_1')), StringDefinitionType$FUNCTION_getInstance(), 'F'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('C_1')), StringDefinitionType$FUNCTION_getInstance(), 'C'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('f_1')), StringDefinitionType$FUNCTION_getInstance(), 'f'), new FunctionStringDefinition(ensureNotNull(this.functionPropertiesByName.get_11rb$('g_1')), StringDefinitionType$FUNCTION_getInstance(), 'g')]);
    var $receiver_1 = this.stringDefinitions;
    var destination_1 = ArrayList_init();
    var tmp$_1;
    tmp$_1 = $receiver_1.iterator();
    while (tmp$_1.hasNext()) {
      var element_1 = tmp$_1.next();
      if (element_1.definitionType === StringDefinitionType$FUNCTION_getInstance() && element_1.definition.length > 1 && startsWith(element_1.definition, '\\'))
        destination_1.add_11rb$(element_1);
    }
    var destination_2 = ArrayList_init_0(collectionSizeOrDefault(destination_1, 10));
    var tmp$_2;
    tmp$_2 = destination_1.iterator();
    while (tmp$_2.hasNext()) {
      var item = tmp$_2.next();
      destination_2.add_11rb$(new Pair(item.definition, item));
    }
    this.slashToSpaceFunctionDefinitions = sortedWith(destination_2, new Comparator$ObjectLiteral(compareByDescending$lambda(FunctionConfiguration$slashToSpaceFunctionDefinitions$lambda)));
    this.slashToSpaceFunctionDefinitionsMap = toMap(this.slashToSpaceFunctionDefinitions);
    var $receiver_2 = this.stringDefinitions;
    var destination_3 = ArrayList_init();
    var tmp$_3;
    tmp$_3 = $receiver_2.iterator();
    while (tmp$_3.hasNext()) {
      var element_2 = tmp$_3.next();
      if (element_2.definitionType !== StringDefinitionType$FUNCTION_getInstance() && element_2.definition.length > 1 && startsWith(element_2.definition, '\\'))
        destination_3.add_11rb$(element_2);
    }
    var destination_4 = ArrayList_init_0(collectionSizeOrDefault(destination_3, 10));
    var tmp$_4;
    tmp$_4 = destination_3.iterator();
    while (tmp$_4.hasNext()) {
      var item_0 = tmp$_4.next();
      destination_4.add_11rb$(new Pair(item_0.definition, item_0.definitionType));
    }
    this.slashToSpaceDefinitions = sortedWith(destination_4, new Comparator$ObjectLiteral(compareByDescending$lambda(FunctionConfiguration$slashToSpaceDefinitions$lambda)));
    var $receiver_3 = this.stringDefinitions;
    var destination_5 = ArrayList_init();
    var tmp$_5;
    tmp$_5 = $receiver_3.iterator();
    while (tmp$_5.hasNext()) {
      var element_3 = tmp$_5.next();
      if (element_3.definitionType === StringDefinitionType$FUNCTION_getInstance())
        destination_5.add_11rb$(element_3);
    }
    var capacity_0 = coerceAtLeast(mapCapacity(collectionSizeOrDefault(destination_5, 10)), 16);
    var destination_6 = LinkedHashMap_init(capacity_0);
    var tmp$_6;
    tmp$_6 = destination_5.iterator();
    while (tmp$_6.hasNext()) {
      var element_4 = tmp$_6.next();
      destination_6.put_xwzc9p$(FunctionIdentifier$Companion_getInstance().getIdentifier_bm4lxs$(element_4.definition, element_4.function.numberOfArguments), element_4);
    }
    this.functionStringDefinitionByIdentifier = destination_6;
    var $receiver_4 = this.stringDefinitions;
    var destination_7 = LinkedHashMap_init_0();
    var tmp$_7;
    tmp$_7 = $receiver_4.iterator();
    while (tmp$_7.hasNext()) {
      var element_5 = tmp$_7.next();
      var key = element_5.definition;
      var tmp$_0_0;
      var value = destination_7.get_11rb$(key);
      if (value == null) {
        var answer = ArrayList_init();
        destination_7.put_xwzc9p$(key, answer);
        tmp$_0_0 = answer;
      }
       else {
        tmp$_0_0 = value;
      }
      var list = tmp$_0_0;
      list.add_11rb$(element_5);
    }
    this.stringDefinitionByName = destination_7;
    var $receiver_5 = this.stringDefinitions;
    var destination_8 = LinkedHashMap_init_0();
    var tmp$_8;
    tmp$_8 = $receiver_5.iterator();
    while (tmp$_8.hasNext()) {
      var element_6 = tmp$_8.next();
      var key_0 = element_6.function.function;
      var tmp$_0_1;
      var value_0 = destination_8.get_11rb$(key_0);
      if (value_0 == null) {
        var answer_0 = ArrayList_init();
        destination_8.put_xwzc9p$(key_0, answer_0);
        tmp$_0_1 = answer_0;
      }
       else {
        tmp$_0_1 = value_0;
      }
      var list_0 = tmp$_0_1;
      list_0.add_11rb$(element_6);
    }
    this.stringDefinitionByFunctionName = destination_8;
  }
  FunctionConfiguration.prototype.fastFindStringDefinitionByNameAndNumberOfArguments_bm4lxs$ = function (name, numberOfArguments) {
    var tmp$, tmp$_0;
    tmp$ = this.stringDefinitionByFunctionName.get_11rb$(name);
    if (tmp$ == null) {
      return null;
    }
    var actualStringDefinitions = tmp$;
    var tmp$_1;
    var firstOrNull$result;
    firstOrNull$break: do {
      var tmp$_2;
      tmp$_2 = actualStringDefinitions.iterator();
      while (tmp$_2.hasNext()) {
        var element = tmp$_2.next();
        if (numberOfArguments === element.function.numberOfArguments) {
          firstOrNull$result = element;
          break firstOrNull$break;
        }
      }
      firstOrNull$result = null;
    }
     while (false);
    if ((tmp$_0 = firstOrNull$result) != null)
      tmp$_1 = tmp$_0;
    else {
      var firstOrNull$result_0;
      firstOrNull$break: do {
        var tmp$_3;
        tmp$_3 = actualStringDefinitions.iterator();
        while (tmp$_3.hasNext()) {
          var element_0 = tmp$_3.next();
          if (element_0.function.numberOfArguments === -1) {
            firstOrNull$result_0 = element_0;
            break firstOrNull$break;
          }
        }
        firstOrNull$result_0 = null;
      }
       while (false);
      tmp$_1 = firstOrNull$result_0;
    }
    return tmp$_1;
  };
  FunctionConfiguration.prototype.fastFindByNameAndNumberOfArguments_bm4lxs$ = function (name, numberOfArguments) {
    var tmp$;
    return (tmp$ = this.functionStringDefinitionByIdentifier.get_11rb$(FunctionIdentifier$Companion_getInstance().getIdentifier_bm4lxs$(name, numberOfArguments))) != null ? tmp$ : this.functionStringDefinitionByIdentifier.get_11rb$(FunctionIdentifier$Companion_getInstance().getIdentifier_bm4lxs$(name, -1));
  };
  FunctionConfiguration.prototype.findFunctionStringDefinition_7zakv9$ = function (name, type, numberOfArguments, nameIsPossible, subAsLast, filter) {
    if (nameIsPossible === void 0)
      nameIsPossible = false;
    if (subAsLast === void 0)
      subAsLast = false;
    if (filter === void 0)
      filter = this.scopeFilter;
    var tmp$, tmp$_0;
    var result = null;
    tmp$ = this.stringDefinitionByName.get_11rb$(name);
    if (tmp$ == null) {
      return result;
    }
    var actualStringDefinitions = tmp$;
    var destination = ArrayList_init();
    var tmp$_1;
    tmp$_1 = actualStringDefinitions.iterator();
    while (tmp$_1.hasNext()) {
      var element = tmp$_1.next();
      if (isBlank(element.filter) || filter.contains_11rb$(element.filter))
        destination.add_11rb$(element);
    }
    tmp$_0 = destination.iterator();
    while (tmp$_0.hasNext()) {
      var stringDefinition = tmp$_0.next();
      if (stringDefinition.definitionType === type && subAsLast === stringDefinition.subAsLast && (nameIsPossible || !stringDefinition.function.isNameForRuleDesignations))
        if (stringDefinition.function.numberOfArguments === -1 || stringDefinition.function.numberOfArguments === numberOfArguments || (subAsLast && stringDefinition.function.numberOfArguments === 2) || (stringDefinition.powSeparatedAsPow && (stringDefinition.function.numberOfArguments + 1 | 0) === numberOfArguments)) {
          if (!isBlank(stringDefinition.filter)) {
            return stringDefinition;
          }
           else if (result == null || equals(result.filter, '')) {
            result = stringDefinition;
          }
        }
    }
    return result;
  };
  function FunctionConfiguration$slashToSpaceFunctionDefinitions$lambda(it) {
    return it.first.length;
  }
  function FunctionConfiguration$slashToSpaceDefinitions$lambda(it) {
    return it.first.length;
  }
  FunctionConfiguration.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FunctionConfiguration',
    interfaces: []
  };
  function VariableReplacementRule(left, right) {
    this.left = left;
    this.right = right;
  }
  VariableReplacementRule.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'VariableReplacementRule',
    interfaces: []
  };
  VariableReplacementRule.prototype.component1 = function () {
    return this.left;
  };
  VariableReplacementRule.prototype.component2 = function () {
    return this.right;
  };
  VariableReplacementRule.prototype.copy_puj7f4$ = function (left, right) {
    return new VariableReplacementRule(left === void 0 ? this.left : left, right === void 0 ? this.right : right);
  };
  VariableReplacementRule.prototype.toString = function () {
    return 'VariableReplacementRule(left=' + Kotlin.toString(this.left) + (', right=' + Kotlin.toString(this.right)) + ')';
  };
  VariableReplacementRule.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.left) | 0;
    result = result * 31 + Kotlin.hashCode(this.right) | 0;
    return result;
  };
  VariableReplacementRule.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.left, other.left) && Kotlin.equals(this.right, other.right)))));
  };
  function VariableConfiguration() {
    this.variableImmediateReplacementRules = listOf_0([new VariableReplacementRule('e', '2.7182818284590452353602874713526'), new VariableReplacementRule('pi', '3.1415926535897932384626433832795'), new VariableReplacementRule('&#x3C0', '3.1415926535897932384626433832795'), new VariableReplacementRule('&#x3C0;', '3.1415926535897932384626433832795')]);
  }
  VariableConfiguration.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'VariableConfiguration',
    interfaces: []
  };
  function containsDifferentiation($receiver) {
    return $receiver.containsFunction_bm4lxs$('d', 2);
  }
  function diff($receiver, transformationWeight, compiledConfiguration) {
    if (transformationWeight === void 0)
      transformationWeight = mutableListOf([0.0]);
    var tmp$;
    if (transformationWeight.isEmpty()) {
      transformationWeight.add_11rb$(0.0);
    }
    if (!$receiver.containsFunction_bm4lxs$('d', 2)) {
      return $receiver;
    }
    if ($receiver.nodeType === NodeType$FUNCTION_getInstance() && equals($receiver.value, 'd') && $receiver.children.size === 2 && $receiver.children.get_za3lpa$(1).nodeType === NodeType$VARIABLE_getInstance()) {
      var variable = $receiver.children.get_za3lpa$(1).value;
      if ($receiver.children.get_za3lpa$(0).getContainedVariables_ywdfdh$(setOf(variable)).isEmpty()) {
        return new ExpressionNode(NodeType$VARIABLE_getInstance(), '0', void 0, void 0, void 0, void 0, void 0, '0');
      }
       else if ($receiver.children.get_za3lpa$(0).nodeType === NodeType$VARIABLE_getInstance()) {
        return new ExpressionNode(NodeType$VARIABLE_getInstance(), '1', void 0, void 0, void 0, void 0, void 0, '1');
      }
       else if (equals($receiver.children.get_za3lpa$(0).value, '+') || equals($receiver.children.get_za3lpa$(0).value, '-')) {
        return diffPlusMinus($receiver, variable, transformationWeight, compiledConfiguration);
      }
       else if (equals($receiver.children.get_za3lpa$(0).value, '*') && $receiver.children.get_za3lpa$(0).children.size === 2 && ($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).getContainedVariables_ywdfdh$(setOf(variable)).isEmpty() || $receiver.children.get_za3lpa$(0).children.get_za3lpa$(1).getContainedVariables_ywdfdh$(setOf(variable)).isEmpty())) {
        return diffMul($receiver, variable, transformationWeight, compiledConfiguration);
      }
      transformationWeight.set_wxm5ur$(0, transformationWeight.get_za3lpa$(0) + 0.4);
      if (equals($receiver.children.get_za3lpa$(0).value, '*'))
        return diffMul($receiver, variable, transformationWeight, compiledConfiguration);
      transformationWeight.set_wxm5ur$(0, transformationWeight.get_za3lpa$(0) + 0.15);
      switch ($receiver.children.get_za3lpa$(0).value) {
        case '/':
          return diffDiv($receiver, variable, transformationWeight, compiledConfiguration);
        case '^':
          return diffPow($receiver, variable, transformationWeight, compiledConfiguration);
        case 'sqrt':
          return diffSqrt($receiver, variable, transformationWeight, compiledConfiguration);
        case 'ln':
          return diffLn($receiver, variable, transformationWeight, compiledConfiguration);
        case 'exp':
          return diffExp($receiver, variable, transformationWeight, compiledConfiguration);
        case 'sin':
          return diffSin($receiver, variable, transformationWeight, compiledConfiguration);
        case 'cos':
          return diffCos($receiver, variable, transformationWeight, compiledConfiguration);
        case 'asin':
          return diffAsin($receiver, variable, transformationWeight, compiledConfiguration);
        case 'acos':
          return diffAcos($receiver, variable, transformationWeight, compiledConfiguration);
        case 'sh':
          return diffSh($receiver, variable, transformationWeight, compiledConfiguration);
        case 'ch':
          return diffCh($receiver, variable, transformationWeight, compiledConfiguration);
        case 'tg':
          return diffTg($receiver, variable, transformationWeight, compiledConfiguration);
        case 'ctg':
          return diffCtg($receiver, variable, transformationWeight, compiledConfiguration);
        case 'atg':
          return diffAtg($receiver, variable, transformationWeight, compiledConfiguration);
        case 'actg':
          return diffActg($receiver, variable, transformationWeight, compiledConfiguration);
        case 'th':
          return diffTh($receiver, variable, transformationWeight, compiledConfiguration);
        case 'cth':
          return diffCth($receiver, variable, transformationWeight, compiledConfiguration);
      }
    }
    var result = $receiver.copy_uq8prj$();
    var maxWeight = 0.0;
    tmp$ = $receiver.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      var currWeight = mutableListOf([0.0]);
      result.addChild_6718cy$(diff(child, currWeight, compiledConfiguration));
      if (maxWeight < currWeight.get_za3lpa$(0)) {
        maxWeight = currWeight.get_za3lpa$(0);
      }
    }
    transformationWeight.set_wxm5ur$(0, transformationWeight.get_za3lpa$(0) + maxWeight);
    return result;
  }
  var unlimitedWeight;
  function buildDiffNode(expressionNode, variable, compiledConfiguration) {
    var newChild = new ExpressionNode(NodeType$FUNCTION_getInstance(), 'd');
    if (!equals(expressionNode.value, '') || expressionNode.children.size !== 1)
      newChild.addChild_6718cy$(expressionNode.clone());
    else
      newChild.addChild_6718cy$(expressionNode.children.get_za3lpa$(0).clone());
    newChild.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), variable));
    return newChild;
  }
  function diffLn($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    result.addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).clone());
    return result;
  }
  function diffSqrt($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    var doubledValue = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
    doubledValue.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '2'));
    doubledValue.addChild_6718cy$($receiver.children.get_za3lpa$(0).clone());
    result.addChild_6718cy$(doubledValue);
    return result;
  }
  function diffExp($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    result.addChild_6718cy$($receiver.children.get_za3lpa$(0).clone());
    return result;
  }
  function diffSin($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('cos', 1));
    last(result.children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).clone());
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    return result;
  }
  function diffCos($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
    last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
    last(last(result.children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('sin', 1));
    last(last(last(result.children).children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).clone());
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    return result;
  }
  function diffSh($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('ch', 1));
    last(result.children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).clone());
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    return result;
  }
  function diffCh($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('sh', 1));
    last(result.children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).clone());
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    return result;
  }
  function diffAsin($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
    last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
    last(last(result.children).children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
    last(last(result.children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
    last(last(last(result.children).children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
    last(last(last(last(result.children).children).children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0));
    last(last(last(last(result.children).children).children).children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '2'));
    last(result.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '0.5'));
    return result;
  }
  function diffAcos($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
    last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    last(last(result.children).children).addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
    last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
    last(last(result.children).children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
    last(last(result.children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
    last(last(last(result.children).children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
    last(last(last(last(result.children).children).children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0));
    last(last(last(last(result.children).children).children).children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '2'));
    last(result.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '0.5'));
    return result;
  }
  function diffTg($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
    last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('cos', 1));
    last(last(result.children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0));
    last(result.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '2'));
    return result;
  }
  function diffCtg($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
    last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
    last(last(result.children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
    last(last(last(result.children).children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('sin', 1));
    last(last(last(last(result.children).children).children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0));
    last(result.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '2'));
    return result;
  }
  function diffAtg($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
    last(result.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
    last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
    last(last(result.children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0));
    last(last(result.children).children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '2'));
    return result;
  }
  function diffActg($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
    last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    last(last(result.children).children).addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
    last(result.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
    last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
    last(last(result.children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0));
    last(last(result.children).children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '2'));
    return result;
  }
  function diffTh($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
    last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('ch', 1));
    last(last(result.children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0));
    last(result.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '2'));
    return result;
  }
  function diffCth($receiver, variable, transformationWeight, compiledConfiguration) {
    if ($receiver.children.get_za3lpa$(0).children.size !== 1)
      return $receiver.clone();
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
    var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
    result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
    result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
    last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
    last(last(result.children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
    last(last(last(result.children).children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('sh', 1));
    last(last(last(last(result.children).children).children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0));
    last(result.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '2'));
    return result;
  }
  function diffPlusMinus($receiver, variable, transformationWeight, compiledConfiguration) {
    var tmp$;
    var result = $receiver.children.get_za3lpa$(0).copy_uq8prj$();
    var maxWeight = 0.0;
    tmp$ = $receiver.children.get_za3lpa$(0).children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      var newChild = buildDiffNode(child, variable, compiledConfiguration);
      var currWeight = toMutableList(plus(mutableListOf([0.0]), transformationWeight.subList_vux9f0$(1, transformationWeight.size)));
      result.addChild_6718cy$(diff(newChild, currWeight, compiledConfiguration));
      if (maxWeight < currWeight.get_za3lpa$(0)) {
        maxWeight = currWeight.get_za3lpa$(0);
      }
    }
    transformationWeight.set_wxm5ur$(0, transformationWeight.get_za3lpa$(0) + maxWeight);
    return result;
  }
  function diffMul($receiver, variable, transformationWeight, compiledConfiguration) {
    var tmp$, tmp$_0;
    var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
    var maxWeight = 0.0;
    tmp$ = get_lastIndex($receiver.children.get_za3lpa$(0).children);
    for (var diffChildIndex = 0; diffChildIndex <= tmp$; diffChildIndex++) {
      result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1));
      tmp$_0 = get_lastIndex($receiver.children.get_za3lpa$(0).children);
      for (var i = 0; i <= tmp$_0; i++) {
        if (diffChildIndex === i) {
          var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(i), variable, compiledConfiguration);
          var currWeight = toMutableList(plus(mutableListOf([0.0]), transformationWeight.subList_vux9f0$(1, transformationWeight.size)));
          last(result.children).addChild_6718cy$(diff(newChild, currWeight, compiledConfiguration));
          if (maxWeight < currWeight.get_za3lpa$(0)) {
            maxWeight = currWeight.get_za3lpa$(0);
          }
        }
         else {
          last(result.children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(i).clone());
        }
      }
    }
    transformationWeight.set_wxm5ur$(0, transformationWeight.get_za3lpa$(0) + maxWeight);
    return result;
  }
  function diffDiv($receiver, variable, transformationWeight, compiledConfiguration) {
    var tmp$;
    if ($receiver.children.get_za3lpa$(0).children.size === 1) {
      var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
      result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
      last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
      var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
      last(last(result.children).children).addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
      result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
      last(result.children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).clone());
      last(result.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '2', void 0, void 0, void 0, void 0, void 0, '2'));
      return result;
    }
     else {
      var denum = $receiver.children.get_za3lpa$(0).children.get_za3lpa$(1);
      if ($receiver.children.get_za3lpa$(0).children.size > 2) {
        denum = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
        tmp$ = get_lastIndex($receiver.children.get_za3lpa$(0).children);
        for (var i = 1; i <= tmp$; i++) {
          denum.addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(i));
        }
      }
      if ($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).getContainedVariables_ywdfdh$(setOf(variable)).isEmpty()) {
        var result_0 = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
        result_0.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
        last(result_0.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
        last(last(result_0.children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1));
        last(last(last(result_0.children).children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).clone());
        var newChild_0 = buildDiffNode(denum, variable, compiledConfiguration);
        last(last(last(result_0.children).children).children).addChild_6718cy$(diff(newChild_0, transformationWeight, compiledConfiguration));
        result_0.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
        last(result_0.children).addChild_6718cy$(denum.clone());
        last(result_0.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '2', void 0, void 0, void 0, void 0, void 0, '2'));
        return result_0;
      }
       else {
        var result_1 = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
        result_1.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
        last(result_1.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1));
        last(last(result_1.children).children).addChild_6718cy$(denum.clone());
        var newNumChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
        var weight1 = toMutableList(plus(mutableListOf([0.0]), transformationWeight.subList_vux9f0$(1, transformationWeight.size)));
        last(last(result_1.children).children).addChild_6718cy$(diff(newNumChild, weight1, compiledConfiguration));
        last(result_1.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
        last(last(result_1.children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1));
        last(last(last(result_1.children).children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).clone());
        var newDenumChild = buildDiffNode(denum, variable, compiledConfiguration);
        var weight2 = toMutableList(plus(mutableListOf([0.0]), transformationWeight.subList_vux9f0$(1, transformationWeight.size)));
        last(last(last(result_1.children).children).children).addChild_6718cy$(diff(newDenumChild, weight2, compiledConfiguration));
        result_1.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
        last(result_1.children).addChild_6718cy$(denum.clone());
        last(result_1.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '2', void 0, void 0, void 0, void 0, void 0, '2'));
        if (weight2.get_za3lpa$(0) > weight1.get_za3lpa$(0)) {
          transformationWeight.set_wxm5ur$(0, transformationWeight.get_za3lpa$(0) + weight2.get_za3lpa$(0));
        }
         else {
          transformationWeight.set_wxm5ur$(0, transformationWeight.get_za3lpa$(0) + weight1.get_za3lpa$(0));
        }
        return result_1;
      }
    }
  }
  function diffPow($receiver, variable, transformationWeight, compiledConfiguration) {
    var tmp$;
    if ($receiver.children.get_za3lpa$(0).children.size < 2)
      return $receiver.clone();
    var degree = $receiver.children.get_za3lpa$(0).children.get_za3lpa$(1);
    if ($receiver.children.get_za3lpa$(0).children.size > 2) {
      degree = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1);
      tmp$ = get_lastIndex($receiver.children.get_za3lpa$(0).children);
      for (var i = 1; i <= tmp$; i++) {
        degree.addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(i));
      }
    }
    if (degree.getContainedVariables_ywdfdh$(setOf(variable)).isEmpty()) {
      var result = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
      result.addChild_6718cy$(degree.clone());
      result.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
      last(result.children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).clone());
      last(result.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
      last(last(result.children).children).addChild_6718cy$(degree.clone());
      last(last(result.children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
      last(last(last(result.children).children).children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
      var newChild = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
      result.addChild_6718cy$(diff(newChild, transformationWeight, compiledConfiguration));
      return result;
    }
     else {
      if (!$receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).getContainedVariables_ywdfdh$(setOf(variable)).isEmpty()) {
        if (transformationWeight.size > 1) {
          var result_0 = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
          result_0.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1));
          last(result_0.children).addChild_6718cy$($receiver.children.get_za3lpa$(0).clone());
          last(result_0.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('ln', 1));
          last(last(result_0.children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).clone());
          var newDegreeChild = buildDiffNode(degree, variable, compiledConfiguration);
          var weight1 = toMutableList(plus(mutableListOf([0.0]), transformationWeight.subList_vux9f0$(1, transformationWeight.size)));
          last(result_0.children).addChild_6718cy$(diff(newDegreeChild, weight1, compiledConfiguration));
          result_0.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1));
          last(result_0.children).addChild_6718cy$(degree.clone());
          var newChild_0 = buildDiffNode($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0), variable, compiledConfiguration);
          var weight2 = toMutableList(plus(mutableListOf([0.0]), transformationWeight.subList_vux9f0$(1, transformationWeight.size)));
          last(result_0.children).addChild_6718cy$(diff(newChild_0, weight2, compiledConfiguration));
          last(result_0.children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1));
          last(last(result_0.children).children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).clone());
          last(last(result_0.children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
          last(last(last(result_0.children).children).children).addChild_6718cy$(degree.clone());
          last(last(last(result_0.children).children).children).addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
          last(last(last(last(result_0.children).children).children).children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
          if (weight2.get_za3lpa$(0) > weight1.get_za3lpa$(0)) {
            transformationWeight.set_wxm5ur$(0, transformationWeight.get_za3lpa$(0) + weight2.get_za3lpa$(0));
          }
           else {
            transformationWeight.set_wxm5ur$(0, transformationWeight.get_za3lpa$(0) + weight1.get_za3lpa$(0));
          }
          return result_0;
        }
         else {
          return $receiver.clone();
        }
      }
       else {
        var result_1 = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
        result_1.addChild_6718cy$($receiver.children.get_za3lpa$(0).clone());
        result_1.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('ln', 1));
        last(result_1.children).addChild_6718cy$($receiver.children.get_za3lpa$(0).children.get_za3lpa$(0).clone());
        var newChild_1 = buildDiffNode(degree, variable, compiledConfiguration);
        result_1.addChild_6718cy$(diff(newChild_1, transformationWeight, compiledConfiguration));
        return result_1;
      }
    }
  }
  function calcSinCosDomain(argNum, parentDomain, inverseFunc) {
    var generalValues = DefinitionDomain$Companion_getInstance().inclusive_lu1900$(1.0, -1.0);
    var x = generalValues.intersectWith_1ggb54$(parentDomain);
    var leftVal = inverseFunc(x.leftMostElement());
    var rightVal = inverseFunc(x.rightMostElement());
    var segments = mutableSetOf([new DomainSegment(leftVal - 2 * math.PI, false, rightVal - 2 * math.PI, false), new DomainSegment(leftVal, false, rightVal, false), new DomainSegment(leftVal + 2 * math.PI, false, rightVal + 2 * math.PI, false)]);
    return new DefinitionDomain(void 0, void 0, segments);
  }
  function knownOps$lambda(node, argNum, plusValues) {
    return plusValues;
  }
  function knownOps$lambda_0(node, argNum, parentDomain) {
    return parentDomain;
  }
  function knownOps$lambda_1(node, argNum, parentDomain) {
    return parentDomain;
  }
  function knownOps$lambda_2(node, argNum, parentDomain) {
    return parentDomain;
  }
  function knownOps$lambda_3(node, argNum, parentDomain) {
    return argNum === 0 ? parentDomain : parentDomain.except_yqxtqz$(new Float64Array([0.0]));
  }
  function knownOps$lambda$lambda(a) {
    return Math_0.asin(a);
  }
  function knownOps$lambda_4(node, argnum, parentDomain) {
    return calcSinCosDomain(argnum, parentDomain, knownOps$lambda$lambda);
  }
  function knownOps$lambda$lambda_0(a) {
    return Math_0.acos(a);
  }
  function knownOps$lambda_5(node, argnum, parentDomain) {
    return calcSinCosDomain(argnum, parentDomain, knownOps$lambda$lambda_0);
  }
  var knownOps;
  var knownOpsAssociation;
  function DomainCalculator(expressionNode) {
    this.expressionNode = expressionNode;
    this.varDomain = new MultivariateDefinitionDomain(this.expressionNode);
    this.baseOperationsDefinitions = new BaseOperationsDefinitions();
  }
  DomainCalculator.prototype.calculate = function () {
    this.calcInner_0(this.expressionNode, DomainAll);
    return this;
  };
  DomainCalculator.prototype.calcInner_0 = function (expressionNode, parentDomain) {
    this.calcTopDown_0(expressionNode, parentDomain);
  };
  DomainCalculator.prototype.calcTopDown_0 = function (expressionNode, parentDomain) {
    var tmp$;
    switch (expressionNode.nodeType.name) {
      case 'VARIABLE':
        if (toDoubleOrNull(expressionNode.value) == null) {
          var curval = ensureNotNull(this.varDomain.variables.get_11rb$(expressionNode.value));
          this.varDomain.set_7y87zu$(expressionNode.value, parentDomain.intersectWith_1ggb54$(curval));
        }

        break;
      case 'FUNCTION':
        tmp$ = knownOpsAssociation.get_11rb$(expressionNode.value);
        if (tmp$ == null) {
          throw UnsupportedOperationException_init('operation %s is not supported');
        }

        var domainOp = tmp$;
        var updatedParentDomain = this.scaleDomain_0(expressionNode, parentDomain);
        var index = 0;
        for (var tmp$_0 = expressionNode.children.iterator(); tmp$_0.hasNext(); ++index) {
          var child = tmp$_0.next();
          var argDomain = domainOp.funcToCall(child, index, updatedParentDomain);
          this.calcTopDown_0(child, argDomain);
        }

        break;
      case 'EMPTY':
      case 'ERROR':
        break;
      default:Kotlin.noWhenBranchMatched();
        break;
    }
  };
  DomainCalculator.prototype.scaleDomain_0 = function (expressionNode, parentDomain) {
    var $receiver = expressionNode.children;
    var destination = ArrayList_init();
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      var tmp$_0;
      if ((tmp$_0 = this.subtreeConstantValueOrNull_0(element)) != null) {
        destination.add_11rb$(tmp$_0);
      }
    }
    var constants = destination;
    var tmp$_1;
    var accumulator = parentDomain;
    tmp$_1 = constants.iterator();
    loop_label: while (tmp$_1.hasNext()) {
      var element_0 = tmp$_1.next();
      var acc = accumulator;
      var operation$result;
      operation$break: do {
        switch (expressionNode.value) {
          case '+':
            operation$result = acc.shiftBy_14dthe$(-element_0);
            break operation$break;
          case '-':
            operation$result = acc.shiftBy_14dthe$(element_0);
            break operation$break;
          case '*':
            operation$result = acc.scaleBy_14dthe$(1 / element_0);
            break operation$break;
          case '/':
            operation$result = acc.scaleBy_14dthe$(element_0);
            break operation$break;
          default:operation$result = acc;
            break operation$break;
        }
      }
       while (false);
      accumulator = operation$result;
    }
    return accumulator;
  };
  DomainCalculator.prototype.subtreeConstantValueOrNull_0 = function (tree) {
    var tmp$, tmp$_0, tmp$_1;
    switch (tree.nodeType.name) {
      case 'FUNCTION':
        var innerDoubleValue = tree.children.size !== 1 ? null : this.subtreeConstantValueOrNull_0(tree.children.get_za3lpa$(0));
        var opToCall = innerDoubleValue == null ? null : this.baseOperationsDefinitions.getOperation_bm4lxs$(tree.value, 1);
        return (tmp$_1 = (tmp$_0 = (tmp$ = opToCall != null ? opToCall.calculatingFunction : null) != null ? tmp$(tree) : null) != null ? tmp$_0.value : null) != null ? toDoubleOrNull(tmp$_1) : null;
      case 'VARIABLE':
        return toDoubleOrNull(tree.value);
      case 'EMPTY':
      case 'ERROR':
        return null;
      default:return Kotlin.noWhenBranchMatched();
    }
  };
  DomainCalculator.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'DomainCalculator',
    interfaces: []
  };
  function ParserError(position, description, endPosition) {
    if (position === void 0)
      position = -1;
    if (description === void 0)
      description = '';
    if (endPosition === void 0)
      endPosition = -1;
    this.position = position;
    this.description = description;
    this.endPosition = endPosition;
  }
  ParserError.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ParserError',
    interfaces: []
  };
  ParserError.prototype.component1 = function () {
    return this.position;
  };
  ParserError.prototype.component2 = function () {
    return this.description;
  };
  ParserError.prototype.component3 = function () {
    return this.endPosition;
  };
  ParserError.prototype.copy_jl0c9m$ = function (position, description, endPosition) {
    return new ParserError(position === void 0 ? this.position : position, description === void 0 ? this.description : description, endPosition === void 0 ? this.endPosition : endPosition);
  };
  ParserError.prototype.toString = function () {
    return 'ParserError(position=' + Kotlin.toString(this.position) + (', description=' + Kotlin.toString(this.description)) + (', endPosition=' + Kotlin.toString(this.endPosition)) + ')';
  };
  ParserError.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.position) | 0;
    result = result * 31 + Kotlin.hashCode(this.description) | 0;
    result = result * 31 + Kotlin.hashCode(this.endPosition) | 0;
    return result;
  };
  ParserError.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.position, other.position) && Kotlin.equals(this.description, other.description) && Kotlin.equals(this.endPosition, other.endPosition)))));
  };
  function GeneralError(description) {
    if (description === void 0)
      description = '';
    this.description = description;
  }
  GeneralError.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'GeneralError',
    interfaces: []
  };
  GeneralError.prototype.component1 = function () {
    return this.description;
  };
  GeneralError.prototype.copy_61zpoe$ = function (description) {
    return new GeneralError(description === void 0 ? this.description : description);
  };
  GeneralError.prototype.toString = function () {
    return 'GeneralError(description=' + Kotlin.toString(this.description) + ')';
  };
  GeneralError.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.description) | 0;
    return result;
  };
  GeneralError.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && Kotlin.equals(this.description, other.description))));
  };
  function ExpressionComporator(baseOperationsDefinitions) {
    if (baseOperationsDefinitions === void 0)
      baseOperationsDefinitions = new BaseOperationsDefinitions();
    this.baseOperationsDefinitions = baseOperationsDefinitions;
    this.compiledConfiguration_h7im45$_0 = this.compiledConfiguration_h7im45$_0;
    this.definedFunctionNameNumberOfArgsSet_cdkc0l$_0 = this.definedFunctionNameNumberOfArgsSet_cdkc0l$_0;
  }
  Object.defineProperty(ExpressionComporator.prototype, 'compiledConfiguration', {
    get: function () {
      if (this.compiledConfiguration_h7im45$_0 == null)
        return throwUPAE('compiledConfiguration');
      return this.compiledConfiguration_h7im45$_0;
    },
    set: function (compiledConfiguration) {
      this.compiledConfiguration_h7im45$_0 = compiledConfiguration;
    }
  });
  Object.defineProperty(ExpressionComporator.prototype, 'definedFunctionNameNumberOfArgsSet', {
    get: function () {
      if (this.definedFunctionNameNumberOfArgsSet_cdkc0l$_0 == null)
        return throwUPAE('definedFunctionNameNumberOfArgsSet');
      return this.definedFunctionNameNumberOfArgsSet_cdkc0l$_0;
    },
    set: function (definedFunctionNameNumberOfArgsSet) {
      this.definedFunctionNameNumberOfArgsSet_cdkc0l$_0 = definedFunctionNameNumberOfArgsSet;
    }
  });
  ExpressionComporator.prototype.init_lwoezr$ = function (compiledConfiguration) {
    this.compiledConfiguration = compiledConfiguration;
    this.definedFunctionNameNumberOfArgsSet = compiledConfiguration.definedFunctionNameNumberOfArgsSet;
  };
  ExpressionComporator.prototype.compareAsIs_98xwbf$ = function (left, right, nameArgsMap, withBracketUnification) {
    if (nameArgsMap === void 0) {
      nameArgsMap = LinkedHashMap_init_0();
    }
    if (withBracketUnification === void 0)
      withBracketUnification = false;
    var normilized = normalizeExpressionsForComparison(left, right);
    if (normilized.first.isNodeSubtreeEquals_7j5kvs$(normilized.second, nameArgsMap)) {
      return true;
    }
     else if (!withBracketUnification) {
      return false;
    }
    var lUnified = normilized.first;
    lUnified.dropBracketNodesIfOperationsSame();
    var rUnified = normilized.second;
    rUnified.dropBracketNodesIfOperationsSame();
    if (lUnified.isNodeSubtreeEquals_7j5kvs$(rUnified, nameArgsMap)) {
      return true;
    }
    lUnified.normalizeSubTree_f8z7ch$(void 0, void 0, true);
    rUnified.normalizeSubTree_f8z7ch$(void 0, void 0, true);
    return lUnified.isNodeSubtreeEquals_7j5kvs$(rUnified, nameArgsMap);
  };
  ExpressionComporator.prototype.probabilityTestComparison_3fo6fu$ = function (leftOrigin, rightOrigin, comparisonType, justInDomainsIntersection, maxMinNumberOfPointsForEquality, allowedPartOfErrorTests, testWithUndefinedResultIncreasingCoef, useCleverDomain, useGradientDescentComparison) {
    if (comparisonType === void 0)
      comparisonType = this.compiledConfiguration.comparisonSettings.defaultComparisonType;
    if (justInDomainsIntersection === void 0)
      justInDomainsIntersection = this.compiledConfiguration.comparisonSettings.justInDomainsIntersection;
    if (maxMinNumberOfPointsForEquality === void 0)
      maxMinNumberOfPointsForEquality = this.compiledConfiguration.comparisonSettings.minNumberOfPointsForEquality;
    if (allowedPartOfErrorTests === void 0)
      allowedPartOfErrorTests = this.compiledConfiguration.comparisonSettings.allowedPartOfErrorTests;
    if (testWithUndefinedResultIncreasingCoef === void 0)
      testWithUndefinedResultIncreasingCoef = this.compiledConfiguration.comparisonSettings.testWithUndefinedResultIncreasingCoef;
    if (useCleverDomain === void 0)
      useCleverDomain = false;
    if (useGradientDescentComparison === void 0)
      useGradientDescentComparison = false;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10;
    var normalized = normalizeExpressionsForComparison(leftOrigin, rightOrigin);
    var left = normalized.first;
    var right = normalized.second;
    if (this.compareAsIs_98xwbf$(left, right)) {
      return !strictComparison(comparisonType);
    }
    if (right.children.isEmpty() || left.children.isEmpty()) {
      return false;
    }
    this.baseOperationsDefinitions.computeExpressionTree_6718cy$(left.children.get_za3lpa$(0));
    this.baseOperationsDefinitions.computeExpressionTree_6718cy$(right.children.get_za3lpa$(0));
    var numberOfRemainingTests = left.getCountOfNodes() + right.getCountOfNodes() | 0;
    if (comparisonType === ComparisonType$EQUAL_getInstance()) {
      var domain = new PointGenerator(this.baseOperationsDefinitions, arrayListOf([left, right]));
      var baseOperationsComputationComplex = new BaseOperationsComputation(ComputationType$COMPLEX_getInstance());
      var baseOperationsComputationDouble = new BaseOperationsComputation(ComputationType$DOUBLE_getInstance());
      var totalTests = numberOfRemainingTests;
      var passedTests = 0.0;
      var a = left.getMaxMinNumberOfPointsForEquality();
      var b = right.getMaxMinNumberOfPointsForEquality();
      var a_0 = Math_0.max(a, b);
      var minNumberOfPointsForEquality = Math_0.max(a_0, maxMinNumberOfPointsForEquality);
      while ((tmp$ = numberOfRemainingTests, numberOfRemainingTests = tmp$ - 1, tmp$) > 0) {
        var pointI = domain.generateNewPoint();
        var lDouble = typeof (tmp$_0 = baseOperationsComputationDouble.compute_6718cy$(left.cloneWithNormalization_1g1bdl$(pointI, false))) === 'number' ? tmp$_0 : throwCCE();
        var rDouble = typeof (tmp$_1 = baseOperationsComputationDouble.compute_6718cy$(right.cloneWithNormalization_1g1bdl$(pointI, false))) === 'number' ? tmp$_1 : throwCCE();
        if (isNaN_0(lDouble) || isNaN_0(rDouble)) {
          if (isNaN_0(lDouble) !== isNaN_0(rDouble) && justInDomainsIntersection) {
            return false;
          }
          var lComplex = Kotlin.isType(tmp$_2 = baseOperationsComputationComplex.compute_6718cy$(left.cloneWithNormalization_1g1bdl$(pointI, false)), Complex) ? tmp$_2 : throwCCE();
          var rComplex = Kotlin.isType(tmp$_3 = baseOperationsComputationComplex.compute_6718cy$(right.cloneWithNormalization_1g1bdl$(pointI, false)), Complex) ? tmp$_3 : throwCCE();
          if (lComplex.equals_i6s3kk$(rComplex)) {
            tmp$_4 = passedTests, passedTests = tmp$_4 + 1;
          }
        }
         else {
          if (!isFinite(lDouble) || !isFinite(rDouble)) {
            numberOfRemainingTests += testWithUndefinedResultIncreasingCoef;
          }
           else if (this.baseOperationsDefinitions.additivelyEqual_lu1900$(lDouble, rDouble)) {
            passedTests = passedTests + 1;
          }
           else
            return false;
        }
        if (passedTests >= minNumberOfPointsForEquality) {
          return true;
        }
      }
      return passedTests >= totalTests * (1 - allowedPartOfErrorTests) && passedTests >= minNumberOfPointsForEquality || passedTests >= totalTests;
    }
     else {
      if (useCleverDomain) {
        var domain_0 = new DomainPointGenerator(arrayListOf([left, right]), this.baseOperationsDefinitions);
        if (useGradientDescentComparison) {
          return gradientDescentComparison(left, right, this.compiledConfiguration, comparisonType, domain_0);
        }
         else {
          while ((tmp$_5 = numberOfRemainingTests, numberOfRemainingTests = tmp$_5 - 1, tmp$_5) > 0) {
            var pointI_0 = domain_0.generateNewPoint_mqu1mq$();
            tmp$_6 = toDoubleOrNull(this.baseOperationsDefinitions.computeExpressionTree_6718cy$(left.cloneWithNormalization_1g1bdl$(pointI_0, false)).value);
            if (tmp$_6 == null) {
              continue;
            }
            var l = tmp$_6;
            tmp$_7 = toDoubleOrNull(this.baseOperationsDefinitions.computeExpressionTree_6718cy$(right.cloneWithNormalization_1g1bdl$(pointI_0, false)).value);
            if (tmp$_7 == null) {
              continue;
            }
            var r = tmp$_7;
            if (justInDomainsIntersection && isNaN_0(l) !== isNaN_0(r)) {
              return false;
            }
             else if (!isFinite(l) || !isFinite(r)) {
              numberOfRemainingTests += testWithUndefinedResultIncreasingCoef;
            }
             else {
              switch (comparisonType.name) {
                case 'LEFT_MORE_OR_EQUAL':
                  if (l < r)
                    return false;
                  break;
                case 'LEFT_MORE':
                  if (l <= r)
                    return false;
                  break;
                case 'LEFT_LESS_OR_EQUAL':
                  if (l > r)
                    return false;
                  break;
                case 'LEFT_LESS':
                  if (l >= r)
                    return false;
                  break;
              }
            }
          }
          return true;
        }
      }
       else {
        var domain_1 = new PointGenerator(this.baseOperationsDefinitions, arrayListOf([left, right]));
        while ((tmp$_8 = numberOfRemainingTests, numberOfRemainingTests = tmp$_8 - 1, tmp$_8) > 0) {
          var pointI_1 = domain_1.generateNewPoint();
          tmp$_9 = toDoubleOrNull(this.baseOperationsDefinitions.computeExpressionTree_6718cy$(left.cloneWithNormalization_1g1bdl$(pointI_1, false)).value);
          if (tmp$_9 == null) {
            continue;
          }
          var l_0 = tmp$_9;
          tmp$_10 = toDoubleOrNull(this.baseOperationsDefinitions.computeExpressionTree_6718cy$(right.cloneWithNormalization_1g1bdl$(pointI_1, false)).value);
          if (tmp$_10 == null) {
            continue;
          }
          var r_0 = tmp$_10;
          if (justInDomainsIntersection && isNaN_0(l_0) !== isNaN_0(r_0)) {
            return false;
          }
           else if (!isFinite(l_0) || !isFinite(r_0)) {
            numberOfRemainingTests += testWithUndefinedResultIncreasingCoef;
          }
           else {
            switch (comparisonType.name) {
              case 'LEFT_MORE_OR_EQUAL':
                if (l_0 < r_0)
                  return false;
                break;
              case 'LEFT_MORE':
                if (l_0 <= r_0)
                  return false;
                break;
              case 'LEFT_LESS_OR_EQUAL':
                if (l_0 > r_0)
                  return false;
                break;
              case 'LEFT_LESS':
                if (l_0 >= r_0)
                  return false;
                break;
            }
          }
        }
        return true;
      }
    }
  };
  ExpressionComporator.prototype.compareWithoutSubstitutions_15tjed$ = function (l, r, comparisonType, definedFunctionNameNumberOfArgs, justInDomainsIntersection) {
    if (comparisonType === void 0)
      comparisonType = this.compiledConfiguration.comparisonSettings.defaultComparisonType;
    if (definedFunctionNameNumberOfArgs === void 0)
      definedFunctionNameNumberOfArgs = this.definedFunctionNameNumberOfArgsSet;
    if (justInDomainsIntersection === void 0)
      justInDomainsIntersection = this.compiledConfiguration.comparisonSettings.justInDomainsIntersection;
    if (this.compareAsIs_98xwbf$(l, r, void 0, false))
      return true;
    var left = l.clone();
    var right = r.clone();
    applyAllImmediateSubstitutions(left, this.compiledConfiguration);
    applyAllImmediateSubstitutions(right, this.compiledConfiguration);
    applyAllSubstitutions(left, this.compiledConfiguration.compiledFunctionDefinitions);
    applyAllSubstitutions(right, this.compiledConfiguration.compiledFunctionDefinitions);
    left.normalizeSubTree_f8z7ch$(void 0, void 0, true);
    right.normalizeSubTree_f8z7ch$(void 0, void 0, true);
    if (this.compiledConfiguration.comparisonSettings.compareExpressionsWithProbabilityRulesWhenComparingExpressions && !left.isBoolExpression_ywdfdh$(this.compiledConfiguration.functionConfiguration.boolFunctions) && !left.isBoolExpression_ywdfdh$(this.compiledConfiguration.functionConfiguration.boolFunctions)) {
      var functionIdentifierToVariableMap = LinkedHashMap_init_0();
      left.replaceNotDefinedFunctionsOnVariables_g22vlb$(functionIdentifierToVariableMap, definedFunctionNameNumberOfArgs, this);
      right.replaceNotDefinedFunctionsOnVariables_g22vlb$(functionIdentifierToVariableMap, definedFunctionNameNumberOfArgs, this);
      return this.probabilityTestComparison_3fo6fu$(left, right, comparisonType, justInDomainsIntersection);
    }
    return this.compareAsIs_98xwbf$(left.cloneAndSimplifyByCommutativeNormalizeAndComputeSimplePlaces_xcc95t$(this.compiledConfiguration), right.cloneAndSimplifyByCommutativeNormalizeAndComputeSimplePlaces_xcc95t$(this.compiledConfiguration), void 0, true);
  };
  ExpressionComporator.prototype.compareWithTreeTransformationRules_ob15jn$ = function (leftOriginal, rightOriginal, transformations, maxTransformationWeight, maxBustCount, minTransformationWeight, expressionChainComparisonType, maxDistBetweenDiffSteps) {
    var tmp$, tmp$_0;
    if (maxTransformationWeight === void 0)
      maxTransformationWeight = this.compiledConfiguration.comparisonSettings.maxExpressionTransformationWeight;
    if (maxBustCount === void 0)
      maxBustCount = this.compiledConfiguration.comparisonSettings.maxExpressionBustCount;
    if (minTransformationWeight === void 0) {
      var minBy$result;
      minBy$break: do {
        var iterator = transformations.iterator();
        if (!iterator.hasNext()) {
          minBy$result = null;
          break minBy$break;
        }
        var minElem = iterator.next();
        var minValue = minElem.weight;
        while (iterator.hasNext()) {
          var e = iterator.next();
          var v = e.weight;
          if (Kotlin.compareTo(minValue, v) > 0) {
            minElem = e;
            minValue = v;
          }
        }
        minBy$result = minElem;
      }
       while (false);
      minTransformationWeight = (tmp$_0 = (tmp$ = minBy$result) != null ? tmp$.weight : null) != null ? tmp$_0 : 1.0;
    }
    if (expressionChainComparisonType === void 0)
      expressionChainComparisonType = ComparisonType$EQUAL_getInstance();
    if (maxDistBetweenDiffSteps === void 0)
      maxDistBetweenDiffSteps = 1.0;
    var resultForOperandsInOriginalOrder = this.compareWithTreeTransformationRulesInternal_pe5b20$(leftOriginal, rightOriginal, transformations, maxTransformationWeight, maxBustCount, minTransformationWeight, expressionChainComparisonType, false, maxDistBetweenDiffSteps);
    if (resultForOperandsInOriginalOrder) {
      return true;
    }
     else {
      var resultForOperandsInSortedOrder = this.compareWithTreeTransformationRulesInternal_pe5b20$(leftOriginal, rightOriginal, transformations, maxTransformationWeight, maxBustCount, minTransformationWeight, expressionChainComparisonType, true, maxDistBetweenDiffSteps);
      return resultForOperandsInSortedOrder;
    }
  };
  function ExpressionComporator$compareWithTreeTransformationRulesInternal$lambda() {
    return "COMPARISON_SIGNS_CONFLICT '";
  }
  function ExpressionComporator$compareWithTreeTransformationRulesInternal$lambda_0() {
    return "' in expression vs '";
  }
  function ExpressionComporator$compareWithTreeTransformationRulesInternal$lambda_1() {
    return "' in rule. MSG_CODE_";
  }
  ExpressionComporator.prototype.compareWithTreeTransformationRulesInternal_pe5b20$ = function (leftOriginal, rightOriginal, transformations, maxTransformationWeight, maxBustCount, minTransformationWeight, expressionChainComparisonType, sortOperands, maxDistBetweenDiffSteps) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5;
    if (maxTransformationWeight === void 0)
      maxTransformationWeight = this.compiledConfiguration.comparisonSettings.maxExpressionTransformationWeight;
    if (maxBustCount === void 0)
      maxBustCount = this.compiledConfiguration.comparisonSettings.maxExpressionBustCount;
    if (minTransformationWeight === void 0) {
      var minBy$result;
      minBy$break: do {
        var iterator = transformations.iterator();
        if (!iterator.hasNext()) {
          minBy$result = null;
          break minBy$break;
        }
        var minElem = iterator.next();
        var minValue = minElem.weight;
        while (iterator.hasNext()) {
          var e = iterator.next();
          var v = e.weight;
          if (Kotlin.compareTo(minValue, v) > 0) {
            minElem = e;
            minValue = v;
          }
        }
        minBy$result = minElem;
      }
       while (false);
      minTransformationWeight = (tmp$_0 = (tmp$ = minBy$result) != null ? tmp$.weight : null) != null ? tmp$_0 : 1.0;
    }
    if (expressionChainComparisonType === void 0)
      expressionChainComparisonType = ComparisonType$EQUAL_getInstance();
    if (sortOperands === void 0)
      sortOperands = false;
    if (maxDistBetweenDiffSteps === void 0)
      maxDistBetweenDiffSteps = 1.0;
    var left = sortOperands ? leftOriginal.cloneWithSortingChildrenForExpressionSubstitutionComparison() : leftOriginal.clone();
    var right = sortOperands ? rightOriginal.cloneWithSortingChildrenForExpressionSubstitutionComparison() : rightOriginal.clone();
    applyAllImmediateSubstitutions(left, this.compiledConfiguration);
    applyAllImmediateSubstitutions(right, this.compiledConfiguration);
    if (maxTransformationWeight < 0.5) {
      tmp$_1 = this.compiledConfiguration.noTransformationDefinedFunctionNameNumberOfArgsSet;
    }
     else {
      tmp$_1 = this.compiledConfiguration.definedFunctionNameNumberOfArgsSet;
    }
    this.definedFunctionNameNumberOfArgsSet = tmp$_1;
    if (this.compareWithoutSubstitutions_15tjed$(left, right, expressionChainComparisonType))
      return true;
    if (maxTransformationWeight < minTransformationWeight)
      return false;
    if (containsDifferentiation(left) || containsDifferentiation(right)) {
      var leftDiffWeight = toMutableList(plus(listOf(0.0), maxDistBetweenDiffSteps > unlimitedWeight ? listOf(maxDistBetweenDiffSteps) : emptyList()));
      var rightDiffWeight = toMutableList(plus(listOf(0.0), maxDistBetweenDiffSteps > unlimitedWeight ? listOf(maxDistBetweenDiffSteps) : emptyList()));
      var leftDiff = diff(left, leftDiffWeight, this.compiledConfiguration);
      var rightDiff = diff(right, rightDiffWeight, this.compiledConfiguration);
      var x = leftDiffWeight.get_za3lpa$(0) - rightDiffWeight.get_za3lpa$(0);
      if (Math_0.abs(x) < maxDistBetweenDiffSteps && this.compareWithoutSubstitutions_15tjed$(leftDiff, rightDiff, expressionChainComparisonType)) {
        return true;
      }
    }
    var functionsInExpression = plus_0(left.getContainedFunctions(), right.getContainedFunctions());
    var destination = ArrayList_init();
    var tmp$_6;
    tmp$_6 = transformations.iterator();
    while (tmp$_6.hasNext()) {
      var element = tmp$_6.next();
      if (element.weight <= maxTransformationWeight)
        destination.add_11rb$(element);
    }
    tmp$_2 = destination.iterator();
    while (tmp$_2.hasNext()) {
      var originalTransformation = tmp$_2.next();
      var tmp$_7 = !originalTransformation.basedOnTaskContext;
      if (tmp$_7) {
        tmp$_7 = !originalTransformation.leftFunctions.isEmpty();
      }
      if (tmp$_7 && intersect(functionsInExpression, originalTransformation.leftFunctions).isEmpty()) {
        continue;
      }
      if (sortOperands) {
        tmp$_3 = new ExpressionSubstitution(originalTransformation.left.cloneWithSortingChildrenForExpressionSubstitutionComparison(), originalTransformation.right.cloneWithSortingChildrenForExpressionSubstitutionComparison(), originalTransformation.weight, originalTransformation.basedOnTaskContext, originalTransformation.code, void 0, void 0, originalTransformation.comparisonType);
      }
       else {
        tmp$_3 = originalTransformation;
      }
      var transformation = tmp$_3;
      var l = sortOperands ? left.cloneWithSortingChildrenForExpressionSubstitutionComparison() : left.clone();
      var r = sortOperands ? right.cloneWithSortingChildrenForExpressionSubstitutionComparison() : right.clone();
      var direction = getComparingDirection(expressionChainComparisonType, transformation.comparisonType);
      if (direction == null) {
        log_1.add_gqvic5$(expressionChainComparisonType.string, transformation.comparisonType.string, ExpressionComporator$compareWithTreeTransformationRulesInternal$lambda, ExpressionComporator$compareWithTreeTransformationRulesInternal$lambda_0, ExpressionComporator$compareWithTreeTransformationRulesInternal$lambda_1, void 0, void 0, MessageType$USER_getInstance());
      }
      if (!equals(direction, SubstitutionDirection$RIGHT_TO_LEFT_getInstance())) {
        tmp$_4 = transformation.findAllPossibleSubstitutionPlaces_6718cy$(l);
      }
       else {
        tmp$_4 = emptyList();
      }
      if (!equals(direction, SubstitutionDirection$LEFT_TO_RIGHT_getInstance())) {
        tmp$_5 = transformation.findAllPossibleSubstitutionPlaces_6718cy$(r);
      }
       else {
        tmp$_5 = emptyList();
      }
      var substitutionPlaces = plus(tmp$_4, tmp$_5);
      var bitMaskCount = 1 << substitutionPlaces.size;
      if (Kotlin.imul(bitMaskCount, transformations.size) > maxBustCount) {
        transformation.applySubstitution_55nkop$(substitutionPlaces);
        if (this.compareWithTreeTransformationRulesInternal_pe5b20$(l, r, transformations, maxTransformationWeight - transformation.weight, maxBustCount, minTransformationWeight, expressionChainComparisonType, sortOperands))
          return true;
      }
       else {
        for (var bitMask = 1; bitMask < bitMaskCount; bitMask++) {
          transformation.applySubstitutionByBitMask_eqestx$(substitutionPlaces, bitMask);
          if (this.compareWithTreeTransformationRulesInternal_pe5b20$(l.clone(), r.clone(), transformations, maxTransformationWeight - transformation.weight, maxBustCount, minTransformationWeight, expressionChainComparisonType, sortOperands))
            return true;
        }
      }
    }
    return false;
  };
  ExpressionComporator.prototype.fullExpressionsCompare_c3m35x$ = function (left, right, expressionChainComparisonType) {
    if (expressionChainComparisonType === void 0)
      expressionChainComparisonType = ComparisonType$EQUAL_getInstance();
    applyAllSubstitutions(left, this.compiledConfiguration.compiledImmediateTreeTransformationRules);
    applyAllSubstitutions(right, this.compiledConfiguration.compiledImmediateTreeTransformationRules);
    if (this.compiledConfiguration.comparisonSettings.isComparisonWithRules) {
      if (this.compareWithTreeTransformationRulesInternal_pe5b20$(left, right, this.compiledConfiguration.compiledExpressionTreeTransformationRules, this.compiledConfiguration.comparisonSettings.maxTransformationWeight, this.compiledConfiguration.comparisonSettings.maxBustCount, void 0, expressionChainComparisonType))
        return true;
      this.baseOperationsDefinitions.computeExpressionTree_6718cy$(left.children.get_za3lpa$(0));
      this.baseOperationsDefinitions.computeExpressionTree_6718cy$(right.children.get_za3lpa$(0));
      if (this.compareWithTreeTransformationRulesInternal_pe5b20$(left, right, this.compiledConfiguration.compiledExpressionTreeTransformationRules, this.compiledConfiguration.comparisonSettings.maxTransformationWeight, this.compiledConfiguration.comparisonSettings.maxBustCount, void 0, expressionChainComparisonType))
        return true;
    }
     else {
      if (this.compareWithoutSubstitutions_15tjed$(left, right))
        return true;
    }
    return false;
  };
  ExpressionComporator.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionComporator',
    interfaces: []
  };
  function getComparingDirection(expressionChainComparisonType, transformationComparisonType) {
    var tmp$;
    switch (expressionChainComparisonType.name) {
      case 'EQUAL':
        tmp$ = transformationComparisonType === ComparisonType$EQUAL_getInstance() ? SubstitutionDirection$ALL_TO_ALL_getInstance() : null;
        break;
      case 'LEFT_MORE_OR_EQUAL':
        switch (transformationComparisonType.name) {
          case 'EQUAL':
            tmp$ = SubstitutionDirection$ALL_TO_ALL_getInstance();
            break;
          case 'LEFT_MORE_OR_EQUAL':
          case 'LEFT_MORE':
            tmp$ = SubstitutionDirection$LEFT_TO_RIGHT_getInstance();
            break;
          case 'LEFT_LESS_OR_EQUAL':
          case 'LEFT_LESS':
            tmp$ = SubstitutionDirection$RIGHT_TO_LEFT_getInstance();
            break;
          default:tmp$ = Kotlin.noWhenBranchMatched();
            break;
        }

        break;
      case 'LEFT_LESS_OR_EQUAL':
        switch (transformationComparisonType.name) {
          case 'EQUAL':
            tmp$ = SubstitutionDirection$ALL_TO_ALL_getInstance();
            break;
          case 'LEFT_MORE_OR_EQUAL':
          case 'LEFT_MORE':
            tmp$ = SubstitutionDirection$RIGHT_TO_LEFT_getInstance();
            break;
          case 'LEFT_LESS_OR_EQUAL':
          case 'LEFT_LESS':
            tmp$ = SubstitutionDirection$LEFT_TO_RIGHT_getInstance();
            break;
          default:tmp$ = Kotlin.noWhenBranchMatched();
            break;
        }

        break;
      case 'LEFT_MORE':
        switch (transformationComparisonType.name) {
          case 'LEFT_MORE':
            tmp$ = SubstitutionDirection$LEFT_TO_RIGHT_getInstance();
            break;
          case 'LEFT_LESS':
            tmp$ = SubstitutionDirection$RIGHT_TO_LEFT_getInstance();
            break;
          default:tmp$ = null;
            break;
        }

        break;
      case 'LEFT_LESS':
        switch (transformationComparisonType.name) {
          case 'LEFT_MORE':
            tmp$ = SubstitutionDirection$RIGHT_TO_LEFT_getInstance();
            break;
          case 'LEFT_LESS':
            tmp$ = SubstitutionDirection$LEFT_TO_RIGHT_getInstance();
            break;
          default:tmp$ = null;
            break;
        }

        break;
      default:tmp$ = Kotlin.noWhenBranchMatched();
        break;
    }
    return tmp$;
  }
  function Comparator$ObjectLiteral_0(closure$comparison) {
    this.closure$comparison = closure$comparison;
  }
  Comparator$ObjectLiteral_0.prototype.compare = function (a, b) {
    return this.closure$comparison(a, b);
  };
  Comparator$ObjectLiteral_0.$metadata$ = {kind: Kind_CLASS, interfaces: [Comparator]};
  var compareBy$lambda = wrapFunction(function () {
    var compareValues = Kotlin.kotlin.comparisons.compareValues_s00gnj$;
    return function (closure$selector) {
      return function (a, b) {
        var selector = closure$selector;
        return compareValues(selector(a), selector(b));
      };
    };
  });
  function Comparator$ObjectLiteral_1(closure$comparison) {
    this.closure$comparison = closure$comparison;
  }
  Comparator$ObjectLiteral_1.prototype.compare = function (a, b) {
    return this.closure$comparison(a, b);
  };
  Comparator$ObjectLiteral_1.$metadata$ = {kind: Kind_CLASS, interfaces: [Comparator]};
  var compareBy$lambda_0 = wrapFunction(function () {
    var compareValues = Kotlin.kotlin.comparisons.compareValues_s00gnj$;
    return function (closure$selector) {
      return function (a, b) {
        var selector = closure$selector;
        return compareValues(selector(a), selector(b));
      };
    };
  });
  function Comparator$ObjectLiteral_2(closure$comparison) {
    this.closure$comparison = closure$comparison;
  }
  Comparator$ObjectLiteral_2.prototype.compare = function (a, b) {
    return this.closure$comparison(a, b);
  };
  Comparator$ObjectLiteral_2.$metadata$ = {kind: Kind_CLASS, interfaces: [Comparator]};
  function NodeType(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function NodeType_initFields() {
    NodeType_initFields = function () {
    };
    NodeType$FUNCTION_instance = new NodeType('FUNCTION', 0);
    NodeType$VARIABLE_instance = new NodeType('VARIABLE', 1);
    NodeType$EMPTY_instance = new NodeType('EMPTY', 2);
    NodeType$ERROR_instance = new NodeType('ERROR', 3);
  }
  var NodeType$FUNCTION_instance;
  function NodeType$FUNCTION_getInstance() {
    NodeType_initFields();
    return NodeType$FUNCTION_instance;
  }
  var NodeType$VARIABLE_instance;
  function NodeType$VARIABLE_getInstance() {
    NodeType_initFields();
    return NodeType$VARIABLE_instance;
  }
  var NodeType$EMPTY_instance;
  function NodeType$EMPTY_getInstance() {
    NodeType_initFields();
    return NodeType$EMPTY_instance;
  }
  var NodeType$ERROR_instance;
  function NodeType$ERROR_getInstance() {
    NodeType_initFields();
    return NodeType$ERROR_instance;
  }
  NodeType.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'NodeType',
    interfaces: [Enum]
  };
  function NodeType$values() {
    return [NodeType$FUNCTION_getInstance(), NodeType$VARIABLE_getInstance(), NodeType$EMPTY_getInstance(), NodeType$ERROR_getInstance()];
  }
  NodeType.values = NodeType$values;
  function NodeType$valueOf(name) {
    switch (name) {
      case 'FUNCTION':
        return NodeType$FUNCTION_getInstance();
      case 'VARIABLE':
        return NodeType$VARIABLE_getInstance();
      case 'EMPTY':
        return NodeType$EMPTY_getInstance();
      case 'ERROR':
        return NodeType$ERROR_getInstance();
      default:throwISE('No enum constant expressiontree.NodeType.' + name);
    }
  }
  NodeType.valueOf_61zpoe$ = NodeType$valueOf;
  function NodeValue(exactNumber) {
    this.exactNumber = exactNumber;
  }
  NodeValue.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'NodeValue',
    interfaces: []
  };
  NodeValue.prototype.component1 = function () {
    return this.exactNumber;
  };
  NodeValue.prototype.copy_za3lpa$ = function (exactNumber) {
    return new NodeValue(exactNumber === void 0 ? this.exactNumber : exactNumber);
  };
  NodeValue.prototype.toString = function () {
    return 'NodeValue(exactNumber=' + Kotlin.toString(this.exactNumber) + ')';
  };
  NodeValue.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.exactNumber) | 0;
    return result;
  };
  NodeValue.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && Kotlin.equals(this.exactNumber, other.exactNumber))));
  };
  function ExpressionStrictureIdentifier(originalOrderIdentifier, commutativeSortedIdentifier) {
    this.originalOrderIdentifier = originalOrderIdentifier;
    this.commutativeSortedIdentifier = commutativeSortedIdentifier;
  }
  ExpressionStrictureIdentifier.prototype.equals = function (other) {
    if (Kotlin.isType(other, ExpressionStrictureIdentifier))
      return equals(this.originalOrderIdentifier, other.originalOrderIdentifier) || equals(this.commutativeSortedIdentifier, other.commutativeSortedIdentifier);
    else
      return false;
  };
  ExpressionStrictureIdentifier.prototype.hashCode = function () {
    return 1;
  };
  ExpressionStrictureIdentifier.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionStrictureIdentifier',
    interfaces: []
  };
  ExpressionStrictureIdentifier.prototype.component1 = function () {
    return this.originalOrderIdentifier;
  };
  ExpressionStrictureIdentifier.prototype.component2 = function () {
    return this.commutativeSortedIdentifier;
  };
  ExpressionStrictureIdentifier.prototype.copy_puj7f4$ = function (originalOrderIdentifier, commutativeSortedIdentifier) {
    return new ExpressionStrictureIdentifier(originalOrderIdentifier === void 0 ? this.originalOrderIdentifier : originalOrderIdentifier, commutativeSortedIdentifier === void 0 ? this.commutativeSortedIdentifier : commutativeSortedIdentifier);
  };
  ExpressionStrictureIdentifier.prototype.toString = function () {
    return 'ExpressionStrictureIdentifier(originalOrderIdentifier=' + Kotlin.toString(this.originalOrderIdentifier) + (', commutativeSortedIdentifier=' + Kotlin.toString(this.commutativeSortedIdentifier)) + ')';
  };
  function ExpressionNode(nodeType, value, startPosition, endPosition, subValue, parent, functionStringDefinition, identifier, nodeId, distanceToRoot, expressionStrictureIdentifier) {
    if (startPosition === void 0)
      startPosition = -1;
    if (endPosition === void 0)
      endPosition = -1;
    if (subValue === void 0)
      subValue = '';
    if (parent === void 0)
      parent = null;
    if (functionStringDefinition === void 0)
      functionStringDefinition = null;
    if (identifier === void 0)
      identifier = '';
    if (nodeId === void 0)
      nodeId = -1;
    if (distanceToRoot === void 0)
      distanceToRoot = 0;
    if (expressionStrictureIdentifier === void 0)
      expressionStrictureIdentifier = null;
    this.nodeType = nodeType;
    this.value = value;
    this.startPosition = startPosition;
    this.endPosition = endPosition;
    this.subValue = subValue;
    this.parent = parent;
    this.functionStringDefinition = functionStringDefinition;
    this.identifier = identifier;
    this.nodeId = nodeId;
    this.distanceToRoot = distanceToRoot;
    this.expressionStrictureIdentifier = expressionStrictureIdentifier;
    this.children = ArrayList_init();
    this.rules = ArrayList_init();
    this.parserMark = '';
    this.linkOnOriginalTreeNode = null;
  }
  ExpressionNode.prototype.addChild_6718cy$ = function (newNode) {
    this.children.add_11rb$(newNode);
    newNode.parent = this;
  };
  ExpressionNode.prototype.addChildOnPosition_tvfpvg$ = function (newNode, position) {
    this.children.add_wxm5ur$(position, newNode);
    newNode.parent = this;
  };
  ExpressionNode.prototype.setChildOnPosition_tvfpvg$ = function (newNode, position) {
    this.children.set_wxm5ur$(position, newNode);
    newNode.parent = this;
  };
  ExpressionNode.prototype.setVariable_61zpoe$ = function (value) {
    this.setVariableWithoutChildrenClearing_61zpoe$(value);
    this.children.clear();
  };
  ExpressionNode.prototype.setVariableWithoutChildrenClearing_61zpoe$ = function (value) {
    this.nodeType = NodeType$VARIABLE_getInstance();
    this.value = value;
    this.identifier = value;
    this.functionStringDefinition = null;
  };
  ExpressionNode.prototype.setNode_6718cy$ = function (value) {
    this.nodeType = value.nodeType;
    this.value = value.value;
    this.identifier = value.identifier;
    this.functionStringDefinition = value.functionStringDefinition;
    this.children.clear();
    this.children = value.children;
    this.subValue = value.subValue;
    value.parent = this;
  };
  ExpressionNode.prototype.isNumberValue = function () {
    return !isBlank(this.value) && (isNumberPart(first_0(this.value)) || equals(this.value, '\u03C0'));
  };
  ExpressionNode.prototype.getNodeValueString = function () {
    return this.value;
  };
  ExpressionNode.prototype.getTopNode = function () {
    var result = this;
    while (result.parent != null) {
      result = ensureNotNull(result.parent);
    }
    return result;
  };
  ExpressionNode.prototype.getChildNodesOnDepthOrWhileOperation_okkhzr$ = function (depth, operationList) {
    var tmp$;
    var result = ArrayList_init();
    if (depth < 1 && !operationList.contains_11rb$(this.value))
      return result;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      result.add_11rb$(child);
      result.addAll_brywnq$(child.getChildNodesOnDepthOrWhileOperation_okkhzr$(depth - 1 | 0, operationList));
    }
    return result;
  };
  ExpressionNode.prototype.getChildNodesWhileOperation_mhpeer$ = function (operationList) {
    var tmp$;
    var result = ArrayList_init();
    if (!operationList.contains_11rb$(this.value)) {
      result.add_11rb$(this);
    }
     else {
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        result.addAll_brywnq$(child.getChildNodesWhileOperation_mhpeer$(operationList));
      }
    }
    return result;
  };
  ExpressionNode.prototype.resetNodeIds = function () {
    var tmp$;
    this.nodeId = -1;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      child.resetNodeIds();
    }
  };
  ExpressionNode.prototype.computeNodeIdsAsNumbersInDirectTraversalAndDistancesToRoot_ydzd23$ = function (startId, startDistance, replaceCalculatedNodeIds) {
    if (startId === void 0)
      startId = 0;
    if (startDistance === void 0)
      startDistance = 0;
    if (replaceCalculatedNodeIds === void 0)
      replaceCalculatedNodeIds = true;
    var tmp$;
    if (replaceCalculatedNodeIds || this.nodeId < 0) {
      this.nodeId = startId;
    }
    var currentStartId = startId + 1 | 0;
    this.distanceToRoot = startDistance;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      currentStartId = child.computeNodeIdsAsNumbersInDirectTraversalAndDistancesToRoot_ydzd23$(currentStartId, startDistance + 1 | 0, replaceCalculatedNodeIds);
    }
    return currentStartId;
  };
  ExpressionNode.prototype.correctPositions = function () {
    var tmp$;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      child.correctPositions();
      if (child.startPosition < this.startPosition) {
        this.startPosition = child.startPosition;
      }
      if (child.endPosition > this.endPosition) {
        this.endPosition = child.endPosition;
      }
    }
  };
  ExpressionNode.prototype.normalizeParentLinks = function () {
    var tmp$;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      child.normalizeParentLinks();
      child.parent = this;
    }
  };
  ExpressionNode.prototype.normalizeFunctionStringDefinitions_hee78y$ = function (functionConfiguration) {
    var tmp$;
    this.functionStringDefinition = functionConfiguration.fastFindStringDefinitionByNameAndNumberOfArguments_bm4lxs$(this.value, this.children.size);
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      child.normalizeFunctionStringDefinitions_hee78y$(functionConfiguration);
    }
  };
  ExpressionNode.prototype.reduceExtraSigns_9jge9g$ = function (extraUnaryFunctions, exclusionChildFunctions) {
    if (exclusionChildFunctions === void 0) {
      exclusionChildFunctions = emptySet();
    }
    for (var i = get_lastIndex(this.children); i >= 0; i--) {
      this.children.get_za3lpa$(i).reduceExtraSigns_9jge9g$(extraUnaryFunctions, exclusionChildFunctions);
      if ((this.children.size === 1 || !extraUnaryFunctions.contains_11rb$(this.value)) && this.children.get_za3lpa$(i).children.size === 1 && extraUnaryFunctions.contains_11rb$(this.children.get_za3lpa$(i).value) && !exclusionChildFunctions.contains_11rb$(first(this.children.get_za3lpa$(i).children).value)) {
        this.children.set_wxm5ur$(i, first(this.children.get_za3lpa$(i).children));
        this.children.get_za3lpa$(i).parent = this;
      }
    }
  };
  ExpressionNode.prototype.normilizeSubtructions_hee78y$ = function (functionConfiguration) {
    for (var i = get_lastIndex(this.children); i >= 0; i--) {
      this.children.get_za3lpa$(i).normilizeSubtructions_hee78y$(functionConfiguration);
      if (this.children.get_za3lpa$(i).nodeType === NodeType$VARIABLE_getInstance() && startsWith(this.children.get_za3lpa$(i).value, '-')) {
        var double = toDoubleOrNull(this.children.get_za3lpa$(i).value);
        if (double != null && double <= 0) {
          if (equals(this.value, '-')) {
            this.setVariable_61zpoe$((-double).toString());
          }
           else {
            var valueNode = new ExpressionNode(NodeType$VARIABLE_getInstance(), toShortString(-double));
            var minusNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '-');
            minusNode.addChild_6718cy$(valueNode);
            if (!equals(this.value, '+')) {
              this.children.set_wxm5ur$(i, minusNode);
              minusNode.parent = this;
            }
             else {
              var plusNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '+');
              plusNode.addChild_6718cy$(minusNode);
              this.children.set_wxm5ur$(i, plusNode);
              plusNode.parent = this;
            }
          }
        }
      }
      if (!this.children.isEmpty() && equals(this.children.get_za3lpa$(i).value, '-') && !equals(this.value, '+')) {
        var plusParent = new ExpressionNode(NodeType$FUNCTION_getInstance(), '+', this.children.get_za3lpa$(i).startPosition, this.children.get_za3lpa$(i).endPosition, '', this, functionConfiguration.fastFindStringDefinitionByNameAndNumberOfArguments_bm4lxs$('+', 1));
        plusParent.addChild_6718cy$(this.children.get_za3lpa$(i));
        this.children.set_wxm5ur$(i, plusParent);
      }
    }
  };
  ExpressionNode.prototype.normalizeNullWeightCommutativeFunctions = function () {
    var tmp$, tmp$_0;
    for (var i = get_lastIndex(this.children); i >= 0; i--) {
      this.children.get_za3lpa$(i).normalizeNullWeightCommutativeFunctions();
      if (this.children.get_za3lpa$(i).children.size === 1 && ((tmp$_0 = (tmp$ = this.children.get_za3lpa$(i).functionStringDefinition) != null ? tmp$.function : null) != null ? tmp$_0.isCommutativeWithNullWeight : null) === true) {
        first(this.children.get_za3lpa$(i).children).parent = this;
        this.children.set_wxm5ur$(i, first(this.children.get_za3lpa$(i).children));
      }
    }
  };
  function ExpressionNode$fillStructureStringIdentifiers$lambda(it) {
    return it.getNodeValueString();
  }
  function ExpressionNode$fillStructureStringIdentifiers$lambda_0(it) {
    return ensureNotNull(it.expressionStrictureIdentifier).originalOrderIdentifier;
  }
  function ExpressionNode$fillStructureStringIdentifiers$lambda_1(it) {
    return ensureNotNull(it.expressionStrictureIdentifier).commutativeSortedIdentifier;
  }
  function ExpressionNode$fillStructureStringIdentifiers$lambda_2(it) {
    return ensureNotNull(it.expressionStrictureIdentifier).commutativeSortedIdentifier;
  }
  function ExpressionNode$fillStructureStringIdentifiers$lambda_3(it) {
    return ensureNotNull(it.expressionStrictureIdentifier).commutativeSortedIdentifier;
  }
  ExpressionNode.prototype.fillStructureStringIdentifiers_t6ztn0$ = function (getNodeValueString) {
    if (getNodeValueString === void 0)
      getNodeValueString = ExpressionNode$fillStructureStringIdentifiers$lambda;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4;
    if (this.nodeType === NodeType$VARIABLE_getInstance()) {
      var v = getNodeValueString(this);
      this.expressionStrictureIdentifier = new ExpressionStrictureIdentifier(v, v);
    }
     else {
      var start = this.value + '(';
      this.expressionStrictureIdentifier = new ExpressionStrictureIdentifier(start, start);
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        child.fillStructureStringIdentifiers_t6ztn0$(getNodeValueString);
      }
      ensureNotNull(this.expressionStrictureIdentifier).originalOrderIdentifier = ensureNotNull(this.expressionStrictureIdentifier).originalOrderIdentifier + joinToString(this.children, ';', void 0, void 0, void 0, void 0, ExpressionNode$fillStructureStringIdentifiers$lambda_0);
      tmp$_3 = ensureNotNull(this.expressionStrictureIdentifier);
      tmp$_4 = tmp$_3.commutativeSortedIdentifier;
      if (((tmp$_1 = (tmp$_0 = this.functionStringDefinition) != null ? tmp$_0.function : null) != null ? tmp$_1.isCommutativeWithNullWeight : null) === true) {
        tmp$_2 = joinToString(sortedWith(this.children, new Comparator$ObjectLiteral_0(compareBy$lambda(ExpressionNode$fillStructureStringIdentifiers$lambda_1))), ';', void 0, void 0, void 0, void 0, ExpressionNode$fillStructureStringIdentifiers$lambda_2);
      }
       else {
        tmp$_2 = joinToString(this.children, ';', void 0, void 0, void 0, void 0, ExpressionNode$fillStructureStringIdentifiers$lambda_3);
      }
      tmp$_3.commutativeSortedIdentifier = tmp$_4 + tmp$_2;
      ensureNotNull(this.expressionStrictureIdentifier).originalOrderIdentifier = ensureNotNull(this.expressionStrictureIdentifier).originalOrderIdentifier + ')';
      ensureNotNull(this.expressionStrictureIdentifier).commutativeSortedIdentifier = ensureNotNull(this.expressionStrictureIdentifier).commutativeSortedIdentifier + ')';
    }
  };
  function ExpressionNode$computeIdentifier$lambda(it) {
    return it.getNodeValueString();
  }
  ExpressionNode.prototype.computeIdentifier_t6ztn0$ = function (getNodeValueString) {
    if (getNodeValueString === void 0)
      getNodeValueString = ExpressionNode$computeIdentifier$lambda;
    var tmp$;
    if (this.nodeType === NodeType$VARIABLE_getInstance()) {
      this.identifier = getNodeValueString(this);
    }
     else {
      this.identifier = this.value + '(';
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        this.identifier += child.computeIdentifier_t6ztn0$(getNodeValueString) + ';';
      }
      if (this.children.size > 0) {
        var $receiver = this.identifier;
        var endIndex = this.identifier.length - 1 | 0;
        this.identifier = $receiver.substring(0, endIndex);
      }
      this.identifier += ')';
    }
    return this.identifier;
  };
  function ExpressionNode$computeIdentifierWithPositions$lambda(it) {
    return it.getNodeValueString();
  }
  ExpressionNode.prototype.computeIdentifierWithPositions_t6ztn0$ = function (getNodeValueString) {
    if (getNodeValueString === void 0)
      getNodeValueString = ExpressionNode$computeIdentifierWithPositions$lambda;
    var tmp$;
    if (this.nodeType === NodeType$VARIABLE_getInstance()) {
      this.identifier = getNodeValueString(this);
    }
     else {
      this.identifier = this.value + '(';
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        this.identifier += child.computeIdentifierWithPositions_t6ztn0$(getNodeValueString) + ';';
      }
      if (this.children.size > 0) {
        var $receiver = this.identifier;
        var endIndex = this.identifier.length - 1 | 0;
        this.identifier = $receiver.substring(0, endIndex);
      }
      this.identifier += ')';
    }
    return this.identifier + ('{' + this.startPosition + ';' + this.endPosition + '}');
  };
  function ExpressionNode$toStringsWithPositions$lambda(it) {
    return it.getNodeValueString();
  }
  ExpressionNode.prototype.toStringsWithPositions_2befga$ = function (getNodeValueString, offset) {
    if (getNodeValueString === void 0)
      getNodeValueString = ExpressionNode$toStringsWithPositions$lambda;
    if (offset === void 0)
      offset = '';
    var tmp$;
    if (this.nodeType === NodeType$VARIABLE_getInstance()) {
      this.identifier = offset + getNodeValueString(this) + ('  :  [' + this.startPosition + '; ' + this.endPosition + '; ' + this.nodeId + ']' + '\n');
    }
     else {
      this.identifier = offset + this.value + ('  :  [' + this.startPosition + '; ' + this.endPosition + '; ' + this.nodeId + ']' + '\n');
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        this.identifier += child.toStringsWithPositions_2befga$(getNodeValueString, offset + '  ');
      }
    }
    return this.identifier;
  };
  function ExpressionNode$toStringsWithNodeIds$lambda(it) {
    return it.getNodeValueString();
  }
  ExpressionNode.prototype.toStringsWithNodeIds_2befga$ = function (getNodeValueString, offset) {
    if (getNodeValueString === void 0)
      getNodeValueString = ExpressionNode$toStringsWithNodeIds$lambda;
    if (offset === void 0)
      offset = '';
    var tmp$;
    if (this.nodeType === NodeType$VARIABLE_getInstance()) {
      this.identifier = offset + getNodeValueString(this) + ('  :  [' + this.nodeId + ']' + '\n');
    }
     else {
      this.identifier = offset + this.value + ('  :  [' + this.nodeId + ']' + '\n');
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        this.identifier += child.toStringsWithNodeIds_2befga$(getNodeValueString, offset + '  ');
      }
    }
    return this.identifier;
  };
  function ExpressionNode$toPlainTextView$lambda(it) {
    return it.getNodeValueString();
  }
  ExpressionNode.prototype.toPlainTextView_odr8sm$ = function (functionConfiguration, getNodeValueString) {
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration();
    if (getNodeValueString === void 0)
      getNodeValueString = ExpressionNode$toPlainTextView$lambda;
    var tmp$;
    var result = this.toPlainTextViewRec_0(functionConfiguration, getNodeValueString);
    if (first_0(result) === 40 && last_0(result) === 41) {
      var numberOfOpenBrackets = 1;
      var currentIndex = 1;
      while (currentIndex < result.length && numberOfOpenBrackets > 0) {
        if (result.charCodeAt(currentIndex) === 40) {
          numberOfOpenBrackets = numberOfOpenBrackets + 1 | 0;
        }
         else if (result.charCodeAt(currentIndex) === 41) {
          tmp$ = numberOfOpenBrackets, numberOfOpenBrackets = tmp$ - 1 | 0;
        }
        currentIndex = currentIndex + 1 | 0;
      }
      if (currentIndex >= get_lastIndex_0(result)) {
        var $receiver = result;
        var endIndex = result.length - 1 | 0;
        result = $receiver.substring(1, endIndex);
      }
    }
    return result;
  };
  function ExpressionNode$toPlainTextViewRec$lambda(it) {
    return it.getNodeValueString();
  }
  ExpressionNode.prototype.toPlainTextViewRec_0 = function (functionConfiguration, getNodeValueString) {
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration();
    if (getNodeValueString === void 0)
      getNodeValueString = ExpressionNode$toPlainTextViewRec$lambda;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5;
    var identifier = '';
    if (this.nodeType === NodeType$VARIABLE_getInstance()) {
      identifier = getNodeValueString(this);
    }
     else if (equals(this.value, '') && this.children.size === 1) {
      identifier = first(this.children).toPlainTextViewRec_0(functionConfiguration);
    }
     else {
      var $receiver = functionConfiguration.functionProperties;
      var destination = ArrayList_init();
      var tmp$_6;
      tmp$_6 = $receiver.iterator();
      while (tmp$_6.hasNext()) {
        var element = tmp$_6.next();
        if (equals(element.function, this.value) && element.defaultStringDefinitionType !== StringDefinitionType$FUNCTION_getInstance())
          destination.add_11rb$(element);
      }
      if (!destination.isEmpty()) {
        var $receiver_0 = functionConfiguration.functionProperties;
        var firstOrNull$result;
        firstOrNull$break: do {
          var tmp$_7;
          tmp$_7 = $receiver_0.iterator();
          while (tmp$_7.hasNext()) {
            var element_0 = tmp$_7.next();
            if (equals(element_0.function, this.value)) {
              firstOrNull$result = element_0;
              break firstOrNull$break;
            }
          }
          firstOrNull$result = null;
        }
         while (false);
        var functionIdentifier = ensureNotNull(firstOrNull$result);
        switch (functionIdentifier.defaultStringDefinitionType.name) {
          case 'BINARY_OPERATION':
            if (this.binaryOperationNeedBrackets_0()) {
              identifier = '(';
            }

            tmp$ = this.children.iterator();
            while (tmp$.hasNext()) {
              var child = tmp$.next();
              if (equals((tmp$_0 = functionConfiguration.functionPropertiesByName.get_11rb$(child.value + '_-1')) != null ? tmp$_0.mainFunction : null, functionIdentifier.function) && !equals((tmp$_1 = functionConfiguration.functionPropertiesByName.get_11rb$(child.value + '_-1')) != null ? tmp$_1.function : null, functionIdentifier.function)) {
                if (identifier.length > 1) {
                  var $receiver_1 = identifier;
                  var endIndex = identifier.length - functionIdentifier.plainTextRepresentation.length | 0;
                  identifier = $receiver_1.substring(0, endIndex);
                }
                identifier += ensureNotNull(functionConfiguration.functionPropertiesByName.get_11rb$(child.value + '_-1')).function;
                identifier += first(child.children).toPlainTextViewRec_0(functionConfiguration) + functionIdentifier.plainTextRepresentation;
              }
               else {
                identifier += child.toPlainTextViewRec_0(functionConfiguration) + functionIdentifier.plainTextRepresentation;
              }
            }

            if (this.children.size > 0) {
              var $receiver_2 = identifier;
              var endIndex_0 = identifier.length - functionIdentifier.plainTextRepresentation.length | 0;
              identifier = $receiver_2.substring(0, endIndex_0);
            }

            if (this.binaryOperationNeedBrackets_0()) {
              identifier += ')';
            }

            break;
          case 'UNARY_LEFT_OPERATION':
            var childplainTextRepresentation = first(this.children).toPlainTextViewRec_0(functionConfiguration);
            tmp$_3 = functionIdentifier.plainTextRepresentation;
            if (isSign(first_0(childplainTextRepresentation), false)) {
              tmp$_2 = '(' + childplainTextRepresentation + ')';
            }
             else {
              tmp$_2 = childplainTextRepresentation;
            }

            identifier = tmp$_3 + tmp$_2;
            break;
          case 'UNARY_RIGHT_OPERATION':
            var childplainTextRepresentation_0 = first(this.children).toPlainTextViewRec_0(functionConfiguration);
            if (isSign(first_0(childplainTextRepresentation_0), false)) {
              tmp$_4 = '(' + childplainTextRepresentation_0 + ')';
            }
             else {
              tmp$_4 = childplainTextRepresentation_0;
            }

            identifier = tmp$_4 + functionIdentifier.plainTextRepresentation;
            break;
        }
      }
       else {
        identifier = this.value + '(';
        tmp$_5 = this.children.iterator();
        while (tmp$_5.hasNext()) {
          var child_0 = tmp$_5.next();
          identifier += child_0.toPlainTextViewRec_0() + ',';
        }
        if (this.children.size > 0) {
          var $receiver_3 = identifier;
          var endIndex_1 = identifier.length - 1 | 0;
          identifier = $receiver_3.substring(0, endIndex_1);
        }
        identifier += ')';
      }
    }
    return identifier;
  };
  function ExpressionNode$toTexView$lambda(it) {
    return it.getNodeValueString();
  }
  ExpressionNode.prototype.toTexView_odr8sm$ = function (functionConfiguration, getNodeValueString) {
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration();
    if (getNodeValueString === void 0)
      getNodeValueString = ExpressionNode$toTexView$lambda;
    var tmp$;
    var result = this.toTexViewRec_0(functionConfiguration, getNodeValueString);
    if (first_0(result) === 40 && last_0(result) === 41) {
      var numberOfOpenBrackets = 1;
      var currentIndex = 1;
      while (currentIndex < result.length && numberOfOpenBrackets > 0) {
        if (result.charCodeAt(currentIndex) === 40) {
          numberOfOpenBrackets = numberOfOpenBrackets + 1 | 0;
        }
         else if (result.charCodeAt(currentIndex) === 41) {
          tmp$ = numberOfOpenBrackets, numberOfOpenBrackets = tmp$ - 1 | 0;
        }
        currentIndex = currentIndex + 1 | 0;
      }
      if (currentIndex >= get_lastIndex_0(result)) {
        var $receiver = result;
        var startIndex = texOpenBracket.length;
        var endIndex = result.length - texCloseBracket.length | 0;
        result = $receiver.substring(startIndex, endIndex);
      }
    }
    return result;
  };
  function ExpressionNode$toTexViewRec$lambda(it) {
    return it.getNodeValueString();
  }
  ExpressionNode.prototype.toTexViewRec_0 = function (functionConfiguration, getNodeValueString) {
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration();
    if (getNodeValueString === void 0)
      getNodeValueString = ExpressionNode$toTexViewRec$lambda;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6;
    var identifier = '';
    if (this.nodeType === NodeType$VARIABLE_getInstance()) {
      identifier = getNodeValueString(this);
    }
     else if (equals(this.value, '') && this.children.size === 1) {
      identifier = first(this.children).toTexViewRec_0(functionConfiguration);
    }
     else {
      var $receiver = functionConfiguration.functionProperties;
      var firstOrNull$result;
      firstOrNull$break: do {
        var tmp$_7;
        tmp$_7 = $receiver.iterator();
        while (tmp$_7.hasNext()) {
          var element = tmp$_7.next();
          if (equals(element.function, this.value)) {
            firstOrNull$result = element;
            break firstOrNull$break;
          }
        }
        firstOrNull$result = null;
      }
       while (false);
      var functionIdentifier = firstOrNull$result;
      if (functionIdentifier != null && functionIdentifier.texStringDefinitionType !== StringDefinitionType$FUNCTION_getInstance()) {
        switch (functionIdentifier.texStringDefinitionType.name) {
          case 'BINARY_OPERATION':
            if (this.binaryOperationNeedBrackets_0()) {
              identifier = texOpenBracket;
            }

            if (equals(this.value, '/') && this.children.size === 2) {
              identifier += '\\frac{' + first(this.children).toTexViewRec_0(functionConfiguration) + '}{' + last(this.children).toTexViewRec_0(functionConfiguration) + '}';
            }
             else if (equals(this.value, 'log') && this.children.size === 2) {
              identifier += '\\log _{' + last(this.children).toTexViewRec_0(functionConfiguration) + '}{' + first(this.children).toTexViewRec_0(functionConfiguration) + '}';
            }
             else if (equals(this.value, 'sqrt') && this.children.size === 1) {
              identifier += '\\sqrt{' + first(this.children).toTexViewRec_0(functionConfiguration) + '}';
            }
             else if (equals(this.value, '^') && this.children.size >= 2) {
              tmp$ = this.children.iterator();
              while (tmp$.hasNext()) {
                var child = tmp$.next();
                identifier += '{' + child.toTexViewRec_0(functionConfiguration) + '^';
              }
              var $receiver_0 = identifier;
              var endIndex = identifier.length - 1 | 0;
              identifier = $receiver_0.substring(0, endIndex) + repeat('}', this.children.size);
            }
             else {
              tmp$_0 = this.children.iterator();
              while (tmp$_0.hasNext()) {
                var child_0 = tmp$_0.next();
                if (equals((tmp$_1 = functionConfiguration.functionPropertiesByName.get_11rb$(child_0.value + '_-1')) != null ? tmp$_1.mainFunction : null, functionIdentifier.function) && !equals((tmp$_2 = functionConfiguration.functionPropertiesByName.get_11rb$(child_0.value + '_-1')) != null ? tmp$_2.function : null, functionIdentifier.function)) {
                  if (identifier.length > 6) {
                    var $receiver_1 = identifier;
                    var endIndex_0 = identifier.length - (functionIdentifier.texRepresentation.length + 2) | 0;
                    identifier = $receiver_1.substring(0, endIndex_0);
                  }
                  identifier += ensureNotNull(functionConfiguration.functionPropertiesByName.get_11rb$(child_0.value + '_-1')).function;
                  identifier += first(child_0.children).toTexViewRec_0(functionConfiguration) + (' ' + functionIdentifier.texRepresentation + ' ');
                }
                 else {
                  identifier += child_0.toTexViewRec_0(functionConfiguration) + (' ' + functionIdentifier.texRepresentation + ' ');
                }
              }
              if (this.children.size > 0) {
                var $receiver_2 = identifier;
                var endIndex_1 = identifier.length - (functionIdentifier.texRepresentation.length + 2) | 0;
                identifier = $receiver_2.substring(0, endIndex_1);
              }
            }

            if (this.binaryOperationNeedBrackets_0()) {
              identifier += texCloseBracket;
            }

            break;
          case 'UNARY_LEFT_OPERATION':
            var childTexRepresentation = first(this.children).toTexViewRec_0(functionConfiguration);
            tmp$_4 = ' ' + functionIdentifier.texRepresentation + ' ';
            if (isSign(first_0(childTexRepresentation), false)) {
              tmp$_3 = '(' + childTexRepresentation + ')';
            }
             else {
              tmp$_3 = childTexRepresentation;
            }

            identifier = tmp$_4 + tmp$_3;
            break;
          case 'UNARY_RIGHT_OPERATION':
            var childTexRepresentation_0 = first(this.children).toTexViewRec_0(functionConfiguration);
            if (isSign(first_0(childTexRepresentation_0), false)) {
              tmp$_5 = '(' + childTexRepresentation_0 + ')';
            }
             else {
              tmp$_5 = childTexRepresentation_0;
            }

            identifier = tmp$_5 + (' ' + functionIdentifier.texRepresentation + ' ');
            break;
        }
      }
       else {
        identifier = this.value + texOpenBracket;
        tmp$_6 = this.children.iterator();
        while (tmp$_6.hasNext()) {
          var child_1 = tmp$_6.next();
          identifier += child_1.toTexViewRec_0() + ',';
        }
        if (this.children.size > 0) {
          var $receiver_3 = identifier;
          var endIndex_2 = identifier.length - 1 | 0;
          identifier = $receiver_3.substring(0, endIndex_2);
        }
        identifier += texCloseBracket;
      }
    }
    return identifier;
  };
  ExpressionNode.prototype.binaryOperationNeedBrackets_0 = function (bracketThresholdAdditive) {
    if (bracketThresholdAdditive === void 0)
      bracketThresholdAdditive = 0.2;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11, tmp$_12, tmp$_13, tmp$_14, tmp$_15, tmp$_16, tmp$_17, tmp$_18, tmp$_19, tmp$_20, tmp$_21, tmp$_22, tmp$_23, tmp$_24, tmp$_25, tmp$_26;
    if (!equals((tmp$_1 = (tmp$_0 = (tmp$ = this.parent) != null ? tmp$.functionStringDefinition : null) != null ? tmp$_0.function : null) != null ? tmp$_1.defaultStringDefinitionType : null, StringDefinitionType$FUNCTION_getInstance())) {
      var tmp$_27 = !(equals((tmp$_4 = (tmp$_3 = (tmp$_2 = this.parent) != null ? tmp$_2.functionStringDefinition : null) != null ? tmp$_3.function : null) != null ? tmp$_4.defaultStringDefinitionType : null, StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance()) || (equals((tmp$_7 = (tmp$_6 = (tmp$_5 = this.parent) != null ? tmp$_5.functionStringDefinition : null) != null ? tmp$_6.function : null) != null ? tmp$_7.defaultStringDefinitionType : null, StringDefinitionType$UNARY_LEFT_OPERATION_getInstance()) && equals((tmp$_10 = (tmp$_9 = (tmp$_8 = this.parent) != null ? tmp$_8.functionStringDefinition : null) != null ? tmp$_9.function : null) != null ? tmp$_10.function : null, (tmp$_13 = (tmp$_12 = (tmp$_11 = this.parent) != null ? tmp$_11.functionStringDefinition : null) != null ? tmp$_12.function : null) != null ? tmp$_13.mainFunction : null))) ? bracketThresholdAdditive + ((tmp$_17 = (tmp$_16 = (tmp$_15 = (tmp$_14 = this.parent) != null ? tmp$_14.functionStringDefinition : null) != null ? tmp$_15.function : null) != null ? tmp$_16.priority : null) != null ? tmp$_17 : 0.0) >= ((tmp$_20 = (tmp$_19 = (tmp$_18 = this.functionStringDefinition) != null ? tmp$_18.function : null) != null ? tmp$_19.priority : null) != null ? tmp$_20 : 0.0) : true;
      if (!tmp$_27) {
        var tmp$_28 = equals((tmp$_22 = (tmp$_21 = this.functionStringDefinition) != null ? tmp$_21.function : null) != null ? tmp$_22.defaultStringDefinitionType : null, StringDefinitionType$FUNCTION_getInstance()) && this.nodeId !== ((tmp$_25 = (tmp$_24 = (tmp$_23 = this.parent) != null ? tmp$_23.children : null) != null ? last(tmp$_24) : null) != null ? tmp$_25.nodeId : null);
        if (tmp$_28) {
          tmp$_28 = !first(this.children).children.isEmpty();
        }
        tmp$_27 = tmp$_28;
      }
      tmp$_26 = tmp$_27;
    }
     else
      tmp$_26 = false;
    return tmp$_26;
  };
  ExpressionNode.prototype.isNodeValueEquals_6718cy$ = function (expressionNode) {
    return equals(this.getNodeValueString(), expressionNode.getNodeValueString());
  };
  ExpressionNode.prototype.isNodeSubtreeIdentifiersEquals_6718cy$ = function (expressionNode) {
    return equals(this.computeIdentifier_t6ztn0$(), expressionNode.computeIdentifier_t6ztn0$());
  };
  function ExpressionNode$sortChildrenAscendingIdentifiers$lambda(it) {
    return it.identifier;
  }
  ExpressionNode.prototype.sortChildrenAscendingIdentifiers = function () {
    var tmp$, tmp$_0;
    if (this.nodeType === NodeType$FUNCTION_getInstance() && ((tmp$_0 = (tmp$ = this.functionStringDefinition) != null ? tmp$.function : null) != null ? tmp$_0.isCommutativeWithNullWeight : null) === true) {
      var $receiver = this.children;
      if ($receiver.size > 1) {
        sortWith($receiver, new Comparator$ObjectLiteral_1(compareBy$lambda_0(ExpressionNode$sortChildrenAscendingIdentifiers$lambda)));
      }
    }
  };
  function ExpressionNode$sortChildrenAscendingNodeIds$lambda(it) {
    return it.nodeId;
  }
  ExpressionNode.prototype.sortChildrenAscendingNodeIds = function () {
    var tmp$;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      child.sortChildrenAscendingNodeIds();
    }
    var $receiver = this.children;
    if ($receiver.size > 1) {
      sortWith($receiver, new Comparator$ObjectLiteral_1(compareBy$lambda_0(ExpressionNode$sortChildrenAscendingNodeIds$lambda)));
    }
  };
  function ExpressionNode$sortChildrenByNodeIdsOrder$lambda(closure$nodeIdsPositionsMap) {
    return function (o1, o2) {
      return ensureNotNull(closure$nodeIdsPositionsMap.get_11rb$(o1.nodeId)) - ensureNotNull(closure$nodeIdsPositionsMap.get_11rb$(o2.nodeId)) | 0;
    };
  }
  ExpressionNode.prototype.sortChildrenByNodeIdsOrder_orwq1h$ = function (nodeIdsPositionsMap) {
    var tmp$, tmp$_0, tmp$_1;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      child.sortChildrenByNodeIdsOrder_orwq1h$(nodeIdsPositionsMap);
    }
    var tmp$_2 = ((tmp$_1 = (tmp$_0 = this.functionStringDefinition) != null ? tmp$_0.function : null) != null ? tmp$_1.isCommutativeWithNullWeight : null) === true;
    if (tmp$_2) {
      var $receiver = this.children;
      var all$result;
      all$break: do {
        var tmp$_3;
        if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
          all$result = true;
          break all$break;
        }
        tmp$_3 = $receiver.iterator();
        while (tmp$_3.hasNext()) {
          var element = tmp$_3.next();
          if (!nodeIdsPositionsMap.containsKey_11rb$(element.nodeId)) {
            all$result = false;
            break all$break;
          }
        }
        all$result = true;
      }
       while (false);
      tmp$_2 = all$result;
    }
    if (tmp$_2) {
      sortWith(this.children, new Comparator$ObjectLiteral_2(ExpressionNode$sortChildrenByNodeIdsOrder$lambda(nodeIdsPositionsMap)));
    }
  };
  function ExpressionNode$sortChildrenForExpressionSubstitutionComparison$lambda(it) {
    return it.isNumberValue() ? '1' + it.identifier : it.nodeType === NodeType$FUNCTION_getInstance() ? '2' + it.value : '3';
  }
  ExpressionNode.prototype.sortChildrenForExpressionSubstitutionComparison = function () {
    var tmp$, tmp$_0, tmp$_1;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      child.sortChildrenForExpressionSubstitutionComparison();
    }
    if (this.nodeType === NodeType$FUNCTION_getInstance() && ((tmp$_1 = (tmp$_0 = this.functionStringDefinition) != null ? tmp$_0.function : null) != null ? tmp$_1.isCommutativeWithNullWeight : null) === true) {
      var $receiver = this.children;
      if ($receiver.size > 1) {
        sortWith($receiver, new Comparator$ObjectLiteral_1(compareBy$lambda_0(ExpressionNode$sortChildrenForExpressionSubstitutionComparison$lambda)));
      }
    }
    return this;
  };
  ExpressionNode.prototype.cloneWithSortingChildrenForExpressionSubstitutionComparison = function () {
    return this.clone().sortChildrenForExpressionSubstitutionComparison();
  };
  ExpressionNode.prototype.getCountOfNodes = function () {
    var tmp$;
    var sum = 0;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      sum = sum + element.getCountOfNodes() | 0;
    }
    return 1 + sum | 0;
  };
  ExpressionNode.prototype.getMaxMinNumberOfPointsForEquality = function () {
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    if (this.nodeType === NodeType$VARIABLE_getInstance()) {
      return 1;
    }
     else {
      var $receiver = this.children;
      var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
      var tmp$_3;
      tmp$_3 = $receiver.iterator();
      while (tmp$_3.hasNext()) {
        var item = tmp$_3.next();
        destination.add_11rb$(item.getMaxMinNumberOfPointsForEquality());
      }
      var maxMinNumberOfPointsForEquality = (tmp$ = max(destination)) != null ? tmp$ : 1;
      var b = (tmp$_2 = (tmp$_1 = (tmp$_0 = this.functionStringDefinition) != null ? tmp$_0.function : null) != null ? tmp$_1.minNumberOfPointsForEquality : null) != null ? tmp$_2 : 1;
      return Math_0.max(maxMinNumberOfPointsForEquality, b);
    }
  };
  ExpressionNode.prototype.containsVariables = function () {
    var tmp$;
    if (this.nodeType === NodeType$VARIABLE_getInstance()) {
      if (toDoubleOrNull(this.value) == null)
        return true;
    }
     else {
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        if (child.containsVariables())
          return true;
      }
    }
    return false;
  };
  ExpressionNode.prototype.getVariableNames = function () {
    var tmp$;
    var result = LinkedHashSet_init();
    if (this.nodeType === NodeType$VARIABLE_getInstance()) {
      if (toDoubleOrNull(this.value) == null)
        result.add_11rb$(this.value);
    }
     else {
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        result.addAll_brywnq$(child.getVariableNames());
      }
    }
    return result;
  };
  ExpressionNode.prototype.containsFunctions = function () {
    var tmp$;
    if (this.nodeType === NodeType$FUNCTION_getInstance() && !equals(this.value, '')) {
      return false;
    }
     else {
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        if (child.containsFunctions()) {
          return false;
        }
      }
    }
    return true;
  };
  ExpressionNode.prototype.containsFunction_bm4lxs$ = function (name, numberOfArgs) {
    var tmp$;
    if (this.nodeType === NodeType$FUNCTION_getInstance() && equals(this.value, name) && this.children.size === numberOfArgs) {
      return true;
    }
     else {
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        if (child.containsFunction_bm4lxs$(name, numberOfArgs)) {
          return true;
        }
      }
    }
    return false;
  };
  ExpressionNode.prototype.isBoolExpression_ywdfdh$ = function (boolFunctions) {
    return !intersect(this.getContainedFunctions(), boolFunctions).isEmpty();
  };
  ExpressionNode.prototype.getContainedFunctions = function () {
    var tmp$;
    var result = LinkedHashSet_init();
    if (!this.children.isEmpty()) {
      if (!isBlank(this.value)) {
        result.add_11rb$(this.value);
      }
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        result.addAll_brywnq$(child.getContainedFunctions());
      }
    }
    return result;
  };
  ExpressionNode.prototype.topOperationIsPossibleMainFunction_61zpoe$ = function (topOperation) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6;
    return equals((tmp$_0 = (tmp$ = this.functionStringDefinition) != null ? tmp$.function : null) != null ? tmp$_0.notObligateMainFunction() : null, topOperation) || (((tmp$_2 = (tmp$_1 = this.linkOnOriginalTreeNode) != null ? tmp$_1.children : null) != null ? tmp$_2.size : null) === 1 && ((tmp$_4 = (tmp$_3 = this.functionStringDefinition) != null ? tmp$_3.function : null) != null ? tmp$_4.numberOfArguments : null) === -1 && ((tmp$_6 = (tmp$_5 = this.functionStringDefinition) != null ? tmp$_5.function : null) != null ? tmp$_6.mainFunctionIsCommutativeWithNullWeight : null) === true);
  };
  ExpressionNode.prototype.getContainedChildOperationNodeIds_61zpoe$ = function (topOperation) {
    var tmp$;
    var result = LinkedHashSet_init();
    if (this.children.isEmpty() || !this.topOperationIsPossibleMainFunction_61zpoe$(topOperation)) {
      result.add_11rb$(this.nodeId);
    }
     else {
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        result.addAll_brywnq$(child.getContainedChildOperationNodeIds_61zpoe$(topOperation));
      }
    }
    return result;
  };
  ExpressionNode.prototype.getAllChildrenNodeIds = function () {
    var tmp$;
    var result = LinkedHashSet_init();
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      result.add_11rb$(child.nodeId);
      result.addAll_brywnq$(child.getAllChildrenNodeIds());
    }
    return result;
  };
  ExpressionNode.prototype.allParentsMainFunctionIs_61zpoe$ = function (topOperation) {
    var tmp$;
    if (!this.topOperationIsPossibleMainFunction_61zpoe$(topOperation)) {
      return this.children.isEmpty();
    }
     else {
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        if (!child.allParentsMainFunctionIs_61zpoe$(topOperation)) {
          return false;
        }
      }
    }
    return true;
  };
  ExpressionNode.prototype.listWhichParentsFunctionIs_61zpoe$ = function (topOperation) {
    var tmp$;
    if (this.children.isEmpty()) {
      return listOf(ensureNotNull(this.linkOnOriginalTreeNode));
    }
     else if (!equals(this.value, topOperation)) {
      return emptyList();
    }
     else {
      var result = ArrayList_init();
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        result.addAll_brywnq$(child.listWhichParentsFunctionIs_61zpoe$(topOperation));
      }
      return result;
    }
  };
  ExpressionNode.prototype.getContainedVariables = function () {
    var tmp$;
    var result = LinkedHashSet_init();
    if (this.children.isEmpty()) {
      if (!equals(this.value, '\u03C0') && toDoubleOrNull(this.value) == null) {
        result.add_11rb$(this.value);
      }
    }
     else {
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        result.addAll_brywnq$(child.getContainedVariables());
      }
    }
    return result;
  };
  ExpressionNode.prototype.getContainedVariables_ywdfdh$ = function (variables) {
    var tmp$;
    var result = LinkedHashSet_init();
    if (this.children.isEmpty()) {
      if (toDoubleOrNull(this.value) == null) {
        if (variables.contains_11rb$(this.value)) {
          result.add_11rb$(this.value);
        }
      }
    }
     else {
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        result.addAll_brywnq$(child.getContainedVariables_ywdfdh$(variables));
      }
    }
    return result;
  };
  ExpressionNode.prototype.getNotContainedVariables_ywdfdh$ = function (variables) {
    var tmp$;
    var result = LinkedHashSet_init();
    if (this.children.isEmpty()) {
      if (toDoubleOrNull(this.value) == null) {
        if (!variables.contains_11rb$(this.value)) {
          result.add_11rb$(this.value);
        }
      }
    }
     else {
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        result.addAll_brywnq$(child.getNotContainedVariables_ywdfdh$(variables));
      }
    }
    return result;
  };
  ExpressionNode.prototype.canContainDivisions = function () {
    var tmp$, tmp$_0;
    if (equals(this.value, '/')) {
      return true;
    }
    if (equals(this.value, '^') && this.children.size > 1) {
      tmp$ = get_lastIndex(this.children);
      for (var i = 2; i <= tmp$; i++) {
        if (this.children.get_za3lpa$(i).nodeType === NodeType$FUNCTION_getInstance())
          return true;
      }
    }
    tmp$_0 = this.children.iterator();
    while (tmp$_0.hasNext()) {
      var child = tmp$_0.next();
      return child.canContainDivisions();
    }
    return false;
  };
  ExpressionNode.prototype.getDepth = function () {
    var tmp$;
    var result = 1;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      var a = result;
      var b = child.getDepth() + 1 | 0;
      result = Math_0.max(a, b);
    }
    return result;
  };
  ExpressionNode.prototype.getMaxConstant = function () {
    var tmp$, tmp$_0;
    var result = 0.0;
    if (this.children.isEmpty()) {
      result = abs_0((tmp$ = toDoubleOrNull(this.value)) != null ? tmp$ : 0.0);
    }
    tmp$_0 = this.children.iterator();
    while (tmp$_0.hasNext()) {
      var child = tmp$_0.next();
      var a = result;
      var b = abs_0(child.getMaxConstant());
      result = Math_0.max(a, b);
    }
    return result;
  };
  ExpressionNode.prototype.toString = function () {
    return this.computeIdentifier_t6ztn0$();
  };
  ExpressionNode.prototype.toStringWithPositions = function () {
    return this.computeIdentifierWithPositions_t6ztn0$();
  };
  ExpressionNode.prototype.normalizeSubTree_f8z7ch$ = function (currentDeep, nameArgsMap, sorted) {
    if (currentDeep === void 0)
      currentDeep = 0;
    if (nameArgsMap === void 0) {
      nameArgsMap = LinkedHashMap_init_0();
    }
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3;
    if (this.nodeType === NodeType$FUNCTION_getInstance()) {
      var numberOfDefinitionArguments = (tmp$_1 = (tmp$_0 = (tmp$ = this.functionStringDefinition) != null ? tmp$.function : null) != null ? tmp$_0.numberOfDefinitionArguments : null) != null ? tmp$_1 : 0;
      var childrenNameArgs = ArrayList_init();
      var previousNameArgsMap = LinkedHashMap_init_0();
      for (var i = 0; i < numberOfDefinitionArguments; i++) {
        childrenNameArgs.add_11rb$('' + this.children.get_za3lpa$(i).value);
        var currentNameArgMap = nameArgsMap.get_11rb$(this.children.get_za3lpa$(i).value);
        if (currentNameArgMap != null)
          previousNameArgsMap.put_xwzc9p$(this.children.get_za3lpa$(i).value, currentNameArgMap);
        nameArgsMap.put_xwzc9p$(this.children.get_za3lpa$(i).value, 'sys_twf_name_var_value_' + currentDeep + '_' + i);
      }
      tmp$_2 = this.children.iterator();
      while (tmp$_2.hasNext()) {
        var child = tmp$_2.next();
        child.normalizeSubTree_f8z7ch$(currentDeep + 1 | 0, nameArgsMap, sorted);
      }
      if (sorted) {
        this.sortChildrenAscendingIdentifiers();
      }
      this.computeIdentifier_t6ztn0$();
      tmp$_3 = childrenNameArgs.iterator();
      while (tmp$_3.hasNext()) {
        var name = tmp$_3.next();
        nameArgsMap.remove_11rb$(name);
      }
      nameArgsMap.putAll_a2k3zr$(previousNameArgsMap);
    }
     else {
      var newValue = nameArgsMap.get_11rb$(this.value);
      if (newValue != null)
        this.value = newValue;
    }
    return this;
  };
  ExpressionNode.prototype.variableReplacement_y0zsll$ = function (replacements) {
    if (replacements === void 0) {
      replacements = LinkedHashMap_init_0();
    }
    var tmp$;
    if (this.nodeType === NodeType$FUNCTION_getInstance()) {
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        child.variableReplacement_y0zsll$(replacements);
      }
    }
     else {
      var newValue = replacements.get_11rb$(this.value);
      if (newValue != null)
        this.value = newValue;
    }
    return this;
  };
  ExpressionNode.prototype.clone = function () {
    var tmp$;
    var result = this.copy_uq8prj$();
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      result.addChild_6718cy$(child.clone());
    }
    return result;
  };
  ExpressionNode.prototype.containsNestedSameFunctions = function () {
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      if (((tmp$_2 = (tmp$_1 = (tmp$_0 = this.functionStringDefinition) != null ? tmp$_0.function : null) != null ? tmp$_1.isCommutativeWithNullWeight : null) != null ? tmp$_2 : false) && equals(this.value, child.value)) {
        return true;
      }
      if (child.containsNestedSameFunctions())
        return true;
    }
    return false;
  };
  ExpressionNode.prototype.cloneWithExpandingNestedSameFunctions = function () {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3;
    var result = this.copy_uq8prj$();
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      var childCopy = child.cloneWithExpandingNestedSameFunctions();
      if (((tmp$_2 = (tmp$_1 = (tmp$_0 = this.functionStringDefinition) != null ? tmp$_0.function : null) != null ? tmp$_1.isCommutativeWithNullWeight : null) != null ? tmp$_2 : false) && equals(this.value, childCopy.value)) {
        tmp$_3 = childCopy.children.iterator();
        while (tmp$_3.hasNext()) {
          var childCopyChild = tmp$_3.next();
          result.addChild_6718cy$(childCopyChild);
        }
      }
       else {
        result.addChild_6718cy$(childCopy);
      }
    }
    return result;
  };
  ExpressionNode.prototype.cloneAndSimplifyByCommutativeNormalizeAndComputeSimplePlaces_xcc95t$ = function (compiledConfiguration, selectedNodeIds) {
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration();
    if (selectedNodeIds === void 0) {
      selectedNodeIds = [];
    }
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    if ((selectedNodeIds.length === 0 || !containsAny_0(this.getAllChildrenNodeIds(), selectedNodeIds)) && calcComplexity(this) <= compiledConfiguration.simpleComputationRuleParams.maxCalcComplexity && !this.containsVariables()) {
      var computed = computeNodeIfSimple(this, compiledConfiguration.simpleComputationRuleParams);
      if (computed != null) {
        var actualNodeId = this.nodeId;
        var $receiver = compiledConfiguration.createExpressionVariableNode_14dthe$(computed);
        $receiver.nodeId = actualNodeId;
        return $receiver;
      }
    }
    var result = this.copy_uq8prj$();
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      var simplifiedChild = child.cloneAndSimplifyByCommutativeNormalizeAndComputeSimplePlaces_xcc95t$(compiledConfiguration, selectedNodeIds);
      if (equals(simplifiedChild.value, this.value) && ((tmp$_1 = (tmp$_0 = this.functionStringDefinition) != null ? tmp$_0.function : null) != null ? tmp$_1.isCommutativeWithNullWeight : null) === true && !contains(selectedNodeIds, simplifiedChild.nodeId)) {
        tmp$_2 = simplifiedChild.children.iterator();
        while (tmp$_2.hasNext()) {
          var childOfChild = tmp$_2.next();
          result.addChild_6718cy$(childOfChild.cloneAndSimplifyByCommutativeNormalizeAndComputeSimplePlaces_xcc95t$(compiledConfiguration, selectedNodeIds));
        }
      }
       else {
        result.addChild_6718cy$(simplifiedChild);
      }
    }
    return result;
  };
  ExpressionNode.prototype.cloneAndSimplifyByComputeSimplePlaces_ky12w7$ = function (simpleComputationRuleParams, selectedNodeIds) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    if (selectedNodeIds === void 0) {
      selectedNodeIds = [];
    }
    var tmp$;
    if ((selectedNodeIds.length === 0 || !containsAny_0(this.getAllChildrenNodeIds(), selectedNodeIds)) && calcComplexity(this) <= simpleComputationRuleParams.maxCalcComplexity && !this.containsVariables()) {
      var computed = computeNodeIfSimple(this, simpleComputationRuleParams);
      if (computed != null) {
        return new ExpressionNode(NodeType$VARIABLE_getInstance(), toShortString(computed), void 0, void 0, void 0, void 0, void 0, void 0, this.nodeId);
      }
    }
    var result = this.copy_uq8prj$();
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      result.addChild_6718cy$(child.cloneAndSimplifyByComputeSimplePlaces_ky12w7$(simpleComputationRuleParams, selectedNodeIds));
    }
    return result;
  };
  ExpressionNode.prototype.dropBracketNodesIfOperationsSame = function () {
    var tmp$, tmp$_0;
    var newChildren = ArrayList_init();
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      child.dropBracketNodesIfOperationsSame();
      if (equals(child.value, this.value) && !equals(this.value, '') && this.functionStringDefinition != null && ensureNotNull(this.functionStringDefinition).function.numberOfArguments < 0) {
        tmp$_0 = child.children.iterator();
        while (tmp$_0.hasNext()) {
          var childChild = tmp$_0.next();
          newChildren.add_11rb$(childChild);
          childChild.parent = this;
        }
      }
       else {
        newChildren.add_11rb$(child);
      }
    }
    this.children = newChildren;
  };
  ExpressionNode.prototype.cloneWithDeepSubstitutions_q0nxk6$ = function (nameArgsMap) {
    var tmp$;
    if (this.nodeType === NodeType$FUNCTION_getInstance()) {
      var result = this.copy_uq8prj$();
      tmp$ = this.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        result.addChild_6718cy$(child.cloneWithDeepSubstitutions_q0nxk6$(nameArgsMap));
      }
      return result;
    }
     else {
      var newNode = nameArgsMap.get_11rb$(this.value);
      if (newNode != null)
        return newNode.cloneWithNormalization_1g1bdl$(void 0, false);
      else
        return this.copy_uq8prj$();
    }
  };
  ExpressionNode.prototype.cloneWithNormalization_1g1bdl$ = function (nameArgsMap, sorted) {
    if (nameArgsMap === void 0) {
      nameArgsMap = LinkedHashMap_init_0();
    }
    return this.clone().normalizeSubTree_f8z7ch$(void 0, nameArgsMap, sorted);
  };
  ExpressionNode.prototype.cloneWithVariableReplacement_y0zsll$ = function (replacements) {
    return this.clone().variableReplacement_y0zsll$(replacements);
  };
  ExpressionNode.prototype.isNodeSubtreeEquals_7j5kvs$ = function (expressionNode, nameArgsMap) {
    if (nameArgsMap === void 0) {
      nameArgsMap = LinkedHashMap_init_0();
    }
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8;
    var actualValue = (tmp$ = nameArgsMap.get_11rb$(this.value)) != null ? tmp$ : this.value;
    var result = equals(actualValue, expressionNode.value);
    if (this.nodeType === NodeType$FUNCTION_getInstance()) {
      if (this.children.size !== expressionNode.children.size || ((tmp$_1 = (tmp$_0 = this.functionStringDefinition) != null ? tmp$_0.function : null) != null ? tmp$_1.numberOfDefinitionArguments : null) != ((tmp$_3 = (tmp$_2 = expressionNode.functionStringDefinition) != null ? tmp$_2.function : null) != null ? tmp$_3.numberOfDefinitionArguments : null))
        return false;
      var numberOfDefinitionArguments = (tmp$_6 = (tmp$_5 = (tmp$_4 = this.functionStringDefinition) != null ? tmp$_4.function : null) != null ? tmp$_5.numberOfDefinitionArguments : null) != null ? tmp$_6 : 0;
      var childrenNameArgs = ArrayList_init();
      var previousNameArgsMap = LinkedHashMap_init_0();
      for (var i = 0; i < numberOfDefinitionArguments; i++) {
        childrenNameArgs.add_11rb$('' + this.children.get_za3lpa$(i).value);
        var currentNameArgMap = nameArgsMap.get_11rb$(this.children.get_za3lpa$(i).value);
        if (currentNameArgMap != null)
          previousNameArgsMap.put_xwzc9p$(this.children.get_za3lpa$(i).value, currentNameArgMap);
        nameArgsMap.put_xwzc9p$(this.children.get_za3lpa$(i).value, expressionNode.children.get_za3lpa$(i).value);
      }
      tmp$_7 = this.children.size;
      for (var i_0 = 0; i_0 < tmp$_7; i_0++) {
        if (!this.children.get_za3lpa$(i_0).isNodeSubtreeEquals_7j5kvs$(expressionNode.children.get_za3lpa$(i_0), nameArgsMap))
          return false;
      }
      tmp$_8 = childrenNameArgs.iterator();
      while (tmp$_8.hasNext()) {
        var name = tmp$_8.next();
        nameArgsMap.remove_11rb$(name);
      }
      nameArgsMap.putAll_a2k3zr$(previousNameArgsMap);
    }
    return result;
  };
  ExpressionNode.prototype.isNodeMatchesNumber_61zpoe$ = function (numberValue) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    tmp$ = toDoubleOrNull(numberValue);
    if (tmp$ == null) {
      return false;
    }
    var matchingValue = tmp$;
    if (this.nodeType === NodeType$VARIABLE_getInstance()) {
      tmp$_0 = toDoubleOrNull(this.value);
      if (tmp$_0 == null) {
        return false;
      }
      tmp$_2 = tmp$_0;
    }
     else if (calcComplexity(this) < 4 && !this.containsVariables()) {
      tmp$_1 = computeNodeIfSimple(this);
      if (tmp$_1 == null) {
        return false;
      }
      tmp$_2 = tmp$_1;
    }
     else
      return false;
    var expressionValue = tmp$_2;
    return abs_0(expressionValue - matchingValue) < 1.19E-6;
  };
  ExpressionNode.prototype.replaceNotDefinedFunctionsOnVariables_g22vlb$ = function (functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet, expressionComporator, hasBoolFunctions) {
    if (expressionComporator === void 0)
      expressionComporator = null;
    if (hasBoolFunctions === void 0)
      hasBoolFunctions = false;
    var tmp$, tmp$_0, tmp$_1;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      child.replaceNotDefinedFunctionsOnVariables_g22vlb$(functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet, expressionComporator, hasBoolFunctions);
    }
    if (this.nodeType === NodeType$FUNCTION_getInstance() && !definedFunctionNameNumberOfArgsSet.contains_11rb$(this.value + '_' + toString(this.children.size)) && !definedFunctionNameNumberOfArgsSet.contains_11rb$(this.value + '_-1')) {
      var nodeExists = false;
      tmp$_0 = functionIdentifierToVariableMap.entries.iterator();
      while (tmp$_0.hasNext()) {
        var tmp$_2 = tmp$_0.next();
        var expression = tmp$_2.key;
        var variable = tmp$_2.value;
        if (this.children.size === expression.children.size) {
          if (expressionComporator != null && expressionComporator.compiledConfiguration.comparisonSettings.useTestingToCompareFunctionArgumentsInProbabilityComparison && !hasBoolFunctions) {
            if (expressionComporator.baseOperationsDefinitions.definedFunctionNameNumberOfArgsSet.contains_11rb$(this.value + '_' + toString(this.children.size)) || expressionComporator.baseOperationsDefinitions.definedFunctionNameNumberOfArgsSet.contains_11rb$(this.value + '_-1')) {
              if (expressionComporator.probabilityTestComparison_3fo6fu$(this, expression, ComparisonType$EQUAL_getInstance())) {
                nodeExists = true;
                this.setVariable_61zpoe$(variable);
                break;
              }
            }
             else {
              var hasDifferentArgs = false;
              tmp$_1 = get_lastIndex(this.children);
              for (var i = 0; i <= tmp$_1; i++) {
                if (!expressionComporator.probabilityTestComparison_3fo6fu$(this.children.get_za3lpa$(i), expression.children.get_za3lpa$(i), ComparisonType$EQUAL_getInstance())) {
                  hasDifferentArgs = true;
                  break;
                }
              }
              if (!hasDifferentArgs) {
                nodeExists = true;
                this.setVariable_61zpoe$(variable);
                break;
              }
            }
          }
           else {
            if (this.isNodeSubtreeEquals_7j5kvs$(expression)) {
              nodeExists = true;
              this.setVariable_61zpoe$(variable);
              break;
            }
          }
        }
      }
      if (!nodeExists) {
        var variableName = 'sys_def_var_replace_fun_' + functionIdentifierToVariableMap.size;
        var key = this.clone();
        functionIdentifierToVariableMap.put_xwzc9p$(key, variableName);
        this.setVariable_61zpoe$(variableName);
      }
    }
  };
  ExpressionNode.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionNode',
    interfaces: []
  };
  ExpressionNode.prototype.component1 = function () {
    return this.nodeType;
  };
  ExpressionNode.prototype.component2 = function () {
    return this.value;
  };
  ExpressionNode.prototype.component3 = function () {
    return this.startPosition;
  };
  ExpressionNode.prototype.component4 = function () {
    return this.endPosition;
  };
  ExpressionNode.prototype.component5 = function () {
    return this.subValue;
  };
  ExpressionNode.prototype.component6 = function () {
    return this.parent;
  };
  ExpressionNode.prototype.component7 = function () {
    return this.functionStringDefinition;
  };
  ExpressionNode.prototype.component8 = function () {
    return this.identifier;
  };
  ExpressionNode.prototype.component9 = function () {
    return this.nodeId;
  };
  ExpressionNode.prototype.component10 = function () {
    return this.distanceToRoot;
  };
  ExpressionNode.prototype.component11 = function () {
    return this.expressionStrictureIdentifier;
  };
  ExpressionNode.prototype.copy_uq8prj$ = function (nodeType, value, startPosition, endPosition, subValue, parent, functionStringDefinition, identifier, nodeId, distanceToRoot, expressionStrictureIdentifier) {
    return new ExpressionNode(nodeType === void 0 ? this.nodeType : nodeType, value === void 0 ? this.value : value, startPosition === void 0 ? this.startPosition : startPosition, endPosition === void 0 ? this.endPosition : endPosition, subValue === void 0 ? this.subValue : subValue, parent === void 0 ? this.parent : parent, functionStringDefinition === void 0 ? this.functionStringDefinition : functionStringDefinition, identifier === void 0 ? this.identifier : identifier, nodeId === void 0 ? this.nodeId : nodeId, distanceToRoot === void 0 ? this.distanceToRoot : distanceToRoot, expressionStrictureIdentifier === void 0 ? this.expressionStrictureIdentifier : expressionStrictureIdentifier);
  };
  ExpressionNode.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.nodeType) | 0;
    result = result * 31 + Kotlin.hashCode(this.value) | 0;
    result = result * 31 + Kotlin.hashCode(this.startPosition) | 0;
    result = result * 31 + Kotlin.hashCode(this.endPosition) | 0;
    result = result * 31 + Kotlin.hashCode(this.subValue) | 0;
    result = result * 31 + Kotlin.hashCode(this.parent) | 0;
    result = result * 31 + Kotlin.hashCode(this.functionStringDefinition) | 0;
    result = result * 31 + Kotlin.hashCode(this.identifier) | 0;
    result = result * 31 + Kotlin.hashCode(this.nodeId) | 0;
    result = result * 31 + Kotlin.hashCode(this.distanceToRoot) | 0;
    result = result * 31 + Kotlin.hashCode(this.expressionStrictureIdentifier) | 0;
    return result;
  };
  ExpressionNode.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.nodeType, other.nodeType) && Kotlin.equals(this.value, other.value) && Kotlin.equals(this.startPosition, other.startPosition) && Kotlin.equals(this.endPosition, other.endPosition) && Kotlin.equals(this.subValue, other.subValue) && Kotlin.equals(this.parent, other.parent) && Kotlin.equals(this.functionStringDefinition, other.functionStringDefinition) && Kotlin.equals(this.identifier, other.identifier) && Kotlin.equals(this.nodeId, other.nodeId) && Kotlin.equals(this.distanceToRoot, other.distanceToRoot) && Kotlin.equals(this.expressionStrictureIdentifier, other.expressionStrictureIdentifier)))));
  };
  function ExpressionNodeConstructor(functionConfiguration, compiledImmediateVariableReplacements) {
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration();
    if (compiledImmediateVariableReplacements === void 0) {
      compiledImmediateVariableReplacements = emptyMap();
    }
    this.functionConfiguration = functionConfiguration;
    this.compiledImmediateVariableReplacements = compiledImmediateVariableReplacements;
  }
  ExpressionNodeConstructor.prototype.construct_61zpoe$ = function (identifier) {
    var tmp$;
    if (identifier.length === 0) {
      return new ExpressionNode(NodeType$FUNCTION_getInstance(), '');
    }
    if (first_0(identifier) === 40 && last_0(identifier) === 41) {
      var endIndex = get_lastIndex_0(identifier);
      tmp$ = this.constructRecursive_0(identifier.substring(1, endIndex), 1);
    }
     else {
      tmp$ = this.constructRecursive_0(identifier, 0);
    }
    var child = tmp$;
    if (child.nodeType === NodeType$ERROR_getInstance()) {
      return child;
    }
    var newNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '', void 0, void 0, void 0, void 0, void 0, identifier);
    newNode.addChild_6718cy$(child);
    return newNode;
  };
  ExpressionNodeConstructor.prototype.constructRecursive_0 = function (identifier, startPosition) {
    if (startPosition === void 0)
      startPosition = 0;
    var tmp$, tmp$_0;
    if (identifier.length === 0) {
      return new ExpressionNode(NodeType$ERROR_getInstance(), 'Something expected', startPosition, startPosition + 1 | 0);
    }
    var indexOfFirst$result;
    indexOfFirst$break: do {
      var tmp$_1, tmp$_0_0, tmp$_1_0, tmp$_2;
      tmp$_1 = get_indices(identifier);
      tmp$_0_0 = tmp$_1.first;
      tmp$_1_0 = tmp$_1.last;
      tmp$_2 = tmp$_1.step;
      for (var index = tmp$_0_0; index <= tmp$_1_0; index += tmp$_2) {
        if (unboxChar(toBoxedChar(identifier.charCodeAt(index))) === 40) {
          indexOfFirst$result = index;
          break indexOfFirst$break;
        }
      }
      indexOfFirst$result = -1;
    }
     while (false);
    var openBracketIndex = indexOfFirst$result;
    if (openBracketIndex >= 0) {
      var newNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), identifier.substring(0, openBracketIndex), void 0, void 0, void 0, void 0, void 0, identifier);
      var openBracketCount = 0;
      var currentChildIdentifier = new StringBuilder('');
      tmp$ = identifier.length;
      for (var i = openBracketIndex + 1 | 0; i < tmp$; i++) {
        if (openBracketCount === 0 && (identifier.charCodeAt(i) === 59 || identifier.charCodeAt(i) === 41)) {
          var child = this.constructRecursive_0(currentChildIdentifier.toString(), startPosition + i - currentChildIdentifier.length | 0);
          if (child.nodeType === NodeType$ERROR_getInstance()) {
            return child;
          }
          newNode.addChild_6718cy$(child);
          currentChildIdentifier = new StringBuilder('');
        }
         else {
          currentChildIdentifier.append_s8itvh$(identifier.charCodeAt(i));
        }
        if (identifier.charCodeAt(i) === 40) {
          openBracketCount = openBracketCount + 1 | 0;
        }
         else if (identifier.charCodeAt(i) === 41)
          tmp$_0 = openBracketCount, openBracketCount = tmp$_0 - 1 | 0;
        if (openBracketCount < -1) {
          return new ExpressionNode(NodeType$ERROR_getInstance(), "Unexpected ')'", startPosition + i | 0, startPosition + i + 1 | 0);
        }
      }
      if (openBracketCount >= 0) {
        return new ExpressionNode(NodeType$ERROR_getInstance(), 'closing bracket missing', startPosition + identifier.length - 1 | 0, startPosition + identifier.length | 0);
      }
      if (newNode.value.length > 0 || newNode.children.size > 1) {
        newNode.functionStringDefinition = this.functionConfiguration.fastFindStringDefinitionByNameAndNumberOfArguments_bm4lxs$(newNode.value, newNode.children.size);
        if (newNode.functionStringDefinition == null) {
          return new ExpressionNode(NodeType$ERROR_getInstance(), "Unknown function: '" + newNode.value + "' with '" + toString(newNode.children.size) + "' arguments", startPosition, startPosition + openBracketIndex | 0);
        }
      }
      return newNode;
    }
     else {
      var indexOfFirst$result_0;
      indexOfFirst$break: do {
        var tmp$_3, tmp$_0_1, tmp$_1_1, tmp$_2_0;
        tmp$_3 = get_indices(identifier);
        tmp$_0_1 = tmp$_3.first;
        tmp$_1_1 = tmp$_3.last;
        tmp$_2_0 = tmp$_3.step;
        for (var index_0 = tmp$_0_1; index_0 <= tmp$_1_1; index_0 += tmp$_2_0) {
          if (!isNameOrNumberPart(unboxChar(toBoxedChar(identifier.charCodeAt(index_0))))) {
            indexOfFirst$result_0 = index_0;
            break indexOfFirst$break;
          }
        }
        indexOfFirst$result_0 = -1;
      }
       while (false);
      var notDigitVariableSymbolIndex = indexOfFirst$result_0;
      if (notDigitVariableSymbolIndex >= 0) {
        return new ExpressionNode(NodeType$ERROR_getInstance(), "Wrong variable symbol '" + String.fromCharCode(identifier.charCodeAt(notDigitVariableSymbolIndex)) + "'", startPosition + notDigitVariableSymbolIndex | 0, startPosition + notDigitVariableSymbolIndex + 1 | 0);
      }
      var newValue = this.compiledImmediateVariableReplacements.get_11rb$(identifier);
      if (newValue != null)
        return new ExpressionNode(NodeType$VARIABLE_getInstance(), newValue, void 0, void 0, void 0, void 0, void 0, identifier);
      else
        return new ExpressionNode(NodeType$VARIABLE_getInstance(), identifier, void 0, void 0, void 0, void 0, void 0, identifier);
    }
  };
  ExpressionNodeConstructor.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionNodeConstructor',
    interfaces: []
  };
  function normalizeExpressionsForComparison(left, right) {
    var tmp$;
    if (left.nodeType === NodeType$FUNCTION_getInstance() && equals(left.value, ''))
      tmp$ = new Pair(left, right);
    else if (right.nodeType === NodeType$FUNCTION_getInstance() && equals(right.value, ''))
      tmp$ = new Pair(right, left);
    else
      return new Pair(left, right);
    var ordered = tmp$;
    if (ordered.second.nodeType !== NodeType$FUNCTION_getInstance() || !equals(ordered.second.value, '')) {
      var tmp$_0 = ordered.first;
      var $receiver = new ExpressionNode(NodeType$FUNCTION_getInstance(), '');
      $receiver.addChild_6718cy$(ordered.second);
      return new Pair(tmp$_0, $receiver);
    }
     else
      return ordered;
  }
  function subtractionTree(minuend, subtrahend) {
    var result = new ExpressionNode(NodeType$FUNCTION_getInstance(), '');
    result.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '+'));
    first(result.children).addChild_6718cy$(first(minuend.children).clone());
    first(result.children).addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '-'));
    last(first(result.children).children).addChild_6718cy$(first(subtrahend.children).clone());
    return result;
  }
  function divisionTree(dividend, divider) {
    var result = new ExpressionNode(NodeType$FUNCTION_getInstance(), '');
    result.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '/'));
    first(result.children).addChild_6718cy$(first(dividend.children).clone());
    first(result.children).addChild_6718cy$(first(divider.children).clone());
    return result;
  }
  function addRootNodeToExpression(expression) {
    var root = new ExpressionNode(NodeType$FUNCTION_getInstance(), '');
    root.addChild_6718cy$(expression);
    root.computeIdentifier_t6ztn0$();
    return root;
  }
  function Comparator$ObjectLiteral_3(closure$comparison) {
    this.closure$comparison = closure$comparison;
  }
  Comparator$ObjectLiteral_3.prototype.compare = function (a, b) {
    return this.closure$comparison(a, b);
  };
  Comparator$ObjectLiteral_3.$metadata$ = {kind: Kind_CLASS, interfaces: [Comparator]};
  var compareBy$lambda_1 = wrapFunction(function () {
    var compareValues = Kotlin.kotlin.comparisons.compareValues_s00gnj$;
    return function (closure$selector) {
      return function (a, b) {
        var selector = closure$selector;
        return compareValues(selector(a), selector(b));
      };
    };
  });
  var PARENT_BRACKETS_EXPANSION;
  var REDUCE_FRACTION;
  function nodeIdsPositionsMap(nodeIds) {
    var tmp$;
    var nodeIdsMap = LinkedHashMap_init_0();
    tmp$ = get_lastIndex_1(nodeIds);
    for (var i = 0; i <= tmp$; i++) {
      nodeIdsMap.put_xwzc9p$(nodeIds[i], i);
    }
    return nodeIdsMap;
  }
  function nodeIdsToNodeLinksInSameOrder($receiver, nodeIds, nodeIdsMap) {
    if (nodeIdsMap === void 0)
      nodeIdsMap = nodeIdsPositionsMap(nodeIds);
    var list = ArrayList_init_0(nodeIds.length);
    for (var index = 0; index < nodeIds.length; index++) {
      list.add_11rb$(new ExpressionNode(NodeType$EMPTY_getInstance(), ''));
    }
    var result = list;
    nodeIdsToNodeLinksInSameOrderRecursivePart($receiver, nodeIdsMap, result);
    return result;
  }
  function nodeIdsToNodeLinksInSameOrderRecursivePart($receiver, nodeIdsMap, result) {
    var tmp$;
    var index = nodeIdsMap.get_11rb$($receiver.nodeId);
    if (index != null) {
      result.set_wxm5ur$(index, $receiver);
    }
    tmp$ = $receiver.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      nodeIdsToNodeLinksInSameOrderRecursivePart(child, nodeIdsMap, result);
    }
  }
  function findLowestSubtreeTopOfNodes($receiver, nodes) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    tmp$ = firstOrNull_0(nodes);
    if (tmp$ == null) {
      return null;
    }
    var currentSubtree = tmp$;
    var nodeChains = toMutableList(nodes);
    var subtreeOfNodesFound = false;
    while (!subtreeOfNodesFound) {
      subtreeOfNodesFound = true;
      tmp$_0 = get_lastIndex(nodeChains);
      for (var i = 0; i <= tmp$_0; i++) {
        while (nodeChains.get_za3lpa$(i).distanceToRoot > currentSubtree.distanceToRoot) {
          tmp$_1 = nodeChains.get_za3lpa$(i).parent;
          if (tmp$_1 == null) {
            return null;
          }
          nodeChains.set_wxm5ur$(i, tmp$_1);
        }
        if (nodeChains.get_za3lpa$(i).distanceToRoot === currentSubtree.distanceToRoot && nodeChains.get_za3lpa$(i).nodeId !== currentSubtree.nodeId) {
          tmp$_2 = nodeChains.get_za3lpa$(i).parent;
          if (tmp$_2 == null) {
            return null;
          }
          nodeChains.set_wxm5ur$(i, tmp$_2);
        }
        if (nodeChains.get_za3lpa$(i).distanceToRoot < currentSubtree.distanceToRoot) {
          currentSubtree = nodeChains.get_za3lpa$(i);
          subtreeOfNodesFound = false;
        }
      }
    }
    return currentSubtree;
  }
  function findLowestSubtreeWithNodes($receiver, nodes, onlyHigherSelection, nestedNodesInSelection) {
    if (nestedNodesInSelection === void 0)
      nestedNodesInSelection = mutableListOf([false]);
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3;
    var currentSubtree = null;
    var destination = ArrayList_init_0(collectionSizeOrDefault(nodes, 10));
    var tmp$_4;
    tmp$_4 = nodes.iterator();
    while (tmp$_4.hasNext()) {
      var item = tmp$_4.next();
      destination.add_11rb$(item.nodeId);
    }
    var nodeIdsSet = toSet(destination);
    var nodeChains = toMutableList(nodes);
    var destination_0 = ArrayList_init_0(collectionSizeOrDefault(nodeChains, 10));
    var tmp$_5;
    tmp$_5 = nodeChains.iterator();
    while (tmp$_5.hasNext()) {
      var item_0 = tmp$_5.next();
      var tmp$_6 = destination_0.add_11rb$;
      var res = onlyHigherSelection ? item_0.copy_uq8prj$() : item_0.clone();
      res.linkOnOriginalTreeNode = item_0;
      tmp$_6.call(destination_0, res);
    }
    var nodeSelectedChains = toMutableList(destination_0);
    var destination_1 = ArrayList_init_0(collectionSizeOrDefault(nodeSelectedChains, 10));
    var tmp$_7;
    tmp$_7 = nodeSelectedChains.iterator();
    while (tmp$_7.hasNext()) {
      var item_1 = tmp$_7.next();
      destination_1.add_11rb$(new Pair(ensureNotNull(item_1).nodeId, item_1));
    }
    var treeParts = toMutableMap(toMap(destination_1));
    var subtreeOfNodesFound = false;
    while (!subtreeOfNodesFound) {
      subtreeOfNodesFound = true;
      tmp$ = get_lastIndex(nodeChains);
      loop_label: for (var i = 0; i <= tmp$; i++) {
        if (nodeSelectedChains.get_za3lpa$(i) == null || (currentSubtree != null && nodeChains.get_za3lpa$(i).nodeId === currentSubtree.nodeId))
          continue loop_label;
        if (currentSubtree != null && (nodeChains.get_za3lpa$(i).distanceToRoot > currentSubtree.distanceToRoot || !equals((tmp$_1 = (tmp$_0 = nodeChains.get_za3lpa$(i).functionStringDefinition) != null ? tmp$_0.function : null) != null ? tmp$_1.mainFunction : null, nodeChains.get_za3lpa$(i).value) || (nodeChains.get_za3lpa$(i).distanceToRoot === currentSubtree.distanceToRoot && nodeChains.get_za3lpa$(i).nodeId !== currentSubtree.nodeId))) {
          tmp$_2 = nodeChains.get_za3lpa$(i).parent;
          if (tmp$_2 == null) {
            return null;
          }
          nodeChains.set_wxm5ur$(i, tmp$_2);
          if (nestedNodesInSelection.isEmpty() && nodeIdsSet.contains_11rb$(nodeChains.get_za3lpa$(i).nodeId)) {
            nestedNodesInSelection.add_11rb$(true);
          }
          var suchPart = treeParts.get_11rb$(nodeChains.get_za3lpa$(i).nodeId);
          if (suchPart != null) {
            var $receiver_0 = suchPart.children;
            var all$result;
            all$break: do {
              var tmp$_8;
              if (Kotlin.isType($receiver_0, Collection) && $receiver_0.isEmpty()) {
                all$result = true;
                break all$break;
              }
              tmp$_8 = $receiver_0.iterator();
              while (tmp$_8.hasNext()) {
                var element = tmp$_8.next();
                if (!(element.nodeId !== ensureNotNull(nodeSelectedChains.get_za3lpa$(i)).nodeId)) {
                  all$result = false;
                  break all$break;
                }
              }
              all$result = true;
            }
             while (false);
            if (all$result)
              suchPart.addChild_6718cy$(ensureNotNull(nodeSelectedChains.get_za3lpa$(i)));
            nodeSelectedChains.set_wxm5ur$(i, null);
          }
           else {
            var $receiver_1 = nodeChains.get_za3lpa$(i).copy_uq8prj$();
            $receiver_1.linkOnOriginalTreeNode = nodeChains.get_za3lpa$(i);
            var newChainParent = $receiver_1;
            newChainParent.addChild_6718cy$(ensureNotNull(nodeSelectedChains.get_za3lpa$(i)));
            nodeSelectedChains.set_wxm5ur$(i, newChainParent);
            treeParts.put_xwzc9p$(nodeChains.get_za3lpa$(i).nodeId, ensureNotNull(nodeSelectedChains.get_za3lpa$(i)));
          }
          subtreeOfNodesFound = false;
        }
         else if (currentSubtree == null || nodeChains.get_za3lpa$(i).distanceToRoot < currentSubtree.distanceToRoot) {
          currentSubtree = ensureNotNull(nodeSelectedChains.get_za3lpa$(i));
          subtreeOfNodesFound = false;
        }
         else {
          tmp$_3 = get_lastIndex(ensureNotNull(nodeSelectedChains.get_za3lpa$(i)).children);
          for (var j = 0; j <= tmp$_3; j++) {
            currentSubtree.addChild_6718cy$(ensureNotNull(nodeSelectedChains.get_za3lpa$(i)).children.get_za3lpa$(j));
          }
          nodeSelectedChains.set_wxm5ur$(i, null);
        }
      }
    }
    if (currentSubtree != null) {
      currentSubtree.sortChildrenAscendingNodeIds();
    }
    return currentSubtree;
  }
  function cloneWithoutSelectedNodes($receiver, selectedTopNodeIds) {
    var tmp$;
    if (selectedTopNodeIds.contains_11rb$($receiver.nodeId)) {
      return new ExpressionNode(NodeType$EMPTY_getInstance(), '');
    }
    var result = $receiver.copy_uq8prj$();
    if (result.nodeType === NodeType$VARIABLE_getInstance()) {
      return result;
    }
    tmp$ = $receiver.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      var newChild = cloneWithoutSelectedNodes(child, selectedTopNodeIds);
      if (newChild.nodeType !== NodeType$EMPTY_getInstance()) {
        result.addChild_6718cy$(newChild);
      }
       else if (equals($receiver.value, '/')) {
        result.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
      }
    }
    if (ensureNotNull(result.functionStringDefinition).function.numberOfArguments === -1 && result.children.size === 0) {
      return new ExpressionNode(NodeType$EMPTY_getInstance(), '');
    }
     else if (ensureNotNull(result.functionStringDefinition).function.numberOfArguments > 0 && ensureNotNull(result.functionStringDefinition).function.numberOfArguments < result.children.size) {
      return new ExpressionNode(NodeType$EMPTY_getInstance(), '');
    }
    return result;
  }
  function SubstitutionSelectionData(originalExpression, selectedNodeIds, compiledConfiguration, expressionToTransform, isMoving, selectedNodeIdsMap, selectedNodes, topOfSelection, topOfSelectionParent, topOfSelectionIndex, lowestSubtree, lowestSubtreeHigh, notSelectedSubtreeTopOriginalTree, notSelectedSubtreeTopArguments, selectedSubtreeTopArguments, selectedSubtreeTopArgumentsInSelectionOrder, nestedNodesInSelection) {
    if (expressionToTransform === void 0)
      expressionToTransform = originalExpression.clone();
    if (isMoving === void 0)
      isMoving = false;
    if (selectedNodeIdsMap === void 0)
      selectedNodeIdsMap = nodeIdsPositionsMap(selectedNodeIds);
    if (selectedNodes === void 0)
      selectedNodes = nodeIdsToNodeLinksInSameOrder(expressionToTransform, selectedNodeIds, selectedNodeIdsMap);
    if (topOfSelection === void 0)
      topOfSelection = null;
    if (topOfSelectionParent === void 0)
      topOfSelectionParent = null;
    if (topOfSelectionIndex === void 0)
      topOfSelectionIndex = 0;
    if (lowestSubtree === void 0)
      lowestSubtree = null;
    if (lowestSubtreeHigh === void 0)
      lowestSubtreeHigh = null;
    if (notSelectedSubtreeTopOriginalTree === void 0)
      notSelectedSubtreeTopOriginalTree = null;
    if (notSelectedSubtreeTopArguments === void 0)
      notSelectedSubtreeTopArguments = null;
    if (selectedSubtreeTopArguments === void 0)
      selectedSubtreeTopArguments = null;
    if (selectedSubtreeTopArgumentsInSelectionOrder === void 0)
      selectedSubtreeTopArgumentsInSelectionOrder = null;
    if (nestedNodesInSelection === void 0)
      nestedNodesInSelection = false;
    this.originalExpression = originalExpression;
    this.selectedNodeIds = selectedNodeIds;
    this.compiledConfiguration = compiledConfiguration;
    this.expressionToTransform = expressionToTransform;
    this.isMoving = isMoving;
    this.selectedNodeIdsMap = selectedNodeIdsMap;
    this.selectedNodes = selectedNodes;
    this.topOfSelection = topOfSelection;
    this.topOfSelectionParent = topOfSelectionParent;
    this.topOfSelectionIndex = topOfSelectionIndex;
    this.lowestSubtree = lowestSubtree;
    this.lowestSubtreeHigh = lowestSubtreeHigh;
    this.notSelectedSubtreeTopOriginalTree = notSelectedSubtreeTopOriginalTree;
    this.notSelectedSubtreeTopArguments = notSelectedSubtreeTopArguments;
    this.selectedSubtreeTopArguments = selectedSubtreeTopArguments;
    this.selectedSubtreeTopArgumentsInSelectionOrder = selectedSubtreeTopArgumentsInSelectionOrder;
    this.nestedNodesInSelection = nestedNodesInSelection;
  }
  SubstitutionSelectionData.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'SubstitutionSelectionData',
    interfaces: []
  };
  SubstitutionSelectionData.prototype.component1 = function () {
    return this.originalExpression;
  };
  SubstitutionSelectionData.prototype.component2 = function () {
    return this.selectedNodeIds;
  };
  SubstitutionSelectionData.prototype.component3 = function () {
    return this.compiledConfiguration;
  };
  SubstitutionSelectionData.prototype.component4 = function () {
    return this.expressionToTransform;
  };
  SubstitutionSelectionData.prototype.component5 = function () {
    return this.isMoving;
  };
  SubstitutionSelectionData.prototype.component6 = function () {
    return this.selectedNodeIdsMap;
  };
  SubstitutionSelectionData.prototype.component7 = function () {
    return this.selectedNodes;
  };
  SubstitutionSelectionData.prototype.component8 = function () {
    return this.topOfSelection;
  };
  SubstitutionSelectionData.prototype.component9 = function () {
    return this.topOfSelectionParent;
  };
  SubstitutionSelectionData.prototype.component10 = function () {
    return this.topOfSelectionIndex;
  };
  SubstitutionSelectionData.prototype.component11 = function () {
    return this.lowestSubtree;
  };
  SubstitutionSelectionData.prototype.component12 = function () {
    return this.lowestSubtreeHigh;
  };
  SubstitutionSelectionData.prototype.component13 = function () {
    return this.notSelectedSubtreeTopOriginalTree;
  };
  SubstitutionSelectionData.prototype.component14 = function () {
    return this.notSelectedSubtreeTopArguments;
  };
  SubstitutionSelectionData.prototype.component15 = function () {
    return this.selectedSubtreeTopArguments;
  };
  SubstitutionSelectionData.prototype.component16 = function () {
    return this.selectedSubtreeTopArgumentsInSelectionOrder;
  };
  SubstitutionSelectionData.prototype.component17 = function () {
    return this.nestedNodesInSelection;
  };
  SubstitutionSelectionData.prototype.copy_mmvv2t$ = function (originalExpression, selectedNodeIds, compiledConfiguration, expressionToTransform, isMoving, selectedNodeIdsMap, selectedNodes, topOfSelection, topOfSelectionParent, topOfSelectionIndex, lowestSubtree, lowestSubtreeHigh, notSelectedSubtreeTopOriginalTree, notSelectedSubtreeTopArguments, selectedSubtreeTopArguments, selectedSubtreeTopArgumentsInSelectionOrder, nestedNodesInSelection) {
    return new SubstitutionSelectionData(originalExpression === void 0 ? this.originalExpression : originalExpression, selectedNodeIds === void 0 ? this.selectedNodeIds : selectedNodeIds, compiledConfiguration === void 0 ? this.compiledConfiguration : compiledConfiguration, expressionToTransform === void 0 ? this.expressionToTransform : expressionToTransform, isMoving === void 0 ? this.isMoving : isMoving, selectedNodeIdsMap === void 0 ? this.selectedNodeIdsMap : selectedNodeIdsMap, selectedNodes === void 0 ? this.selectedNodes : selectedNodes, topOfSelection === void 0 ? this.topOfSelection : topOfSelection, topOfSelectionParent === void 0 ? this.topOfSelectionParent : topOfSelectionParent, topOfSelectionIndex === void 0 ? this.topOfSelectionIndex : topOfSelectionIndex, lowestSubtree === void 0 ? this.lowestSubtree : lowestSubtree, lowestSubtreeHigh === void 0 ? this.lowestSubtreeHigh : lowestSubtreeHigh, notSelectedSubtreeTopOriginalTree === void 0 ? this.notSelectedSubtreeTopOriginalTree : notSelectedSubtreeTopOriginalTree, notSelectedSubtreeTopArguments === void 0 ? this.notSelectedSubtreeTopArguments : notSelectedSubtreeTopArguments, selectedSubtreeTopArguments === void 0 ? this.selectedSubtreeTopArguments : selectedSubtreeTopArguments, selectedSubtreeTopArgumentsInSelectionOrder === void 0 ? this.selectedSubtreeTopArgumentsInSelectionOrder : selectedSubtreeTopArgumentsInSelectionOrder, nestedNodesInSelection === void 0 ? this.nestedNodesInSelection : nestedNodesInSelection);
  };
  SubstitutionSelectionData.prototype.toString = function () {
    return 'SubstitutionSelectionData(originalExpression=' + Kotlin.toString(this.originalExpression) + (', selectedNodeIds=' + Kotlin.toString(this.selectedNodeIds)) + (', compiledConfiguration=' + Kotlin.toString(this.compiledConfiguration)) + (', expressionToTransform=' + Kotlin.toString(this.expressionToTransform)) + (', isMoving=' + Kotlin.toString(this.isMoving)) + (', selectedNodeIdsMap=' + Kotlin.toString(this.selectedNodeIdsMap)) + (', selectedNodes=' + Kotlin.toString(this.selectedNodes)) + (', topOfSelection=' + Kotlin.toString(this.topOfSelection)) + (', topOfSelectionParent=' + Kotlin.toString(this.topOfSelectionParent)) + (', topOfSelectionIndex=' + Kotlin.toString(this.topOfSelectionIndex)) + (', lowestSubtree=' + Kotlin.toString(this.lowestSubtree)) + (', lowestSubtreeHigh=' + Kotlin.toString(this.lowestSubtreeHigh)) + (', notSelectedSubtreeTopOriginalTree=' + Kotlin.toString(this.notSelectedSubtreeTopOriginalTree)) + (', notSelectedSubtreeTopArguments=' + Kotlin.toString(this.notSelectedSubtreeTopArguments)) + (', selectedSubtreeTopArguments=' + Kotlin.toString(this.selectedSubtreeTopArguments)) + (', selectedSubtreeTopArgumentsInSelectionOrder=' + Kotlin.toString(this.selectedSubtreeTopArgumentsInSelectionOrder)) + (', nestedNodesInSelection=' + Kotlin.toString(this.nestedNodesInSelection)) + ')';
  };
  SubstitutionSelectionData.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.originalExpression) | 0;
    result = result * 31 + Kotlin.hashCode(this.selectedNodeIds) | 0;
    result = result * 31 + Kotlin.hashCode(this.compiledConfiguration) | 0;
    result = result * 31 + Kotlin.hashCode(this.expressionToTransform) | 0;
    result = result * 31 + Kotlin.hashCode(this.isMoving) | 0;
    result = result * 31 + Kotlin.hashCode(this.selectedNodeIdsMap) | 0;
    result = result * 31 + Kotlin.hashCode(this.selectedNodes) | 0;
    result = result * 31 + Kotlin.hashCode(this.topOfSelection) | 0;
    result = result * 31 + Kotlin.hashCode(this.topOfSelectionParent) | 0;
    result = result * 31 + Kotlin.hashCode(this.topOfSelectionIndex) | 0;
    result = result * 31 + Kotlin.hashCode(this.lowestSubtree) | 0;
    result = result * 31 + Kotlin.hashCode(this.lowestSubtreeHigh) | 0;
    result = result * 31 + Kotlin.hashCode(this.notSelectedSubtreeTopOriginalTree) | 0;
    result = result * 31 + Kotlin.hashCode(this.notSelectedSubtreeTopArguments) | 0;
    result = result * 31 + Kotlin.hashCode(this.selectedSubtreeTopArguments) | 0;
    result = result * 31 + Kotlin.hashCode(this.selectedSubtreeTopArgumentsInSelectionOrder) | 0;
    result = result * 31 + Kotlin.hashCode(this.nestedNodesInSelection) | 0;
    return result;
  };
  SubstitutionSelectionData.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.originalExpression, other.originalExpression) && Kotlin.equals(this.selectedNodeIds, other.selectedNodeIds) && Kotlin.equals(this.compiledConfiguration, other.compiledConfiguration) && Kotlin.equals(this.expressionToTransform, other.expressionToTransform) && Kotlin.equals(this.isMoving, other.isMoving) && Kotlin.equals(this.selectedNodeIdsMap, other.selectedNodeIdsMap) && Kotlin.equals(this.selectedNodes, other.selectedNodes) && Kotlin.equals(this.topOfSelection, other.topOfSelection) && Kotlin.equals(this.topOfSelectionParent, other.topOfSelectionParent) && Kotlin.equals(this.topOfSelectionIndex, other.topOfSelectionIndex) && Kotlin.equals(this.lowestSubtree, other.lowestSubtree) && Kotlin.equals(this.lowestSubtreeHigh, other.lowestSubtreeHigh) && Kotlin.equals(this.notSelectedSubtreeTopOriginalTree, other.notSelectedSubtreeTopOriginalTree) && Kotlin.equals(this.notSelectedSubtreeTopArguments, other.notSelectedSubtreeTopArguments) && Kotlin.equals(this.selectedSubtreeTopArguments, other.selectedSubtreeTopArguments) && Kotlin.equals(this.selectedSubtreeTopArgumentsInSelectionOrder, other.selectedSubtreeTopArgumentsInSelectionOrder) && Kotlin.equals(this.nestedNodesInSelection, other.nestedNodesInSelection)))));
  };
  function SubstitutionApplication(expressionSubstitution, originalExpression, originalExpressionChangingPart, resultExpression, resultExpressionChangingPart, substitutionType, priority) {
    this.expressionSubstitution = expressionSubstitution;
    this.originalExpression = originalExpression;
    this.originalExpressionChangingPart = originalExpressionChangingPart;
    this.resultExpression = resultExpression;
    this.resultExpressionChangingPart = resultExpressionChangingPart;
    this.substitutionType = substitutionType;
    this.priority = priority;
  }
  SubstitutionApplication.prototype.toString = function () {
    return '' + ("result: '" + this.resultExpression.toPlainTextView_odr8sm$() + "'" + '\n') + ("expressionSubstitution.left: '" + this.expressionSubstitution.left.toString() + "'" + '\n') + ("expressionSubstitution.right: '" + this.expressionSubstitution.right.toString() + "'" + '\n') + ("originalExpression: '" + this.originalExpression.toString() + "'" + '\n') + ("originalExpressionChangingPart: '" + this.originalExpressionChangingPart.toString() + "'" + '\n') + ("resultExpression: '" + this.resultExpression.toString() + "'" + '\n') + ("resultExpressionChangingPart: '" + this.resultExpressionChangingPart.toString() + "'" + '\n') + ("substitutionType: '" + this.substitutionType + "'" + '\n') + ("priority: '" + this.priority + "'");
  };
  SubstitutionApplication.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'SubstitutionApplication',
    interfaces: []
  };
  SubstitutionApplication.prototype.component1 = function () {
    return this.expressionSubstitution;
  };
  SubstitutionApplication.prototype.component2 = function () {
    return this.originalExpression;
  };
  SubstitutionApplication.prototype.component3 = function () {
    return this.originalExpressionChangingPart;
  };
  SubstitutionApplication.prototype.component4 = function () {
    return this.resultExpression;
  };
  SubstitutionApplication.prototype.component5 = function () {
    return this.resultExpressionChangingPart;
  };
  SubstitutionApplication.prototype.component6 = function () {
    return this.substitutionType;
  };
  SubstitutionApplication.prototype.component7 = function () {
    return this.priority;
  };
  SubstitutionApplication.prototype.copy_p6ff07$ = function (expressionSubstitution, originalExpression, originalExpressionChangingPart, resultExpression, resultExpressionChangingPart, substitutionType, priority) {
    return new SubstitutionApplication(expressionSubstitution === void 0 ? this.expressionSubstitution : expressionSubstitution, originalExpression === void 0 ? this.originalExpression : originalExpression, originalExpressionChangingPart === void 0 ? this.originalExpressionChangingPart : originalExpressionChangingPart, resultExpression === void 0 ? this.resultExpression : resultExpression, resultExpressionChangingPart === void 0 ? this.resultExpressionChangingPart : resultExpressionChangingPart, substitutionType === void 0 ? this.substitutionType : substitutionType, priority === void 0 ? this.priority : priority);
  };
  SubstitutionApplication.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.expressionSubstitution) | 0;
    result = result * 31 + Kotlin.hashCode(this.originalExpression) | 0;
    result = result * 31 + Kotlin.hashCode(this.originalExpressionChangingPart) | 0;
    result = result * 31 + Kotlin.hashCode(this.resultExpression) | 0;
    result = result * 31 + Kotlin.hashCode(this.resultExpressionChangingPart) | 0;
    result = result * 31 + Kotlin.hashCode(this.substitutionType) | 0;
    result = result * 31 + Kotlin.hashCode(this.priority) | 0;
    return result;
  };
  SubstitutionApplication.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.expressionSubstitution, other.expressionSubstitution) && Kotlin.equals(this.originalExpression, other.originalExpression) && Kotlin.equals(this.originalExpressionChangingPart, other.originalExpressionChangingPart) && Kotlin.equals(this.resultExpression, other.resultExpression) && Kotlin.equals(this.resultExpressionChangingPart, other.resultExpressionChangingPart) && Kotlin.equals(this.substitutionType, other.substitutionType) && Kotlin.equals(this.priority, other.priority)))));
  };
  function simpleCommutativeOperationSelectionHandling(substitutionSelectionData) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    if (substitutionSelectionData.selectedNodeIds.length > 1 && substitutionSelectionData.lowestSubtreeHigh != null) {
      tmp$_1 = (tmp$_0 = (tmp$ = ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).functionStringDefinition) != null ? tmp$.function : null) != null ? tmp$_0.isCommutativeWithNullWeight : null;
      if (tmp$_1 == null) {
        return;
      }
      var tmp$_3 = tmp$_1;
      if (!tmp$_3) {
        var tmp$_4 = substitutionSelectionData.selectedNodeIds.length === 2;
        if (tmp$_4) {
          var $receiver = ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).getChildNodesOnDepthOrWhileOperation_okkhzr$(2, listOf_0(['*', '/']));
          var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
          var tmp$_5;
          tmp$_5 = $receiver.iterator();
          while (tmp$_5.hasNext()) {
            var item = tmp$_5.next();
            destination.add_11rb$(item.nodeId);
          }
          tmp$_4 = destination.containsAll_brywnq$(toList(substitutionSelectionData.selectedNodeIds));
        }
        tmp$_3 = (tmp$_4 && equals(ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).value, '/'));
      }
      tmp$_2 = tmp$_3;
    }
     else
      tmp$_2 = false;
    if (tmp$_2) {
      var topOperation = ensureNotNull(ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).functionStringDefinition).function.notObligateMainFunction();
      substitutionSelectionData.notSelectedSubtreeTopOriginalTree = cloneWithoutSelectedNodes(ensureNotNull(substitutionSelectionData.topOfSelection), ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).getContainedChildOperationNodeIds_61zpoe$(topOperation));
      substitutionSelectionData.notSelectedSubtreeTopArguments = topOperationNode(topOperation, ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).value, substitutionSelectionData);
      if (!equals(ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).value, '/')) {
        ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments).addChild_6718cy$(new ExpressionNode(NodeType$EMPTY_getInstance(), 'place_for_result'));
      }
      substitutionSelectionData.selectedSubtreeTopArguments = topOperationNode(topOperation, ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).value, substitutionSelectionData);
      substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder = topOperationNode(topOperation, ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).value, substitutionSelectionData);
      var tmp$_6 = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder);
      var array = Array_0(substitutionSelectionData.selectedNodeIds.length);
      var tmp$_7;
      tmp$_7 = array.length - 1 | 0;
      for (var i = 0; i <= tmp$_7; i++) {
        array[i] = new ExpressionNode(NodeType$EMPTY_getInstance(), '');
      }
      tmp$_6.children = toMutableList_0(array);
      simpleCommutativeOperationSelectionHandlingRecursivePart(ensureNotNull(substitutionSelectionData.lowestSubtreeHigh), substitutionSelectionData, topOperation);
      var tmp$_8 = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder);
      var $receiver_0 = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children;
      var destination_0 = ArrayList_init();
      var tmp$_9;
      tmp$_9 = $receiver_0.iterator();
      while (tmp$_9.hasNext()) {
        var element = tmp$_9.next();
        if (element.nodeType !== NodeType$EMPTY_getInstance())
          destination_0.add_11rb$(element);
      }
      tmp$_8.children = toMutableList(destination_0);
    }
     else {
      substitutionSelectionData.selectedSubtreeTopArguments = substitutionSelectionData.topOfSelection;
      while (ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).value.length === 0 && ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).children.size === 1) {
        substitutionSelectionData.selectedSubtreeTopArguments = first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).children);
      }
      substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder = substitutionSelectionData.selectedSubtreeTopArguments;
    }
  }
  function topOperationNode(topOperation, value, substitutionSelectionData) {
    if (!equals(value, '/')) {
      var $receiver = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$(topOperation, -1);
      $receiver.linkOnOriginalTreeNode = ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).linkOnOriginalTreeNode;
      return $receiver;
    }
     else {
      var $receiver_0 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
      $receiver_0.linkOnOriginalTreeNode = ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).linkOnOriginalTreeNode;
      var $receiver_1 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
      $receiver_1.linkOnOriginalTreeNode = ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).linkOnOriginalTreeNode;
      $receiver_0.addChild_6718cy$($receiver_1);
      var $receiver_2 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
      $receiver_2.linkOnOriginalTreeNode = ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).linkOnOriginalTreeNode;
      $receiver_0.addChild_6718cy$($receiver_2);
      return $receiver_0;
    }
  }
  function simpleCommutativeOperationSelectionHandlingRecursivePart($receiver, substitutionSelectionData, topOperation, hasMinus, hasDivision) {
    if (hasMinus === void 0)
      hasMinus = false;
    if (hasDivision === void 0)
      hasDivision = false;
    var tmp$, tmp$_0, tmp$_1;
    var originalNode = ensureNotNull($receiver.linkOnOriginalTreeNode);
    var $receiver_0 = $receiver.children;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver_0, 10));
    var tmp$_2;
    tmp$_2 = $receiver_0.iterator();
    while (tmp$_2.hasNext()) {
      var item = tmp$_2.next();
      destination.add_11rb$(new Pair(item.nodeId, item));
    }
    var selectedNodeIdsMap = toMap(destination);
    tmp$ = get_lastIndex(originalNode.children);
    for (var i = 0; i <= tmp$; i++) {
      var updatedHasDivision = hasDivision ^ (i > 0 && equals($receiver.value, '/'));
      var child = originalNode.children.get_za3lpa$(i);
      var childSelectionNode = selectedNodeIdsMap.get_11rb$(child.nodeId);
      if (childSelectionNode == null) {
        var newChild = createNewArgument(hasMinus, child, substitutionSelectionData);
        minusDivisionSafetyAddChild(ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments), substitutionSelectionData.compiledConfiguration, newChild, updatedHasDivision);
      }
       else {
        if (!childSelectionNode.children.isEmpty() && (equals((tmp$_1 = (tmp$_0 = childSelectionNode.functionStringDefinition) != null ? tmp$_0.function : null) != null ? tmp$_1.notObligateMainFunction() : null, topOperation) || (childSelectionNode.children.size === 1 && equals(childSelectionNode.value, '+') && equals(first(childSelectionNode.children).value, '-')))) {
          simpleCommutativeOperationSelectionHandlingRecursivePart(childSelectionNode, substitutionSelectionData, topOperation, hasMinus ^ equals(childSelectionNode.value, '-'), updatedHasDivision);
        }
         else {
          var newChild_0 = createNewArgument(hasMinus, child, substitutionSelectionData);
          minusDivisionSafetyAddChild(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments), substitutionSelectionData.compiledConfiguration, newChild_0, updatedHasDivision);
          if (!equals(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).value, '/')) {
            minusDivisionSafetySetChildOnPosition(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder), substitutionSelectionData.compiledConfiguration, newChild_0.clone(), findPositionOfClosedSelectedNode(child, substitutionSelectionData), updatedHasDivision);
          }
        }
      }
    }
  }
  function createNewArgument(hasMinus, child, substitutionSelectionData) {
    if (hasMinus) {
      if (hasMinus && equals(child.value, '-') && child.children.size === 1) {
        return first(child.children).clone();
      }
       else {
        return generateMinusNode(ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments).value, substitutionSelectionData.compiledConfiguration, child.clone());
      }
    }
     else {
      return child.clone();
    }
  }
  function minusDivisionSafetyAddChild($receiver, compiledConfiguration, child, hasDivision) {
    var tmp$;
    if (equals(child.value, '-') && !equals($receiver.value, '+')) {
      var $receiver_0 = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
      $receiver_0.addChild_6718cy$(child);
      tmp$ = $receiver_0;
    }
     else {
      tmp$ = child;
    }
    var newChild = tmp$;
    if (!equals($receiver.value, '/')) {
      if (hasDivision) {
        var $receiver_1 = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
        $receiver_1.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
        $receiver_1.addChild_6718cy$(newChild);
        $receiver.addChild_6718cy$($receiver_1);
      }
       else {
        $receiver.addChild_6718cy$(newChild);
      }
    }
     else {
      if (hasDivision) {
        last($receiver.children).addChild_6718cy$(newChild);
      }
       else {
        first($receiver.children).addChild_6718cy$(newChild);
      }
    }
  }
  function minusDivisionSafetySetChildOnPosition($receiver, compiledConfiguration, child, position, hasDivision) {
    var tmp$;
    if (equals(child.value, '-') && !equals($receiver.value, '+')) {
      var $receiver_0 = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
      $receiver_0.addChild_6718cy$(child);
      tmp$ = $receiver_0;
    }
     else {
      tmp$ = child;
    }
    var newChild = tmp$;
    if (hasDivision) {
      var $receiver_1 = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
      $receiver_1.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
      $receiver_1.addChild_6718cy$(newChild);
      $receiver.setChildOnPosition_tvfpvg$($receiver_1, position);
    }
     else {
      $receiver.setChildOnPosition_tvfpvg$(newChild, position);
    }
  }
  function generateMinusNode(currentNodeValue, compiledConfiguration, child) {
    if (equals(currentNodeValue, '+')) {
      var $receiver = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1);
      $receiver.addChild_6718cy$(child.clone());
      return $receiver;
    }
     else {
      var $receiver_0 = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
      $receiver_0.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
      last($receiver_0.children).addChild_6718cy$(child.clone());
      return $receiver_0;
    }
  }
  function findPositionOfClosedSelectedNode($receiver, substitutionSelectionData) {
    var tmp$;
    var result = substitutionSelectionData.selectedNodeIdsMap.get_11rb$($receiver.nodeId);
    if (result != null)
      return result;
    tmp$ = $receiver.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      result = findPositionOfClosedSelectedNode(child, substitutionSelectionData);
      if (result >= 0)
        return result;
    }
    return -1;
  }
  function fillSubstitutionSelectionData(substitutionSelectionData) {
    var tmp$;
    substitutionSelectionData.topOfSelection = findLowestSubtreeTopOfNodes(substitutionSelectionData.expressionToTransform, substitutionSelectionData.selectedNodes);
    substitutionSelectionData.topOfSelectionParent = (tmp$ = substitutionSelectionData.topOfSelection) != null ? tmp$.parent : null;
    substitutionSelectionData.topOfSelectionIndex = indexOf(ensureNotNull(substitutionSelectionData.topOfSelectionParent).children, substitutionSelectionData.topOfSelection);
    var nestedNodesInSelection = ArrayList_init();
    substitutionSelectionData.lowestSubtree = findLowestSubtreeWithNodes(substitutionSelectionData.expressionToTransform, substitutionSelectionData.selectedNodes, false, nestedNodesInSelection);
    if (nestedNodesInSelection.contains_11rb$(true)) {
      substitutionSelectionData.nestedNodesInSelection = true;
    }
    substitutionSelectionData.lowestSubtreeHigh = findLowestSubtreeWithNodes(substitutionSelectionData.expressionToTransform, substitutionSelectionData.selectedNodes, true);
    simpleCommutativeOperationSelectionHandling(substitutionSelectionData);
  }
  function findConfiguredSubstitutionsApplications(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, withExtendingSubstitutions, alreadyAddedSubstitutionCodes) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    if (withExtendingSubstitutions === void 0)
      withExtendingSubstitutions = true;
    if (alreadyAddedSubstitutionCodes === void 0) {
      alreadyAddedSubstitutionCodes = emptySet();
    }
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3;
    var result = ArrayList_init();
    tmp$ = substitutionSelectionData.compiledConfiguration.compiledExpressionTreeTransformationRules.iterator();
    while (tmp$.hasNext()) {
      var transformation = tmp$.next();
      if (alreadyAddedSubstitutionCodes.contains_11rb$(transformation.code)) {
        continue;
      }
      if ((!withExtendingSubstitutions || substitutionSelectionData.selectedNodes.size > 1) && transformation.isExtending) {
        continue;
      }
      tmp$_0 = checkLeftCondition(substitutionSelectionData, transformation, fastestAppropriateVersion);
      if (tmp$_0 == null) {
        continue;
      }
      var substitutionInstance = tmp$_0;
      if (substitutionInstance.isApplicable) {
        tmp$_1 = transformation.applyRight_7o4uji$(substitutionInstance);
        if (tmp$_1 == null) {
          continue;
        }
        var applicationToSelectedPartResult = tmp$_1;
        addApplicationToResults(withReadyApplicationResult, substitutionSelectionData, simplifyNotSelectedTopArguments, applicationToSelectedPartResult, result, transformation, (tmp$_2 = transformation.code) != null ? tmp$_2 : 'ConfiguredSubstitution', (tmp$_3 = transformation.priority) != null ? tmp$_3 : 50);
      }
    }
    return result;
  }
  function generateParentBracketsExpansionSubstitution(substitutionSelectionData) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8;
    var result = ArrayList_init();
    if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$(PARENT_BRACKETS_EXPANSION)) {
      var subst = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$(PARENT_BRACKETS_EXPANSION));
      if (substitutionSelectionData.selectedNodes.size === 1 && equals((tmp$ = firstOrNull_0(substitutionSelectionData.selectedNodes)) != null ? tmp$.value : null, (tmp$_1 = (tmp$_0 = firstOrNull_0(substitutionSelectionData.selectedNodes)) != null ? tmp$_0.parent : null) != null ? tmp$_1.value : null) && ((tmp$_4 = (tmp$_3 = (tmp$_2 = firstOrNull_0(substitutionSelectionData.selectedNodes)) != null ? tmp$_2.functionStringDefinition : null) != null ? tmp$_3.function : null) != null ? tmp$_4.isCommutativeWithNullWeight : null) === true) {
        var inBracketsNode = first(substitutionSelectionData.selectedNodes);
        var inBracketsNodeParent = ensureNotNull(inBracketsNode.parent);
        var inBracketsNodeIndex = inBracketsNodeParent.children.indexOf_11rb$(inBracketsNode);
        var newParent = inBracketsNodeParent.copy_uq8prj$();
        for (var i = 0; i < inBracketsNodeIndex; i++) {
          newParent.addChild_6718cy$(inBracketsNodeParent.children.get_za3lpa$(i).clone());
        }
        tmp$_5 = inBracketsNode.children.iterator();
        while (tmp$_5.hasNext()) {
          var child = tmp$_5.next();
          newParent.addChild_6718cy$(child.clone());
        }
        tmp$_6 = get_lastIndex(inBracketsNodeParent.children);
        for (var i_0 = inBracketsNodeIndex + 1 | 0; i_0 <= tmp$_6; i_0++) {
          newParent.addChild_6718cy$(inBracketsNodeParent.children.get_za3lpa$(i_0).clone());
        }
        tmp$_7 = inBracketsNodeParent.parent;
        if (tmp$_7 == null) {
          return result;
        }
        var parentOfParent = tmp$_7;
        var parentNodeIndex = parentOfParent.children.indexOf_11rb$(inBracketsNodeParent);
        parentOfParent.setChildOnPosition_tvfpvg$(newParent, parentNodeIndex);
        var $receiver = substitutionSelectionData.expressionToTransform.clone();
        normalizeExpressionToUsualForm($receiver, substitutionSelectionData.compiledConfiguration);
        var resultExpression = $receiver;
        parentOfParent.setChildOnPosition_tvfpvg$(inBracketsNodeParent, parentNodeIndex);
        var swapSubstitution = new ExpressionSubstitution(addRootNodeToExpression(inBracketsNodeParent.clone()), addRootNodeToExpression(newParent), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
        result.add_11rb$(new SubstitutionApplication(swapSubstitution, substitutionSelectionData.originalExpression, inBracketsNodeParent.clone(), resultExpression, newParent, PARENT_BRACKETS_EXPANSION, (tmp$_8 = subst.priority) != null ? tmp$_8 : 1));
      }
    }
    return result;
  }
  function generateMinusInOutBracketsSubstitution(substitutionSelectionData) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11;
    var result = ArrayList_init();
    if (substitutionSelectionData.selectedNodes.size === 1 && equals((tmp$_1 = (tmp$_0 = (tmp$ = firstOrNull_0(substitutionSelectionData.selectedNodes)) != null ? tmp$.functionStringDefinition : null) != null ? tmp$_0.function : null) != null ? tmp$_1.mainFunction : null, '+') && substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('MinusInOutBrackets')) {
      var subst = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('MinusInOutBrackets'));
      if (equals((tmp$_2 = firstOrNull_0(substitutionSelectionData.selectedNodes)) != null ? tmp$_2.value : null, '+')) {
        tmp$_7 = first(substitutionSelectionData.selectedNodes);
      }
       else if (equals((tmp$_3 = firstOrNull_0(substitutionSelectionData.selectedNodes)) != null ? tmp$_3.value : null, '-') && equals((tmp$_6 = (tmp$_5 = (tmp$_4 = firstOrNull_0(substitutionSelectionData.selectedNodes)) != null ? tmp$_4.children : null) != null ? firstOrNull_0(tmp$_5) : null) != null ? tmp$_6.value : null, '+')) {
        tmp$_7 = first(first(substitutionSelectionData.selectedNodes).children);
      }
       else
        return emptyList();
      var inBracketsNode = tmp$_7;
      var newInBracketsNode = inBracketsNode.copy_uq8prj$();
      tmp$_8 = inBracketsNode.children.iterator();
      while (tmp$_8.hasNext()) {
        var child = tmp$_8.next();
        if (equals(child.value, '-')) {
          newInBracketsNode.addChild_6718cy$(first(child.children).clone());
        }
         else {
          var $receiver = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1);
          $receiver.addChild_6718cy$(child.clone());
          newInBracketsNode.addChild_6718cy$($receiver);
        }
      }
      var inBracketsNodeParent = ensureNotNull(inBracketsNode.parent);
      if (equals(inBracketsNodeParent.value, '-')) {
        var $receiver_0 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
        $receiver_0.addChild_6718cy$(inBracketsNodeParent.clone());
        var left = $receiver_0;
        var originalExpression = substitutionSelectionData.originalExpression.clone();
        tmp$_9 = inBracketsNodeParent.parent;
        if (tmp$_9 == null) {
          return result;
        }
        var parentOfParent = tmp$_9;
        var parentNodeIndex = parentOfParent.children.indexOf_11rb$(inBracketsNodeParent);
        parentOfParent.setChildOnPosition_tvfpvg$(newInBracketsNode, parentNodeIndex);
        var $receiver_1 = substitutionSelectionData.expressionToTransform.clone();
        normalizeExpressionToUsualForm($receiver_1, substitutionSelectionData.compiledConfiguration);
        var resultExpression = $receiver_1;
        parentOfParent.setChildOnPosition_tvfpvg$(inBracketsNodeParent, parentNodeIndex);
        var minusInBracketsSubstitution = new ExpressionSubstitution(addRootNodeToExpression(left), addRootNodeToExpression(newInBracketsNode), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
        result.add_11rb$(new SubstitutionApplication(minusInBracketsSubstitution, originalExpression, left, resultExpression, newInBracketsNode, 'MinusInBrackets', (tmp$_10 = subst.priority) != null ? tmp$_10 : 60));
      }
       else {
        var $receiver_2 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1);
        $receiver_2.addChild_6718cy$(newInBracketsNode.clone());
        var right = {v: $receiver_2};
        if (!equals(inBracketsNodeParent.value, '+')) {
          var $receiver_3 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
          $receiver_3.addChild_6718cy$(right.v.clone());
          right.v = $receiver_3;
        }
        var originalExpression_0 = substitutionSelectionData.originalExpression.clone();
        var inBracketsNodeIndex = inBracketsNodeParent.children.indexOf_11rb$(inBracketsNode);
        inBracketsNodeParent.setChildOnPosition_tvfpvg$(right.v, inBracketsNodeIndex);
        var $receiver_4 = substitutionSelectionData.expressionToTransform.clone();
        normalizeExpressionToUsualForm($receiver_4, substitutionSelectionData.compiledConfiguration);
        var resultExpression_0 = $receiver_4;
        inBracketsNodeParent.setChildOnPosition_tvfpvg$(inBracketsNode, inBracketsNodeIndex);
        if (equals(right.v.value, '-')) {
          var $receiver_5 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
          $receiver_5.addChild_6718cy$(right.v.clone());
          right.v = $receiver_5;
        }
        var minusOutBracketsSubstitution = new ExpressionSubstitution(addRootNodeToExpression(inBracketsNode), addRootNodeToExpression(right.v), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
        result.add_11rb$(new SubstitutionApplication(minusOutBracketsSubstitution, originalExpression_0, inBracketsNode, resultExpression_0, right.v, 'MinusFromBrackets', (tmp$_11 = subst.priority) != null ? tmp$_11 : 60));
      }
    }
    return result;
  }
  function generatePermutationSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11, tmp$_12, tmp$_13, tmp$_14, tmp$_15, tmp$_16;
    var result = ArrayList_init();
    if (substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder != null && ((tmp$_1 = (tmp$_0 = (tmp$ = substitutionSelectionData.selectedSubtreeTopArguments) != null ? tmp$.functionStringDefinition : null) != null ? tmp$_0.function : null) != null ? tmp$_1.isCommutativeWithNullWeight : null) === true && !substitutionSelectionData.nestedNodesInSelection) {
      tmp$_7 = substitutionSelectionData.lowestSubtreeHigh;
      tmp$_6 = (tmp$_5 = (tmp$_4 = (tmp$_3 = (tmp$_2 = substitutionSelectionData.lowestSubtreeHigh) != null ? tmp$_2.functionStringDefinition : null) != null ? tmp$_3.function : null) != null ? tmp$_4.mainFunction : null) != null ? tmp$_5 : '';
      var userSelectedDirectlyChildrenOfCommutativeNode = (tmp$_8 = tmp$_7 != null ? tmp$_7.allParentsMainFunctionIs_61zpoe$(tmp$_6) : null) != null ? tmp$_8 : false;
      var swapSubstitutionSuggested = false;
      if (substitutionSelectionData.selectedNodes.size === 2 && userSelectedDirectlyChildrenOfCommutativeNode && substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('ArgumentsSwap')) {
        var subst = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('ArgumentsSwap'));
        var selectedHighList = ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).listWhichParentsFunctionIs_61zpoe$(ensureNotNull(ensureNotNull(substitutionSelectionData.lowestSubtreeHigh).functionStringDefinition).function.mainFunction);
        if (selectedHighList.size === 2) {
          var originalExpression = substitutionSelectionData.originalExpression.clone();
          var firstNode = first(selectedHighList);
          tmp$_9 = firstNode.parent;
          if (tmp$_9 == null) {
            return result;
          }
          var firstNodeParent = tmp$_9;
          var firstNodeIndex = firstNodeParent.children.indexOf_11rb$(firstNode);
          var secondNode = last(selectedHighList);
          tmp$_10 = secondNode.parent;
          if (tmp$_10 == null) {
            return result;
          }
          var secondNodeParent = tmp$_10;
          var secondNodeIndex = secondNodeParent.children.indexOf_11rb$(secondNode);
          firstNodeParent.setChildOnPosition_tvfpvg$(secondNode, firstNodeIndex);
          secondNodeParent.setChildOnPosition_tvfpvg$(firstNode, secondNodeIndex);
          var swapResult = ensureNotNull(substitutionSelectionData.topOfSelection).clone();
          var $receiver = substitutionSelectionData.expressionToTransform.clone();
          normalizeExpressionToUsualForm($receiver, substitutionSelectionData.compiledConfiguration);
          var resultExpression = $receiver;
          firstNodeParent.setChildOnPosition_tvfpvg$(firstNode, firstNodeIndex);
          secondNodeParent.setChildOnPosition_tvfpvg$(secondNode, secondNodeIndex);
          var swapSubstitution = new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.topOfSelection).clone()), addRootNodeToExpression(swapResult), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
          result.add_11rb$(new SubstitutionApplication(swapSubstitution, originalExpression, ensureNotNull(substitutionSelectionData.topOfSelection).clone(), resultExpression, swapResult, 'Swap', (tmp$_11 = subst.priority) != null ? tmp$_11 : 10));
          swapSubstitutionSuggested = true;
        }
      }
      if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('ArgumentsPermutation')) {
        var subst_0 = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('ArgumentsPermutation'));
        if (!swapSubstitutionSuggested && substitutionSelectionData.notSelectedSubtreeTopArguments != null && ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments).children.size === 1 && ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).children.size === 2) {
          var $receiver_0 = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone();
          reverse($receiver_0.children);
          var selectedPartTransformationResultInSelectedOrderInBrackets = $receiver_0;
          addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, selectedPartTransformationResultInSelectedOrderInBrackets, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone()), addRootNodeToExpression(selectedPartTransformationResultInSelectedOrderInBrackets), void 0, void 0, subst_0.code, subst_0.nameEn, subst_0.nameRu), 'ArgumentsPermutation', (tmp$_12 = subst_0.priority) != null ? tmp$_12 : 90);
        }
         else if (substitutionSelectionData.notSelectedSubtreeTopArguments != null && ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments).children.size > 1 || (!swapSubstitutionSuggested && !equals(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).toString(), ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).toString()))) {
          if (ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments).children.size > 1) {
            var $receiver_1 = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).copy_uq8prj$();
            $receiver_1.addChild_6718cy$(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).clone());
            tmp$_13 = $receiver_1;
          }
           else {
            tmp$_13 = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder);
          }
          var selectedPartTransformationResultInSelectedOrderInBrackets_0 = tmp$_13;
          addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, selectedPartTransformationResultInSelectedOrderInBrackets_0, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone()), addRootNodeToExpression(selectedPartTransformationResultInSelectedOrderInBrackets_0), void 0, void 0, subst_0.code, subst_0.nameEn, subst_0.nameRu), 'SelectedOrderExtraction', (tmp$_14 = subst_0.priority) != null ? tmp$_14 : 90);
          if (!equals(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).toString(), ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).toString()) && (substitutionSelectionData.notSelectedSubtreeTopArguments != null && ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments).children.size > 1) && !equals(ensureNotNull(substitutionSelectionData.topOfSelection).toString(), ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).toString()) && substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('ArgumentsPermutationInOriginalOrder')) {
            subst_0 = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('ArgumentsPermutationInOriginalOrder'));
            if (ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments).children.size > 1) {
              var $receiver_2 = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).copy_uq8prj$();
              $receiver_2.addChild_6718cy$(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone());
              tmp$_15 = $receiver_2;
            }
             else {
              tmp$_15 = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments);
            }
            var selectedPartTransformationResultInOriginalOrderInBrackets = tmp$_15;
            addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, selectedPartTransformationResultInOriginalOrderInBrackets, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone()), addRootNodeToExpression(selectedPartTransformationResultInOriginalOrderInBrackets), void 0, void 0, subst_0.code, subst_0.nameEn, subst_0.nameRu), 'OriginalOrderExtraction', (tmp$_16 = subst_0.priority) != null ? tmp$_16 : 90);
          }
        }
      }
    }
    return result;
  }
  function ExpressionStrictureIdentifierCounter(expressionStrictureIdentifier, count) {
    if (count === void 0)
      count = 1;
    this.expressionStrictureIdentifier = expressionStrictureIdentifier;
    this.count = count;
  }
  ExpressionStrictureIdentifierCounter.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionStrictureIdentifierCounter',
    interfaces: []
  };
  ExpressionStrictureIdentifierCounter.prototype.component1 = function () {
    return this.expressionStrictureIdentifier;
  };
  ExpressionStrictureIdentifierCounter.prototype.component2 = function () {
    return this.count;
  };
  ExpressionStrictureIdentifierCounter.prototype.copy_d7ey3a$ = function (expressionStrictureIdentifier, count) {
    return new ExpressionStrictureIdentifierCounter(expressionStrictureIdentifier === void 0 ? this.expressionStrictureIdentifier : expressionStrictureIdentifier, count === void 0 ? this.count : count);
  };
  ExpressionStrictureIdentifierCounter.prototype.toString = function () {
    return 'ExpressionStrictureIdentifierCounter(expressionStrictureIdentifier=' + Kotlin.toString(this.expressionStrictureIdentifier) + (', count=' + Kotlin.toString(this.count)) + ')';
  };
  ExpressionStrictureIdentifierCounter.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.expressionStrictureIdentifier) | 0;
    result = result * 31 + Kotlin.hashCode(this.count) | 0;
    return result;
  };
  ExpressionStrictureIdentifierCounter.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.expressionStrictureIdentifier, other.expressionStrictureIdentifier) && Kotlin.equals(this.count, other.count)))));
  };
  function generateReduceArithmeticSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, alreadyAddedSubstitutionCodes) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    if (alreadyAddedSubstitutionCodes === void 0) {
      alreadyAddedSubstitutionCodes = emptySet();
    }
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7;
    var result = ArrayList_init();
    if (substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder != null && ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children.size > 1) {
      ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).fillStructureStringIdentifiers_t6ztn0$();
      var plusOperation = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).value;
      var dotOperation = dotOperationByPlus(plusOperation);
      if (!isBlank(dotOperation) && substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('TwoSidesArithmeticReduce')) {
        var possibleMultipliersSet = tryToAddMonomReduceTransformation(plusOperation, dotOperation, substitutionSelectionData, false, simplifyNotSelectedTopArguments, result);
        tryToAddMonomReduceTransformation(plusOperation, dotOperation, substitutionSelectionData, true, simplifyNotSelectedTopArguments, result, possibleMultipliersSet);
      }
      if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('ReduceArithmetic')) {
        var subst = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('ReduceArithmetic'));
        if (equals(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).value, '+')) {
          var possibleDenominator = getOperandsFrom2ArgsNode(first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children), '/', 1, new ExpressionNode(NodeType$EMPTY_getInstance(), ''));
          if (ensureNotNull(possibleDenominator).nodeType !== NodeType$EMPTY_getInstance()) {
            tmp$ = get_lastIndex(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children);
            for (var i = 1; i <= tmp$; i++) {
              if (!equals(possibleDenominator != null ? possibleDenominator.expressionStrictureIdentifier : null, getOperandsFrom2ArgsNode(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children.get_za3lpa$(i), '/', 1, new ExpressionNode(NodeType$EMPTY_getInstance(), '')).expressionStrictureIdentifier)) {
                possibleDenominator = null;
                break;
              }
            }
            if (possibleDenominator != null) {
              var degNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
              var prodNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
              tmp$_0 = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children.iterator();
              while (tmp$_0.hasNext()) {
                var child = tmp$_0.next();
                prodNode.addChild_6718cy$(getOperandsFrom2ArgsNode(child, '/', 0, null, substitutionSelectionData).clone());
              }
              degNode.addChild_6718cy$(prodNode);
              degNode.addChild_6718cy$(possibleDenominator.clone());
              addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, degNode, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone()), addRootNodeToExpression(degNode), void 0, void 0, subst.code, subst.nameEn, subst.nameRu), 'ReduceArithmetic', (tmp$_1 = subst.priority) != null ? tmp$_1 : 5);
            }
          }
        }
        if (equals(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).value, '*')) {
          var possibleDegree = getOperandsFrom2ArgsNode(first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children), '^', 0, null);
          tmp$_2 = get_lastIndex(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children);
          for (var i_0 = 1; i_0 <= tmp$_2; i_0++) {
            if (!equals(possibleDegree != null ? possibleDegree.expressionStrictureIdentifier : null, getOperandsFrom2ArgsNode(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children.get_za3lpa$(i_0), '^', 0, null).expressionStrictureIdentifier)) {
              possibleDegree = null;
              break;
            }
          }
          if (possibleDegree != null) {
            var degNode_0 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1);
            degNode_0.addChild_6718cy$(possibleDegree.clone());
            var sumNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
            tmp$_3 = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children.iterator();
            while (tmp$_3.hasNext()) {
              var child_0 = tmp$_3.next();
              sumNode.addChild_6718cy$(getOperandsFrom2ArgsNode(child_0, '^', 1, new ExpressionNode(NodeType$VARIABLE_getInstance(), '1')).clone());
            }
            degNode_0.addChild_6718cy$(sumNode);
            addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, degNode_0, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone()), addRootNodeToExpression(degNode_0), void 0, void 0, subst.code, subst.nameEn, subst.nameRu), 'ReduceArithmetic', (tmp$_4 = subst.priority) != null ? tmp$_4 : 5);
          }
        }
        if (equals(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).value, '*')) {
          var possibleDegree_0 = getOperandsFrom2ArgsNode(first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children), '^', 1, new ExpressionNode(NodeType$EMPTY_getInstance(), ''));
          if (ensureNotNull(possibleDegree_0).nodeType !== NodeType$EMPTY_getInstance()) {
            tmp$_5 = get_lastIndex(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children);
            for (var i_1 = 1; i_1 <= tmp$_5; i_1++) {
              if (!equals(possibleDegree_0 != null ? possibleDegree_0.expressionStrictureIdentifier : null, getOperandsFrom2ArgsNode(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children.get_za3lpa$(i_1), '^', 1, new ExpressionNode(NodeType$EMPTY_getInstance(), '')).expressionStrictureIdentifier)) {
                possibleDegree_0 = null;
                break;
              }
            }
            if (possibleDegree_0 != null) {
              var degNode_1 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1);
              var prodNode_0 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
              tmp$_6 = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children.iterator();
              while (tmp$_6.hasNext()) {
                var child_1 = tmp$_6.next();
                prodNode_0.addChild_6718cy$(getOperandsFrom2ArgsNode(child_1, '^', 0, null).clone());
              }
              degNode_1.addChild_6718cy$(prodNode_0);
              degNode_1.addChild_6718cy$(possibleDegree_0.clone());
              addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, degNode_1, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone()), addRootNodeToExpression(degNode_1), void 0, void 0, subst.code, subst.nameEn, subst.nameRu), 'ReduceArithmetic', (tmp$_7 = subst.priority) != null ? tmp$_7 : 5);
            }
          }
        }
      }
    }
    var tmp$_8;
    var set = HashSet_init();
    var list = ArrayList_init();
    tmp$_8 = result.iterator();
    while (tmp$_8.hasNext()) {
      var e = tmp$_8.next();
      var key = e.resultExpression;
      if (set.add_11rb$(key))
        list.add_11rb$(e);
    }
    return list;
  }
  function tryToAddMonomReduceTransformation(plusOperation, dotOperation, substitutionSelectionData, useExpanded, simplifyNotSelectedTopArguments, result, otherMultipliers) {
    if (otherMultipliers === void 0)
      otherMultipliers = emptyList();
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5;
    tmp$ = substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('TwoSidesArithmeticReduce');
    if (tmp$ == null) {
      return emptyList();
    }
    var subst = tmp$;
    var possibleMultipliersSet = getMultipliersFromNode(plusOperation, dotOperation, first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children), useExpanded);
    tmp$_0 = get_lastIndex(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children);
    for (var i = 1; i <= tmp$_0; i++) {
      var childMultipliers = getMultipliersFromNode(plusOperation, dotOperation, ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children.get_za3lpa$(i), useExpanded);
      tmp$_1 = possibleMultipliersSet.iterator();
      loop_label: while (tmp$_1.hasNext()) {
        var possibleMultiplier = tmp$_1.next();
        var firstOrNull$result;
        firstOrNull$break: do {
          var tmp$_6;
          tmp$_6 = childMultipliers.iterator();
          while (tmp$_6.hasNext()) {
            var element = tmp$_6.next();
            var tmp$_7;
            if ((tmp$_7 = element.expressionStrictureIdentifier) != null ? tmp$_7.equals(possibleMultiplier.expressionStrictureIdentifier) : null) {
              firstOrNull$result = element;
              break firstOrNull$break;
            }
          }
          firstOrNull$result = null;
        }
         while (false);
        var maxCount = (tmp$_3 = (tmp$_2 = firstOrNull$result) != null ? tmp$_2.count : null) != null ? tmp$_3 : 0;
        var a = possibleMultiplier.count;
        possibleMultiplier.count = Math_0.min(a, maxCount);
      }
      var $receiver = possibleMultipliersSet;
      var destination = ArrayList_init();
      var tmp$_8;
      tmp$_8 = $receiver.iterator();
      while (tmp$_8.hasNext()) {
        var element_0 = tmp$_8.next();
        if (element_0.count > 0)
          destination.add_11rb$(element_0);
      }
      possibleMultipliersSet = destination;
      if (possibleMultipliersSet.isEmpty()) {
        break;
      }
    }
    if (!possibleMultipliersSet.isEmpty()) {
      var $receiver_0 = possibleMultipliersSet;
      var destination_0 = ArrayList_init();
      var tmp$_9;
      tmp$_9 = $receiver_0.iterator();
      while (tmp$_9.hasNext()) {
        var element_1 = tmp$_9.next();
        var tmp$_10;
        var originalOrderIdentifier = '(^(' + element_1.expressionStrictureIdentifier.originalOrderIdentifier + ';' + element_1.count + '))';
        var commutativeSortedIdentifier = '(^(' + element_1.expressionStrictureIdentifier.commutativeSortedIdentifier + ';' + element_1.count + '))';
        var selected = false;
        tmp$_10 = substitutionSelectionData.selectedNodes.iterator();
        while (tmp$_10.hasNext()) {
          var node = tmp$_10.next();
          var nodeIdentifier = node.toString();
          if (contains_0(originalOrderIdentifier, nodeIdentifier) || contains_0(commutativeSortedIdentifier, nodeIdentifier)) {
            selected = true;
            break;
          }
        }
        if (selected)
          destination_0.add_11rb$(element_1);
      }
      var onlySelectedMultipliers = destination_0;
      if (!onlySelectedMultipliers.isEmpty()) {
        possibleMultipliersSet = onlySelectedMultipliers;
      }
      if (otherMultipliers.isEmpty() || !otherMultipliers.containsAll_brywnq$(possibleMultipliersSet)) {
        var prodNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$(dotOperation, -1);
        var dotZero = ensureNotNull(ensureNotNull(prodNode.functionStringDefinition).function.fieldAddZero);
        var sumNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$(plusOperation, -1);
        handleAdditiveNodeAsReductionPart(plusOperation, dotOperation, dotZero, substitutionSelectionData, first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children), possibleMultipliersSet, sumNode, prodNode, useExpanded);
        tmp$_4 = get_lastIndex(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children);
        for (var i_0 = 1; i_0 <= tmp$_4; i_0++) {
          handleAdditiveNodeAsReductionPart(plusOperation, dotOperation, dotZero, substitutionSelectionData, ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children.get_za3lpa$(i_0), possibleMultipliersSet, sumNode, null, useExpanded);
        }
        prodNode.addChild_6718cy$(sumNode);
        addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, prodNode, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone()), addRootNodeToExpression(prodNode), void 0, void 0, subst.code, subst.nameEn, subst.nameRu), 'TwoSidesArithmeticReduce', (tmp$_5 = subst.priority) != null ? tmp$_5 : 5);
      }
    }
    return possibleMultipliersSet;
  }
  function generateReduceFractionSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, alreadyAddedSubstitutionCodes) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    if (alreadyAddedSubstitutionCodes === void 0) {
      alreadyAddedSubstitutionCodes = emptySet();
    }
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7;
    var result = ArrayList_init();
    if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$(REDUCE_FRACTION) && !alreadyAddedSubstitutionCodes.contains_11rb$(REDUCE_FRACTION)) {
      var subst = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$(REDUCE_FRACTION));
      var tmp$_8 = equals(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).value, '/') && substitutionSelectionData.selectedNodeIds.length === 2;
      if (tmp$_8) {
        var $receiver = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).children;
        var all$result;
        all$break: do {
          var tmp$_9;
          if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
            all$result = true;
            break all$break;
          }
          tmp$_9 = $receiver.iterator();
          while (tmp$_9.hasNext()) {
            var element = tmp$_9.next();
            if (!(element.children.size === 1)) {
              all$result = false;
              break all$break;
            }
          }
          all$result = true;
        }
         while (false);
        tmp$_8 = all$result;
      }
      if (tmp$_8) {
        var originalExpression = substitutionSelectionData.originalExpression.clone();
        ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).fillStructureStringIdentifiers_t6ztn0$();
        var numerator = first(first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).children).children);
        var denominator = first(last(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).children).children);
        var rightBase = ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments);
        if (equals(numerator.expressionStrictureIdentifier, denominator.expressionStrictureIdentifier)) {
          var $receiver_0 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
          $receiver_0.addChild_6718cy$(numerator);
          $receiver_0.addChild_6718cy$(denominator);
          var expressionSubstitution = new ExpressionSubstitution(addRootNodeToExpression($receiver_0), addRootNodeToExpression(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1')), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
          var applicationPlace = ensureNotNull(substitutionSelectionData.topOfSelection).clone();
          var applicationResultInPlace = normalizeReduceFractionResult(rightBase.clone());
          ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(applicationResultInPlace, substitutionSelectionData.topOfSelectionIndex);
          var $receiver_1 = substitutionSelectionData.expressionToTransform.clone();
          normalizeExpressionToUsualForm($receiver_1, substitutionSelectionData.compiledConfiguration);
          result.add_11rb$(new SubstitutionApplication(expressionSubstitution, originalExpression, applicationPlace, $receiver_1, applicationResultInPlace, REDUCE_FRACTION, (tmp$ = subst.priority) != null ? tmp$ : 5));
        }
         else if (numerator.isNumberValue() && denominator.isNumberValue()) {
          tmp$_0 = toDoubleOrNull(numerator.value);
          if (tmp$_0 == null) {
            return result;
          }
          var num = tmp$_0;
          tmp$_1 = toDoubleOrNull(denominator.value);
          if (tmp$_1 == null) {
            return result;
          }
          var denom = tmp$_1;
          var numDivDenom = numberToInt(num / denom);
          var denomDivNum = numberToInt(denom / num);
          if (substitutionSelectionData.compiledConfiguration.factComporator.expressionComporator.baseOperationsDefinitions.additivelyEqual_lu1900$(num, denom * numDivDenom)) {
            tmp$_2 = new ExpressionNode(NodeType$VARIABLE_getInstance(), numDivDenom.toString());
          }
           else if (substitutionSelectionData.compiledConfiguration.factComporator.expressionComporator.baseOperationsDefinitions.additivelyEqual_lu1900$(denom, num * denomDivNum)) {
            var $receiver_2 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
            $receiver_2.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
            $receiver_2.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), denomDivNum.toString()));
            tmp$_2 = $receiver_2;
          }
           else
            tmp$_2 = null;
          var resNode = tmp$_2;
          if (resNode != null) {
            var $receiver_3 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
            $receiver_3.addChild_6718cy$(numerator);
            $receiver_3.addChild_6718cy$(denominator);
            var expressionSubstitution_0 = new ExpressionSubstitution(addRootNodeToExpression($receiver_3), addRootNodeToExpression(resNode), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
            var applicationPlace_0 = ensureNotNull(substitutionSelectionData.topOfSelection).clone();
            var $receiver_4 = rightBase.clone();
            if (equals(resNode.value, '/')) {
              last($receiver_4.children).addChildOnPosition_tvfpvg$(new ExpressionNode(NodeType$VARIABLE_getInstance(), denomDivNum.toString()), 0);
            }
             else {
              first($receiver_4.children).addChildOnPosition_tvfpvg$(new ExpressionNode(NodeType$VARIABLE_getInstance(), numDivDenom.toString()), 0);
            }
            var applicationResultInPlace_0 = normalizeReduceFractionResult($receiver_4);
            ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(applicationResultInPlace_0, substitutionSelectionData.topOfSelectionIndex);
            var $receiver_5 = substitutionSelectionData.expressionToTransform.clone();
            normalizeExpressionToUsualForm($receiver_5, substitutionSelectionData.compiledConfiguration);
            result.add_11rb$(new SubstitutionApplication(expressionSubstitution_0, originalExpression, applicationPlace_0, $receiver_5, applicationResultInPlace_0, REDUCE_FRACTION, (tmp$_3 = subst.priority) != null ? tmp$_3 : 5));
          }
        }
         else if (equals(numerator.value, '^') && equals(denominator.value, '^') && numerator.children.size === 2 && denominator.children.size === 2 && equals(first(numerator.children).expressionStrictureIdentifier, first(denominator.children).expressionStrictureIdentifier)) {
          var numPow = toDoubleOrNull(last(numerator.children).value);
          var denomPow = toDoubleOrNull(last(denominator.children).value);
          if (numPow != null && denomPow != null) {
            if (numPow >= denomPow) {
              var pow = numPow - denomPow;
              if (substitutionSelectionData.compiledConfiguration.factComporator.expressionComporator.baseOperationsDefinitions.additivelyEqual_lu1900$(pow, 1.0)) {
                tmp$_4 = first(numerator.children).clone();
              }
               else {
                var $receiver_6 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1);
                $receiver_6.addChild_6718cy$(first(numerator.children).clone());
                $receiver_6.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), toShortString(pow)));
                tmp$_4 = $receiver_6;
              }
            }
             else {
              var pow_0 = denomPow - numPow;
              var $receiver_7 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
              $receiver_7.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
              if (substitutionSelectionData.compiledConfiguration.factComporator.expressionComporator.baseOperationsDefinitions.additivelyEqual_lu1900$(pow_0, 1.0)) {
                $receiver_7.addChild_6718cy$(first(numerator.children).clone());
              }
               else {
                var $receiver_8 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1);
                $receiver_8.addChild_6718cy$(first(numerator.children).clone());
                $receiver_8.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), toShortString(pow_0)));
                $receiver_7.addChild_6718cy$($receiver_8);
              }
              tmp$_4 = $receiver_7;
            }
            var resNode_0 = tmp$_4;
            var $receiver_9 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
            $receiver_9.addChild_6718cy$(numerator);
            $receiver_9.addChild_6718cy$(denominator);
            var expressionSubstitution_1 = new ExpressionSubstitution(addRootNodeToExpression($receiver_9), addRootNodeToExpression(resNode_0), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
            var applicationPlace_1 = ensureNotNull(substitutionSelectionData.topOfSelection).clone();
            var $receiver_10 = rightBase.clone();
            if (equals(resNode_0.value, '/')) {
              last($receiver_10.children).addChildOnPosition_tvfpvg$(last(resNode_0.children).clone(), 0);
            }
             else {
              first($receiver_10.children).addChildOnPosition_tvfpvg$(resNode_0.clone(), 0);
            }
            var applicationResultInPlace_1 = normalizeReduceFractionResult($receiver_10);
            ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(applicationResultInPlace_1, substitutionSelectionData.topOfSelectionIndex);
            var $receiver_11 = substitutionSelectionData.expressionToTransform.clone();
            normalizeExpressionToUsualForm($receiver_11, substitutionSelectionData.compiledConfiguration);
            result.add_11rb$(new SubstitutionApplication(expressionSubstitution_1, originalExpression, applicationPlace_1, $receiver_11, applicationResultInPlace_1, REDUCE_FRACTION, (tmp$_5 = subst.priority) != null ? tmp$_5 : 5));
          }
           else {
            var $receiver_12 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1);
            $receiver_12.addChild_6718cy$(first(numerator.children).clone());
            var $receiver_13 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
            $receiver_13.addChild_6718cy$(last(numerator.children));
            var $receiver_14 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1);
            $receiver_14.addChild_6718cy$(last(denominator.children));
            $receiver_13.addChild_6718cy$($receiver_14);
            $receiver_12.addChild_6718cy$($receiver_13);
            var resNodeNumerator = $receiver_12;
            var $receiver_15 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
            $receiver_15.addChild_6718cy$(numerator);
            $receiver_15.addChild_6718cy$(denominator);
            var expressionSubstitutionNumerator = new ExpressionSubstitution(addRootNodeToExpression($receiver_15), addRootNodeToExpression(resNodeNumerator), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
            var applicationPlaceNumerator = ensureNotNull(substitutionSelectionData.topOfSelection).clone();
            var $receiver_16 = rightBase.clone();
            first($receiver_16.children).addChild_6718cy$(resNodeNumerator.clone());
            var applicationResultInPlaceNumerator = normalizeReduceFractionResult($receiver_16);
            ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(applicationResultInPlaceNumerator, substitutionSelectionData.topOfSelectionIndex);
            var $receiver_17 = substitutionSelectionData.expressionToTransform.clone();
            normalizeExpressionToUsualForm($receiver_17, substitutionSelectionData.compiledConfiguration);
            result.add_11rb$(new SubstitutionApplication(expressionSubstitutionNumerator, originalExpression, applicationPlaceNumerator, $receiver_17, applicationResultInPlaceNumerator, REDUCE_FRACTION, (tmp$_6 = subst.priority) != null ? tmp$_6 : 5));
            var $receiver_18 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
            $receiver_18.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
            var $receiver_19 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1);
            $receiver_19.addChild_6718cy$(first(numerator.children).clone());
            var $receiver_20 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
            $receiver_20.addChild_6718cy$(last(denominator.children));
            var $receiver_21 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1);
            $receiver_21.addChild_6718cy$(last(numerator.children));
            $receiver_20.addChild_6718cy$($receiver_21);
            $receiver_19.addChild_6718cy$($receiver_20);
            $receiver_18.addChild_6718cy$($receiver_19);
            var resNodeDenominator = $receiver_18;
            var $receiver_22 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
            $receiver_22.addChild_6718cy$(numerator);
            $receiver_22.addChild_6718cy$(denominator);
            var expressionSubstitutionDenominator = new ExpressionSubstitution(addRootNodeToExpression($receiver_22), addRootNodeToExpression(resNodeDenominator), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
            var applicationPlaceDenominator = ensureNotNull(substitutionSelectionData.topOfSelection).clone();
            var $receiver_23 = rightBase.clone();
            last($receiver_23.children).addChild_6718cy$(last(resNodeDenominator.children).clone());
            var applicationResultInPlaceDenominator = normalizeReduceFractionResult($receiver_23);
            ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(applicationResultInPlaceDenominator, substitutionSelectionData.topOfSelectionIndex);
            var $receiver_24 = substitutionSelectionData.expressionToTransform.clone();
            normalizeExpressionToUsualForm($receiver_24, substitutionSelectionData.compiledConfiguration);
            result.add_11rb$(new SubstitutionApplication(expressionSubstitutionDenominator, originalExpression, applicationPlaceDenominator, $receiver_24, applicationResultInPlaceDenominator, REDUCE_FRACTION, (tmp$_7 = subst.priority) != null ? tmp$_7 : 5));
          }
        }
      }
    }
    return result;
  }
  function normalizeReduceFractionResult($receiver) {
    var $receiver_0 = $receiver.children;
    var all$result;
    all$break: do {
      var tmp$;
      if (Kotlin.isType($receiver_0, Collection) && $receiver_0.isEmpty()) {
        all$result = true;
        break all$break;
      }
      tmp$ = $receiver_0.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (!(element.children.size === 0)) {
          all$result = false;
          break all$break;
        }
      }
      all$result = true;
    }
     while (false);
    if (all$result) {
      $receiver.setVariable_61zpoe$('1');
    }
     else {
      if (first($receiver.children).children.size === 0) {
        first($receiver.children).setVariable_61zpoe$('1');
      }
       else if (first($receiver.children).children.size === 1) {
        $receiver.setChildOnPosition_tvfpvg$(first(first($receiver.children).children), 0);
      }
      if (last($receiver.children).children.size === 0) {
        $receiver.value = first($receiver.children).value;
        $receiver.functionStringDefinition = first($receiver.children).functionStringDefinition;
        $receiver.children = first($receiver.children).children;
        var tmp$_0;
        tmp$_0 = $receiver.children.iterator();
        while (tmp$_0.hasNext()) {
          var element_0 = tmp$_0.next();
          element_0.parent = $receiver;
        }
      }
       else if (last($receiver.children).children.size === 1) {
        $receiver.setChildOnPosition_tvfpvg$(first(last($receiver.children).children), 1);
      }
    }
    return $receiver;
  }
  function getOperandsFrom2ArgsNode(expressionNode, operation, operandIndex, ifNotReturn, substitutionSelectionData, hasMinus) {
    if (substitutionSelectionData === void 0)
      substitutionSelectionData = null;
    if (hasMinus === void 0)
      hasMinus = false;
    var tmp$;
    if (equals(expressionNode.value, '-')) {
      return getOperandsFrom2ArgsNode(first(expressionNode.children), operation, operandIndex, ifNotReturn, substitutionSelectionData, hasMinus ^ true);
    }
     else {
      if (equals(expressionNode.value, operation) && expressionNode.children.size === 2) {
        tmp$ = expressionNode.children.get_za3lpa$(operandIndex);
      }
       else {
        tmp$ = ifNotReturn != null ? ifNotReturn : expressionNode;
      }
      var result = tmp$;
      if (hasMinus && substitutionSelectionData != null) {
        var $receiver = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1);
        $receiver.addChild_6718cy$(result);
        return $receiver;
      }
       else
        return result;
    }
  }
  function getMultipliersFromNode(plusOperation, dotOperation, expressionNode, expandPow) {
    var tmp$;
    if (equals(expressionNode.value, '-') && equals(plusOperation, '+')) {
      return getMultipliersFromNode(plusOperation, dotOperation, first(expressionNode.children), expandPow);
    }
     else if (equals(expressionNode.value, dotOperation)) {
      var result = ArrayList_init();
      tmp$ = expressionNode.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        if (powExpandCondition(plusOperation, expandPow, child)) {
          var pow = toInt(last(child.children).value);
          addMultiplierIdentifierToList(result, first(child.children), pow);
        }
         else {
          addMultiplierIdentifierToList(result, child);
        }
      }
      return result;
    }
     else if (powExpandCondition(plusOperation, expandPow, expressionNode)) {
      var pow_0 = toInt(last(expressionNode.children).value);
      return listOf(new ExpressionStrictureIdentifierCounter(ensureNotNull(first(expressionNode.children).expressionStrictureIdentifier), pow_0));
    }
     else {
      return listOf(new ExpressionStrictureIdentifierCounter(ensureNotNull(expressionNode.expressionStrictureIdentifier)));
    }
  }
  function powExpandCondition(plusOperation, expandPow, child) {
    var tmp$ = expandPow && equals(child.value, '^') && equals(plusOperation, '+') && child.children.size === 2 && last(child.children).value.length < 2;
    if (tmp$) {
      var $receiver = last(child.children).value;
      var all$result;
      all$break: do {
        var tmp$_0;
        tmp$_0 = iterator($receiver);
        while (tmp$_0.hasNext()) {
          var element = unboxChar(tmp$_0.next());
          if (!isDigit(unboxChar(toBoxedChar(element)))) {
            all$result = false;
            break all$break;
          }
        }
        all$result = true;
      }
       while (false);
      tmp$ = all$result;
    }
    return tmp$;
  }
  function addMultiplierIdentifierToList(result, node, count) {
    if (count === void 0)
      count = 1;
    var tmp$;
    var indexOfFirst$result;
    indexOfFirst$break: do {
      var tmp$_0;
      var index = 0;
      tmp$_0 = result.iterator();
      while (tmp$_0.hasNext()) {
        var item = tmp$_0.next();
        if (equals(node.expressionStrictureIdentifier, item.expressionStrictureIdentifier)) {
          indexOfFirst$result = index;
          break indexOfFirst$break;
        }
        index = index + 1 | 0;
      }
      indexOfFirst$result = -1;
    }
     while (false);
    var childIndex = indexOfFirst$result;
    if (childIndex < 0) {
      result.add_11rb$(new ExpressionStrictureIdentifierCounter(ensureNotNull(node.expressionStrictureIdentifier), count));
    }
     else {
      tmp$ = result.get_za3lpa$(childIndex);
      tmp$.count = tmp$.count + count | 0;
    }
  }
  function handleAdditiveNodeAsReductionPart(plusOperation, dotOperation, dotZero, substitutionSelectionData, expressionNode, multipliers, sumNode, prodNode, expandPow, hasMinus) {
    if (hasMinus === void 0)
      hasMinus = false;
    var tmp$, tmp$_0;
    if (equals(expressionNode.value, '-') && equals(plusOperation, '+')) {
      handleAdditiveNodeAsReductionPart(plusOperation, dotOperation, dotZero, substitutionSelectionData, first(expressionNode.children), multipliers, sumNode, prodNode, expandPow, hasMinus ^ true);
    }
     else if (equals(expressionNode.value, dotOperation)) {
      var multipliersCopy = ArrayList_init();
      tmp$ = multipliers.iterator();
      while (tmp$.hasNext()) {
        var multiplier = tmp$.next();
        multipliersCopy.add_11rb$(new ExpressionStrictureIdentifierCounter(multiplier.expressionStrictureIdentifier, multiplier.count));
      }
      var sumProdNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$(dotOperation, -1);
      tmp$_0 = expressionNode.children.iterator();
      while (tmp$_0.hasNext()) {
        var child = tmp$_0.next();
        if (powExpandCondition(plusOperation, expandPow, child)) {
          var pow = toInt(last(child.children).value);
          addMultiplierToSumProdNode(multipliersCopy, first(child.children), prodNode, substitutionSelectionData, sumProdNode, pow);
        }
         else {
          addMultiplierToSumProdNode(multipliersCopy, child, prodNode, substitutionSelectionData, sumProdNode, 1);
        }
      }
      if (sumProdNode.children.isEmpty()) {
        sumNode.addChild_6718cy$(minusNode(substitutionSelectionData, new ExpressionNode(NodeType$VARIABLE_getInstance(), dotZero), hasMinus));
      }
      if (sumProdNode.children.size === 1) {
        sumNode.addChild_6718cy$(minusNode(substitutionSelectionData, first(sumProdNode.children), hasMinus));
      }
       else if (sumProdNode.children.size > 1) {
        sumNode.addChild_6718cy$(minusNode(substitutionSelectionData, sumProdNode, hasMinus));
      }
    }
     else {
      if (powExpandCondition(plusOperation, expandPow, expressionNode)) {
        var pow_0 = toInt(last(expressionNode.children).value);
        var firstOrNull$result;
        firstOrNull$break: do {
          var tmp$_1;
          tmp$_1 = multipliers.iterator();
          while (tmp$_1.hasNext()) {
            var element = tmp$_1.next();
            if (equals(element.expressionStrictureIdentifier, first(expressionNode.children).expressionStrictureIdentifier)) {
              firstOrNull$result = element;
              break firstOrNull$break;
            }
          }
          firstOrNull$result = null;
        }
         while (false);
        var mul = firstOrNull$result;
        if (mul != null && pow_0 > mul.count) {
          sumNode.addChild_6718cy$(minusNode(substitutionSelectionData, powNode(substitutionSelectionData, expressionNode, pow_0 - mul.count | 0), hasMinus));
          prodNode != null ? (prodNode.addChild_6718cy$(minusNode(substitutionSelectionData, powNode(substitutionSelectionData, expressionNode, mul.count), hasMinus)), Unit) : null;
          return;
        }
      }
      sumNode.addChild_6718cy$(minusNode(substitutionSelectionData, new ExpressionNode(NodeType$VARIABLE_getInstance(), dotZero), hasMinus));
      prodNode != null ? (prodNode.addChild_6718cy$(minusNode(substitutionSelectionData, expressionNode, hasMinus)), Unit) : null;
    }
  }
  function addMultiplierToSumProdNode(multipliersCopy, node, prodNode, substitutionSelectionData, sumProdNode, count) {
    var firstOrNull$result;
    firstOrNull$break: do {
      var tmp$;
      tmp$ = multipliersCopy.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (equals(element.expressionStrictureIdentifier, node.expressionStrictureIdentifier)) {
          firstOrNull$result = element;
          break firstOrNull$break;
        }
      }
      firstOrNull$result = null;
    }
     while (false);
    var mul = firstOrNull$result;
    if (mul != null && mul.count >= count) {
      mul.count = mul.count - count | 0;
      prodNode != null ? (prodNode.addChild_6718cy$(powNode(substitutionSelectionData, node, count)), Unit) : null;
    }
     else if (mul != null && 0 < mul.count && mul.count < count) {
      prodNode != null ? (prodNode.addChild_6718cy$(powNode(substitutionSelectionData, node, mul.count)), Unit) : null;
      sumProdNode.addChild_6718cy$(powNode(substitutionSelectionData, node, count - mul.count | 0));
      mul.count = 0;
    }
     else {
      sumProdNode.addChild_6718cy$(powNode(substitutionSelectionData, node, count));
    }
  }
  function powNode(substitutionSelectionData, node, pow) {
    if (pow === 1) {
      return node.clone();
    }
     else {
      var $receiver = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1);
      $receiver.addChild_6718cy$(node.clone());
      $receiver.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), pow.toString()));
      return $receiver;
    }
  }
  function minusNode(substitutionSelectionData, node, hasMinus) {
    if (!hasMinus) {
      return node.clone();
    }
     else {
      var $receiver = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1);
      $receiver.addChild_6718cy$(node.clone());
      return $receiver;
    }
  }
  function generateZeroComputationSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11, tmp$_12, tmp$_13, tmp$_14, tmp$_15, tmp$_16, tmp$_17, tmp$_18, tmp$_19, tmp$_20, tmp$_21, tmp$_22, tmp$_23, tmp$_24;
    var result = ArrayList_init();
    if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('ZeroComputation')) {
      var subst = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('ZeroComputation'));
      if (((tmp$_1 = (tmp$_0 = (tmp$ = substitutionSelectionData.topOfSelection) != null ? tmp$.functionStringDefinition : null) != null ? tmp$_0.function : null) != null ? tmp$_1.isCommutativeWithNullWeight : null) === true && ((tmp$_4 = (tmp$_3 = (tmp$_2 = substitutionSelectionData.topOfSelection) != null ? tmp$_2.functionStringDefinition : null) != null ? tmp$_3.function : null) != null ? tmp$_4.fieldAddZero : null) != null) {
        var topNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$(ensureNotNull(substitutionSelectionData.topOfSelection).value, -1);
        var zeroElementFound = false;
        tmp$_5 = ensureNotNull(substitutionSelectionData.topOfSelection).children.iterator();
        while (tmp$_5.hasNext()) {
          var child = tmp$_5.next();
          if (equals(child.value, (tmp$_8 = (tmp$_7 = (tmp$_6 = substitutionSelectionData.topOfSelection) != null ? tmp$_6.functionStringDefinition : null) != null ? tmp$_7.function : null) != null ? tmp$_8.fieldAddZero : null) || (equals(ensureNotNull(substitutionSelectionData.topOfSelection).value, '+') && equals(child.value, '-') && equals((tmp$_9 = firstOrNull_0(child.children)) != null ? tmp$_9.value : null, (tmp$_12 = (tmp$_11 = (tmp$_10 = substitutionSelectionData.topOfSelection) != null ? tmp$_10.functionStringDefinition : null) != null ? tmp$_11.function : null) != null ? tmp$_12.fieldAddZero : null))) {
            zeroElementFound = true;
          }
           else {
            topNode.addChild_6718cy$(child.clone());
          }
        }
        if (zeroElementFound) {
          var zeroComputationSubstitution = new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.topOfSelection).clone()), addRootNodeToExpression(topNode), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
          var originalExpression = substitutionSelectionData.originalExpression.clone();
          ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(topNode, substitutionSelectionData.topOfSelectionIndex);
          tmp$_13 = ensureNotNull(substitutionSelectionData.topOfSelection);
          var $receiver = substitutionSelectionData.expressionToTransform.clone();
          normalizeExpressionToUsualForm($receiver, substitutionSelectionData.compiledConfiguration);
          result.add_11rb$(new SubstitutionApplication(zeroComputationSubstitution, originalExpression, tmp$_13, $receiver, topNode, 'ZeroComputation', (tmp$_14 = subst.priority) != null ? tmp$_14 : 10));
          ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(ensureNotNull(substitutionSelectionData.topOfSelection), substitutionSelectionData.topOfSelectionIndex);
        }
      }
      var tmp$_25 = ((tmp$_17 = (tmp$_16 = (tmp$_15 = substitutionSelectionData.topOfSelection) != null ? tmp$_15.functionStringDefinition : null) != null ? tmp$_16.function : null) != null ? tmp$_17.isCommutativeWithNullWeight : null) === true && ((tmp$_20 = (tmp$_19 = (tmp$_18 = substitutionSelectionData.topOfSelection) != null ? tmp$_18.functionStringDefinition : null) != null ? tmp$_19.function : null) != null ? tmp$_20.fieldMulZero : null) != null;
      if (tmp$_25) {
        var tmp$_26;
        if ((tmp$_22 = (tmp$_21 = substitutionSelectionData.topOfSelection) != null ? tmp$_21.children : null) != null) {
          var any$result;
          any$break: do {
            var tmp$_27;
            if (Kotlin.isType(tmp$_22, Collection) && tmp$_22.isEmpty()) {
              any$result = false;
              break any$break;
            }
            tmp$_27 = tmp$_22.iterator();
            while (tmp$_27.hasNext()) {
              var element = tmp$_27.next();
              var tmp$_28, tmp$_29, tmp$_30;
              if (equals(element.value, (tmp$_30 = (tmp$_29 = (tmp$_28 = substitutionSelectionData.topOfSelection) != null ? tmp$_28.functionStringDefinition : null) != null ? tmp$_29.function : null) != null ? tmp$_30.fieldMulZero : null)) {
                any$result = true;
                break any$break;
              }
            }
            any$result = false;
          }
           while (false);
          tmp$_26 = any$result;
        }
         else
          tmp$_26 = null;
        tmp$_25 = tmp$_26 === true;
      }
      if (tmp$_25) {
        var topNode_0 = new ExpressionNode(NodeType$VARIABLE_getInstance(), ensureNotNull(ensureNotNull(ensureNotNull(substitutionSelectionData.topOfSelection).functionStringDefinition).function.fieldMulZero));
        var zeroComputationSubstitution_0 = new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.topOfSelection).clone()), addRootNodeToExpression(topNode_0), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
        var originalExpression_0 = substitutionSelectionData.originalExpression.clone();
        ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(topNode_0, substitutionSelectionData.topOfSelectionIndex);
        tmp$_23 = ensureNotNull(substitutionSelectionData.topOfSelection);
        var $receiver_0 = substitutionSelectionData.expressionToTransform.clone();
        normalizeExpressionToUsualForm($receiver_0, substitutionSelectionData.compiledConfiguration);
        result.add_11rb$(new SubstitutionApplication(zeroComputationSubstitution_0, originalExpression_0, tmp$_23, $receiver_0, topNode_0, 'ZeroComputation', (tmp$_24 = subst.priority) != null ? tmp$_24 : 10));
        ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(ensureNotNull(substitutionSelectionData.topOfSelection), substitutionSelectionData.topOfSelectionIndex);
      }
    }
    return result;
  }
  function plusOperationByDot(dotOperation) {
    switch (dotOperation) {
      case '*':
      case '/':
        return '+';
      case 'and':
        return 'or';
      case 'or':
        return 'and';
      default:return '';
    }
  }
  function dotOperationByPlus(plusOperation) {
    switch (plusOperation) {
      case '+':
        return '*';
      case 'and':
        return 'or';
      case 'or':
        return 'and';
      default:return '';
    }
  }
  function generateOpeningBracketsSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11, tmp$_12, tmp$_13;
    var result = ArrayList_init();
    if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('OpeningBrackets')) {
      var subst = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('OpeningBrackets'));
      var tmp$_14 = ((tmp$_1 = (tmp$_0 = (tmp$ = substitutionSelectionData.topOfSelection) != null ? tmp$.functionStringDefinition : null) != null ? tmp$_0.function : null) != null ? tmp$_1.isCommutativeWithNullWeight : null) === true;
      if (tmp$_14) {
        var tmp$_15;
        if ((tmp$_3 = (tmp$_2 = substitutionSelectionData.topOfSelection) != null ? tmp$_2.children : null) != null) {
          var any$result;
          any$break: do {
            var tmp$_16;
            if (Kotlin.isType(tmp$_3, Collection) && tmp$_3.isEmpty()) {
              any$result = false;
              break any$break;
            }
            tmp$_16 = tmp$_3.iterator();
            while (tmp$_16.hasNext()) {
              var element = tmp$_16.next();
              var tmp$_17;
              if (equals(element.value, (tmp$_17 = substitutionSelectionData.topOfSelection) != null ? tmp$_17.value : null)) {
                any$result = true;
                break any$break;
              }
            }
            any$result = false;
          }
           while (false);
          tmp$_15 = any$result;
        }
         else
          tmp$_15 = null;
        tmp$_14 = tmp$_15 === true;
      }
      if (tmp$_14) {
        var topOperationChildren = ensureNotNull(substitutionSelectionData.topOfSelection).getChildNodesWhileOperation_mhpeer$(listOf(ensureNotNull(substitutionSelectionData.topOfSelection).value));
        if (topOperationChildren.size > 1) {
          var topNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$(ensureNotNull(substitutionSelectionData.topOfSelection).value, -1);
          tmp$_4 = topOperationChildren.iterator();
          while (tmp$_4.hasNext()) {
            var child = tmp$_4.next();
            topNode.addChild_6718cy$(child.clone());
          }
          var expandingSubstitution = new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.topOfSelection).clone()), addRootNodeToExpression(topNode), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
          var originalExpression = substitutionSelectionData.originalExpression.clone();
          ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(topNode, substitutionSelectionData.topOfSelectionIndex);
          tmp$_5 = ensureNotNull(substitutionSelectionData.topOfSelection);
          var $receiver = substitutionSelectionData.expressionToTransform.clone();
          normalizeExpressionToUsualForm($receiver, substitutionSelectionData.compiledConfiguration);
          result.add_11rb$(new SubstitutionApplication(expandingSubstitution, originalExpression, tmp$_5, $receiver, topNode, 'OpeningBrackets', (tmp$_6 = subst.priority) != null ? tmp$_6 : 60));
          ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(ensureNotNull(substitutionSelectionData.topOfSelection), substitutionSelectionData.topOfSelectionIndex);
        }
      }
      if (substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder != null && ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children.size === 2) {
        var dotOperation = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).value;
        var plusOperation = plusOperationByDot(dotOperation);
        if (!isBlank(plusOperation)) {
          if (!equals(dotOperation, '/') && equals(last(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).value, plusOperation) && last(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).children.size > 1) {
            var sumNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$(plusOperation, -1);
            if (equals(first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).value, plusOperation)) {
              tmp$_7 = first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).children;
            }
             else {
              tmp$_7 = listOf(first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children));
            }
            var lChildren = tmp$_7;
            if (equals(last(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).value, plusOperation)) {
              tmp$_8 = last(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).children;
            }
             else {
              tmp$_8 = listOf(last(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children));
            }
            var rChildren = tmp$_8;
            addSumOpeningBracketsResult(lChildren, rChildren, substitutionSelectionData, sumNode, simplifyNotSelectedTopArguments, result);
          }
          if (equals(first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).value, plusOperation) && first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).children.size > 1) {
            var sumNode_0 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$(plusOperation, -1);
            if (equals(first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).value, plusOperation)) {
              tmp$_9 = first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).children;
            }
             else {
              tmp$_9 = listOf(first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children));
            }
            var lChildren_0 = tmp$_9;
            var rChildren_0 = listOf(last(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children));
            addSumOpeningBracketsResult(lChildren_0, rChildren_0, substitutionSelectionData, sumNode_0, simplifyNotSelectedTopArguments, result);
          }
        }
        if (equals(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).value, '^') && equals(first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).value, '*') && first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).children.size > 1) {
          var prodNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
          tmp$_10 = first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).children.iterator();
          while (tmp$_10.hasNext()) {
            var lChild = tmp$_10.next();
            var powNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1);
            powNode.addChild_6718cy$(lChild.clone());
            powNode.addChild_6718cy$(last(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).clone());
            prodNode.addChild_6718cy$(powNode);
          }
          addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, prodNode, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone()), addRootNodeToExpression(prodNode), void 0, void 0, subst.code, subst.nameEn, subst.nameRu), 'OpeningBrackets', (tmp$_11 = subst.priority) != null ? tmp$_11 : 20);
        }
        if (equals(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).value, '^') && equals(last(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).value, '+') && last(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).children.size > 1) {
          var prodNode_0 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
          tmp$_12 = last(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).children.iterator();
          while (tmp$_12.hasNext()) {
            var rChild = tmp$_12.next();
            var powNode_0 = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1);
            powNode_0.addChild_6718cy$(first(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).children).clone());
            if (equals(rChild.value, '-')) {
              powNode_0.addChild_6718cy$(substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1));
              last(powNode_0.children).addChild_6718cy$(rChild.clone());
            }
             else {
              powNode_0.addChild_6718cy$(rChild.clone());
            }
            prodNode_0.addChild_6718cy$(powNode_0);
          }
          addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, prodNode_0, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone()), addRootNodeToExpression(prodNode_0), void 0, void 0, subst.code, subst.nameEn, subst.nameRu), 'OpeningBrackets', (tmp$_13 = subst.priority) != null ? tmp$_13 : 20);
        }
      }
    }
    return result;
  }
  function addSumOpeningBracketsResult(lChildren, rChildren, substitutionSelectionData, sumNode, simplifyNotSelectedTopArguments, result) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3;
    if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('OpeningBrackets')) {
      var subst = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('OpeningBrackets'));
      tmp$ = lChildren.iterator();
      while (tmp$.hasNext()) {
        var lChild = tmp$.next();
        tmp$_0 = rChildren.iterator();
        while (tmp$_0.hasNext()) {
          var rChild = tmp$_0.next();
          var productionNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder).value, -1);
          var needMinus = false;
          if (equals(lChild.value, '-')) {
            needMinus = needMinus ^ true;
            tmp$_1 = first(lChild.children);
          }
           else
            tmp$_1 = lChild;
          var lMul = tmp$_1;
          if (equals(rChild.value, '-')) {
            needMinus = needMinus ^ true;
            tmp$_2 = first(rChild.children);
          }
           else
            tmp$_2 = rChild;
          var rMul = tmp$_2;
          productionNode.addChild_6718cy$(lMul.clone());
          productionNode.addChild_6718cy$(rMul.clone());
          if (needMinus) {
            var minusNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1);
            minusNode.addChild_6718cy$(productionNode);
            sumNode.addChild_6718cy$(minusNode);
          }
           else {
            sumNode.addChild_6718cy$(productionNode);
          }
        }
      }
      addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, sumNode, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone()), addRootNodeToExpression(sumNode), void 0, void 0, subst.code, subst.nameEn, subst.nameRu), 'OpeningBrackets', (tmp$_3 = subst.priority) != null ? tmp$_3 : 20);
    }
  }
  function generateSimpleComputationSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    var tmp$, tmp$_0;
    var result = ArrayList_init();
    if (substitutionSelectionData.compiledConfiguration.simpleComputationRuleParams.isIncluded && substitutionSelectionData.selectedSubtreeTopArguments != null && !ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).isNumberValue() && (substitutionSelectionData.selectedNodes.size === 1 || !equals((tmp$ = substitutionSelectionData.topOfSelection) != null ? tmp$.value : null, '/')) && calcComplexity(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments)) <= substitutionSelectionData.compiledConfiguration.simpleComputationRuleParams.maxCalcComplexity && subtract(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).getContainedFunctions(), substitutionSelectionData.compiledConfiguration.simpleComputationRuleParams.operationsMap.keys).isEmpty() && ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).getContainedVariables().isEmpty()) {
      tmp$_0 = computeNodeIfSimple(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments), substitutionSelectionData.compiledConfiguration.simpleComputationRuleParams);
      if (tmp$_0 == null) {
        return result;
      }
      var computed = tmp$_0;
      var computedNode = substitutionSelectionData.compiledConfiguration.createExpressionVariableNode_14dthe$(computed);
      addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, computedNode, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments).clone()), addRootNodeToExpression(computedNode), void 0, void 0, void 0, void 0, void 0, void 0, void 0, void 0, 5), TREE_COMPUTATION_DEFAULT, 5);
    }
    return result;
  }
  function generateNumberTransformationSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8;
    var result = ArrayList_init();
    tmp$_1 = (tmp$_0 = (tmp$ = substitutionSelectionData.topOfSelection) != null ? tmp$.value : null) != null ? toDoubleOrNull(tmp$_0) : null;
    if (tmp$_1 == null) {
      return result;
    }
    var currentValue = tmp$_1;
    var intCurrentValue = numberToInt(currentValue);
    if (2 <= intCurrentValue && intCurrentValue <= 144 && toReal_0(intCurrentValue - currentValue).additivelyEqualToZero()) {
      if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('MultiplicationFactorization')) {
        var subst = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('MultiplicationFactorization'));
        var sqrtValue = numberToInt(Math_0.sqrt(currentValue));
        for (var i = 2; i <= sqrtValue; i++) {
          var div = intCurrentValue / i | 0;
          if (intCurrentValue === Kotlin.imul(i, div)) {
            var mulTreeNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '*');
            mulTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), i.toString()));
            mulTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), div.toString()));
            addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, mulTreeNode, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.topOfSelection).clone()), addRootNodeToExpression(mulTreeNode), void 0, void 0, subst.code, subst.nameEn, subst.nameRu), 'NumberTransformation', (tmp$_2 = subst.priority) != null ? tmp$_2 : 50);
          }
        }
      }
      if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('PowFactorization')) {
        var subst_0 = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('PowFactorization'));
        var maxPowValue = numberToInt(Math_0.log2(currentValue));
        for (var i_0 = 2; i_0 <= maxPowValue; i_0++) {
          var x = 1.0 / i_0;
          var base = Math_0.pow(currentValue, x);
          var baseInt = numberToInt(base);
          var tmp$_9 = toReal_0(baseInt - base).additivelyEqualToZero();
          if (tmp$_9) {
            tmp$_9 = intCurrentValue === numberToInt(Math_0.pow(base, i_0));
          }
          if (tmp$_9) {
            var degTreeNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '^');
            degTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), baseInt.toString()));
            degTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), i_0.toString()));
            addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, degTreeNode, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.topOfSelection).clone()), addRootNodeToExpression(degTreeNode), void 0, void 0, subst_0.code, subst_0.nameEn, subst_0.nameRu), 'NumberTransformation', (tmp$_3 = subst_0.priority) != null ? tmp$_3 : 50);
          }
        }
      }
    }
    if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('DecimalToFraction')) {
      var subst_1 = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('DecimalToFraction'));
      var xTenPow = tenPowToMakeZ(currentValue, substitutionSelectionData.compiledConfiguration.simpleComputationRuleParams);
      if (0 < xTenPow && xTenPow < substitutionSelectionData.compiledConfiguration.simpleComputationRuleParams.maxTenPowIterations) {
        var divTreeNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '/');
        var multiplier = Math_0.pow(10.0, xTenPow);
        divTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), toShortString(currentValue * multiplier)));
        divTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), toShortString(multiplier)));
        addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, divTreeNode, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.topOfSelection).clone()), addRootNodeToExpression(divTreeNode), void 0, void 0, subst_1.code, subst_1.nameEn, subst_1.nameRu), 'NumberTransformation', (tmp$_4 = subst_1.priority) != null ? tmp$_4 : 60);
      }
    }
    if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('NumberPlusMinus1')) {
      var subst_2 = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('NumberPlusMinus1'));
      var plusTreeNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '+');
      plusTreeNode.addChild_6718cy$(substitutionSelectionData.compiledConfiguration.createExpressionVariableNode_14dthe$(currentValue - 1));
      plusTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
      addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, plusTreeNode, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.topOfSelection).clone()), addRootNodeToExpression(plusTreeNode), void 0, void 0, subst_2.code, subst_2.nameEn, subst_2.nameRu), 'NumberTransformation', (tmp$_5 = subst_2.priority) != null ? tmp$_5 : 70);
      var minusTreeNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '+');
      minusTreeNode.addChild_6718cy$(substitutionSelectionData.compiledConfiguration.createExpressionVariableNode_14dthe$(currentValue + 1));
      minusTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '-'));
      last(minusTreeNode.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
      addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, minusTreeNode, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.topOfSelection).clone()), addRootNodeToExpression(minusTreeNode), void 0, void 0, subst_2.code, subst_2.nameEn, subst_2.nameRu), 'NumberTransformation', (tmp$_6 = subst_2.priority) != null ? tmp$_6 : 70);
    }
     else if (currentValue >= 0 && substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('PositiveNumberPlusMinus1')) {
      var subst_3 = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('PositiveNumberPlusMinus1'));
      if (currentValue >= 1) {
        var plusTreeNode_0 = new ExpressionNode(NodeType$FUNCTION_getInstance(), '+');
        plusTreeNode_0.addChild_6718cy$(substitutionSelectionData.compiledConfiguration.createExpressionVariableNode_14dthe$(currentValue - 1));
        plusTreeNode_0.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
        addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, plusTreeNode_0, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.topOfSelection).clone()), addRootNodeToExpression(plusTreeNode_0), void 0, void 0, subst_3.code, subst_3.nameEn, subst_3.nameRu), 'NumberTransformation', (tmp$_7 = subst_3.priority) != null ? tmp$_7 : 70);
      }
      var minusTreeNode_0 = new ExpressionNode(NodeType$FUNCTION_getInstance(), '+');
      minusTreeNode_0.addChild_6718cy$(substitutionSelectionData.compiledConfiguration.createExpressionVariableNode_14dthe$(currentValue + 1));
      minusTreeNode_0.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '-'));
      last(minusTreeNode_0.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
      addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, minusTreeNode_0, result, new ExpressionSubstitution(addRootNodeToExpression(ensureNotNull(substitutionSelectionData.topOfSelection).clone()), addRootNodeToExpression(minusTreeNode_0), void 0, void 0, subst_3.code, subst_3.nameEn, subst_3.nameRu), 'NumberTransformation', (tmp$_8 = subst_3.priority) != null ? tmp$_8 : 70);
    }
    return result;
  }
  function generateComplicatingExtensionSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4;
    var result = ArrayList_init();
    if (substitutionSelectionData.selectedNodes.size === 2) {
      var applicationPlace = first(substitutionSelectionData.selectedNodes);
      tmp$ = applicationPlace.parent;
      if (tmp$ == null) {
        return result;
      }
      var applicationPlaceParent = tmp$;
      var applicationPlaceIndex = applicationPlaceParent.children.indexOf_11rb$(applicationPlace);
      var applicationObject = last(substitutionSelectionData.selectedNodes);
      var originalExpression = substitutionSelectionData.originalExpression.clone();
      if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('AdditiveComplicatingExtension')) {
        var subst = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('AdditiveComplicatingExtension'));
        var additiveTreeNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '+');
        additiveTreeNode.addChild_6718cy$(applicationPlace.clone());
        additiveTreeNode.addChild_6718cy$(applicationObject.clone());
        additiveTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '-'));
        last(additiveTreeNode.children).addChild_6718cy$(applicationObject.clone());
        var additiveSubstitution = new ExpressionSubstitution(addRootNodeToExpression(applicationPlace.clone()), addRootNodeToExpression(additiveTreeNode), void 0, void 0, subst.code, subst.nameEn, subst.nameRu);
        applicationPlaceParent.setChildOnPosition_tvfpvg$(additiveTreeNode, applicationPlaceIndex);
        var $receiver = substitutionSelectionData.expressionToTransform.clone();
        normalizeExpressionToUsualForm($receiver, substitutionSelectionData.compiledConfiguration);
        result.add_11rb$(new SubstitutionApplication(additiveSubstitution, originalExpression, applicationPlace, $receiver, additiveTreeNode, 'ComplicatingExtension', (tmp$_0 = subst.priority) != null ? tmp$_0 : 60));
        applicationPlaceParent.setChildOnPosition_tvfpvg$(applicationPlace, applicationPlaceIndex);
      }
      if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('MultiplicativeComplicatingExtension') ? !substitutionSelectionData.compiledConfiguration.factComporator.expressionComporator.baseOperationsDefinitions.additivelyEqual_lu1900$((tmp$_1 = computeNodeIfPossible(applicationObject)) != null ? tmp$_1 : 1.0, 0.0) : false) {
        var subst_0 = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('MultiplicativeComplicatingExtension'));
        var multiplicativeTreeNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '/');
        multiplicativeTreeNode.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '*'));
        last(multiplicativeTreeNode.children).addChild_6718cy$(applicationPlace.clone());
        last(multiplicativeTreeNode.children).addChild_6718cy$(applicationObject.clone());
        multiplicativeTreeNode.addChild_6718cy$(applicationObject.clone());
        var multiplicativeSubstitution = new ExpressionSubstitution(addRootNodeToExpression(applicationPlace.clone()), addRootNodeToExpression(multiplicativeTreeNode), void 0, void 0, subst_0.code, subst_0.nameEn, subst_0.nameRu);
        applicationPlaceParent.setChildOnPosition_tvfpvg$(multiplicativeTreeNode, applicationPlaceIndex);
        var $receiver_0 = substitutionSelectionData.expressionToTransform.clone();
        normalizeExpressionToUsualForm($receiver_0, substitutionSelectionData.compiledConfiguration);
        result.add_11rb$(new SubstitutionApplication(multiplicativeSubstitution, originalExpression, applicationPlace, $receiver_0, multiplicativeTreeNode, 'ComplicatingExtension', (tmp$_2 = subst_0.priority) != null ? tmp$_2 : 60));
        applicationPlaceParent.setChildOnPosition_tvfpvg$(applicationPlace, applicationPlaceIndex);
      }
      if (substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.containsKey_11rb$('SetComplicatingExtension')) {
        var subst_1 = ensureNotNull(substitutionSelectionData.compiledConfiguration.expressionTreeAutogeneratedTransformationRuleIdentifiers.get_11rb$('SetComplicatingExtension'));
        var andOrTreeNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('and', -1);
        andOrTreeNode.addChild_6718cy$(applicationPlace.clone());
        andOrTreeNode.addChild_6718cy$(substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('or', -1));
        last(andOrTreeNode.children).addChild_6718cy$(applicationPlace.clone());
        last(andOrTreeNode.children).addChild_6718cy$(applicationObject.clone());
        var andOrSubstitution = new ExpressionSubstitution(addRootNodeToExpression(applicationPlace.clone()), addRootNodeToExpression(andOrTreeNode), void 0, void 0, subst_1.code, subst_1.nameEn, subst_1.nameRu);
        applicationPlaceParent.setChildOnPosition_tvfpvg$(andOrTreeNode, applicationPlaceIndex);
        var $receiver_1 = substitutionSelectionData.expressionToTransform.clone();
        normalizeExpressionToUsualForm($receiver_1, substitutionSelectionData.compiledConfiguration);
        result.add_11rb$(new SubstitutionApplication(andOrSubstitution, originalExpression, applicationPlace, $receiver_1, andOrTreeNode, 'ComplicatingExtension', (tmp$_3 = subst_1.priority) != null ? tmp$_3 : 60));
        applicationPlaceParent.setChildOnPosition_tvfpvg$(applicationPlace, applicationPlaceIndex);
        var orAndTreeNode = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('or', -1);
        orAndTreeNode.addChild_6718cy$(applicationPlace.clone());
        orAndTreeNode.addChild_6718cy$(substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('and', -1));
        last(orAndTreeNode.children).addChild_6718cy$(applicationPlace.clone());
        last(orAndTreeNode.children).addChild_6718cy$(applicationObject.clone());
        var orAndSubstitution = new ExpressionSubstitution(addRootNodeToExpression(applicationPlace.clone()), addRootNodeToExpression(orAndTreeNode), void 0, void 0, subst_1.code, subst_1.nameEn, subst_1.nameRu);
        applicationPlaceParent.setChildOnPosition_tvfpvg$(orAndTreeNode, applicationPlaceIndex);
        var $receiver_2 = substitutionSelectionData.expressionToTransform.clone();
        normalizeExpressionToUsualForm($receiver_2, substitutionSelectionData.compiledConfiguration);
        result.add_11rb$(new SubstitutionApplication(orAndSubstitution, originalExpression, applicationPlace, $receiver_2, orAndTreeNode, 'ComplicatingExtension', (tmp$_4 = subst_1.priority) != null ? tmp$_4 : 60));
        applicationPlaceParent.setChildOnPosition_tvfpvg$(applicationPlace, applicationPlaceIndex);
      }
    }
    return result;
  }
  function applySubstitution_1(substitutionSelectionData, expressionSubstitution, simplifyNotSelectedTopArguments) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    var result = ArrayList_init();
    tmp$ = checkLeftCondition(substitutionSelectionData, expressionSubstitution, false);
    if (tmp$ == null) {
      return null;
    }
    var substitutionInstance = tmp$;
    if (substitutionInstance.isApplicable) {
      tmp$_0 = expressionSubstitution.applyRight_7o4uji$(substitutionInstance);
      if (tmp$_0 == null) {
        return null;
      }
      var applicationToSelectedPartResult = tmp$_0;
      addApplicationToResults(true, substitutionSelectionData, simplifyNotSelectedTopArguments, applicationToSelectedPartResult, result, expressionSubstitution, (tmp$_1 = expressionSubstitution.code) != null ? tmp$_1 : '', (tmp$_2 = expressionSubstitution.priority) != null ? tmp$_2 : 100);
      return first(result).resultExpression;
    }
    return null;
  }
  function checkLeftCondition(substitutionSelectionData, expressionSubstitution, fastestAppropriateVersion) {
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = true;
    var tmp$, tmp$_0;
    if (substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder != null && !expressionSubstitution.changeOnlyOrder) {
      tmp$ = tryToGenerateApplicationSubstitutionInstance(ensureNotNull(substitutionSelectionData.selectedSubtreeTopArgumentsInSelectionOrder), expressionSubstitution);
    }
     else
      tmp$ = null;
    var substitutionInstance = tmp$;
    if (substitutionInstance == null || (!fastestAppropriateVersion && !substitutionInstance.isApplicable)) {
      tmp$_0 = substitutionSelectionData.selectedSubtreeTopArguments;
      if (tmp$_0 == null) {
        return null;
      }
      substitutionInstance = tryToGenerateApplicationSubstitutionInstance(tmp$_0, expressionSubstitution);
    }
    return substitutionInstance;
  }
  function tryToGenerateApplicationSubstitutionInstance(expression, substitution) {
    var result = substitution.checkLeftCondition_6718cy$(expression);
    if (!result.isApplicable && substitution.matchJumbledAndNested) {
      var simplifiedExpression = expression.cloneWithExpandingNestedSameFunctions();
      result = substitution.checkLeftCondition_6718cy$(simplifiedExpression);
    }
    return result;
  }
  function addApplicationToResults(withReadyApplicationResult, substitutionSelectionData, simplifyNotSelectedTopArguments, applicationToSelectedPartResult, result, transformation, substitutionType, priority, onSameBracketLevel) {
    if (onSameBracketLevel === void 0)
      onSameBracketLevel = false;
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    var originalExpression = substitutionSelectionData.originalExpression.clone();
    if (withReadyApplicationResult) {
      if (substitutionSelectionData.notSelectedSubtreeTopArguments != null) {
        if (onSameBracketLevel && equals(ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments).value, applicationToSelectedPartResult.value)) {
          var $receiver = applicationToSelectedPartResult.clone();
          var tmp$_3, tmp$_4;
          if (simplifyNotSelectedTopArguments) {
            tmp$_3 = get_lastIndex(ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments).children);
            for (var i = 1; i <= tmp$_3; i++) {
              $receiver.addChild_6718cy$(ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments).children.get_za3lpa$(i));
            }
          }
           else {
            tmp$_4 = ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopOriginalTree).children.iterator();
            while (tmp$_4.hasNext()) {
              var child = tmp$_4.next();
              $receiver.addChild_6718cy$(child);
            }
          }
          tmp$_0 = $receiver;
        }
         else if (simplifyNotSelectedTopArguments) {
          var $receiver_0 = ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments);
          $receiver_0.setChildOnPosition_tvfpvg$(applicationToSelectedPartResult, 0);
          tmp$_0 = $receiver_0;
        }
         else {
          var commutativeOperationNode = ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopArguments).copy_uq8prj$();
          commutativeOperationNode.addChild_6718cy$(applicationToSelectedPartResult);
          tmp$ = ensureNotNull(substitutionSelectionData.notSelectedSubtreeTopOriginalTree).children.iterator();
          while (tmp$.hasNext()) {
            var child_0 = tmp$.next();
            commutativeOperationNode.addChild_6718cy$(child_0);
          }
          tmp$_0 = commutativeOperationNode;
        }
        var applicationResultNode = tmp$_0;
        if (substitutionSelectionData.topOfSelectionParent != null) {
          ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(applicationResultNode, substitutionSelectionData.topOfSelectionIndex);
        }
      }
       else {
        if (substitutionSelectionData.topOfSelectionParent != null) {
          ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(applicationToSelectedPartResult, substitutionSelectionData.topOfSelectionIndex);
        }
      }
    }
    tmp$_1 = ensureNotNull(substitutionSelectionData.selectedSubtreeTopArguments);
    if (withReadyApplicationResult) {
      var $receiver_1 = substitutionSelectionData.expressionToTransform.clone();
      normalizeExpressionToUsualForm($receiver_1, substitutionSelectionData.compiledConfiguration);
      tmp$_2 = $receiver_1;
    }
     else {
      tmp$_2 = new ExpressionNode(NodeType$EMPTY_getInstance(), "To get application result use argument 'withReadyApplicationResult' = 'true'");
    }
    result.add_11rb$(new SubstitutionApplication(transformation, originalExpression, tmp$_1, tmp$_2, applicationToSelectedPartResult, substitutionType, priority));
    ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(ensureNotNull(substitutionSelectionData.topOfSelection), substitutionSelectionData.topOfSelectionIndex);
  }
  function generateFormIndependentSubstitutionsBySelectedNodes(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    var result = ArrayList_init();
    result.addAll_brywnq$(generateSimpleComputationSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion));
    result.addAll_brywnq$(generateZeroComputationSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion));
    result.addAll_brywnq$(generateOpeningBracketsSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion));
    result.addAll_brywnq$(generatePermutationSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion));
    result.addAll_brywnq$(generateNumberTransformationSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion));
    result.addAll_brywnq$(generateComplicatingExtensionSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion));
    result.addAll_brywnq$(generateParentBracketsExpansionSubstitution(substitutionSelectionData));
    result.addAll_brywnq$(generateMinusInOutBracketsSubstitution(substitutionSelectionData));
    return result;
  }
  function generateFormDependentSubstitutionsBySelectedNodes(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, withExtendingSubstitutions, alreadyAddedSubstitutionCodes) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    if (withExtendingSubstitutions === void 0)
      withExtendingSubstitutions = true;
    var tmp$;
    var result = ArrayList_init();
    result.addAll_brywnq$(generateReduceArithmeticSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, alreadyAddedSubstitutionCodes));
    result.addAll_brywnq$(generateReduceFractionSubstitutions(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, alreadyAddedSubstitutionCodes));
    if (equals((tmp$ = substitutionSelectionData.topOfSelection) != null ? tmp$.value : null, '/') && substitutionSelectionData.selectedNodeIds.length === 2) {
      var tmp$_0 = substitutionSelectionData.originalExpression;
      var array = Array_0(1);
      var tmp$_1;
      tmp$_1 = array.length - 1 | 0;
      for (var i = 0; i <= tmp$_1; i++) {
        array[i] = ensureNotNull(substitutionSelectionData.topOfSelection).nodeId;
      }
      var divisionSubstitutionSelectionData = new SubstitutionSelectionData(tmp$_0, array, substitutionSelectionData.compiledConfiguration);
      fillSubstitutionSelectionData(divisionSubstitutionSelectionData);
      result.addAll_brywnq$(findConfiguredSubstitutionsApplications(divisionSubstitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, withExtendingSubstitutions, alreadyAddedSubstitutionCodes));
    }
     else {
      result.addAll_brywnq$(findConfiguredSubstitutionsApplications(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, withExtendingSubstitutions, alreadyAddedSubstitutionCodes));
    }
    return result;
  }
  function generateFormDependentSubstitutionsBySelectedNodesWithExpressionSimplifications(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, withExtendingSubstitutions) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    if (withExtendingSubstitutions === void 0)
      withExtendingSubstitutions = true;
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    var result = ArrayList_init();
    result.addAll_brywnq$(generateFormDependentSubstitutionsBySelectedNodes(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, withExtendingSubstitutions, emptySet()));
    var resultWithMaxSimplificationSubstitutions = ArrayList_init();
    tmp$_1 = (tmp$_0 = (tmp$ = substitutionSelectionData.topOfSelection) != null ? tmp$.clone() : null) != null ? tmp$_0.cloneAndSimplifyByCommutativeNormalizeAndComputeSimplePlaces_xcc95t$(substitutionSelectionData.compiledConfiguration, substitutionSelectionData.selectedNodeIds) : null;
    if (tmp$_1 == null) {
      return result;
    }
    var topWithMaxSimplification = tmp$_1;
    if (((tmp$_2 = substitutionSelectionData.topOfSelectionParent) != null ? (tmp$_2.setChildOnPosition_tvfpvg$(topWithMaxSimplification, substitutionSelectionData.topOfSelectionIndex), Unit) : null) == null)
      return result;
    var expression = substitutionSelectionData.expressionToTransform.clone();
    ensureNotNull(substitutionSelectionData.topOfSelectionParent).setChildOnPosition_tvfpvg$(ensureNotNull(substitutionSelectionData.topOfSelection), substitutionSelectionData.topOfSelectionIndex);
    if (!equals(expression.toString(), substitutionSelectionData.originalExpression.toString())) {
      expression.computeNodeIdsAsNumbersInDirectTraversalAndDistancesToRoot_ydzd23$(void 0, void 0, false);
      var additionalSubstitutionSelectionData = new SubstitutionSelectionData(expression, substitutionSelectionData.selectedNodeIds, substitutionSelectionData.compiledConfiguration);
      fillSubstitutionSelectionData(additionalSubstitutionSelectionData);
      var destination = ArrayList_init_0(collectionSizeOrDefault(result, 10));
      var tmp$_3;
      tmp$_3 = result.iterator();
      while (tmp$_3.hasNext()) {
        var item = tmp$_3.next();
        destination.add_11rb$(item.expressionSubstitution.code);
      }
      resultWithMaxSimplificationSubstitutions.addAll_brywnq$(generateFormDependentSubstitutionsBySelectedNodes(additionalSubstitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, withExtendingSubstitutions, toSet(destination)));
      var destination_0 = ArrayList_init_0(collectionSizeOrDefault(result, 10));
      var tmp$_4;
      tmp$_4 = result.iterator();
      while (tmp$_4.hasNext()) {
        var item_0 = tmp$_4.next();
        var tmp$_5, tmp$_6, tmp$_7;
        destination_0.add_11rb$(new Pair(item_0.expressionSubstitution.code, (tmp$_7 = (tmp$_6 = (tmp$_5 = firstOrNull_0(item_0.expressionSubstitution.right.children)) != null ? tmp$_5.children : null) != null ? tmp$_6.size : null) != null ? tmp$_7 : 0));
      }
      var alreadyAddedSubstitutions = toMap(destination_0);
      var destination_1 = ArrayList_init();
      var tmp$_8;
      tmp$_8 = resultWithMaxSimplificationSubstitutions.iterator();
      while (tmp$_8.hasNext()) {
        var element = tmp$_8.next();
        var tmp$_9, tmp$_10, tmp$_11;
        if (alreadyAddedSubstitutions.get_11rb$(element.expressionSubstitution.code) == null || !equals(alreadyAddedSubstitutions.get_11rb$(element.expressionSubstitution.code), (tmp$_11 = (tmp$_10 = (tmp$_9 = firstOrNull_0(element.expressionSubstitution.right.children)) != null ? tmp$_9.children : null) != null ? tmp$_10.size : null) != null ? tmp$_11 : 0))
          destination_1.add_11rb$(element);
      }
      result.addAll_brywnq$(destination_1);
    }
    return result;
  }
  function generateSubstitutionsBySelectedNodes$lambda(it) {
    return it.priority;
  }
  function generateSubstitutionsBySelectedNodes$lambda_0(it) {
    return it.priority;
  }
  function generateSubstitutionsBySelectedNodes(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion) {
    if (simplifyNotSelectedTopArguments === void 0)
      simplifyNotSelectedTopArguments = false;
    if (withReadyApplicationResult === void 0)
      withReadyApplicationResult = false;
    if (fastestAppropriateVersion === void 0)
      fastestAppropriateVersion = false;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6;
    var result = ArrayList_init();
    fillSubstitutionSelectionData(substitutionSelectionData);
    result.addAll_brywnq$(generateFormIndependentSubstitutionsBySelectedNodes(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion));
    result.addAll_brywnq$(generateFormDependentSubstitutionsBySelectedNodesWithExpressionSimplifications(substitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, true));
    if (result.size > 1) {
      sortWith(result, new Comparator$ObjectLiteral_3(compareBy$lambda_1(generateSubstitutionsBySelectedNodes$lambda)));
    }
    var resultWithAdditionalSubstitutions = ArrayList_init();
    if (substitutionSelectionData.selectedNodeIds.length > 1) {
      tmp$ = substitutionSelectionData.compiledConfiguration.compiledExpressionSimpleAdditionalTreeTransformationRules.iterator();
      while (tmp$.hasNext()) {
        var rule = tmp$.next();
        var expression = substitutionSelectionData.originalExpression.clone();
        var selectedNodes = nodeIdsToNodeLinksInSameOrder(expression, substitutionSelectionData.selectedNodeIds, nodeIdsPositionsMap(substitutionSelectionData.selectedNodeIds));
        var happenedReplacementsCount = 0;
        tmp$_0 = selectedNodes.iterator();
        while (tmp$_0.hasNext()) {
          var selectedNode = tmp$_0.next();
          if (!equals(selectedNode.value, first(rule.right.children).value) && !containsAny_0(selectedNode.getAllChildrenNodeIds(), substitutionSelectionData.selectedNodeIds)) {
            tmp$_1 = selectedNode.parent;
            if (tmp$_1 == null) {
              continue;
            }
            var selectedNodeParent = tmp$_1;
            var selectedNodeIndex = selectedNodeParent.children.indexOf_11rb$(selectedNode);
            var applicationResult = rule.checkAndApply_6718cy$(selectedNode);
            if (applicationResult != null) {
              selectedNodeParent.setChildOnPosition_tvfpvg$(applicationResult, selectedNodeIndex);
              happenedReplacementsCount = happenedReplacementsCount + 1 | 0;
            }
          }
        }
        if (0 < happenedReplacementsCount && happenedReplacementsCount < selectedNodes.size) {
          expression.computeNodeIdsAsNumbersInDirectTraversalAndDistancesToRoot_ydzd23$(1073741823, 0, false);
          var additionalSubstitutionSelectionData = new SubstitutionSelectionData(expression, substitutionSelectionData.selectedNodeIds, substitutionSelectionData.compiledConfiguration);
          fillSubstitutionSelectionData(additionalSubstitutionSelectionData);
          resultWithAdditionalSubstitutions.addAll_brywnq$(generateFormDependentSubstitutionsBySelectedNodesWithExpressionSimplifications(additionalSubstitutionSelectionData, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, false));
        }
      }
    }
     else if (equals((tmp$_3 = (tmp$_2 = firstOrNull_0(substitutionSelectionData.selectedNodes)) != null ? tmp$_2.parent : null) != null ? tmp$_3.value : null, '-') && equals((tmp$_6 = (tmp$_5 = (tmp$_4 = firstOrNull_0(substitutionSelectionData.selectedNodes)) != null ? tmp$_4.parent : null) != null ? tmp$_5.parent : null) != null ? tmp$_6.value : null, '+')) {
      var expression_0 = substitutionSelectionData.originalExpression.clone();
      var selectedNodes_0 = nodeIdsToNodeLinksInSameOrder(expression_0, substitutionSelectionData.selectedNodeIds, nodeIdsPositionsMap(substitutionSelectionData.selectedNodeIds));
      var dadPlusNode = ensureNotNull(ensureNotNull(first(selectedNodes_0).parent).parent);
      var parentMinusNode = ensureNotNull(first(selectedNodes_0).parent);
      var parentMinusNodeIndex = dadPlusNode.children.indexOf_11rb$(parentMinusNode);
      var $receiver = substitutionSelectionData.compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
      $receiver.nodeId = first_1(substitutionSelectionData.selectedNodeIds);
      var addNode = $receiver;
      parentMinusNode.resetNodeIds();
      addNode.addChild_6718cy$(parentMinusNode);
      addNode.computeNodeIdsAsNumbersInDirectTraversalAndDistancesToRoot_ydzd23$(1073741823, 0, false);
      dadPlusNode.setChildOnPosition_tvfpvg$(addNode, parentMinusNodeIndex);
      var additionalSubstitutionSelectionData_0 = new SubstitutionSelectionData(expression_0, substitutionSelectionData.selectedNodeIds, substitutionSelectionData.compiledConfiguration);
      fillSubstitutionSelectionData(additionalSubstitutionSelectionData_0);
      var destination = ArrayList_init_0(collectionSizeOrDefault(result, 10));
      var tmp$_7;
      tmp$_7 = result.iterator();
      while (tmp$_7.hasNext()) {
        var item = tmp$_7.next();
        destination.add_11rb$(item.expressionSubstitution.code);
      }
      resultWithAdditionalSubstitutions.addAll_brywnq$(findConfiguredSubstitutionsApplications(additionalSubstitutionSelectionData_0, simplifyNotSelectedTopArguments, withReadyApplicationResult, fastestAppropriateVersion, false, toSet(destination)));
    }
    if (resultWithAdditionalSubstitutions.size > 1) {
      sortWith(resultWithAdditionalSubstitutions, new Comparator$ObjectLiteral_3(compareBy$lambda_1(generateSubstitutionsBySelectedNodes$lambda_0)));
    }
    result.addAll_brywnq$(resultWithAdditionalSubstitutions);
    var tmp$_8;
    var set = HashSet_init();
    var list = ArrayList_init();
    tmp$_8 = result.iterator();
    while (tmp$_8.hasNext()) {
      var e = tmp$_8.next();
      var key = e.resultExpression.identifier;
      if (set.add_11rb$(key))
        list.add_11rb$(e);
    }
    var destination_0 = ArrayList_init();
    var tmp$_9;
    tmp$_9 = list.iterator();
    while (tmp$_9.hasNext()) {
      var element = tmp$_9.next();
      !equals(element.expressionSubstitution.left.toString(), element.expressionSubstitution.right.toString());
      if (!equals(element.resultExpression.toString(), element.originalExpression.toString()))
        destination_0.add_11rb$(element);
    }
    return destination_0;
  }
  function ExpressionStructurePart() {
  }
  ExpressionStructurePart.$metadata$ = {
    kind: Kind_INTERFACE,
    simpleName: 'ExpressionStructurePart',
    interfaces: []
  };
  function FunctionCondition(name, numberOfArgumentsInterval, internalFunctionCondition, internalVariableCondition, parent) {
    if (name === void 0)
      name = '';
    if (numberOfArgumentsInterval === void 0)
      numberOfArgumentsInterval = new NumberInterval();
    if (internalFunctionCondition === void 0)
      internalFunctionCondition = new FunctionsCondition();
    if (internalVariableCondition === void 0)
      internalVariableCondition = new VariablesCondition();
    if (parent === void 0)
      parent = null;
    this.name = name;
    this.numberOfArgumentsInterval = numberOfArgumentsInterval;
    this.internalFunctionCondition = internalFunctionCondition;
    this.internalVariableCondition = internalVariableCondition;
    this.parent = parent;
  }
  FunctionCondition.prototype.toString = function () {
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    if (this.name.length > 0) {
      tmp$ = 'name=' + this.name;
    }
     else {
      tmp$ = '';
    }
    if (this.numberOfArgumentsInterval.isNotEmpty()) {
      tmp$_0 = 'numberOfArgumentsInterval=' + this.numberOfArgumentsInterval;
    }
     else {
      tmp$_0 = '';
    }
    if (this.internalFunctionCondition.isNotEmpty()) {
      tmp$_1 = 'internalFunctionCondition=' + this.internalFunctionCondition;
    }
     else {
      tmp$_1 = '';
    }
    if (this.internalVariableCondition.isNotEmpty()) {
      tmp$_2 = 'internalVariableCondition=' + this.internalVariableCondition;
    }
     else {
      tmp$_2 = '';
    }
    return '[' + tmp$ + ',' + tmp$_0 + ',' + tmp$_1 + ',' + tmp$_2 + ']';
  };
  FunctionCondition.prototype.isEmpty = function () {
    return this.name.length === 0 && this.numberOfArgumentsInterval.isEmpty() && this.internalFunctionCondition.isEmpty() && !this.internalVariableCondition.isNotEmpty();
  };
  FunctionCondition.prototype.matchFunction_6718cy$ = function (node) {
    var tmp$;
    if (equals(this.name, node.value) && this.numberOfArgumentsInterval.matchNumber_14dthe$(node.children.size)) {
      var $receiver = node.getContainedVariables();
      var all$result;
      all$break: do {
        var tmp$_0;
        if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
          all$result = true;
          break all$break;
        }
        tmp$_0 = $receiver.iterator();
        while (tmp$_0.hasNext()) {
          var element = tmp$_0.next();
          if (!this.internalVariableCondition.matchVariable_61zpoe$(element)) {
            all$result = false;
            break all$break;
          }
        }
        all$result = true;
      }
       while (false);
      if (all$result) {
        tmp$ = node.children.iterator();
        while (tmp$.hasNext()) {
          var child = tmp$.next();
          if (!this.internalFunctionCondition.matchFunction_6718cy$(child)) {
            return false;
          }
        }
        return true;
      }
    }
    return false;
  };
  FunctionCondition.prototype.matchFunctionByNameNumberOfArguments_6718cy$ = function (node) {
    return this.name.length === 0 && this.numberOfArgumentsInterval.isEmpty() && this.internalFunctionCondition.isEmpty() && !this.internalVariableCondition.isNotEmpty() || (equals(this.name, node.value) && this.numberOfArgumentsInterval.matchNumber_14dthe$(node.children.size));
  };
  FunctionCondition.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FunctionCondition',
    interfaces: [ExpressionStructurePart]
  };
  FunctionCondition.prototype.component1 = function () {
    return this.name;
  };
  FunctionCondition.prototype.component2 = function () {
    return this.numberOfArgumentsInterval;
  };
  FunctionCondition.prototype.component3 = function () {
    return this.internalFunctionCondition;
  };
  FunctionCondition.prototype.component4 = function () {
    return this.internalVariableCondition;
  };
  FunctionCondition.prototype.component5 = function () {
    return this.parent;
  };
  FunctionCondition.prototype.copy_qcapyp$ = function (name, numberOfArgumentsInterval, internalFunctionCondition, internalVariableCondition, parent) {
    return new FunctionCondition(name === void 0 ? this.name : name, numberOfArgumentsInterval === void 0 ? this.numberOfArgumentsInterval : numberOfArgumentsInterval, internalFunctionCondition === void 0 ? this.internalFunctionCondition : internalFunctionCondition, internalVariableCondition === void 0 ? this.internalVariableCondition : internalVariableCondition, parent === void 0 ? this.parent : parent);
  };
  FunctionCondition.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.name) | 0;
    result = result * 31 + Kotlin.hashCode(this.numberOfArgumentsInterval) | 0;
    result = result * 31 + Kotlin.hashCode(this.internalFunctionCondition) | 0;
    result = result * 31 + Kotlin.hashCode(this.internalVariableCondition) | 0;
    result = result * 31 + Kotlin.hashCode(this.parent) | 0;
    return result;
  };
  FunctionCondition.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.name, other.name) && Kotlin.equals(this.numberOfArgumentsInterval, other.numberOfArgumentsInterval) && Kotlin.equals(this.internalFunctionCondition, other.internalFunctionCondition) && Kotlin.equals(this.internalVariableCondition, other.internalVariableCondition) && Kotlin.equals(this.parent, other.parent)))));
  };
  function FunctionsCondition(treePermittedFunctions, treeForbiddenFunctions, parent) {
    if (treePermittedFunctions === void 0) {
      treePermittedFunctions = ArrayList_init();
    }
    if (treeForbiddenFunctions === void 0) {
      treeForbiddenFunctions = ArrayList_init();
    }
    if (parent === void 0)
      parent = null;
    this.treePermittedFunctions = treePermittedFunctions;
    this.treeForbiddenFunctions = treeForbiddenFunctions;
    this.parent = parent;
  }
  FunctionsCondition.prototype.toString = function () {
    var tmp$, tmp$_0;
    if (!this.treePermittedFunctions.isEmpty()) {
      tmp$ = 'treePermittedFunctions=' + this.treePermittedFunctions;
    }
     else {
      tmp$ = '';
    }
    if (!this.treeForbiddenFunctions.isEmpty()) {
      tmp$_0 = 'treeForbiddenFunctions=' + this.treeForbiddenFunctions;
    }
     else {
      tmp$_0 = '';
    }
    return '[' + tmp$ + ',' + tmp$_0 + ']';
  };
  FunctionsCondition.prototype.isEmpty = function () {
    return !this.isNotEmpty();
  };
  FunctionsCondition.prototype.isNotEmpty = function () {
    var tmp$ = !this.treePermittedFunctions.isEmpty();
    if (!tmp$) {
      tmp$ = !this.treeForbiddenFunctions.isEmpty();
    }
    return tmp$;
  };
  FunctionsCondition.prototype.mergeWithTopFunctionsCondition_9lcxp4$ = function (topFunctionsCondition) {
    if (this.isNotEmpty()) {
      this.treePermittedFunctions.addAll_brywnq$(topFunctionsCondition.treePermittedFunctions);
      this.treeForbiddenFunctions.addAll_brywnq$(topFunctionsCondition.treeForbiddenFunctions);
    }
  };
  FunctionsCondition.prototype.matchFunction_6718cy$ = function (node) {
    var tmp$ = this.isEmpty();
    if (!tmp$) {
      var $receiver = this.treeForbiddenFunctions;
      var any$result;
      any$break: do {
        var tmp$_0;
        if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
          any$result = false;
          break any$break;
        }
        tmp$_0 = $receiver.iterator();
        while (tmp$_0.hasNext()) {
          var element = tmp$_0.next();
          if (element.matchFunction_6718cy$(node)) {
            any$result = true;
            break any$break;
          }
        }
        any$result = false;
      }
       while (false);
      tmp$ = any$result;
    }
    if (tmp$) {
      return false;
    }
     else if (this.treePermittedFunctions.isEmpty() || (this.treePermittedFunctions.size === 1 && first(this.treePermittedFunctions).isEmpty())) {
      return true;
    }
     else {
      var $receiver_0 = this.treePermittedFunctions;
      var any$result_0;
      any$break: do {
        var tmp$_1;
        if (Kotlin.isType($receiver_0, Collection) && $receiver_0.isEmpty()) {
          any$result_0 = false;
          break any$break;
        }
        tmp$_1 = $receiver_0.iterator();
        while (tmp$_1.hasNext()) {
          var element_0 = tmp$_1.next();
          if (element_0.matchFunction_6718cy$(node)) {
            any$result_0 = true;
            break any$break;
          }
        }
        any$result_0 = false;
      }
       while (false);
      return any$result_0;
    }
  };
  FunctionsCondition.prototype.matchFunctionByNameNumberOfArguments_6718cy$ = function (node) {
    var tmp$ = this.isEmpty();
    if (!tmp$) {
      var $receiver = this.treeForbiddenFunctions;
      var any$result;
      any$break: do {
        var tmp$_0;
        if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
          any$result = false;
          break any$break;
        }
        tmp$_0 = $receiver.iterator();
        while (tmp$_0.hasNext()) {
          var element = tmp$_0.next();
          if (element.matchFunctionByNameNumberOfArguments_6718cy$(node)) {
            any$result = true;
            break any$break;
          }
        }
        any$result = false;
      }
       while (false);
      tmp$ = any$result;
    }
    if (tmp$) {
      return false;
    }
     else if (this.treePermittedFunctions.isEmpty()) {
      return true;
    }
     else {
      var $receiver_0 = this.treePermittedFunctions;
      var any$result_0;
      any$break: do {
        var tmp$_1;
        if (Kotlin.isType($receiver_0, Collection) && $receiver_0.isEmpty()) {
          any$result_0 = false;
          break any$break;
        }
        tmp$_1 = $receiver_0.iterator();
        while (tmp$_1.hasNext()) {
          var element_0 = tmp$_1.next();
          if (element_0.matchFunctionByNameNumberOfArguments_6718cy$(node)) {
            any$result_0 = true;
            break any$break;
          }
        }
        any$result_0 = false;
      }
       while (false);
      return any$result_0;
    }
  };
  FunctionsCondition.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FunctionsCondition',
    interfaces: [ExpressionStructurePart]
  };
  FunctionsCondition.prototype.component1 = function () {
    return this.treePermittedFunctions;
  };
  FunctionsCondition.prototype.component2 = function () {
    return this.treeForbiddenFunctions;
  };
  FunctionsCondition.prototype.component3 = function () {
    return this.parent;
  };
  FunctionsCondition.prototype.copy_wsp4rb$ = function (treePermittedFunctions, treeForbiddenFunctions, parent) {
    return new FunctionsCondition(treePermittedFunctions === void 0 ? this.treePermittedFunctions : treePermittedFunctions, treeForbiddenFunctions === void 0 ? this.treeForbiddenFunctions : treeForbiddenFunctions, parent === void 0 ? this.parent : parent);
  };
  FunctionsCondition.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.treePermittedFunctions) | 0;
    result = result * 31 + Kotlin.hashCode(this.treeForbiddenFunctions) | 0;
    result = result * 31 + Kotlin.hashCode(this.parent) | 0;
    return result;
  };
  FunctionsCondition.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.treePermittedFunctions, other.treePermittedFunctions) && Kotlin.equals(this.treeForbiddenFunctions, other.treeForbiddenFunctions) && Kotlin.equals(this.parent, other.parent)))));
  };
  function NumberIntervalType(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function NumberIntervalType_initFields() {
    NumberIntervalType_initFields = function () {
    };
    NumberIntervalType$NATURAL_instance = new NumberIntervalType('NATURAL', 0);
    NumberIntervalType$INTEGER_instance = new NumberIntervalType('INTEGER', 1);
    NumberIntervalType$REAL_instance = new NumberIntervalType('REAL', 2);
  }
  var NumberIntervalType$NATURAL_instance;
  function NumberIntervalType$NATURAL_getInstance() {
    NumberIntervalType_initFields();
    return NumberIntervalType$NATURAL_instance;
  }
  var NumberIntervalType$INTEGER_instance;
  function NumberIntervalType$INTEGER_getInstance() {
    NumberIntervalType_initFields();
    return NumberIntervalType$INTEGER_instance;
  }
  var NumberIntervalType$REAL_instance;
  function NumberIntervalType$REAL_getInstance() {
    NumberIntervalType_initFields();
    return NumberIntervalType$REAL_instance;
  }
  NumberIntervalType.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'NumberIntervalType',
    interfaces: [Enum]
  };
  function NumberIntervalType$values() {
    return [NumberIntervalType$NATURAL_getInstance(), NumberIntervalType$INTEGER_getInstance(), NumberIntervalType$REAL_getInstance()];
  }
  NumberIntervalType.values = NumberIntervalType$values;
  function NumberIntervalType$valueOf(name) {
    switch (name) {
      case 'NATURAL':
        return NumberIntervalType$NATURAL_getInstance();
      case 'INTEGER':
        return NumberIntervalType$INTEGER_getInstance();
      case 'REAL':
        return NumberIntervalType$REAL_getInstance();
      default:throwISE('No enum constant expressiontree.NumberIntervalType.' + name);
    }
  }
  NumberIntervalType.valueOf_61zpoe$ = NumberIntervalType$valueOf;
  function NumberInterval(numbersType, leftBorder, rightBorder, parent) {
    if (numbersType === void 0)
      numbersType = NumberIntervalType$NATURAL_getInstance();
    if (leftBorder === void 0)
      leftBorder = kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY;
    if (rightBorder === void 0)
      rightBorder = kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY;
    if (parent === void 0)
      parent = null;
    this.numbersType = numbersType;
    this.leftBorder = leftBorder;
    this.rightBorder = rightBorder;
    this.parent = parent;
  }
  NumberInterval.prototype.toString = function () {
    var tmp$;
    switch (this.numbersType.name) {
      case 'NATURAL':
        tmp$ = 'N';
        break;
      case 'INTEGER':
        tmp$ = 'Z';
        break;
      case 'REAL':
        tmp$ = 'R';
        break;
      default:tmp$ = Kotlin.noWhenBranchMatched();
        break;
    }
    return replace('[' + this.leftBorder + ';' + this.rightBorder + ']:' + tmp$, 'Infinity', 'Inf');
  };
  NumberInterval.prototype.isEmpty = function () {
    return !this.isNotEmpty();
  };
  NumberInterval.prototype.isNotEmpty = function () {
    return this.leftBorder !== kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY || this.rightBorder !== kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY || this.numbersType !== NumberIntervalType$NATURAL_getInstance();
  };
  NumberInterval.prototype.matchNumber_14dthe$ = function (number) {
    if (this.leftBorder - BaseOperationsComputation$Companion_getInstance().epsilon < number && number < this.rightBorder + BaseOperationsComputation$Companion_getInstance().epsilon) {
      switch (this.numbersType.name) {
        case 'NATURAL':
          var tmp$ = BaseOperationsComputation$Companion_getInstance();
          var x = number + BaseOperationsComputation$Companion_getInstance().epsilon / 3;
          return tmp$.additivelyEqual_lu1900$(Math_0.floor(x), number) && 0.0 - BaseOperationsComputation$Companion_getInstance().epsilon < number;
        case 'INTEGER':
          var tmp$_0 = BaseOperationsComputation$Companion_getInstance();
          var x_0 = number + BaseOperationsComputation$Companion_getInstance().epsilon / 3;
          return tmp$_0.additivelyEqual_lu1900$(Math_0.floor(x_0), number);
        case 'REAL':
          return true;
        default:Kotlin.noWhenBranchMatched();
          break;
      }
    }
     else
      return false;
  };
  NumberInterval.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'NumberInterval',
    interfaces: [ExpressionStructurePart]
  };
  NumberInterval.prototype.component1 = function () {
    return this.numbersType;
  };
  NumberInterval.prototype.component2 = function () {
    return this.leftBorder;
  };
  NumberInterval.prototype.component3 = function () {
    return this.rightBorder;
  };
  NumberInterval.prototype.component4 = function () {
    return this.parent;
  };
  NumberInterval.prototype.copy_xcj34v$ = function (numbersType, leftBorder, rightBorder, parent) {
    return new NumberInterval(numbersType === void 0 ? this.numbersType : numbersType, leftBorder === void 0 ? this.leftBorder : leftBorder, rightBorder === void 0 ? this.rightBorder : rightBorder, parent === void 0 ? this.parent : parent);
  };
  NumberInterval.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.numbersType) | 0;
    result = result * 31 + Kotlin.hashCode(this.leftBorder) | 0;
    result = result * 31 + Kotlin.hashCode(this.rightBorder) | 0;
    result = result * 31 + Kotlin.hashCode(this.parent) | 0;
    return result;
  };
  NumberInterval.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.numbersType, other.numbersType) && Kotlin.equals(this.leftBorder, other.leftBorder) && Kotlin.equals(this.rightBorder, other.rightBorder) && Kotlin.equals(this.parent, other.parent)))));
  };
  function NumberCondition(intervals, parent) {
    if (intervals === void 0) {
      intervals = ArrayList_init();
    }
    if (parent === void 0)
      parent = null;
    this.intervals = intervals;
    this.parent = parent;
  }
  NumberCondition.prototype.toString = function () {
    return '[' + this.intervals.toString() + ']';
  };
  NumberCondition.prototype.isEmpty = function () {
    return !this.isNotEmpty();
  };
  NumberCondition.prototype.isNotEmpty = function () {
    var tmp$ = !this.intervals.isEmpty();
    if (tmp$) {
      var $receiver = this.intervals;
      var any$result;
      any$break: do {
        var tmp$_0;
        if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
          any$result = false;
          break any$break;
        }
        tmp$_0 = $receiver.iterator();
        while (tmp$_0.hasNext()) {
          var element = tmp$_0.next();
          if (element.isNotEmpty()) {
            any$result = true;
            break any$break;
          }
        }
        any$result = false;
      }
       while (false);
      tmp$ = any$result;
    }
    return tmp$;
  };
  NumberCondition.prototype.matchNumber_14dthe$ = function (number) {
    var tmp$ = this.intervals.isEmpty();
    if (!tmp$) {
      var $receiver = this.intervals;
      var any$result;
      any$break: do {
        var tmp$_0;
        if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
          any$result = false;
          break any$break;
        }
        tmp$_0 = $receiver.iterator();
        while (tmp$_0.hasNext()) {
          var element = tmp$_0.next();
          if (element.matchNumber_14dthe$(number)) {
            any$result = true;
            break any$break;
          }
        }
        any$result = false;
      }
       while (false);
      tmp$ = any$result;
    }
    return tmp$;
  };
  NumberCondition.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'NumberCondition',
    interfaces: [ExpressionStructurePart]
  };
  NumberCondition.prototype.component1 = function () {
    return this.intervals;
  };
  NumberCondition.prototype.component2 = function () {
    return this.parent;
  };
  NumberCondition.prototype.copy_3e2a1f$ = function (intervals, parent) {
    return new NumberCondition(intervals === void 0 ? this.intervals : intervals, parent === void 0 ? this.parent : parent);
  };
  NumberCondition.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.intervals) | 0;
    result = result * 31 + Kotlin.hashCode(this.parent) | 0;
    return result;
  };
  NumberCondition.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.intervals, other.intervals) && Kotlin.equals(this.parent, other.parent)))));
  };
  function VariableCondition(intervals, variableName, parent) {
    if (intervals === void 0) {
      intervals = ArrayList_init();
    }
    if (variableName === void 0)
      variableName = '';
    if (parent === void 0)
      parent = null;
    this.intervals = intervals;
    this.variableName = variableName;
    this.parent = parent;
  }
  VariableCondition.prototype.hasNumberCondition = function () {
    return !this.intervals.isEmpty();
  };
  VariableCondition.prototype.hasVariableCondition = function () {
    return this.variableName.length > 0;
  };
  VariableCondition.prototype.intervalsToString = function () {
    if (!this.intervals.isEmpty()) {
      return 'intervals=' + this.intervals;
    }
     else {
      return '';
    }
  };
  VariableCondition.prototype.variableNameToString = function () {
    if (this.variableName.length > 0) {
      return 'variableName=' + this.variableName;
    }
     else {
      return '';
    }
  };
  VariableCondition.prototype.toString = function () {
    var tmp$, tmp$_0;
    if (!this.intervals.isEmpty()) {
      tmp$ = 'intervals=' + this.intervals;
    }
     else {
      tmp$ = '';
    }
    if (this.variableName.length > 0) {
      tmp$_0 = 'variableName=' + this.variableName;
    }
     else {
      tmp$_0 = '';
    }
    return '[' + tmp$ + ',' + tmp$_0 + ']';
  };
  VariableCondition.prototype.matchVariable_61zpoe$ = function (name) {
    var tmp$;
    tmp$ = toDoubleOrNull(name);
    if (tmp$ == null) {
      return equals(name, this.variableName);
    }
    var number = tmp$;
    var tmp$_0 = this.intervals.isEmpty();
    if (!tmp$_0) {
      var $receiver = this.intervals;
      var any$result;
      any$break: do {
        var tmp$_1;
        if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
          any$result = false;
          break any$break;
        }
        tmp$_1 = $receiver.iterator();
        while (tmp$_1.hasNext()) {
          var element = tmp$_1.next();
          if (element.matchNumber_14dthe$(number)) {
            any$result = true;
            break any$break;
          }
        }
        any$result = false;
      }
       while (false);
      tmp$_0 = any$result;
    }
    return tmp$_0;
  };
  VariableCondition.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'VariableCondition',
    interfaces: [ExpressionStructurePart]
  };
  VariableCondition.prototype.component1 = function () {
    return this.intervals;
  };
  VariableCondition.prototype.component2 = function () {
    return this.variableName;
  };
  VariableCondition.prototype.component3 = function () {
    return this.parent;
  };
  VariableCondition.prototype.copy_r1xo85$ = function (intervals, variableName, parent) {
    return new VariableCondition(intervals === void 0 ? this.intervals : intervals, variableName === void 0 ? this.variableName : variableName, parent === void 0 ? this.parent : parent);
  };
  VariableCondition.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.intervals) | 0;
    result = result * 31 + Kotlin.hashCode(this.variableName) | 0;
    result = result * 31 + Kotlin.hashCode(this.parent) | 0;
    return result;
  };
  VariableCondition.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.intervals, other.intervals) && Kotlin.equals(this.variableName, other.variableName) && Kotlin.equals(this.parent, other.parent)))));
  };
  function VariablesCondition(treePermittedVariables, treeForbiddenVariables, parent) {
    if (treePermittedVariables === void 0) {
      treePermittedVariables = ArrayList_init();
    }
    if (treeForbiddenVariables === void 0) {
      treeForbiddenVariables = ArrayList_init();
    }
    if (parent === void 0)
      parent = null;
    this.treePermittedVariables = treePermittedVariables;
    this.treeForbiddenVariables = treeForbiddenVariables;
    this.parent = parent;
  }
  VariablesCondition.prototype.toString = function () {
    var tmp$, tmp$_0;
    if (!this.treePermittedVariables.isEmpty()) {
      tmp$ = 'treePermittedVariables=' + this.treePermittedVariables;
    }
     else {
      tmp$ = '';
    }
    if (!this.treeForbiddenVariables.isEmpty()) {
      tmp$_0 = 'treeForbiddenVariables=' + this.treeForbiddenVariables.toString();
    }
     else {
      tmp$_0 = '';
    }
    return '[' + tmp$ + ',' + tmp$_0 + ']';
  };
  VariablesCondition.prototype.isNotEmpty = function () {
    var tmp$ = !this.treePermittedVariables.isEmpty();
    if (!tmp$) {
      tmp$ = !this.treeForbiddenVariables.isEmpty();
    }
    return tmp$;
  };
  VariablesCondition.prototype.mergeWithTopVariablesCondition_9wdl4s$ = function (topVariablesCondition) {
    this.treePermittedVariables.addAll_brywnq$(topVariablesCondition.treePermittedVariables);
    this.treeForbiddenVariables.addAll_brywnq$(topVariablesCondition.treeForbiddenVariables);
  };
  VariablesCondition.prototype.matchVariable_61zpoe$ = function (name) {
    var $receiver = this.treeForbiddenVariables;
    var any$result;
    any$break: do {
      var tmp$;
      if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
        any$result = false;
        break any$break;
      }
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (element.matchVariable_61zpoe$(name)) {
          any$result = true;
          break any$break;
        }
      }
      any$result = false;
    }
     while (false);
    if (any$result) {
      return false;
    }
     else if (this.treePermittedVariables.isEmpty()) {
      return true;
    }
     else {
      var $receiver_0 = this.treePermittedVariables;
      var any$result_0;
      any$break: do {
        var tmp$_0;
        if (Kotlin.isType($receiver_0, Collection) && $receiver_0.isEmpty()) {
          any$result_0 = false;
          break any$break;
        }
        tmp$_0 = $receiver_0.iterator();
        while (tmp$_0.hasNext()) {
          var element_0 = tmp$_0.next();
          if (element_0.matchVariable_61zpoe$(name)) {
            any$result_0 = true;
            break any$break;
          }
        }
        any$result_0 = false;
      }
       while (false);
      return any$result_0;
    }
  };
  VariablesCondition.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'VariablesCondition',
    interfaces: [ExpressionStructurePart]
  };
  VariablesCondition.prototype.component1 = function () {
    return this.treePermittedVariables;
  };
  VariablesCondition.prototype.component2 = function () {
    return this.treeForbiddenVariables;
  };
  VariablesCondition.prototype.component3 = function () {
    return this.parent;
  };
  VariablesCondition.prototype.copy_mjrsix$ = function (treePermittedVariables, treeForbiddenVariables, parent) {
    return new VariablesCondition(treePermittedVariables === void 0 ? this.treePermittedVariables : treePermittedVariables, treeForbiddenVariables === void 0 ? this.treeForbiddenVariables : treeForbiddenVariables, parent === void 0 ? this.parent : parent);
  };
  VariablesCondition.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.treePermittedVariables) | 0;
    result = result * 31 + Kotlin.hashCode(this.treeForbiddenVariables) | 0;
    result = result * 31 + Kotlin.hashCode(this.parent) | 0;
    return result;
  };
  VariablesCondition.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.treePermittedVariables, other.treePermittedVariables) && Kotlin.equals(this.treeForbiddenVariables, other.treeForbiddenVariables) && Kotlin.equals(this.parent, other.parent)))));
  };
  function ChildrenCondition(childNodes, count, parent) {
    if (childNodes === void 0) {
      childNodes = ArrayList_init();
    }
    if (count === void 0)
      count = new NumberCondition();
    if (parent === void 0)
      parent = null;
    this.childNodes = childNodes;
    this.count = count;
    this.parent = parent;
  }
  ChildrenCondition.prototype.toString = function () {
    var tmp$, tmp$_0;
    if (this.count.isNotEmpty()) {
      tmp$ = 'count=' + this.count;
    }
     else {
      tmp$ = '';
    }
    if (!this.childNodes.isEmpty()) {
      tmp$_0 = 'childNodes=' + this.childNodes;
    }
     else {
      tmp$_0 = '';
    }
    return '[' + tmp$ + ',' + tmp$_0 + ']';
  };
  ChildrenCondition.prototype.isEmpty = function () {
    return !this.isNotEmpty();
  };
  ChildrenCondition.prototype.isNotEmpty = function () {
    return !this.childNodes.isEmpty() || this.count.isNotEmpty();
  };
  ChildrenCondition.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ChildrenCondition',
    interfaces: [ExpressionStructurePart]
  };
  ChildrenCondition.prototype.component1 = function () {
    return this.childNodes;
  };
  ChildrenCondition.prototype.component2 = function () {
    return this.count;
  };
  ChildrenCondition.prototype.component3 = function () {
    return this.parent;
  };
  ChildrenCondition.prototype.copy_sauja7$ = function (childNodes, count, parent) {
    return new ChildrenCondition(childNodes === void 0 ? this.childNodes : childNodes, count === void 0 ? this.count : count, parent === void 0 ? this.parent : parent);
  };
  ChildrenCondition.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.childNodes) | 0;
    result = result * 31 + Kotlin.hashCode(this.count) | 0;
    result = result * 31 + Kotlin.hashCode(this.parent) | 0;
    return result;
  };
  ChildrenCondition.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.childNodes, other.childNodes) && Kotlin.equals(this.count, other.count) && Kotlin.equals(this.parent, other.parent)))));
  };
  function ExpressionStructureConditionNode(nodeFunctions, treeFunctions, treeVariables, children, functionsJoinedWithVariables, parent) {
    if (nodeFunctions === void 0)
      nodeFunctions = new FunctionsCondition();
    if (treeFunctions === void 0)
      treeFunctions = new FunctionsCondition();
    if (treeVariables === void 0)
      treeVariables = new VariablesCondition();
    if (children === void 0) {
      children = ArrayList_init();
    }
    if (functionsJoinedWithVariables === void 0) {
      functionsJoinedWithVariables = LinkedHashSet_init();
    }
    if (parent === void 0)
      parent = null;
    this.nodeFunctions = nodeFunctions;
    this.treeFunctions = treeFunctions;
    this.treeVariables = treeVariables;
    this.children = children;
    this.functionsJoinedWithVariables = functionsJoinedWithVariables;
    this.parent = parent;
  }
  ExpressionStructureConditionNode.prototype.toString = function () {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3;
    if (this.nodeFunctions.isNotEmpty()) {
      tmp$ = 'nodeFunctions=' + this.nodeFunctions;
    }
     else {
      tmp$ = '';
    }
    if (this.treeFunctions.isNotEmpty()) {
      tmp$_0 = 'treeFunctions=' + this.treeFunctions;
    }
     else {
      tmp$_0 = '';
    }
    if (this.treeVariables.isNotEmpty()) {
      tmp$_1 = 'treeVariables=' + this.treeVariables;
    }
     else {
      tmp$_1 = '';
    }
    if (!this.children.isEmpty()) {
      tmp$_2 = 'children=' + this.children;
    }
     else {
      tmp$_2 = '';
    }
    if (!this.functionsJoinedWithVariables.isEmpty()) {
      tmp$_3 = ',functionsJoinedWithVariables=' + this.functionsJoinedWithVariables;
    }
     else {
      tmp$_3 = '';
    }
    return '{ ' + tmp$ + ',' + tmp$_0 + ',' + tmp$_1 + ',' + tmp$_2 + tmp$_3 + ' }';
  };
  ExpressionStructureConditionNode.prototype.forwardTreeFunctionVariablesConditions_2z28lt$ = function (topFunctionsCondition, topVariablesCondition, topFunctionsJoinedWithVariables) {
    if (topFunctionsCondition === void 0)
      topFunctionsCondition = new FunctionsCondition();
    if (topVariablesCondition === void 0)
      topVariablesCondition = new VariablesCondition();
    if (topFunctionsJoinedWithVariables === void 0) {
      topFunctionsJoinedWithVariables = emptySet();
    }
    var tmp$, tmp$_0;
    this.treeFunctions.mergeWithTopFunctionsCondition_9lcxp4$(topFunctionsCondition);
    this.treeVariables.mergeWithTopVariablesCondition_9wdl4s$(topVariablesCondition);
    this.functionsJoinedWithVariables.addAll_brywnq$(topFunctionsJoinedWithVariables);
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      tmp$_0 = child.childNodes.iterator();
      while (tmp$_0.hasNext()) {
        var node = tmp$_0.next();
        node.forwardTreeFunctionVariablesConditions_2z28lt$(this.treeFunctions, this.treeVariables, this.functionsJoinedWithVariables);
      }
    }
  };
  ExpressionStructureConditionNode.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionStructureConditionNode',
    interfaces: [ExpressionStructurePart]
  };
  ExpressionStructureConditionNode.prototype.component1 = function () {
    return this.nodeFunctions;
  };
  ExpressionStructureConditionNode.prototype.component2 = function () {
    return this.treeFunctions;
  };
  ExpressionStructureConditionNode.prototype.component3 = function () {
    return this.treeVariables;
  };
  ExpressionStructureConditionNode.prototype.component4 = function () {
    return this.children;
  };
  ExpressionStructureConditionNode.prototype.component5 = function () {
    return this.functionsJoinedWithVariables;
  };
  ExpressionStructureConditionNode.prototype.component6 = function () {
    return this.parent;
  };
  ExpressionStructureConditionNode.prototype.copy_pu1p67$ = function (nodeFunctions, treeFunctions, treeVariables, children, functionsJoinedWithVariables, parent) {
    return new ExpressionStructureConditionNode(nodeFunctions === void 0 ? this.nodeFunctions : nodeFunctions, treeFunctions === void 0 ? this.treeFunctions : treeFunctions, treeVariables === void 0 ? this.treeVariables : treeVariables, children === void 0 ? this.children : children, functionsJoinedWithVariables === void 0 ? this.functionsJoinedWithVariables : functionsJoinedWithVariables, parent === void 0 ? this.parent : parent);
  };
  ExpressionStructureConditionNode.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.nodeFunctions) | 0;
    result = result * 31 + Kotlin.hashCode(this.treeFunctions) | 0;
    result = result * 31 + Kotlin.hashCode(this.treeVariables) | 0;
    result = result * 31 + Kotlin.hashCode(this.children) | 0;
    result = result * 31 + Kotlin.hashCode(this.functionsJoinedWithVariables) | 0;
    result = result * 31 + Kotlin.hashCode(this.parent) | 0;
    return result;
  };
  ExpressionStructureConditionNode.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.nodeFunctions, other.nodeFunctions) && Kotlin.equals(this.treeFunctions, other.treeFunctions) && Kotlin.equals(this.treeVariables, other.treeVariables) && Kotlin.equals(this.children, other.children) && Kotlin.equals(this.functionsJoinedWithVariables, other.functionsJoinedWithVariables) && Kotlin.equals(this.parent, other.parent)))));
  };
  function checkExpressionStructure(rootNode, structureNode) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3;
    if (rootNode.nodeType === NodeType$VARIABLE_getInstance()) {
      var tmp$_4 = structureNode.treeVariables.matchVariable_61zpoe$(rootNode.value);
      if (tmp$_4) {
        var tmp$_5 = structureNode.children.isEmpty();
        if (!tmp$_5) {
          var $receiver = structureNode.children;
          var any$result;
          any$break: do {
            var tmp$_6;
            if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
              any$result = false;
              break any$break;
            }
            tmp$_6 = $receiver.iterator();
            while (tmp$_6.hasNext()) {
              var element = tmp$_6.next();
              if (element.count.matchNumber_14dthe$(0.0)) {
                any$result = true;
                break any$break;
              }
            }
            any$result = false;
          }
           while (false);
          tmp$_5 = any$result;
        }
        tmp$_4 = tmp$_5;
      }
      return tmp$_4;
    }
    var tmp$_7 = structureNode.functionsJoinedWithVariables.contains_11rb$(rootNode.value);
    if (tmp$_7) {
      var $receiver_0 = rootNode.children;
      var all$result;
      all$break: do {
        var tmp$_8;
        if (Kotlin.isType($receiver_0, Collection) && $receiver_0.isEmpty()) {
          all$result = true;
          break all$break;
        }
        tmp$_8 = $receiver_0.iterator();
        while (tmp$_8.hasNext()) {
          var element_0 = tmp$_8.next();
          if (!(element_0.nodeType === NodeType$VARIABLE_getInstance())) {
            all$result = false;
            break all$break;
          }
        }
        all$result = true;
      }
       while (false);
      tmp$_7 = all$result;
    }
    if (tmp$_7) {
      var $receiver_1 = rootNode.children;
      var all$result_0;
      all$break: do {
        var tmp$_9;
        if (Kotlin.isType($receiver_1, Collection) && $receiver_1.isEmpty()) {
          all$result_0 = true;
          break all$break;
        }
        tmp$_9 = $receiver_1.iterator();
        loop_label: while (tmp$_9.hasNext()) {
          var element_1 = tmp$_9.next();
          var tmp$_10 = structureNode.treeVariables.matchVariable_61zpoe$(element_1.value);
          if (tmp$_10) {
            var tmp$_11 = structureNode.children.isEmpty();
            if (!tmp$_11) {
              var $receiver_2 = structureNode.children;
              var any$result_0;
              any$break: do {
                var tmp$_12;
                if (Kotlin.isType($receiver_2, Collection) && $receiver_2.isEmpty()) {
                  any$result_0 = false;
                  break any$break;
                }
                tmp$_12 = $receiver_2.iterator();
                while (tmp$_12.hasNext()) {
                  var element_2 = tmp$_12.next();
                  if (element_2.count.matchNumber_14dthe$(0.0)) {
                    any$result_0 = true;
                    break any$break;
                  }
                }
                any$result_0 = false;
              }
               while (false);
              tmp$_11 = any$result_0;
            }
            tmp$_10 = tmp$_11;
          }
          if (!tmp$_10) {
            all$result_0 = false;
            break all$break;
          }
        }
        all$result_0 = true;
      }
       while (false);
      return all$result_0;
    }
    if (equals(rootNode.value, '') || (listOf_0(['+', '*', '^']).contains_11rb$(rootNode.value) && rootNode.children.size === 1)) {
      tmp$ = firstOrNull_0(rootNode.children);
      if (tmp$ == null) {
        return true;
      }
      return checkExpressionStructure(tmp$, structureNode);
    }
    if (!structureNode.nodeFunctions.matchFunctionByNameNumberOfArguments_6718cy$(rootNode)) {
      var $receiver_3 = structureNode.children;
      var any$result_1;
      any$break: do {
        var tmp$_13;
        if (Kotlin.isType($receiver_3, Collection) && $receiver_3.isEmpty()) {
          any$result_1 = false;
          break any$break;
        }
        tmp$_13 = $receiver_3.iterator();
        loop_label: while (tmp$_13.hasNext()) {
          var element_3 = tmp$_13.next();
          var $receiver_4 = element_3.childNodes;
          var any$result_2;
          any$break_0: do {
            var tmp$_14;
            if (Kotlin.isType($receiver_4, Collection) && $receiver_4.isEmpty()) {
              any$result_2 = false;
              break any$break_0;
            }
            tmp$_14 = $receiver_4.iterator();
            while (tmp$_14.hasNext()) {
              var element_4 = tmp$_14.next();
              if (checkExpressionStructure(rootNode, element_4)) {
                any$result_2 = true;
                break any$break_0;
              }
            }
            any$result_2 = false;
          }
           while (false);
          if (any$result_2) {
            any$result_1 = true;
            break any$break;
          }
        }
        any$result_1 = false;
      }
       while (false);
      return any$result_1;
    }
    if (structureNode.treeVariables.isNotEmpty()) {
      var variables = rootNode.getContainedVariables();
      var any$result_3;
      any$break: do {
        var tmp$_15;
        if (Kotlin.isType(variables, Collection) && variables.isEmpty()) {
          any$result_3 = false;
          break any$break;
        }
        tmp$_15 = variables.iterator();
        loop_label: while (tmp$_15.hasNext()) {
          var element_5 = tmp$_15.next();
          var variableName = element_5;
          var $receiver_5 = structureNode.treeVariables.treeForbiddenVariables;
          var any$result_4;
          any$break_0: do {
            var tmp$_16;
            if (Kotlin.isType($receiver_5, Collection) && $receiver_5.isEmpty()) {
              any$result_4 = false;
              break any$break_0;
            }
            tmp$_16 = $receiver_5.iterator();
            while (tmp$_16.hasNext()) {
              var element_6 = tmp$_16.next();
              if (element_6.matchVariable_61zpoe$(variableName)) {
                any$result_4 = true;
                break any$break_0;
              }
            }
            any$result_4 = false;
          }
           while (false);
          if (any$result_4) {
            any$result_3 = true;
            break any$break;
          }
        }
        any$result_3 = false;
      }
       while (false);
      if (any$result_3) {
        return false;
      }
      var tmp$_17 = !structureNode.treeVariables.treePermittedVariables.isEmpty();
      if (tmp$_17) {
        var all$result_1;
        all$break: do {
          var tmp$_18;
          if (Kotlin.isType(variables, Collection) && variables.isEmpty()) {
            all$result_1 = true;
            break all$break;
          }
          tmp$_18 = variables.iterator();
          loop_label: while (tmp$_18.hasNext()) {
            var element_7 = tmp$_18.next();
            var variableName_0 = element_7;
            var $receiver_6 = structureNode.treeVariables.treePermittedVariables;
            var any$result_5;
            any$break: do {
              var tmp$_19;
              if (Kotlin.isType($receiver_6, Collection) && $receiver_6.isEmpty()) {
                any$result_5 = false;
                break any$break;
              }
              tmp$_19 = $receiver_6.iterator();
              while (tmp$_19.hasNext()) {
                var element_8 = tmp$_19.next();
                if (element_8.matchVariable_61zpoe$(variableName_0)) {
                  any$result_5 = true;
                  break any$break;
                }
              }
              any$result_5 = false;
            }
             while (false);
            if (!any$result_5) {
              all$result_1 = false;
              break all$break;
            }
          }
          all$result_1 = true;
        }
         while (false);
        tmp$_17 = !all$result_1;
      }
      if (tmp$_17) {
        return false;
      }
    }
    var array = Array_0(structureNode.children.size);
    var tmp$_20;
    tmp$_20 = array.length - 1 | 0;
    for (var i = 0; i <= tmp$_20; i++) {
      array[i] = 0;
    }
    var childrenMatches = array;
    tmp$_0 = rootNode.children.iterator();
    loop_label: while (tmp$_0.hasNext()) {
      var child = tmp$_0.next();
      var matched = false;
      tmp$_1 = get_lastIndex(structureNode.children);
      for (var i_0 = 0; i_0 <= tmp$_1; i_0++) {
        if (!structureNode.children.get_za3lpa$(i_0).childNodes.isEmpty()) {
          tmp$_2 = structureNode.children.get_za3lpa$(i_0).childNodes.iterator();
          while (tmp$_2.hasNext()) {
            var childStructureNode = tmp$_2.next();
            if (checkExpressionStructure(child, childStructureNode)) {
              childrenMatches[i_0] = childrenMatches[i_0] + 1 | 0;
              matched = true;
              break;
            }
          }
          if (!matched) {
            return false;
          }
        }
         else {
          childrenMatches[i_0] = childrenMatches[i_0] + 1 | 0;
        }
      }
      if (!matched) {
        var tmp$_21 = child.nodeType === NodeType$VARIABLE_getInstance();
        if (!tmp$_21) {
          var tmp$_22 = structureNode.functionsJoinedWithVariables.contains_11rb$(child.value);
          if (tmp$_22) {
            var $receiver_7 = child.children;
            var all$result_2;
            all$break: do {
              var tmp$_23;
              if (Kotlin.isType($receiver_7, Collection) && $receiver_7.isEmpty()) {
                all$result_2 = true;
                break all$break;
              }
              tmp$_23 = $receiver_7.iterator();
              while (tmp$_23.hasNext()) {
                var element_9 = tmp$_23.next();
                if (!(element_9.nodeType === NodeType$VARIABLE_getInstance())) {
                  all$result_2 = false;
                  break all$break;
                }
              }
              all$result_2 = true;
            }
             while (false);
            tmp$_22 = all$result_2;
          }
          tmp$_21 = tmp$_22;
        }
        if (!tmp$_21) {
          if (!structureNode.treeFunctions.matchFunction_6718cy$(child)) {
            return false;
          }
        }
      }
    }
    tmp$_3 = get_lastIndex(structureNode.children);
    for (var i_1 = 0; i_1 <= tmp$_3; i_1++) {
      if (!structureNode.children.get_za3lpa$(i_1).count.matchNumber_14dthe$(childrenMatches[i_1])) {
        return false;
      }
    }
    return true;
  }
  function ExpressionStructureConditionConstructor(compiledConfiguration) {
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration();
    this.compiledConfiguration = compiledConfiguration;
    var $receiver = this.compiledConfiguration.functionConfiguration.functionProperties;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var item = tmp$.next();
      destination.add_11rb$(item.function);
    }
    var destination_0 = ArrayList_init();
    var tmp$_0;
    tmp$_0 = destination.iterator();
    while (tmp$_0.hasNext()) {
      var element = tmp$_0.next();
      var tmp$_1, tmp$_2;
      if (!((tmp$_2 = (tmp$_1 = firstOrNull_1(element)) != null ? isLetterOrDigitOrUnderscore(unboxChar(tmp$_1)) : null) != null ? tmp$_2 : true))
        destination_0.add_11rb$(element);
    }
    this.nameSymbols = joinToString(destination_0, '');
    this.tokenSeparator = toBoxedChar(58);
    this.listSeparator = toBoxedChar(44);
    this.childrenListSeparator = toBoxedChar(59);
    this.openChildBracket = toBoxedChar(40);
    this.closeChildBracket = toBoxedChar(41);
    this.freeValueSign = toBoxedChar(63);
    this.negativeSign = toBoxedChar(33);
  }
  ExpressionStructureConditionConstructor.prototype.parse_61zpoe$ = function (pattern) {
    var resultExpressionStructureConditionNode = new ExpressionStructureConditionNode();
    this.parseExpressionStructureConditionNode_ihyupq$(pattern, 0, resultExpressionStructureConditionNode);
    resultExpressionStructureConditionNode.forwardTreeFunctionVariablesConditions_2z28lt$();
    return resultExpressionStructureConditionNode;
  };
  function ExpressionStructureConditionConstructor$parseExpressionStructureConditionNode$lambda(it) {
    return isNameOrNumberPart(unboxChar(it));
  }
  ExpressionStructureConditionConstructor.prototype.parseExpressionStructureConditionNode_ihyupq$ = function (pattern, startPosition, result) {
    var currentPosition = startPosition;
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    if (currentPosition < pattern.length && (this.isFunctionNameOrNumberPart_0(pattern.charCodeAt(currentPosition)) || pattern.charCodeAt(currentPosition) === unboxChar(this.freeValueSign) || pattern.charCodeAt(currentPosition) === unboxChar(this.negativeSign))) {
      currentPosition = this.parseFunctionsCondition_na24n0$(pattern, currentPosition, result.nodeFunctions);
      if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) === unboxChar(this.childrenListSeparator)) {
        return currentPosition + 1 | 0;
      }
      if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) === unboxChar(this.tokenSeparator)) {
        currentPosition = currentPosition + 1 | 0;
      }
    }
    var previousPosition = currentPosition;
    while (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) !== unboxChar(this.tokenSeparator) && pattern.charCodeAt(currentPosition) !== unboxChar(this.closeChildBracket)) {
      result.children.add_11rb$(new ChildrenCondition(void 0, void 0, result));
      currentPosition = this.parseChildCondition_fsjj8g$(pattern, currentPosition, last(result.children));
      if (last(result.children).isEmpty()) {
        result.children.removeAt_za3lpa$(get_lastIndex(result.children));
      }
      currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      if (currentPosition < pattern.length && (pattern.charCodeAt(currentPosition) === unboxChar(this.listSeparator) || pattern.charCodeAt(currentPosition) === unboxChar(this.childrenListSeparator))) {
        currentPosition = currentPosition + 1 | 0;
        currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      }
      if (previousPosition === currentPosition) {
        currentPosition = currentPosition + 1 | 0;
      }
      previousPosition = currentPosition;
    }
    if (currentPosition < pattern.length && (pattern.charCodeAt(currentPosition) === unboxChar(this.childrenListSeparator) || pattern.charCodeAt(currentPosition) === unboxChar(this.closeChildBracket))) {
      return currentPosition + 1 | 0;
    }
    currentPosition = currentPosition + 1 | 0;
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    currentPosition = this.parseFunctionsCondition_na24n0$(pattern, currentPosition, result.treeFunctions);
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) === unboxChar(this.childrenListSeparator)) {
      return currentPosition + 1 | 0;
    }
    currentPosition = currentPosition + 1 | 0;
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    currentPosition = this.parseVariablesCondition_nl2s2o$(pattern, currentPosition, result.treeVariables);
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) === unboxChar(this.childrenListSeparator)) {
      return currentPosition + 1 | 0;
    }
    currentPosition = currentPosition + 1 | 0;
    previousPosition = currentPosition;
    while (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) !== unboxChar(this.tokenSeparator) && pattern.charCodeAt(currentPosition) !== unboxChar(this.closeChildBracket)) {
      var value = StringBuilder_init();
      currentPosition = this.parseValue_71bf4$(pattern, currentPosition, value, ExpressionStructureConditionConstructor$parseExpressionStructureConditionNode$lambda);
      result.functionsJoinedWithVariables.add_11rb$(value.toString());
      currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) === unboxChar(this.listSeparator)) {
        currentPosition = currentPosition + 1 | 0;
        currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      }
      if (previousPosition === currentPosition) {
        currentPosition = currentPosition + 1 | 0;
      }
      previousPosition = currentPosition;
    }
    return currentPosition;
  };
  function ExpressionStructureConditionConstructor$parseChildCondition$lambda(this$ExpressionStructureConditionConstructor) {
    return function (it) {
      return isWhitespace(unboxChar(it)) || unboxChar(it) === unboxChar(this$ExpressionStructureConditionConstructor.closeChildBracket) || unboxChar(it) === unboxChar(this$ExpressionStructureConditionConstructor.openChildBracket);
    };
  }
  ExpressionStructureConditionConstructor.prototype.parseChildCondition_fsjj8g$ = function (pattern, startPosition, result) {
    var currentPosition = startPosition;
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) === unboxChar(this.freeValueSign) || isNumberPart(pattern.charCodeAt(currentPosition))) {
      currentPosition = this.parseNumberCondition_1iy60a$(pattern, currentPosition, result.count);
    }
     else {
      result.count = new NumberCondition(ArrayList_init(), result);
      result.count.intervals.add_11rb$(new NumberInterval(void 0, void 0, void 0, result.count));
    }
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) !== unboxChar(this.openChildBracket)) {
      return currentPosition;
    }
    currentPosition = currentPosition + 1 | 0;
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    var previousPosition = currentPosition;
    while (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) !== unboxChar(this.childrenListSeparator) && pattern.charCodeAt(currentPosition) !== unboxChar(this.tokenSeparator)) {
      result.childNodes.add_11rb$(new ExpressionStructureConditionNode(void 0, void 0, void 0, void 0, void 0, result));
      currentPosition = this.parseExpressionStructureConditionNode_ihyupq$(pattern, currentPosition, last(result.childNodes));
      currentPosition = this.parseSpaces_jrmu5i$(pattern, currentPosition, ExpressionStructureConditionConstructor$parseChildCondition$lambda(this));
      if (previousPosition === currentPosition) {
        currentPosition = currentPosition + 1 | 0;
      }
      previousPosition = currentPosition;
    }
    return currentPosition;
  };
  ExpressionStructureConditionConstructor.prototype.parseFunctionsCondition_na24n0$ = function (pattern, startPosition, result) {
    var tmp$;
    var currentPosition = startPosition;
    var currentNotNumber = 0;
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    var previousPosition = currentPosition;
    while (currentPosition < pattern.length && (this.isFunctionNameOrNumberPart_0(pattern.charCodeAt(currentPosition)) || pattern.charCodeAt(currentPosition) === unboxChar(this.freeValueSign) || pattern.charCodeAt(currentPosition) === unboxChar(this.negativeSign))) {
      if (pattern.charCodeAt(currentPosition) === unboxChar(this.negativeSign)) {
        currentNotNumber = currentNotNumber + 1 | 0;
        currentPosition = currentPosition + 1 | 0;
        currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
        continue;
      }
      if (currentNotNumber % 2 === 0) {
        result.treePermittedFunctions.add_11rb$(new FunctionCondition(void 0, void 0, void 0, void 0, result));
        tmp$ = last(result.treePermittedFunctions);
      }
       else {
        result.treeForbiddenFunctions.add_11rb$(new FunctionCondition(void 0, void 0, void 0, void 0, result));
        tmp$ = last(result.treeForbiddenFunctions);
      }
      var functionCondition = tmp$;
      currentPosition = this.parseFunctionCondition_7uv15l$(pattern, currentPosition, functionCondition);
      currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) === unboxChar(this.listSeparator)) {
        currentPosition = currentPosition + 1 | 0;
      }
      currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      if (previousPosition === currentPosition) {
        currentPosition = currentPosition + 1 | 0;
      }
      previousPosition = currentPosition;
    }
    return currentPosition;
  };
  function ExpressionStructureConditionConstructor$parseFunctionCondition$lambda(this$ExpressionStructureConditionConstructor) {
    return function (it) {
      return this$ExpressionStructureConditionConstructor.isFunctionNameOrNumberPart_0(unboxChar(it));
    };
  }
  function ExpressionStructureConditionConstructor$parseFunctionCondition$lambda_0(this$ExpressionStructureConditionConstructor) {
    return function (it) {
      return isNamePart(unboxChar(it)) || unboxChar(it) === unboxChar(this$ExpressionStructureConditionConstructor.listSeparator);
    };
  }
  ExpressionStructureConditionConstructor.prototype.parseFunctionCondition_7uv15l$ = function (pattern, startPosition, result) {
    var currentPosition = startPosition;
    var value = StringBuilder_init();
    currentPosition = this.parseValue_71bf4$(pattern, currentPosition, value, ExpressionStructureConditionConstructor$parseFunctionCondition$lambda(this));
    result.name = value.toString();
    currentPosition = this.parseSpaces_jrmu5i$(pattern, currentPosition, ExpressionStructureConditionConstructor$parseFunctionCondition$lambda_0(this));
    if (currentPosition < pattern.length && isNumberPart(pattern.charCodeAt(currentPosition))) {
      currentPosition = this.parseNumberInterval_s6a5be$(pattern, currentPosition, result.numberOfArgumentsInterval);
    }
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) !== unboxChar(this.openChildBracket)) {
      return currentPosition;
    }
    currentPosition = currentPosition + 1 | 0;
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) !== unboxChar(this.closeChildBracket)) {
      currentPosition = this.parseFunctionsCondition_na24n0$(pattern, currentPosition, result.internalFunctionCondition);
      currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) === unboxChar(this.tokenSeparator)) {
        currentPosition = currentPosition + 1 | 0;
        currentPosition = this.parseVariablesCondition_nl2s2o$(pattern, currentPosition, result.internalVariableCondition);
        currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      }
      if (currentPosition >= pattern.length || pattern.charCodeAt(currentPosition) !== unboxChar(this.closeChildBracket)) {
        this.throwCloseChildBracketExpectException_0(currentPosition);
      }
    }
    return currentPosition + 1 | 0;
  };
  ExpressionStructureConditionConstructor.prototype.parseVariablesCondition_nl2s2o$ = function (pattern, startPosition, result) {
    var tmp$;
    var currentPosition = startPosition;
    var currentNotNumber = 0;
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    var previousPosition = currentPosition;
    while (currentPosition < pattern.length && (isNamePart(pattern.charCodeAt(currentPosition)) || pattern.charCodeAt(currentPosition) === unboxChar(this.freeValueSign) || pattern.charCodeAt(currentPosition) === unboxChar(this.negativeSign))) {
      if (pattern.charCodeAt(currentPosition) === unboxChar(this.negativeSign)) {
        currentNotNumber = currentNotNumber + 1 | 0;
        currentPosition = currentPosition + 1 | 0;
        currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
        continue;
      }
      var nextPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition + 1 | 0);
      if (pattern.charCodeAt(currentPosition) === unboxChar(this.freeValueSign) && (nextPosition >= pattern.length || listOf_0([this.listSeparator, this.childrenListSeparator, this.openChildBracket, this.closeChildBracket, this.tokenSeparator]).contains_11rb$(toBoxedChar(pattern.charCodeAt(nextPosition))))) {
        currentPosition = currentPosition + 1 | 0;
        currentPosition = nextPosition;
        continue;
      }
      if (currentNotNumber % 2 === 0) {
        result.treePermittedVariables.add_11rb$(new VariableCondition(void 0, void 0, result));
        tmp$ = last(result.treePermittedVariables);
      }
       else {
        result.treeForbiddenVariables.add_11rb$(new VariableCondition(void 0, void 0, result));
        tmp$ = last(result.treeForbiddenVariables);
      }
      var variableCondition = tmp$;
      currentPosition = this.parseVariableCondition_h0gfr1$(pattern, currentPosition, variableCondition);
      currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) === unboxChar(this.listSeparator)) {
        currentPosition = currentPosition + 1 | 0;
      }
      currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      if (previousPosition === currentPosition) {
        currentPosition = currentPosition + 1 | 0;
      }
      previousPosition = currentPosition;
    }
    return currentPosition;
  };
  function ExpressionStructureConditionConstructor$parseVariableCondition$lambda(it) {
    return isNamePart(unboxChar(it));
  }
  ExpressionStructureConditionConstructor.prototype.parseVariableCondition_h0gfr1$ = function (pattern, startPosition, result) {
    var currentPosition = startPosition;
    if (pattern.charCodeAt(currentPosition) === unboxChar(this.freeValueSign) || isNumberPart(pattern.charCodeAt(currentPosition))) {
      result.intervals.add_11rb$(new NumberInterval(void 0, void 0, void 0, result));
      currentPosition = this.parseNumberInterval_s6a5be$(pattern, currentPosition, last(result.intervals));
    }
     else {
      var value = StringBuilder_init();
      currentPosition = this.parseValue_71bf4$(pattern, currentPosition, value, ExpressionStructureConditionConstructor$parseVariableCondition$lambda);
      result.variableName = value.toString();
    }
    return currentPosition;
  };
  ExpressionStructureConditionConstructor.prototype.parseNumberCondition_1iy60a$ = function (pattern, startPosition, result) {
    var currentPosition = startPosition;
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    var previousPosition = currentPosition;
    while (currentPosition < pattern.length && (isNumberPart(pattern.charCodeAt(currentPosition)) || pattern.charCodeAt(currentPosition) === unboxChar(this.freeValueSign))) {
      result.intervals.add_11rb$(new NumberInterval(void 0, void 0, void 0, result));
      currentPosition = this.parseNumberInterval_s6a5be$(pattern, currentPosition, last(result.intervals));
      if (last(result.intervals).isEmpty()) {
        result.intervals.removeAt_za3lpa$(get_lastIndex(result.intervals));
      }
      currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) === unboxChar(this.listSeparator)) {
        currentPosition = currentPosition + 1 | 0;
      }
      currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      if (previousPosition === currentPosition) {
        currentPosition = currentPosition + 1 | 0;
      }
      previousPosition = currentPosition;
    }
    return currentPosition;
  };
  function ExpressionStructureConditionConstructor$parseNumberInterval$lambda(it) {
    return isNumberPart(unboxChar(it));
  }
  function ExpressionStructureConditionConstructor$parseNumberInterval$lambda_0(it) {
    return isNumberPart(unboxChar(it));
  }
  ExpressionStructureConditionConstructor.prototype.parseNumberInterval_s6a5be$ = function (pattern, startPosition, result) {
    var tmp$, tmp$_0;
    var currentPosition = startPosition;
    if (pattern.charCodeAt(currentPosition) === unboxChar(this.freeValueSign)) {
      result.leftBorder = kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY;
      result.rightBorder = kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY;
      currentPosition = currentPosition + 1 | 0;
    }
     else {
      if (isNumberPart(pattern.charCodeAt(currentPosition))) {
        var numberValue = StringBuilder_init();
        currentPosition = this.parseValue_71bf4$(pattern, currentPosition, numberValue, ExpressionStructureConditionConstructor$parseNumberInterval$lambda);
        tmp$ = toDoubleOrNull(numberValue.toString());
        if (tmp$ == null) {
          return this.throwNumberExpectException_0(currentPosition);
        }
        result.leftBorder = tmp$;
        result.rightBorder = result.leftBorder;
      }
       else
        this.throwNumberExpectException_0(currentPosition);
    }
    if (currentPosition < pattern.length && isLetter(pattern.charCodeAt(currentPosition))) {
      switch (pattern.charCodeAt(currentPosition)) {
        case 78:
          result.numbersType = NumberIntervalType$NATURAL_getInstance();
          break;
        case 90:
          result.numbersType = NumberIntervalType$INTEGER_getInstance();
          break;
        case 82:
          result.numbersType = NumberIntervalType$REAL_getInstance();
          break;
        default:return this.throwNumberExpectException_0(currentPosition);
      }
      currentPosition = currentPosition + 1 | 0;
    }
    currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
    if (currentPosition < pattern.length && pattern.charCodeAt(currentPosition) === 45) {
      currentPosition = currentPosition + 1 | 0;
      currentPosition = this.parseWhitespaces_bm4lxs$(pattern, currentPosition);
      if (currentPosition >= pattern.length)
        return this.throwNumberExpectException_0(currentPosition);
      if (pattern.charCodeAt(currentPosition) === unboxChar(this.freeValueSign)) {
        result.rightBorder = kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY;
        currentPosition = currentPosition + 1 | 0;
      }
       else {
        if (isNumberPart(pattern.charCodeAt(currentPosition))) {
          var numberValue_0 = StringBuilder_init();
          currentPosition = this.parseValue_71bf4$(pattern, currentPosition, numberValue_0, ExpressionStructureConditionConstructor$parseNumberInterval$lambda_0);
          tmp$_0 = toDoubleOrNull(numberValue_0.toString());
          if (tmp$_0 == null) {
            return this.throwNumberExpectException_0(currentPosition);
          }
          result.rightBorder = tmp$_0;
        }
         else
          this.throwNumberExpectException_0(currentPosition);
      }
      if (currentPosition < pattern.length && isLetter(pattern.charCodeAt(currentPosition))) {
        switch (pattern.charCodeAt(currentPosition)) {
          case 90:
            result.numbersType = NumberIntervalType$INTEGER_getInstance();
            break;
          case 82:
            result.numbersType = NumberIntervalType$REAL_getInstance();
            break;
          default:return this.throwNumberExpectException_0(currentPosition);
        }
        currentPosition = currentPosition + 1 | 0;
      }
    }
    return currentPosition;
  };
  ExpressionStructureConditionConstructor.prototype.parseWhitespaces_bm4lxs$ = function (pattern, startPosition) {
    var currentPosition = startPosition;
    while (currentPosition < pattern.length && isWhitespace(pattern.charCodeAt(currentPosition))) {
      currentPosition = currentPosition + 1 | 0;
    }
    return currentPosition;
  };
  ExpressionStructureConditionConstructor.prototype.parseSpaces_jrmu5i$ = function (pattern, startPosition, condition) {
    var currentPosition = startPosition;
    while (currentPosition < pattern.length && condition(toBoxedChar(pattern.charCodeAt(currentPosition)))) {
      currentPosition = currentPosition + 1 | 0;
    }
    return currentPosition;
  };
  ExpressionStructureConditionConstructor.prototype.parseValue_71bf4$ = function (pattern, startPosition, value, condition) {
    var currentPosition = startPosition;
    while (currentPosition < pattern.length && condition(toBoxedChar(pattern.charCodeAt(currentPosition)))) {
      value.append_s8itvh$(pattern.charCodeAt(currentPosition));
      currentPosition = currentPosition + 1 | 0;
    }
    return currentPosition;
  };
  ExpressionStructureConditionConstructor.prototype.isFunctionNameOrNumberPart_0 = function ($receiver) {
    return isLetterOrDigitOrUnderscore($receiver) || contains_1(this.nameSymbols, $receiver);
  };
  ExpressionStructureConditionConstructor.prototype.throwExpectException_0 = function (expectType, position) {
    throw IllegalArgumentException_init(expectType + " expected on position '" + position + "'");
  };
  ExpressionStructureConditionConstructor.prototype.throwOpenChildBracketExpectException_0 = function (position) {
    return this.throwExpectException_0("'('", position);
  };
  ExpressionStructureConditionConstructor.prototype.throwCloseChildBracketExpectException_0 = function (position) {
    return this.throwExpectException_0("')'", position);
  };
  ExpressionStructureConditionConstructor.prototype.throwNumberExpectException_0 = function (position) {
    return this.throwExpectException_0('Number', position);
  };
  ExpressionStructureConditionConstructor.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionStructureConditionConstructor',
    interfaces: []
  };
  var additionalFactUsedVarName;
  function SubstitutionInstanceVarType(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function SubstitutionInstanceVarType_initFields() {
    SubstitutionInstanceVarType_initFields = function () {
    };
    SubstitutionInstanceVarType$EXPR_VAR_instance = new SubstitutionInstanceVarType('EXPR_VAR', 0);
    SubstitutionInstanceVarType$EXPR_FUNC_instance = new SubstitutionInstanceVarType('EXPR_FUNC', 1);
    SubstitutionInstanceVarType$COMPARABLE_VAR_instance = new SubstitutionInstanceVarType('COMPARABLE_VAR', 2);
    SubstitutionInstanceVarType$INFO_instance = new SubstitutionInstanceVarType('INFO', 3);
  }
  var SubstitutionInstanceVarType$EXPR_VAR_instance;
  function SubstitutionInstanceVarType$EXPR_VAR_getInstance() {
    SubstitutionInstanceVarType_initFields();
    return SubstitutionInstanceVarType$EXPR_VAR_instance;
  }
  var SubstitutionInstanceVarType$EXPR_FUNC_instance;
  function SubstitutionInstanceVarType$EXPR_FUNC_getInstance() {
    SubstitutionInstanceVarType_initFields();
    return SubstitutionInstanceVarType$EXPR_FUNC_instance;
  }
  var SubstitutionInstanceVarType$COMPARABLE_VAR_instance;
  function SubstitutionInstanceVarType$COMPARABLE_VAR_getInstance() {
    SubstitutionInstanceVarType_initFields();
    return SubstitutionInstanceVarType$COMPARABLE_VAR_instance;
  }
  var SubstitutionInstanceVarType$INFO_instance;
  function SubstitutionInstanceVarType$INFO_getInstance() {
    SubstitutionInstanceVarType_initFields();
    return SubstitutionInstanceVarType$INFO_instance;
  }
  SubstitutionInstanceVarType.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'SubstitutionInstanceVarType',
    interfaces: [Enum]
  };
  function SubstitutionInstanceVarType$values() {
    return [SubstitutionInstanceVarType$EXPR_VAR_getInstance(), SubstitutionInstanceVarType$EXPR_FUNC_getInstance(), SubstitutionInstanceVarType$COMPARABLE_VAR_getInstance(), SubstitutionInstanceVarType$INFO_getInstance()];
  }
  SubstitutionInstanceVarType.values = SubstitutionInstanceVarType$values;
  function SubstitutionInstanceVarType$valueOf(name) {
    switch (name) {
      case 'EXPR_VAR':
        return SubstitutionInstanceVarType$EXPR_VAR_getInstance();
      case 'EXPR_FUNC':
        return SubstitutionInstanceVarType$EXPR_FUNC_getInstance();
      case 'COMPARABLE_VAR':
        return SubstitutionInstanceVarType$COMPARABLE_VAR_getInstance();
      case 'INFO':
        return SubstitutionInstanceVarType$INFO_getInstance();
      default:throwISE('No enum constant expressiontree.SubstitutionInstanceVarType.' + name);
    }
  }
  SubstitutionInstanceVarType.valueOf_61zpoe$ = SubstitutionInstanceVarType$valueOf;
  function SubstitutionInstanceVar(name, type, time) {
    this.name = name;
    this.type = type;
    this.time = time;
  }
  SubstitutionInstanceVar.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'SubstitutionInstanceVar',
    interfaces: []
  };
  SubstitutionInstanceVar.prototype.component1 = function () {
    return this.name;
  };
  SubstitutionInstanceVar.prototype.component2 = function () {
    return this.type;
  };
  SubstitutionInstanceVar.prototype.component3 = function () {
    return this.time;
  };
  SubstitutionInstanceVar.prototype.copy_3wzyvr$ = function (name, type, time) {
    return new SubstitutionInstanceVar(name === void 0 ? this.name : name, type === void 0 ? this.type : type, time === void 0 ? this.time : time);
  };
  SubstitutionInstanceVar.prototype.toString = function () {
    return 'SubstitutionInstanceVar(name=' + Kotlin.toString(this.name) + (', type=' + Kotlin.toString(this.type)) + (', time=' + Kotlin.toString(this.time)) + ')';
  };
  SubstitutionInstanceVar.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.name) | 0;
    result = result * 31 + Kotlin.hashCode(this.type) | 0;
    result = result * 31 + Kotlin.hashCode(this.time) | 0;
    return result;
  };
  SubstitutionInstanceVar.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.name, other.name) && Kotlin.equals(this.type, other.type) && Kotlin.equals(this.time, other.time)))));
  };
  function VarNamesTimeStorage(time) {
    if (time === void 0)
      time = 0;
    this.time = time;
    this.varsList = ArrayList_init();
  }
  VarNamesTimeStorage.prototype.addVarName_5gyjt1$ = function (name, type) {
    return this.addVarName_qc39kt$(new SubstitutionInstanceVar(name, type, this.time));
  };
  VarNamesTimeStorage.prototype.addVarName_qc39kt$ = function (substitutionInstanceVar) {
    var tmp$;
    this.varsList.add_11rb$(substitutionInstanceVar);
    return tmp$ = this.time, this.time = tmp$ + 1 | 0, tmp$;
  };
  VarNamesTimeStorage.prototype.popVarsAfter_za3lpa$ = function (time) {
    var $receiver = this.varsList;
    var tmp$;
    var first = ArrayList_init();
    var second = ArrayList_init();
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      if (element.time >= time) {
        first.add_11rb$(element);
      }
       else {
        second.add_11rb$(element);
      }
    }
    var parts = new Pair(first, second);
    this.varsList = toMutableList(parts.second);
    return parts.first;
  };
  VarNamesTimeStorage.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'VarNamesTimeStorage',
    interfaces: []
  };
  function MatchedNode(matchedFactIndex, nodeType, children) {
    if (matchedFactIndex === void 0)
      matchedFactIndex = 2147483647;
    if (nodeType === void 0)
      nodeType = ComparableTransformationPartType$EMPTY_getInstance();
    if (children === void 0) {
      children = ArrayList_init();
    }
    this.matchedFactIndex = matchedFactIndex;
    this.nodeType = nodeType;
    this.children = children;
  }
  MatchedNode.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'MatchedNode',
    interfaces: []
  };
  MatchedNode.prototype.component1 = function () {
    return this.matchedFactIndex;
  };
  MatchedNode.prototype.component2 = function () {
    return this.nodeType;
  };
  MatchedNode.prototype.component3 = function () {
    return this.children;
  };
  MatchedNode.prototype.copy_112axf$ = function (matchedFactIndex, nodeType, children) {
    return new MatchedNode(matchedFactIndex === void 0 ? this.matchedFactIndex : matchedFactIndex, nodeType === void 0 ? this.nodeType : nodeType, children === void 0 ? this.children : children);
  };
  MatchedNode.prototype.toString = function () {
    return 'MatchedNode(matchedFactIndex=' + Kotlin.toString(this.matchedFactIndex) + (', nodeType=' + Kotlin.toString(this.nodeType)) + (', children=' + Kotlin.toString(this.children)) + ')';
  };
  MatchedNode.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.matchedFactIndex) | 0;
    result = result * 31 + Kotlin.hashCode(this.nodeType) | 0;
    result = result * 31 + Kotlin.hashCode(this.children) | 0;
    return result;
  };
  MatchedNode.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.matchedFactIndex, other.matchedFactIndex) && Kotlin.equals(this.nodeType, other.nodeType) && Kotlin.equals(this.children, other.children)))));
  };
  function SubstitutionInstance(isApplicable, varRuleNameToExpressionValueMap, varRuleFunctionNameArgsToExpressionMap, varRuleNameToComparableTransformationsPartMap, varNamesTimeStorage, correspondingIndexes) {
    if (isApplicable === void 0)
      isApplicable = true;
    if (varRuleNameToExpressionValueMap === void 0) {
      varRuleNameToExpressionValueMap = LinkedHashMap_init_0();
    }
    if (varRuleFunctionNameArgsToExpressionMap === void 0) {
      varRuleFunctionNameArgsToExpressionMap = LinkedHashMap_init_0();
    }
    if (varRuleNameToComparableTransformationsPartMap === void 0) {
      varRuleNameToComparableTransformationsPartMap = LinkedHashMap_init_0();
    }
    if (varNamesTimeStorage === void 0)
      varNamesTimeStorage = new VarNamesTimeStorage();
    if (correspondingIndexes === void 0)
      correspondingIndexes = new MatchedNode();
    this.isApplicable = isApplicable;
    this.varRuleNameToExpressionValueMap_0 = varRuleNameToExpressionValueMap;
    this.varRuleFunctionNameArgsToExpressionMap_0 = varRuleFunctionNameArgsToExpressionMap;
    this.varRuleNameToComparableTransformationsPartMap_0 = varRuleNameToComparableTransformationsPartMap;
    this.varNamesTimeStorage = varNamesTimeStorage;
    this.correspondingIndexes = correspondingIndexes;
  }
  function SubstitutionInstance$logValue$lambda(closure$message) {
    return function () {
      return closure$message() + ", isApplicable: '";
    };
  }
  function SubstitutionInstance$logValue$lambda_0() {
    return "', matchedFactIndex: '";
  }
  function SubstitutionInstance$logValue$lambda_1() {
    return "'";
  }
  function SubstitutionInstance$logValue$lambda_2(it) {
    return it.key + " = '" + it.value.toString() + "'";
  }
  function SubstitutionInstance$logValue$lambda_3() {
    return "NameToExpressionValue: '''";
  }
  function SubstitutionInstance$logValue$lambda_4() {
    return "'''";
  }
  function SubstitutionInstance$logValue$lambda_5(it) {
    return it.key + " = '" + it.value.toString() + "'";
  }
  function SubstitutionInstance$logValue$lambda_6() {
    return "FunctionNameArgsToExpression: '''";
  }
  function SubstitutionInstance$logValue$lambda_7() {
    return "'''";
  }
  function SubstitutionInstance$logValue$lambda_8(it) {
    return it.key + " = '" + it.value.toString() + "'";
  }
  function SubstitutionInstance$logValue$lambda_9() {
    return "NameToFact: '''";
  }
  function SubstitutionInstance$logValue$lambda_10() {
    return "'''";
  }
  SubstitutionInstance.prototype.logValue_d8wcre$ = function (message, messageType, level) {
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    log_1.add_gqvic5$(this.isApplicable, this.correspondingIndexes.matchedFactIndex, SubstitutionInstance$logValue$lambda(message), SubstitutionInstance$logValue$lambda_0, SubstitutionInstance$logValue$lambda_1);
    log_1.add_f1hiuo$(joinToString(this.varRuleNameToExpressionValueMap_0.entries, ', ', void 0, void 0, void 0, void 0, SubstitutionInstance$logValue$lambda_2), SubstitutionInstance$logValue$lambda_3, SubstitutionInstance$logValue$lambda_4, level + 1 | 0, void 0, messageType);
    log_1.add_f1hiuo$(joinToString(this.varRuleFunctionNameArgsToExpressionMap_0.entries, ', ', void 0, void 0, void 0, void 0, SubstitutionInstance$logValue$lambda_5), SubstitutionInstance$logValue$lambda_6, SubstitutionInstance$logValue$lambda_7, level + 1 | 0, void 0, messageType);
    log_1.add_f1hiuo$(joinToString(this.varRuleNameToComparableTransformationsPartMap_0.entries, ', ', void 0, void 0, void 0, void 0, SubstitutionInstance$logValue$lambda_8), SubstitutionInstance$logValue$lambda_9, SubstitutionInstance$logValue$lambda_10, level + 1 | 0, void 0, messageType);
  };
  SubstitutionInstance.prototype.dropExtraVarsAfter_za3lpa$ = function (time) {
    var tmp$;
    var extraVars = this.varNamesTimeStorage.popVarsAfter_za3lpa$(time);
    tmp$ = extraVars.iterator();
    while (tmp$.hasNext()) {
      var extraVar = tmp$.next();
      switch (extraVar.type.name) {
        case 'EXPR_VAR':
          this.varRuleNameToExpressionValueMap_0.remove_11rb$(extraVar.name);
          break;
        case 'EXPR_FUNC':
          this.varRuleFunctionNameArgsToExpressionMap_0.remove_11rb$(extraVar.name);
          break;
        case 'COMPARABLE_VAR':
          this.varRuleNameToComparableTransformationsPartMap_0.remove_11rb$(extraVar.name);
          break;
      }
    }
  };
  SubstitutionInstance.prototype.putExprVar_vkfows$ = function (a, b) {
    this.putComparableVar_10y352$(a, new Expression(0, 0, b));
  };
  SubstitutionInstance.prototype.putExprFunc_vkfows$ = function (a, b) {
    this.varRuleFunctionNameArgsToExpressionMap_0.put_xwzc9p$(a, b);
    this.varNamesTimeStorage.addVarName_5gyjt1$(a, SubstitutionInstanceVarType$EXPR_FUNC_getInstance());
  };
  SubstitutionInstance.prototype.putComparableVar_10y352$ = function (a, b) {
    var tmp$;
    this.varRuleNameToComparableTransformationsPartMap_0.put_xwzc9p$(a, b);
    this.varNamesTimeStorage.addVarName_5gyjt1$(a, SubstitutionInstanceVarType$COMPARABLE_VAR_getInstance());
    if (b.type() === ComparableTransformationPartType$EXPRESSION_getInstance()) {
      this.varRuleNameToExpressionValueMap_0.put_xwzc9p$(a, (Kotlin.isType(tmp$ = b, Expression) ? tmp$ : throwCCE()).data);
      this.varNamesTimeStorage.addVarName_5gyjt1$(a, SubstitutionInstanceVarType$EXPR_VAR_getInstance());
    }
  };
  SubstitutionInstance.prototype.getExprVar_61zpoe$ = function (a) {
    return this.varRuleNameToExpressionValueMap_0.get_11rb$(a);
  };
  SubstitutionInstance.prototype.removeExprVar_61zpoe$ = function (a) {
    return this.varRuleNameToExpressionValueMap_0.remove_11rb$(a);
  };
  SubstitutionInstance.prototype.getExprFunc_61zpoe$ = function (a) {
    return this.varRuleFunctionNameArgsToExpressionMap_0.get_11rb$(a);
  };
  SubstitutionInstance.prototype.getComparableVar_61zpoe$ = function (a) {
    return this.varRuleNameToComparableTransformationsPartMap_0.get_11rb$(a);
  };
  SubstitutionInstance.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'SubstitutionInstance',
    interfaces: []
  };
  SubstitutionInstance.prototype.component1 = function () {
    return this.isApplicable;
  };
  SubstitutionInstance.prototype.component2_0 = function () {
    return this.varRuleNameToExpressionValueMap_0;
  };
  SubstitutionInstance.prototype.component3_0 = function () {
    return this.varRuleFunctionNameArgsToExpressionMap_0;
  };
  SubstitutionInstance.prototype.component4_0 = function () {
    return this.varRuleNameToComparableTransformationsPartMap_0;
  };
  SubstitutionInstance.prototype.component5 = function () {
    return this.varNamesTimeStorage;
  };
  SubstitutionInstance.prototype.component6 = function () {
    return this.correspondingIndexes;
  };
  SubstitutionInstance.prototype.copy_djbqhs$ = function (isApplicable, varRuleNameToExpressionValueMap, varRuleFunctionNameArgsToExpressionMap, varRuleNameToComparableTransformationsPartMap, varNamesTimeStorage, correspondingIndexes) {
    return new SubstitutionInstance(isApplicable === void 0 ? this.isApplicable : isApplicable, varRuleNameToExpressionValueMap === void 0 ? this.varRuleNameToExpressionValueMap_0 : varRuleNameToExpressionValueMap, varRuleFunctionNameArgsToExpressionMap === void 0 ? this.varRuleFunctionNameArgsToExpressionMap_0 : varRuleFunctionNameArgsToExpressionMap, varRuleNameToComparableTransformationsPartMap === void 0 ? this.varRuleNameToComparableTransformationsPartMap_0 : varRuleNameToComparableTransformationsPartMap, varNamesTimeStorage === void 0 ? this.varNamesTimeStorage : varNamesTimeStorage, correspondingIndexes === void 0 ? this.correspondingIndexes : correspondingIndexes);
  };
  SubstitutionInstance.prototype.toString = function () {
    return 'SubstitutionInstance(isApplicable=' + Kotlin.toString(this.isApplicable) + (', varRuleNameToExpressionValueMap=' + Kotlin.toString(this.varRuleNameToExpressionValueMap_0)) + (', varRuleFunctionNameArgsToExpressionMap=' + Kotlin.toString(this.varRuleFunctionNameArgsToExpressionMap_0)) + (', varRuleNameToComparableTransformationsPartMap=' + Kotlin.toString(this.varRuleNameToComparableTransformationsPartMap_0)) + (', varNamesTimeStorage=' + Kotlin.toString(this.varNamesTimeStorage)) + (', correspondingIndexes=' + Kotlin.toString(this.correspondingIndexes)) + ')';
  };
  SubstitutionInstance.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.isApplicable) | 0;
    result = result * 31 + Kotlin.hashCode(this.varRuleNameToExpressionValueMap_0) | 0;
    result = result * 31 + Kotlin.hashCode(this.varRuleFunctionNameArgsToExpressionMap_0) | 0;
    result = result * 31 + Kotlin.hashCode(this.varRuleNameToComparableTransformationsPartMap_0) | 0;
    result = result * 31 + Kotlin.hashCode(this.varNamesTimeStorage) | 0;
    result = result * 31 + Kotlin.hashCode(this.correspondingIndexes) | 0;
    return result;
  };
  SubstitutionInstance.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.isApplicable, other.isApplicable) && Kotlin.equals(this.varRuleNameToExpressionValueMap_0, other.varRuleNameToExpressionValueMap_0) && Kotlin.equals(this.varRuleFunctionNameArgsToExpressionMap_0, other.varRuleFunctionNameArgsToExpressionMap_0) && Kotlin.equals(this.varRuleNameToComparableTransformationsPartMap_0, other.varRuleNameToComparableTransformationsPartMap_0) && Kotlin.equals(this.varNamesTimeStorage, other.varNamesTimeStorage) && Kotlin.equals(this.correspondingIndexes, other.correspondingIndexes)))));
  };
  function SubstitutionPlace(nodeParent, nodeChildIndex, substitutionInstance, originalValue, originalExpression) {
    this.nodeParent = nodeParent;
    this.nodeChildIndex = nodeChildIndex;
    this.substitutionInstance = substitutionInstance;
    this.originalValue = originalValue;
    this.originalExpression = originalExpression;
  }
  SubstitutionPlace.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'SubstitutionPlace',
    interfaces: []
  };
  SubstitutionPlace.prototype.component1 = function () {
    return this.nodeParent;
  };
  SubstitutionPlace.prototype.component2 = function () {
    return this.nodeChildIndex;
  };
  SubstitutionPlace.prototype.component3 = function () {
    return this.substitutionInstance;
  };
  SubstitutionPlace.prototype.component4 = function () {
    return this.originalValue;
  };
  SubstitutionPlace.prototype.component5 = function () {
    return this.originalExpression;
  };
  SubstitutionPlace.prototype.copy_dffy7a$ = function (nodeParent, nodeChildIndex, substitutionInstance, originalValue, originalExpression) {
    return new SubstitutionPlace(nodeParent === void 0 ? this.nodeParent : nodeParent, nodeChildIndex === void 0 ? this.nodeChildIndex : nodeChildIndex, substitutionInstance === void 0 ? this.substitutionInstance : substitutionInstance, originalValue === void 0 ? this.originalValue : originalValue, originalExpression === void 0 ? this.originalExpression : originalExpression);
  };
  SubstitutionPlace.prototype.toString = function () {
    return 'SubstitutionPlace(nodeParent=' + Kotlin.toString(this.nodeParent) + (', nodeChildIndex=' + Kotlin.toString(this.nodeChildIndex)) + (', substitutionInstance=' + Kotlin.toString(this.substitutionInstance)) + (', originalValue=' + Kotlin.toString(this.originalValue)) + (', originalExpression=' + Kotlin.toString(this.originalExpression)) + ')';
  };
  SubstitutionPlace.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.nodeParent) | 0;
    result = result * 31 + Kotlin.hashCode(this.nodeChildIndex) | 0;
    result = result * 31 + Kotlin.hashCode(this.substitutionInstance) | 0;
    result = result * 31 + Kotlin.hashCode(this.originalValue) | 0;
    result = result * 31 + Kotlin.hashCode(this.originalExpression) | 0;
    return result;
  };
  SubstitutionPlace.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.nodeParent, other.nodeParent) && Kotlin.equals(this.nodeChildIndex, other.nodeChildIndex) && Kotlin.equals(this.substitutionInstance, other.substitutionInstance) && Kotlin.equals(this.originalValue, other.originalValue) && Kotlin.equals(this.originalExpression, other.originalExpression)))));
  };
  function ExpressionSubstitution(left, right, weight, basedOnTaskContext, code, nameEn, nameRu, comparisonType, leftFunctions, matchJumbledAndNested, priority, changeOnlyOrder, simpleAdditional, isExtending) {
    ExpressionSubstitution$Companion_getInstance();
    if (weight === void 0)
      weight = 1.0;
    if (basedOnTaskContext === void 0)
      basedOnTaskContext = false;
    if (code === void 0)
      code = '';
    if (nameEn === void 0)
      nameEn = '';
    if (nameRu === void 0)
      nameRu = '';
    if (comparisonType === void 0)
      comparisonType = ComparisonType$EQUAL_getInstance();
    if (leftFunctions === void 0)
      leftFunctions = left.getContainedFunctions();
    if (matchJumbledAndNested === void 0)
      matchJumbledAndNested = false;
    if (priority === void 0)
      priority = null;
    if (changeOnlyOrder === void 0)
      changeOnlyOrder = false;
    if (simpleAdditional === void 0)
      simpleAdditional = false;
    if (isExtending === void 0)
      isExtending = false;
    this.left = left;
    this.right = right;
    this.weight = weight;
    this.basedOnTaskContext = basedOnTaskContext;
    this.code = code;
    this.nameEn = nameEn;
    this.nameRu = nameRu;
    this.comparisonType = comparisonType;
    this.leftFunctions = leftFunctions;
    this.matchJumbledAndNested = matchJumbledAndNested;
    this.priority = priority;
    this.changeOnlyOrder = changeOnlyOrder;
    this.simpleAdditional = simpleAdditional;
    this.isExtending = isExtending;
    if (!this.changeOnlyOrder) {
      var $receiver = this.left.clone();
      $receiver.normalizeSubTree_f8z7ch$(void 0, void 0, true);
      var leftSorted = $receiver;
      var $receiver_0 = this.right.clone();
      $receiver_0.normalizeSubTree_f8z7ch$(void 0, void 0, true);
      var rightSorted = $receiver_0;
      this.changeOnlyOrder = equals(leftSorted.toString(), rightSorted.toString());
    }
    this.identifier = '';
  }
  ExpressionSubstitution.prototype.computeIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.identifier) || recomputeIfComputed) {
      this.identifier = '[' + this.left.computeIdentifier_t6ztn0$() + '->' + this.right.computeIdentifier_t6ztn0$() + ']';
    }
    return this.identifier;
  };
  ExpressionSubstitution.prototype.checkCondition_vs93k4$ = function (expressionNode, conditionNode, substitutionInstance, nameArgsMap) {
    if (nameArgsMap === void 0) {
      nameArgsMap = LinkedHashMap_init_0();
    }
    ExpressionSubstitution$Companion_getInstance().checkConditionCompanion_5w3lm6$(expressionNode, conditionNode, substitutionInstance, nameArgsMap, this.basedOnTaskContext, this.matchJumbledAndNested);
  };
  function ExpressionSubstitution$Companion() {
    ExpressionSubstitution$Companion_instance = this;
  }
  ExpressionSubstitution$Companion.prototype.checkConditionCompanion_5w3lm6$ = function (expressionNode, conditionNode, substitutionInstance, nameArgsMap, basedOnTaskContext, matchJumbledAndNested, onlyCheckListFlag) {
    if (nameArgsMap === void 0) {
      nameArgsMap = LinkedHashMap_init_0();
    }
    if (matchJumbledAndNested === void 0)
      matchJumbledAndNested = false;
    if (onlyCheckListFlag === void 0)
      onlyCheckListFlag = null;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11, tmp$_12, tmp$_13, tmp$_14, tmp$_15, tmp$_16, tmp$_17, tmp$_18;
    if (conditionNode.isNumberValue()) {
      if (expressionNode.nodeType === NodeType$VARIABLE_getInstance()) {
        tmp$_1 = expressionNode.value;
      }
       else if (calcComplexity(expressionNode) < 4 && !expressionNode.containsVariables()) {
        tmp$_1 = (tmp$_0 = (tmp$ = computeNodeIfSimple(expressionNode)) != null ? tmp$.toString() : null) != null ? tmp$_0 : '';
      }
       else
        tmp$_1 = '';
      var expressionValue = tmp$_1;
      if (expressionValue.length === 0 || !isNumberValuesEqual(expressionValue, conditionNode.value)) {
        if (onlyCheckListFlag == null) {
          substitutionInstance.isApplicable = false;
        }
         else {
          onlyCheckListFlag.add_11rb$(false);
        }
        return;
      }
    }
     else if (conditionNode.children.size > 0) {
      if (this.isNameForRulesDesignation_0(basedOnTaskContext, conditionNode)) {
        if (onlyCheckListFlag != null)
          return;
        var actualNameArgsMap = LinkedHashMap_init_0();
        var conditionChildrenMap = LinkedHashMap_init_0();
        tmp$_2 = get_lastIndex(conditionNode.children);
        for (var j = 0; j <= tmp$_2; j++)
          conditionChildrenMap.put_xwzc9p$(conditionNode.children.get_za3lpa$(j).value, 'sys_def_func_agr_' + j);
        tmp$_3 = nameArgsMap.entries.iterator();
        while (tmp$_3.hasNext()) {
          var tmp$_19 = tmp$_3.next();
          var key = tmp$_19.key;
          var value = tmp$_19.value;
          var orderValue = conditionChildrenMap.get_11rb$(value);
          if (orderValue != null)
            actualNameArgsMap.put_xwzc9p$(key, orderValue);
        }
        var functionValue = substitutionInstance.getExprFunc_61zpoe$(conditionNode.value + '_' + toString(conditionNode.children.size));
        if (functionValue == null) {
          substitutionInstance.putExprFunc_vkfows$(conditionNode.value + '_' + toString(conditionNode.children.size), expressionNode.cloneWithNormalization_1g1bdl$(actualNameArgsMap, false));
        }
         else {
          if (!expressionNode.isNodeSubtreeEquals_7j5kvs$(functionValue, actualNameArgsMap)) {
            substitutionInstance.isApplicable = false;
            return;
          }
        }
      }
       else {
        if (conditionNode.children.size < expressionNode.children.size || (conditionNode.children.size !== expressionNode.children.size && (((tmp$_5 = (tmp$_4 = conditionNode.functionStringDefinition) != null ? tmp$_4.function : null) != null ? tmp$_5.fieldAddZero : null) == null || ((tmp$_7 = (tmp$_6 = conditionNode.functionStringDefinition) != null ? tmp$_6.function : null) != null ? tmp$_7.isCommutativeWithNullWeight : null) !== true || !matchJumbledAndNested)) || !conditionNode.isNodeValueEquals_6718cy$(expressionNode)) {
          if (onlyCheckListFlag == null) {
            substitutionInstance.isApplicable = false;
          }
           else {
            onlyCheckListFlag.add_11rb$(false);
          }
          return;
        }
        var argumentStartIndex = (tmp$_10 = (tmp$_9 = (tmp$_8 = conditionNode.functionStringDefinition) != null ? tmp$_8.function : null) != null ? tmp$_9.numberOfDefinitionArguments : null) != null ? tmp$_10 : 0;
        if (argumentStartIndex !== 0 && onlyCheckListFlag != null)
          return;
        for (var i = 0; i < argumentStartIndex; i++) {
          nameArgsMap.put_xwzc9p$(expressionNode.children.get_za3lpa$(i).value, conditionNode.children.get_za3lpa$(i).value);
        }
        if (matchJumbledAndNested && ((tmp$_13 = (tmp$_12 = (tmp$_11 = conditionNode.functionStringDefinition) != null ? tmp$_11.function : null) != null ? tmp$_12.isCommutativeWithNullWeight : null) != null ? tmp$_13 : false)) {
          var usedNodes = LinkedHashSet_init();
          var expressionStartNodeIndex = argumentStartIndex;
          tmp$_14 = get_lastIndex(conditionNode.children);
          for (var i_0 = argumentStartIndex; i_0 <= tmp$_14; i_0++) {
            var isMatched = false;
            tmp$_15 = get_lastIndex(expressionNode.children);
            for (var j_0 = expressionStartNodeIndex; j_0 <= tmp$_15; j_0++) {
              if (usedNodes.contains_11rb$(j_0))
                continue;
              var checkListFlag = ArrayList_init();
              this.checkConditionCompanion_5w3lm6$(expressionNode.children.get_za3lpa$(j_0), conditionNode.children.get_za3lpa$(i_0), substitutionInstance, nameArgsMap, basedOnTaskContext, matchJumbledAndNested, checkListFlag);
              if (!checkListFlag.isEmpty()) {
                continue;
              }
              this.checkConditionCompanion_5w3lm6$(expressionNode.children.get_za3lpa$(j_0), conditionNode.children.get_za3lpa$(i_0), substitutionInstance, nameArgsMap, basedOnTaskContext, matchJumbledAndNested);
              if (!substitutionInstance.isApplicable)
                return;
              if (j_0 === expressionStartNodeIndex) {
                expressionStartNodeIndex = expressionStartNodeIndex + 1 | 0;
              }
               else {
                usedNodes.add_11rb$(j_0);
              }
              isMatched = true;
              break;
            }
            if (!basedOnTaskContext && !isMatched && ((tmp$_17 = (tmp$_16 = conditionNode.functionStringDefinition) != null ? tmp$_16.function : null) != null ? tmp$_17.fieldAddZero : null) != null && conditionNode.children.get_za3lpa$(i_0).nodeType === NodeType$VARIABLE_getInstance() && !conditionNode.children.get_za3lpa$(i_0).isNumberValue()) {
              var varValue = substitutionInstance.getExprVar_61zpoe$(conditionNode.children.get_za3lpa$(i_0).value);
              if (varValue == null) {
                isMatched = true;
                if (onlyCheckListFlag == null) {
                  substitutionInstance.putExprVar_vkfows$(conditionNode.children.get_za3lpa$(i_0).value, new ExpressionNode(NodeType$VARIABLE_getInstance(), ensureNotNull(ensureNotNull(conditionNode.functionStringDefinition).function.fieldAddZero)));
                }
              }
               else {
                if (varValue.isNodeSubtreeEquals_7j5kvs$(new ExpressionNode(NodeType$VARIABLE_getInstance(), ensureNotNull(ensureNotNull(conditionNode.functionStringDefinition).function.fieldAddZero)))) {
                  isMatched = true;
                }
              }
            }
            if (!isMatched) {
              if (onlyCheckListFlag == null) {
                substitutionInstance.isApplicable = false;
              }
               else {
                onlyCheckListFlag.add_11rb$(false);
              }
              return;
            }
          }
        }
         else {
          tmp$_18 = get_lastIndex(expressionNode.children);
          for (var i_1 = argumentStartIndex; i_1 <= tmp$_18; i_1++) {
            if (onlyCheckListFlag != null) {
              this.checkConditionCompanion_5w3lm6$(expressionNode.children.get_za3lpa$(i_1), conditionNode.children.get_za3lpa$(i_1), substitutionInstance, nameArgsMap, basedOnTaskContext, matchJumbledAndNested, onlyCheckListFlag);
              if (!onlyCheckListFlag.isEmpty()) {
                return;
              }
            }
            this.checkConditionCompanion_5w3lm6$(expressionNode.children.get_za3lpa$(i_1), conditionNode.children.get_za3lpa$(i_1), substitutionInstance, nameArgsMap, basedOnTaskContext, matchJumbledAndNested);
            if (!substitutionInstance.isApplicable)
              return;
          }
        }
        for (var i_2 = 0; i_2 < argumentStartIndex; i_2++) {
          nameArgsMap.remove_11rb$(expressionNode.children.get_za3lpa$(i_2).value);
        }
      }
    }
     else {
      if (basedOnTaskContext) {
        if (!conditionNode.isNodeSubtreeEquals_7j5kvs$(expressionNode)) {
          if (onlyCheckListFlag == null) {
            substitutionInstance.isApplicable = false;
          }
           else {
            onlyCheckListFlag.add_11rb$(false);
          }
        }
        return;
      }
       else {
        var varValue_0 = substitutionInstance.getExprVar_61zpoe$(conditionNode.value);
        if (varValue_0 == null) {
          if (onlyCheckListFlag != null)
            return;
          substitutionInstance.putExprVar_vkfows$(conditionNode.value, expressionNode);
        }
         else {
          if (!varValue_0.isNodeSubtreeEquals_7j5kvs$(expressionNode)) {
            if (onlyCheckListFlag == null) {
              substitutionInstance.isApplicable = false;
            }
             else {
              onlyCheckListFlag.add_11rb$(false);
            }
            return;
          }
        }
      }
    }
  };
  ExpressionSubstitution$Companion.prototype.isNameForRulesDesignation_0 = function (basedOnTaskContext, conditionNode) {
    return !basedOnTaskContext && conditionNode.functionStringDefinition != null && ensureNotNull(conditionNode.functionStringDefinition).function.isNameForRuleDesignations;
  };
  ExpressionSubstitution$Companion.prototype.applyRightCompanion_miu9dc$ = function (substitutionInstance, right) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11, tmp$_12, tmp$_13;
    if (right.value.length === 0 && right.children.size === 1) {
      return this.applyRightCompanion_miu9dc$(substitutionInstance, right.children.get_za3lpa$(0));
    }
     else if (right.isNumberValue()) {
      return right.copy_uq8prj$();
    }
     else if (right.children.size !== 0) {
      if ((tmp$_1 = (tmp$_0 = (tmp$ = right.functionStringDefinition) != null ? tmp$.function : null) != null ? tmp$_0.isNameForRuleDesignations : null) != null ? tmp$_1 : false) {
        var actualNameArgsMap = LinkedHashMap_init_0();
        var conditionChildrenMap = LinkedHashMap_init_0();
        var functionNameArgsToExpressionMap = LinkedHashMap_init_0();
        tmp$_2 = get_lastIndex(right.children);
        for (var j = 0; j <= tmp$_2; j++) {
          tmp$_4 = (tmp$_3 = substitutionInstance.getExprVar_61zpoe$(right.children.get_za3lpa$(j).value)) != null ? tmp$_3.cloneWithNormalization_1g1bdl$(void 0, false) : null;
          if (tmp$_4 == null) {
            return null;
          }
          functionNameArgsToExpressionMap.put_xwzc9p$('sys_def_func_agr_' + j, tmp$_4);
        }
        tmp$_7 = (tmp$_6 = (tmp$_5 = substitutionInstance.getExprFunc_61zpoe$(right.value + '_' + toString(right.children.size))) != null ? tmp$_5.cloneWithDeepSubstitutions_q0nxk6$(functionNameArgsToExpressionMap) : null) != null ? tmp$_6.normalizeSubTree_f8z7ch$(void 0, void 0, false) : null;
        if (tmp$_7 == null) {
          return null;
        }
        return tmp$_7;
      }
       else {
        var argumentStartIndex = (tmp$_10 = (tmp$_9 = (tmp$_8 = right.functionStringDefinition) != null ? tmp$_8.function : null) != null ? tmp$_9.numberOfDefinitionArguments : null) != null ? tmp$_10 : 0;
        for (var i = 0; i < argumentStartIndex; i++) {
          substitutionInstance.putExprVar_vkfows$(right.children.get_za3lpa$(i).value, right.children.get_za3lpa$(i));
        }
        var result = right.copy_uq8prj$();
        tmp$_11 = get_lastIndex(right.children);
        for (var i_0 = 0; i_0 <= tmp$_11; i_0++) {
          tmp$_12 = this.applyRightCompanion_miu9dc$(substitutionInstance, right.children.get_za3lpa$(i_0));
          if (tmp$_12 == null) {
            return null;
          }
          result.addChild_6718cy$(tmp$_12);
        }
        for (var i_1 = 0; i_1 < argumentStartIndex; i_1++) {
          substitutionInstance.removeExprVar_61zpoe$(right.children.get_za3lpa$(i_1).value);
        }
        return result;
      }
    }
     else {
      return ((tmp$_13 = substitutionInstance.getExprVar_61zpoe$(right.value)) != null ? tmp$_13 : right).cloneWithNormalization_1g1bdl$(void 0, false);
    }
  };
  ExpressionSubstitution$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var ExpressionSubstitution$Companion_instance = null;
  function ExpressionSubstitution$Companion_getInstance() {
    if (ExpressionSubstitution$Companion_instance === null) {
      new ExpressionSubstitution$Companion();
    }
    return ExpressionSubstitution$Companion_instance;
  }
  ExpressionSubstitution.prototype.checkLeftCondition_6718cy$ = function (expressionNode) {
    var substitutionInstance = new SubstitutionInstance();
    this.checkCondition_vs93k4$(expressionNode, this.left.children.get_za3lpa$(0), substitutionInstance);
    return substitutionInstance;
  };
  ExpressionSubstitution.prototype.findAllPossibleSubstitutionPlaces_0 = function (root, originalExpression, result) {
    var tmp$;
    tmp$ = root.children.size;
    for (var i = 0; i < tmp$; i++) {
      this.findAllPossibleSubstitutionPlaces_0(root.children.get_za3lpa$(i), originalExpression, result);
      var substitutionInstance = this.checkLeftCondition_6718cy$(root.children.get_za3lpa$(i));
      if (substitutionInstance.isApplicable) {
        result.add_11rb$(new SubstitutionPlace(root, i, substitutionInstance, root.children.get_za3lpa$(i), originalExpression));
      }
    }
  };
  ExpressionSubstitution.prototype.findAllPossibleSubstitutionPlaces_6718cy$ = function (root) {
    var result = ArrayList_init();
    this.findAllPossibleSubstitutionPlaces_0(root, root, result);
    return result;
  };
  ExpressionSubstitution.prototype.applySubstitution_55nkop$ = function (substitutionPlaces) {
    var tmp$;
    tmp$ = substitutionPlaces.iterator();
    while (tmp$.hasNext()) {
      var substitutionPlace = tmp$.next();
      var newValue = this.checkAndApply_6718cy$(substitutionPlace.nodeParent.children.get_za3lpa$(substitutionPlace.nodeChildIndex));
      if (newValue != null) {
        substitutionPlace.nodeParent.children.set_wxm5ur$(substitutionPlace.nodeChildIndex, newValue);
        substitutionPlace.nodeParent.normalizeParentLinks();
      }
    }
  };
  ExpressionSubstitution.prototype.applySubstitutionByBitMask_eqestx$ = function (substitutionPlaces, bitMask) {
    var tmp$, tmp$_0;
    tmp$ = substitutionPlaces.size;
    for (var i = 0; i < tmp$; i++) {
      var substitutionPlace = substitutionPlaces.get_za3lpa$(i);
      substitutionPlace.nodeParent.children.set_wxm5ur$(substitutionPlace.nodeChildIndex, substitutionPlace.originalValue);
    }
    tmp$_0 = substitutionPlaces.size;
    for (var i_0 = 0; i_0 < tmp$_0; i_0++) {
      var substitutionPlace_0 = substitutionPlaces.get_za3lpa$(i_0);
      if ((bitMask & 1 << i_0) === 0)
        continue;
      var newValue = this.applyRight_7o4uji$(substitutionPlace_0.substitutionInstance);
      if (newValue != null) {
        substitutionPlace_0.nodeParent.children.set_wxm5ur$(substitutionPlace_0.nodeChildIndex, newValue);
      }
    }
  };
  ExpressionSubstitution.prototype.applyRight_7o4uji$ = function (substitutionInstance, right, topNodeId) {
    if (right === void 0)
      right = this.right.children.get_za3lpa$(0);
    if (topNodeId === void 0)
      topNodeId = -1;
    var tmp$;
    var tmp$_0;
    if ((tmp$ = ExpressionSubstitution$Companion_getInstance().applyRightCompanion_miu9dc$(substitutionInstance, right)) != null) {
      tmp$.resetNodeIds();
      tmp$.nodeId = topNodeId;
      tmp$_0 = tmp$;
    }
     else
      tmp$_0 = null;
    return tmp$_0;
  };
  ExpressionSubstitution.prototype.checkAndApply_6718cy$ = function (expressionNode) {
    var substitutionInstance = this.checkLeftCondition_6718cy$(expressionNode);
    if (substitutionInstance.isApplicable) {
      return this.applyRight_7o4uji$(substitutionInstance, void 0, expressionNode.nodeId);
    }
     else
      return null;
  };
  ExpressionSubstitution.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionSubstitution',
    interfaces: []
  };
  function applyAllFunctionSubstitutions($receiver, compiledSubstitutions) {
    var tmp$;
    var i = 0;
    while (i < $receiver.children.size) {
      applyAllFunctionSubstitutions($receiver.children.get_za3lpa$(i), compiledSubstitutions);
      var substitution = compiledSubstitutions.get_11rb$($receiver.children.get_za3lpa$(i).value + '_' + toString($receiver.children.get_za3lpa$(i).children.size));
      if (substitution != null) {
        $receiver.children.set_wxm5ur$(i, (tmp$ = substitution.checkAndApply_6718cy$($receiver.children.get_za3lpa$(i))) != null ? tmp$ : $receiver.children.get_za3lpa$(i));
      }
      i = i + 1 | 0;
    }
    $receiver.normalizeParentLinks();
  }
  function applyAllSubstitutions($receiver, expressionSubstitutions) {
    var tmp$;
    tmp$ = expressionSubstitutions.iterator();
    while (tmp$.hasNext()) {
      var substitution = tmp$.next();
      var substitutionPlaces = substitution.findAllPossibleSubstitutionPlaces_6718cy$($receiver);
      substitution.applySubstitution_55nkop$(substitutionPlaces);
    }
    $receiver.normalizeParentLinks();
  }
  function applyAllImmediateSubstitutions($receiver, compiledConfiguration) {
    $receiver.variableReplacement_y0zsll$(compiledConfiguration.compiledImmediateVariableReplacements);
    applyAllSubstitutions($receiver, compiledConfiguration.compiledImmediateTreeTransformationRules);
  }
  function ExpressionTask(originalExpression, finalExpression, requiredSubstitutions, allSubstitutions) {
    this.originalExpression = originalExpression;
    this.finalExpression = finalExpression;
    this.requiredSubstitutions = requiredSubstitutions;
    this.allSubstitutions = allSubstitutions;
  }
  ExpressionTask.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionTask',
    interfaces: []
  };
  function generateExpressionTask(expressionSubstitutions, stepsCount, originalExpressions) {
    var tmp$;
    var originalExpression = originalExpressions.size === 1 ? first(originalExpressions) : originalExpressions.get_za3lpa$(randomInt(0, get_lastIndex(originalExpressions)));
    var currentExpression = originalExpression.clone();
    var requiredSubstitutions = ArrayList_init();
    for (var i = 1; i <= stepsCount; i++) {
      var functionsInExpression = currentExpression.getContainedFunctions();
      var appropriateSubstitutions = ArrayList_init();
      tmp$ = expressionSubstitutions.iterator();
      while (tmp$.hasNext()) {
        var expressionSubstitution = tmp$.next();
        var tmp$_0 = !intersect(expressionSubstitution.leftFunctions, functionsInExpression).isEmpty();
        if (tmp$_0) {
          tmp$_0 = !expressionSubstitution.findAllPossibleSubstitutionPlaces_6718cy$(currentExpression).isEmpty();
        }
        if (tmp$_0) {
          appropriateSubstitutions.add_11rb$(expressionSubstitution);
        }
      }
      var tmp$_1;
      var sum = 0.0;
      tmp$_1 = appropriateSubstitutions.iterator();
      while (tmp$_1.hasNext()) {
        var element = tmp$_1.next();
        sum += element.weight;
      }
      var appropriateSubstitutionWeight = sum;
      if (appropriateSubstitutionWeight <= BaseOperationsComputation$Companion_getInstance().epsilon) {
        break;
      }
      var selector = random_0(0.0, appropriateSubstitutionWeight);
      var currentSubstitutionIndex = 0;
      while (selector > appropriateSubstitutions.get_za3lpa$(currentSubstitutionIndex).weight) {
        selector -= appropriateSubstitutions.get_za3lpa$(currentSubstitutionIndex).weight;
        currentSubstitutionIndex = currentSubstitutionIndex + 1 | 0;
      }
      var selectedSubstitution = appropriateSubstitutions.get_za3lpa$(currentSubstitutionIndex);
      requiredSubstitutions.add_11rb$(new ExpressionSubstitution(selectedSubstitution.left, selectedSubstitution.right));
      var places = selectedSubstitution.findAllPossibleSubstitutionPlaces_6718cy$(currentExpression);
      if (places.size === 1) {
        selectedSubstitution.applySubstitution_55nkop$(places);
      }
       else {
        var partSize = selectedSubstitution.weight / places.size;
        var index = numberToInt(selector / partSize);
        selectedSubstitution.applySubstitution_55nkop$(places.subList_vux9f0$(index, index + 1 | 0));
      }
    }
    return new ExpressionTask(originalExpression, currentExpression, requiredSubstitutions, expressionSubstitutions);
  }
  function MathMlTagTreeNode(type, value, startPosition, endPosition, parent, stringDefinitionType, isNumberRead, needDoubleChild, needOneMoreBracket, isLatexArgument, texArgumentType) {
    if (startPosition === void 0)
      startPosition = -1;
    if (endPosition === void 0)
      endPosition = -1;
    if (parent === void 0)
      parent = null;
    if (stringDefinitionType === void 0)
      stringDefinitionType = StringDefinitionType$FUNCTION_getInstance();
    if (isNumberRead === void 0)
      isNumberRead = false;
    if (needDoubleChild === void 0)
      needDoubleChild = false;
    if (needOneMoreBracket === void 0)
      needOneMoreBracket = false;
    if (isLatexArgument === void 0)
      isLatexArgument = false;
    if (texArgumentType === void 0)
      texArgumentType = MathMlTagTreeNode$TexArgumentType$USUAL_getInstance();
    this.type = type;
    this.value = value;
    this.startPosition = startPosition;
    this.endPosition = endPosition;
    this.parent = parent;
    this.stringDefinitionType = stringDefinitionType;
    this.isNumberRead = isNumberRead;
    this.needDoubleChild = needDoubleChild;
    this.needOneMoreBracket = needOneMoreBracket;
    this.isLatexArgument = isLatexArgument;
    this.texArgumentType = texArgumentType;
    this.children = ArrayList_init();
  }
  function MathMlTagTreeNode$Type(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function MathMlTagTreeNode$Type_initFields() {
    MathMlTagTreeNode$Type_initFields = function () {
    };
    MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_instance = new MathMlTagTreeNode$Type('EXPRESSION_PART_STRING', 0);
    MathMlTagTreeNode$Type$MATH_ML_FUNCTION_instance = new MathMlTagTreeNode$Type('MATH_ML_FUNCTION', 1);
    MathMlTagTreeNode$Type$BRACKET_FUNCTION_instance = new MathMlTagTreeNode$Type('BRACKET_FUNCTION', 2);
    MathMlTagTreeNode$Type$NAME_instance = new MathMlTagTreeNode$Type('NAME', 3);
    MathMlTagTreeNode$Type$OPERATION_instance = new MathMlTagTreeNode$Type('OPERATION', 4);
  }
  var MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_instance;
  function MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_getInstance() {
    MathMlTagTreeNode$Type_initFields();
    return MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_instance;
  }
  var MathMlTagTreeNode$Type$MATH_ML_FUNCTION_instance;
  function MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance() {
    MathMlTagTreeNode$Type_initFields();
    return MathMlTagTreeNode$Type$MATH_ML_FUNCTION_instance;
  }
  var MathMlTagTreeNode$Type$BRACKET_FUNCTION_instance;
  function MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance() {
    MathMlTagTreeNode$Type_initFields();
    return MathMlTagTreeNode$Type$BRACKET_FUNCTION_instance;
  }
  var MathMlTagTreeNode$Type$NAME_instance;
  function MathMlTagTreeNode$Type$NAME_getInstance() {
    MathMlTagTreeNode$Type_initFields();
    return MathMlTagTreeNode$Type$NAME_instance;
  }
  var MathMlTagTreeNode$Type$OPERATION_instance;
  function MathMlTagTreeNode$Type$OPERATION_getInstance() {
    MathMlTagTreeNode$Type_initFields();
    return MathMlTagTreeNode$Type$OPERATION_instance;
  }
  MathMlTagTreeNode$Type.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'Type',
    interfaces: [Enum]
  };
  function MathMlTagTreeNode$Type$values() {
    return [MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_getInstance(), MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance(), MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), MathMlTagTreeNode$Type$NAME_getInstance(), MathMlTagTreeNode$Type$OPERATION_getInstance()];
  }
  MathMlTagTreeNode$Type.values = MathMlTagTreeNode$Type$values;
  function MathMlTagTreeNode$Type$valueOf(name) {
    switch (name) {
      case 'EXPRESSION_PART_STRING':
        return MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_getInstance();
      case 'MATH_ML_FUNCTION':
        return MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance();
      case 'BRACKET_FUNCTION':
        return MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance();
      case 'NAME':
        return MathMlTagTreeNode$Type$NAME_getInstance();
      case 'OPERATION':
        return MathMlTagTreeNode$Type$OPERATION_getInstance();
      default:throwISE('No enum constant expressiontree.MathMlTagTreeNode.Type.' + name);
    }
  }
  MathMlTagTreeNode$Type.valueOf_61zpoe$ = MathMlTagTreeNode$Type$valueOf;
  function MathMlTagTreeNode$TexArgumentType(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function MathMlTagTreeNode$TexArgumentType_initFields() {
    MathMlTagTreeNode$TexArgumentType_initFields = function () {
    };
    MathMlTagTreeNode$TexArgumentType$USUAL_instance = new MathMlTagTreeNode$TexArgumentType('USUAL', 0);
    MathMlTagTreeNode$TexArgumentType$UNDERLINED_instance = new MathMlTagTreeNode$TexArgumentType('UNDERLINED', 1);
    MathMlTagTreeNode$TexArgumentType$POW_instance = new MathMlTagTreeNode$TexArgumentType('POW', 2);
  }
  var MathMlTagTreeNode$TexArgumentType$USUAL_instance;
  function MathMlTagTreeNode$TexArgumentType$USUAL_getInstance() {
    MathMlTagTreeNode$TexArgumentType_initFields();
    return MathMlTagTreeNode$TexArgumentType$USUAL_instance;
  }
  var MathMlTagTreeNode$TexArgumentType$UNDERLINED_instance;
  function MathMlTagTreeNode$TexArgumentType$UNDERLINED_getInstance() {
    MathMlTagTreeNode$TexArgumentType_initFields();
    return MathMlTagTreeNode$TexArgumentType$UNDERLINED_instance;
  }
  var MathMlTagTreeNode$TexArgumentType$POW_instance;
  function MathMlTagTreeNode$TexArgumentType$POW_getInstance() {
    MathMlTagTreeNode$TexArgumentType_initFields();
    return MathMlTagTreeNode$TexArgumentType$POW_instance;
  }
  MathMlTagTreeNode$TexArgumentType.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'TexArgumentType',
    interfaces: [Enum]
  };
  function MathMlTagTreeNode$TexArgumentType$values() {
    return [MathMlTagTreeNode$TexArgumentType$USUAL_getInstance(), MathMlTagTreeNode$TexArgumentType$UNDERLINED_getInstance(), MathMlTagTreeNode$TexArgumentType$POW_getInstance()];
  }
  MathMlTagTreeNode$TexArgumentType.values = MathMlTagTreeNode$TexArgumentType$values;
  function MathMlTagTreeNode$TexArgumentType$valueOf(name) {
    switch (name) {
      case 'USUAL':
        return MathMlTagTreeNode$TexArgumentType$USUAL_getInstance();
      case 'UNDERLINED':
        return MathMlTagTreeNode$TexArgumentType$UNDERLINED_getInstance();
      case 'POW':
        return MathMlTagTreeNode$TexArgumentType$POW_getInstance();
      default:throwISE('No enum constant expressiontree.MathMlTagTreeNode.TexArgumentType.' + name);
    }
  }
  MathMlTagTreeNode$TexArgumentType.valueOf_61zpoe$ = MathMlTagTreeNode$TexArgumentType$valueOf;
  MathMlTagTreeNode.prototype.addChild_dsamor$ = function (newNode) {
    this.children.add_11rb$(newNode);
    newNode.parent = this;
  };
  MathMlTagTreeNode.prototype.getNodeString = function () {
    var tmp$;
    if (this.children.size === 0)
      return this.value;
    var value = this.value + '{';
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      value += child.getNodeString() + String.fromCharCode(toBoxedChar(59));
    }
    if (last_0(value) === 59) {
      var $receiver = value;
      var endIndex = get_lastIndex_0(value);
      value = $receiver.substring(0, endIndex);
    }
    value += String.fromCharCode(125);
    return value;
  };
  MathMlTagTreeNode.prototype.toString = function () {
    return this.getNodeString();
  };
  MathMlTagTreeNode.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'MathMlTagTreeNode',
    interfaces: []
  };
  MathMlTagTreeNode.prototype.component1 = function () {
    return this.type;
  };
  MathMlTagTreeNode.prototype.component2 = function () {
    return this.value;
  };
  MathMlTagTreeNode.prototype.component3 = function () {
    return this.startPosition;
  };
  MathMlTagTreeNode.prototype.component4 = function () {
    return this.endPosition;
  };
  MathMlTagTreeNode.prototype.component5 = function () {
    return this.parent;
  };
  MathMlTagTreeNode.prototype.component6 = function () {
    return this.stringDefinitionType;
  };
  MathMlTagTreeNode.prototype.component7 = function () {
    return this.isNumberRead;
  };
  MathMlTagTreeNode.prototype.component8 = function () {
    return this.needDoubleChild;
  };
  MathMlTagTreeNode.prototype.component9 = function () {
    return this.needOneMoreBracket;
  };
  MathMlTagTreeNode.prototype.component10 = function () {
    return this.isLatexArgument;
  };
  MathMlTagTreeNode.prototype.component11 = function () {
    return this.texArgumentType;
  };
  MathMlTagTreeNode.prototype.copy_hdzj83$ = function (type, value, startPosition, endPosition, parent, stringDefinitionType, isNumberRead, needDoubleChild, needOneMoreBracket, isLatexArgument, texArgumentType) {
    return new MathMlTagTreeNode(type === void 0 ? this.type : type, value === void 0 ? this.value : value, startPosition === void 0 ? this.startPosition : startPosition, endPosition === void 0 ? this.endPosition : endPosition, parent === void 0 ? this.parent : parent, stringDefinitionType === void 0 ? this.stringDefinitionType : stringDefinitionType, isNumberRead === void 0 ? this.isNumberRead : isNumberRead, needDoubleChild === void 0 ? this.needDoubleChild : needDoubleChild, needOneMoreBracket === void 0 ? this.needOneMoreBracket : needOneMoreBracket, isLatexArgument === void 0 ? this.isLatexArgument : isLatexArgument, texArgumentType === void 0 ? this.texArgumentType : texArgumentType);
  };
  MathMlTagTreeNode.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.type) | 0;
    result = result * 31 + Kotlin.hashCode(this.value) | 0;
    result = result * 31 + Kotlin.hashCode(this.startPosition) | 0;
    result = result * 31 + Kotlin.hashCode(this.endPosition) | 0;
    result = result * 31 + Kotlin.hashCode(this.parent) | 0;
    result = result * 31 + Kotlin.hashCode(this.stringDefinitionType) | 0;
    result = result * 31 + Kotlin.hashCode(this.isNumberRead) | 0;
    result = result * 31 + Kotlin.hashCode(this.needDoubleChild) | 0;
    result = result * 31 + Kotlin.hashCode(this.needOneMoreBracket) | 0;
    result = result * 31 + Kotlin.hashCode(this.isLatexArgument) | 0;
    result = result * 31 + Kotlin.hashCode(this.texArgumentType) | 0;
    return result;
  };
  MathMlTagTreeNode.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.type, other.type) && Kotlin.equals(this.value, other.value) && Kotlin.equals(this.startPosition, other.startPosition) && Kotlin.equals(this.endPosition, other.endPosition) && Kotlin.equals(this.parent, other.parent) && Kotlin.equals(this.stringDefinitionType, other.stringDefinitionType) && Kotlin.equals(this.isNumberRead, other.isNumberRead) && Kotlin.equals(this.needDoubleChild, other.needDoubleChild) && Kotlin.equals(this.needOneMoreBracket, other.needOneMoreBracket) && Kotlin.equals(this.isLatexArgument, other.isLatexArgument) && Kotlin.equals(this.texArgumentType, other.texArgumentType)))));
  };
  function swap($receiver, index1, index2) {
    var tmp = $receiver.get_za3lpa$(index1);
    $receiver.set_wxm5ur$(index1, $receiver.get_za3lpa$(index2));
    $receiver.set_wxm5ur$(index2, tmp);
  }
  function ExpressionParserNode(type, value, startPosition, endPosition, subValue, parent, functionStringDefinition) {
    if (startPosition === void 0)
      startPosition = -1;
    if (endPosition === void 0)
      endPosition = -1;
    if (subValue === void 0)
      subValue = '';
    if (parent === void 0)
      parent = null;
    if (functionStringDefinition === void 0)
      functionStringDefinition = null;
    this.type = type;
    this.value = value;
    this.startPosition = startPosition;
    this.endPosition = endPosition;
    this.subValue = subValue;
    this.parent = parent;
    this.functionStringDefinition = functionStringDefinition;
    this.children = ArrayList_init();
  }
  function ExpressionParserNode$Type(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function ExpressionParserNode$Type_initFields() {
    ExpressionParserNode$Type_initFields = function () {
    };
    ExpressionParserNode$Type$FUNCTION_instance = new ExpressionParserNode$Type('FUNCTION', 0);
    ExpressionParserNode$Type$VARIABLE_instance = new ExpressionParserNode$Type('VARIABLE', 1);
    ExpressionParserNode$Type$BINARY_OPERATION_instance = new ExpressionParserNode$Type('BINARY_OPERATION', 2);
    ExpressionParserNode$Type$UNARY_OPERATION_instance = new ExpressionParserNode$Type('UNARY_OPERATION', 3);
  }
  var ExpressionParserNode$Type$FUNCTION_instance;
  function ExpressionParserNode$Type$FUNCTION_getInstance() {
    ExpressionParserNode$Type_initFields();
    return ExpressionParserNode$Type$FUNCTION_instance;
  }
  var ExpressionParserNode$Type$VARIABLE_instance;
  function ExpressionParserNode$Type$VARIABLE_getInstance() {
    ExpressionParserNode$Type_initFields();
    return ExpressionParserNode$Type$VARIABLE_instance;
  }
  var ExpressionParserNode$Type$BINARY_OPERATION_instance;
  function ExpressionParserNode$Type$BINARY_OPERATION_getInstance() {
    ExpressionParserNode$Type_initFields();
    return ExpressionParserNode$Type$BINARY_OPERATION_instance;
  }
  var ExpressionParserNode$Type$UNARY_OPERATION_instance;
  function ExpressionParserNode$Type$UNARY_OPERATION_getInstance() {
    ExpressionParserNode$Type_initFields();
    return ExpressionParserNode$Type$UNARY_OPERATION_instance;
  }
  ExpressionParserNode$Type.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'Type',
    interfaces: [Enum]
  };
  function ExpressionParserNode$Type$values() {
    return [ExpressionParserNode$Type$FUNCTION_getInstance(), ExpressionParserNode$Type$VARIABLE_getInstance(), ExpressionParserNode$Type$BINARY_OPERATION_getInstance(), ExpressionParserNode$Type$UNARY_OPERATION_getInstance()];
  }
  ExpressionParserNode$Type.values = ExpressionParserNode$Type$values;
  function ExpressionParserNode$Type$valueOf(name) {
    switch (name) {
      case 'FUNCTION':
        return ExpressionParserNode$Type$FUNCTION_getInstance();
      case 'VARIABLE':
        return ExpressionParserNode$Type$VARIABLE_getInstance();
      case 'BINARY_OPERATION':
        return ExpressionParserNode$Type$BINARY_OPERATION_getInstance();
      case 'UNARY_OPERATION':
        return ExpressionParserNode$Type$UNARY_OPERATION_getInstance();
      default:throwISE('No enum constant expressiontree.ExpressionParserNode.Type.' + name);
    }
  }
  ExpressionParserNode$Type.valueOf_61zpoe$ = ExpressionParserNode$Type$valueOf;
  ExpressionParserNode.prototype.addChild_amp9w1$ = function (newNode) {
    this.children.add_11rb$(newNode);
    newNode.parent = this;
  };
  ExpressionParserNode.prototype.getFirstListNodeAfterFunction_6taknv$ = function (functionMet) {
    if (functionMet === void 0)
      functionMet = false;
    if (this.children.isEmpty()) {
      return functionMet ? this : null;
    }
     else {
      var tmp$ = this.children.get_za3lpa$(0);
      var tmp$_0 = functionMet;
      if (!tmp$_0) {
        var tmp$_1 = this.type === ExpressionParserNode$Type$FUNCTION_getInstance();
        if (tmp$_1) {
          tmp$_1 = this.value.length > 0;
        }
        tmp$_0 = tmp$_1;
      }
      return tmp$.getFirstListNodeAfterFunction_6taknv$(tmp$_0);
    }
  };
  ExpressionParserNode.prototype.isFunction = function () {
    return this.type === ExpressionParserNode$Type$FUNCTION_getInstance() || this.type === ExpressionParserNode$Type$BINARY_OPERATION_getInstance() || this.type === ExpressionParserNode$Type$UNARY_OPERATION_getInstance();
  };
  ExpressionParserNode.prototype.getNonEmptyChildren_mnxts8$ = function (resultChildren, actualStartPosition, actualEndPosition) {
    if (actualStartPosition === void 0)
      actualStartPosition = -1;
    if (actualEndPosition === void 0)
      actualEndPosition = -1;
    var tmp$;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      if (child.startPosition < 0) {
        child.startPosition = actualStartPosition;
      }
      if (child.endPosition < 0) {
        child.endPosition = actualEndPosition;
      }
      if (child.value.length > 0) {
        resultChildren.add_11rb$(child);
      }
       else {
        child.getNonEmptyChildren_mnxts8$(resultChildren, child.startPosition, child.endPosition);
      }
    }
  };
  ExpressionParserNode.prototype.getNodeString = function () {
    var tmp$;
    if (this.children.size === 0)
      return this.value;
    var value = this.value + '(';
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      value += child.getNodeString() + String.fromCharCode(toBoxedChar(59));
    }
    value += String.fromCharCode(41);
    return value;
  };
  ExpressionParserNode.prototype.toString = function () {
    return this.getNodeString();
  };
  ExpressionParserNode.prototype.getMinPriorityOfBinaryOperationsWithoutOperands = function () {
    var tmp$;
    if (this.type === ExpressionParserNode$Type$BINARY_OPERATION_getInstance() && this.children.size === 0)
      return ensureNotNull(this.functionStringDefinition).function.priority;
    var minPriority = kotlin_js_internal_DoubleCompanionObject.MAX_VALUE;
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      var priority = child.getMinPriorityOfBinaryOperationsWithoutOperands();
      if (priority < minPriority)
        minPriority = priority;
    }
    return minPriority;
  };
  ExpressionParserNode.prototype.resolveBinaryOperationsWithPriorityRecursive_z18lgg$ = function (priority, functionConfiguration) {
    var tmp$, tmp$_0;
    var operationWithMinPriority = new ExpressionParserNode(ExpressionParserNode$Type$BINARY_OPERATION_getInstance(), '', this.startPosition, this.endPosition);
    tmp$ = this.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      child.resolveBinaryOperationsWithPriorityRecursive_z18lgg$(priority, functionConfiguration);
      if (child.type === ExpressionParserNode$Type$BINARY_OPERATION_getInstance() && ensureNotNull(child.functionStringDefinition).function.priority <= priority && child.children.size === 0) {
        operationWithMinPriority.functionStringDefinition = functionConfiguration.fastFindStringDefinitionByNameAndNumberOfArguments_bm4lxs$(ensureNotNull(child.functionStringDefinition).function.mainFunction, ensureNotNull(child.functionStringDefinition).function.numberOfArguments);
        operationWithMinPriority.value = ensureNotNull(child.functionStringDefinition).function.mainFunction;
      }
    }
    if (operationWithMinPriority.value.length === 0)
      return;
    operationWithMinPriority.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), ''));
    tmp$_0 = this.children.iterator();
    while (tmp$_0.hasNext()) {
      var child_0 = tmp$_0.next();
      if (child_0.type === ExpressionParserNode$Type$BINARY_OPERATION_getInstance() && equals(ensureNotNull(child_0.functionStringDefinition).function.mainFunction, operationWithMinPriority.value)) {
        if (equals(ensureNotNull(child_0.functionStringDefinition).function.function, operationWithMinPriority.value)) {
          operationWithMinPriority.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), ''));
        }
         else {
          operationWithMinPriority.addChild_amp9w1$(child_0);
        }
      }
       else {
        last(operationWithMinPriority.children).addChild_amp9w1$(child_0);
      }
    }
    this.children.clear();
    this.addChild_amp9w1$(operationWithMinPriority);
  };
  ExpressionParserNode.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionParserNode',
    interfaces: []
  };
  ExpressionParserNode.prototype.component1 = function () {
    return this.type;
  };
  ExpressionParserNode.prototype.component2 = function () {
    return this.value;
  };
  ExpressionParserNode.prototype.component3 = function () {
    return this.startPosition;
  };
  ExpressionParserNode.prototype.component4 = function () {
    return this.endPosition;
  };
  ExpressionParserNode.prototype.component5 = function () {
    return this.subValue;
  };
  ExpressionParserNode.prototype.component6 = function () {
    return this.parent;
  };
  ExpressionParserNode.prototype.component7 = function () {
    return this.functionStringDefinition;
  };
  ExpressionParserNode.prototype.copy_i0rkrg$ = function (type, value, startPosition, endPosition, subValue, parent, functionStringDefinition) {
    return new ExpressionParserNode(type === void 0 ? this.type : type, value === void 0 ? this.value : value, startPosition === void 0 ? this.startPosition : startPosition, endPosition === void 0 ? this.endPosition : endPosition, subValue === void 0 ? this.subValue : subValue, parent === void 0 ? this.parent : parent, functionStringDefinition === void 0 ? this.functionStringDefinition : functionStringDefinition);
  };
  ExpressionParserNode.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.type) | 0;
    result = result * 31 + Kotlin.hashCode(this.value) | 0;
    result = result * 31 + Kotlin.hashCode(this.startPosition) | 0;
    result = result * 31 + Kotlin.hashCode(this.endPosition) | 0;
    result = result * 31 + Kotlin.hashCode(this.subValue) | 0;
    result = result * 31 + Kotlin.hashCode(this.parent) | 0;
    result = result * 31 + Kotlin.hashCode(this.functionStringDefinition) | 0;
    return result;
  };
  ExpressionParserNode.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.type, other.type) && Kotlin.equals(this.value, other.value) && Kotlin.equals(this.startPosition, other.startPosition) && Kotlin.equals(this.endPosition, other.endPosition) && Kotlin.equals(this.subValue, other.subValue) && Kotlin.equals(this.parent, other.parent) && Kotlin.equals(this.functionStringDefinition, other.functionStringDefinition)))));
  };
  function ExpressionTreeParser(originalExpression, nameForRuleDesignationsPossible, functionConfiguration, compiledImmediateVariableReplacements, isMathML) {
    ExpressionTreeParser$Companion_getInstance();
    if (nameForRuleDesignationsPossible === void 0)
      nameForRuleDesignationsPossible = false;
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration();
    if (compiledImmediateVariableReplacements === void 0) {
      compiledImmediateVariableReplacements = emptyMap();
    }
    if (isMathML === void 0) {
      var tmp$;
      var tmp$_0 = startsWith(trim(Kotlin.isCharSequence(tmp$ = originalExpression) ? tmp$ : throwCCE()).toString(), '<');
      if (!tmp$_0) {
        var tmp$_1;
        tmp$_0 = endsWith_0(trim(Kotlin.isCharSequence(tmp$_1 = originalExpression) ? tmp$_1 : throwCCE()).toString(), '>');
      }
      isMathML = tmp$_0 || contains_0(originalExpression, '&#');
    }
    this.originalExpression = originalExpression;
    this.nameForRuleDesignationsPossible = nameForRuleDesignationsPossible;
    this.functionConfiguration = functionConfiguration;
    this.compiledImmediateVariableReplacements = compiledImmediateVariableReplacements;
    this.isMathML = isMathML;
    this.newLinePlaces = findNewLinePlaces(this.originalExpression);
    this.expression = texStringPrefiltering(removeNewLinesFromExpression(this.originalExpression));
    this.bracketCompleteTagTree_0 = new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), '', 0, this.originalExpression.length);
    this.parsedTree_0 = new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), '', 0, this.originalExpression.length);
    this.parsedTreeWithMultiples_0 = new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), '', 0, this.originalExpression.length);
    this.rootNotPrioritized_0 = new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), '', 0, this.originalExpression.length);
    this.rootNotPrioritizedWithMultiplications_0 = new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), '', 0, this.originalExpression.length);
    this.rootNotPrioritizedUnaries_0 = new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), '', 0, this.originalExpression.length);
    this.root = new ExpressionNode(NodeType$FUNCTION_getInstance(), '', 0, this.originalExpression.length);
    this.currentPosition_0 = 0;
    this.completeBinarySigns_0 = listOf_0(['&amp;', '->', '-<\/mo><mo>&gt;']);
  }
  function ExpressionTreeParser$ParserState(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function ExpressionTreeParser$ParserState_initFields() {
    ExpressionTreeParser$ParserState_initFields = function () {
    };
    ExpressionTreeParser$ParserState$WAIT_FOR_NUMBER_instance = new ExpressionTreeParser$ParserState('WAIT_FOR_NUMBER', 0);
    ExpressionTreeParser$ParserState$NUMBER_READ_instance = new ExpressionTreeParser$ParserState('NUMBER_READ', 1);
  }
  var ExpressionTreeParser$ParserState$WAIT_FOR_NUMBER_instance;
  function ExpressionTreeParser$ParserState$WAIT_FOR_NUMBER_getInstance() {
    ExpressionTreeParser$ParserState_initFields();
    return ExpressionTreeParser$ParserState$WAIT_FOR_NUMBER_instance;
  }
  var ExpressionTreeParser$ParserState$NUMBER_READ_instance;
  function ExpressionTreeParser$ParserState$NUMBER_READ_getInstance() {
    ExpressionTreeParser$ParserState_initFields();
    return ExpressionTreeParser$ParserState$NUMBER_READ_instance;
  }
  ExpressionTreeParser$ParserState.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ParserState',
    interfaces: [Enum]
  };
  function ExpressionTreeParser$ParserState$values() {
    return [ExpressionTreeParser$ParserState$WAIT_FOR_NUMBER_getInstance(), ExpressionTreeParser$ParserState$NUMBER_READ_getInstance()];
  }
  ExpressionTreeParser$ParserState.values = ExpressionTreeParser$ParserState$values;
  function ExpressionTreeParser$ParserState$valueOf(name) {
    switch (name) {
      case 'WAIT_FOR_NUMBER':
        return ExpressionTreeParser$ParserState$WAIT_FOR_NUMBER_getInstance();
      case 'NUMBER_READ':
        return ExpressionTreeParser$ParserState$NUMBER_READ_getInstance();
      default:throwISE('No enum constant expressiontree.ExpressionTreeParser.ParserState.' + name);
    }
  }
  ExpressionTreeParser$ParserState.valueOf_61zpoe$ = ExpressionTreeParser$ParserState$valueOf;
  function ExpressionTreeParser$TokenParserState(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function ExpressionTreeParser$TokenParserState_initFields() {
    ExpressionTreeParser$TokenParserState_initFields = function () {
    };
    ExpressionTreeParser$TokenParserState$UNDEFINED_instance = new ExpressionTreeParser$TokenParserState('UNDEFINED', 0);
    ExpressionTreeParser$TokenParserState$UNARY_OPERATION_instance = new ExpressionTreeParser$TokenParserState('UNARY_OPERATION', 1);
    ExpressionTreeParser$TokenParserState$BINARY_OPERATION_instance = new ExpressionTreeParser$TokenParserState('BINARY_OPERATION', 2);
    ExpressionTreeParser$TokenParserState$NUMBER_instance = new ExpressionTreeParser$TokenParserState('NUMBER', 3);
    ExpressionTreeParser$TokenParserState$NAME_instance = new ExpressionTreeParser$TokenParserState('NAME', 4);
    ExpressionTreeParser$TokenParserState$NAME_BREAK_instance = new ExpressionTreeParser$TokenParserState('NAME_BREAK', 5);
    ExpressionTreeParser$TokenParserState$COMMA_instance = new ExpressionTreeParser$TokenParserState('COMMA', 6);
  }
  var ExpressionTreeParser$TokenParserState$UNDEFINED_instance;
  function ExpressionTreeParser$TokenParserState$UNDEFINED_getInstance() {
    ExpressionTreeParser$TokenParserState_initFields();
    return ExpressionTreeParser$TokenParserState$UNDEFINED_instance;
  }
  var ExpressionTreeParser$TokenParserState$UNARY_OPERATION_instance;
  function ExpressionTreeParser$TokenParserState$UNARY_OPERATION_getInstance() {
    ExpressionTreeParser$TokenParserState_initFields();
    return ExpressionTreeParser$TokenParserState$UNARY_OPERATION_instance;
  }
  var ExpressionTreeParser$TokenParserState$BINARY_OPERATION_instance;
  function ExpressionTreeParser$TokenParserState$BINARY_OPERATION_getInstance() {
    ExpressionTreeParser$TokenParserState_initFields();
    return ExpressionTreeParser$TokenParserState$BINARY_OPERATION_instance;
  }
  var ExpressionTreeParser$TokenParserState$NUMBER_instance;
  function ExpressionTreeParser$TokenParserState$NUMBER_getInstance() {
    ExpressionTreeParser$TokenParserState_initFields();
    return ExpressionTreeParser$TokenParserState$NUMBER_instance;
  }
  var ExpressionTreeParser$TokenParserState$NAME_instance;
  function ExpressionTreeParser$TokenParserState$NAME_getInstance() {
    ExpressionTreeParser$TokenParserState_initFields();
    return ExpressionTreeParser$TokenParserState$NAME_instance;
  }
  var ExpressionTreeParser$TokenParserState$NAME_BREAK_instance;
  function ExpressionTreeParser$TokenParserState$NAME_BREAK_getInstance() {
    ExpressionTreeParser$TokenParserState_initFields();
    return ExpressionTreeParser$TokenParserState$NAME_BREAK_instance;
  }
  var ExpressionTreeParser$TokenParserState$COMMA_instance;
  function ExpressionTreeParser$TokenParserState$COMMA_getInstance() {
    ExpressionTreeParser$TokenParserState_initFields();
    return ExpressionTreeParser$TokenParserState$COMMA_instance;
  }
  ExpressionTreeParser$TokenParserState.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'TokenParserState',
    interfaces: [Enum]
  };
  function ExpressionTreeParser$TokenParserState$values() {
    return [ExpressionTreeParser$TokenParserState$UNDEFINED_getInstance(), ExpressionTreeParser$TokenParserState$UNARY_OPERATION_getInstance(), ExpressionTreeParser$TokenParserState$BINARY_OPERATION_getInstance(), ExpressionTreeParser$TokenParserState$NUMBER_getInstance(), ExpressionTreeParser$TokenParserState$NAME_getInstance(), ExpressionTreeParser$TokenParserState$NAME_BREAK_getInstance(), ExpressionTreeParser$TokenParserState$COMMA_getInstance()];
  }
  ExpressionTreeParser$TokenParserState.values = ExpressionTreeParser$TokenParserState$values;
  function ExpressionTreeParser$TokenParserState$valueOf(name) {
    switch (name) {
      case 'UNDEFINED':
        return ExpressionTreeParser$TokenParserState$UNDEFINED_getInstance();
      case 'UNARY_OPERATION':
        return ExpressionTreeParser$TokenParserState$UNARY_OPERATION_getInstance();
      case 'BINARY_OPERATION':
        return ExpressionTreeParser$TokenParserState$BINARY_OPERATION_getInstance();
      case 'NUMBER':
        return ExpressionTreeParser$TokenParserState$NUMBER_getInstance();
      case 'NAME':
        return ExpressionTreeParser$TokenParserState$NAME_getInstance();
      case 'NAME_BREAK':
        return ExpressionTreeParser$TokenParserState$NAME_BREAK_getInstance();
      case 'COMMA':
        return ExpressionTreeParser$TokenParserState$COMMA_getInstance();
      default:throwISE('No enum constant expressiontree.ExpressionTreeParser.TokenParserState.' + name);
    }
  }
  ExpressionTreeParser$TokenParserState.valueOf_61zpoe$ = ExpressionTreeParser$TokenParserState$valueOf;
  ExpressionTreeParser.prototype.normalisePositionInParseError_0 = function (parserError) {
    var tmp$;
    var shift = 0;
    tmp$ = this.newLinePlaces.iterator();
    while (tmp$.hasNext()) {
      var i = tmp$.next();
      if (parserError.position >= i) {
        shift = shift + 1 | 0;
      }
    }
    var endPosition = parserError.endPosition < 0 ? parserError.endPosition : parserError.endPosition + Kotlin.imul(shift, newLineMspace.length) | 0;
    this.root.nodeType = NodeType$ERROR_getInstance();
    this.root.startPosition = parserError.position + Kotlin.imul(shift, newLineMspace.length) | 0;
    this.root.endPosition = endPosition;
    this.root.value = parserError.description;
    return new ParserError(parserError.position + Kotlin.imul(shift, newLineMspace.length) | 0, parserError.description, endPosition);
  };
  ExpressionTreeParser.prototype.parse = function () {
    var parseMathMlTagTreeError = this.parseMathMlTagTree_0();
    if (parseMathMlTagTreeError != null)
      return this.normalisePositionInParseError_0(parseMathMlTagTreeError);
    var parseLeaveStringExpressionPartsError = this.parseLeaveStringExpressionParts_0(this.bracketCompleteTagTree_0, this.parsedTree_0);
    if (parseLeaveStringExpressionPartsError != null)
      return this.normalisePositionInParseError_0(parseLeaveStringExpressionPartsError);
    if (this.isMathML) {
      var multipleFunctionsHandlingError = this.multipleFunctionsHandling_0(this.parsedTree_0, this.parsedTreeWithMultiples_0);
      if (multipleFunctionsHandlingError != null)
        return this.normalisePositionInParseError_0(multipleFunctionsHandlingError);
    }
     else {
      this.parsedTreeWithMultiples_0 = this.parsedTree_0;
    }
    var mathMlTreeToExpressionTreeError = this.mathMlTreeToExpressionTree_0(this.parsedTreeWithMultiples_0, this.rootNotPrioritized_0);
    if (mathMlTreeToExpressionTreeError != null)
      return this.normalisePositionInParseError_0(mathMlTreeToExpressionTreeError);
    var combineUnaryError = this.combineUnary_0(this.rootNotPrioritized_0, this.rootNotPrioritizedUnaries_0);
    if (combineUnaryError != null)
      return this.normalisePositionInParseError_0(combineUnaryError);
    var addMultiplicationsError = this.addMultiplications_0(this.rootNotPrioritizedUnaries_0, this.rootNotPrioritizedWithMultiplications_0);
    if (addMultiplicationsError != null)
      return this.normalisePositionInParseError_0(addMultiplicationsError);
    this.resolveBinaryOperations_0(this.rootNotPrioritizedWithMultiplications_0);
    this.toExpressionTree_0(this.rootNotPrioritizedWithMultiplications_0, this.root);
    this.root.correctPositions();
    this.root.computeIdentifier_t6ztn0$();
    this.root.variableReplacement_y0zsll$(this.compiledImmediateVariableReplacements);
    this.root.computeNodeIdsAsNumbersInDirectTraversalAndDistancesToRoot_ydzd23$();
    return null;
  };
  function ExpressionTreeParser$parseMathMlTagTree$lambda(it) {
    return isLetter(unboxChar(it));
  }
  function ExpressionTreeParser$parseMathMlTagTree$lambda_0(it) {
    return unboxChar(it) !== 62;
  }
  ExpressionTreeParser.prototype.parseMathMlTagTree_0 = function () {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7;
    var actualParent = this.bracketCompleteTagTree_0;
    var numberOfOpenBrackets = 0;
    var currentPosition = 0;
    var value = '';
    var inTag = false;
    var skipMrowCount = 0;
    actualParent.startPosition = currentPosition;
    while (currentPosition < this.expression.length) {
      if (isWhitespace(this.expression.charCodeAt(currentPosition))) {
        currentPosition = currentPosition + 1 | 0;
        continue;
      }
      var startPosition = currentPosition;
      if (this.isMathML && this.expression.charCodeAt(currentPosition) === 60 && (this.isComplicatedTag_0(this.expression, currentPosition) || actualParent.type === MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance())) {
        var tagStartPosition = currentPosition;
        currentPosition = currentPosition + 1 | 0;
        if (remainingExpressionStartsWith('/', this.expression, currentPosition)) {
          currentPosition = currentPosition + 1 | 0;
          value = readFromRemainingExpressionWhile(ExpressionTreeParser$parseMathMlTagTree$lambda, this.expression, currentPosition);
          currentPosition = currentPosition + value.length | 0;
          if (!startsWith_0(value, 109)) {
            var other = value;
            value = String.fromCharCode(109) + other;
          }
          currentPosition = skipFromRemainingExpressionWhile(ExpressionTreeParser$parseMathMlTagTree$lambda_0, this.expression, currentPosition);
          if (equals(value, 'mrow') && skipMrowCount > 0 && !equals(substringBefore(actualParent.value, 95), 'mrow')) {
            skipMrowCount = skipMrowCount - 1 | 0;
          }
           else {
            if (!equals(substringBefore(actualParent.value, 95), value)) {
              if (!equals(value, 'mrow')) {
                return new ParserError(startPosition, "Unexpected: '<\/" + value + "'");
              }
            }
             else {
              actualParent.endPosition = tagStartPosition;
              if (equals(value, 'mrow') && !actualParent.needDoubleChild) {
                var node = actualParent;
                var parent = ensureNotNull(actualParent.parent);
                parent.children.removeAt_za3lpa$(get_lastIndex(parent.children));
                parent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), '', startPosition));
                last(parent.children).addChild_dsamor$(node);
                actualParent = parent;
              }
               else {
                actualParent = ensureNotNull(actualParent.parent);
              }
            }
          }
          currentPosition = currentPosition + 1 | 0;
        }
         else {
          currentPosition = currentPosition - 1 | 0;
          var actualTag = readOpenTagStringIfItPresent(this.expression, currentPosition);
          var tagData = getTagAttributes(ensureNotNull(actualTag));
          var openValue = (tmp$ = tagData.get_11rb$('open')) != null ? replace(tmp$, '"', '') : null;
          var closeValue = (tmp$_0 = tagData.get_11rb$('close')) != null ? replace(tmp$_0, '"', '') : null;
          tmp$_2 = ensureNotNull(tagData.get_11rb$('name'));
          if (openValue != null) {
            tmp$_1 = '_' + toString(openValue);
          }
           else {
            tmp$_1 = '';
          }
          if (closeValue != null) {
            tmp$_3 = '__' + toString(closeValue);
          }
           else {
            tmp$_3 = '';
          }
          value = tmp$_2 + tmp$_1 + tmp$_3;
          var nameNotStartWithM = false;
          if (!startsWith_0(value, 109)) {
            var other_0 = value;
            value = String.fromCharCode(109) + other_0;
            nameNotStartWithM = true;
          }
          if (equals(value, 'mrow') && !ExpressionTreeParser$Companion_getInstance().mathMlTags.contains_11rb$(actualParent.value)) {
            currentPosition = currentPosition + ensureNotNull(actualTag).length | 0;
            skipMrowCount = skipMrowCount + 1 | 0;
          }
           else {
            currentPosition = currentPosition + ensureNotNull(actualTag).length | 0;
            var newParentNode = equals(value, 'msqrt') || equals(value, 'mrow') || equals(value, 'math') || equals(value, 'mfenced_|__|') ? new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), value, startPosition) : new MathMlTagTreeNode(MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance(), value, startPosition);
            var tmp$_8 = nameNotStartWithM;
            if (tmp$_8) {
              tmp$_8 = !actualParent.children.isEmpty();
            }
            if (tmp$_8) {
              if (last(actualParent.children).type === MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_getInstance() && (endsWith_0(last(actualParent.children).value, '<\/mi>') || endsWith_0(last(actualParent.children).value, '<\/mn>') || endsWith_0(last(actualParent.children).value, '<\/mo>')) && lastIndexOfAny(last(actualParent.children).value, listOf_0(['<mi>', '<mo>', '<mn>'])) > 0) {
                var lastSignIndex = lastIndexOfAny(last(actualParent.children).value, listOf_0(['<mi>', '<mo>', '<mn>']));
                var suffix = last(actualParent.children).value.substring(lastSignIndex);
                last(actualParent.children).value = removeSuffix(last(actualParent.children).value, suffix);
                actualParent.addChild_dsamor$(newParentNode);
                actualParent = last(actualParent.children);
                actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_getInstance(), suffix, currentPosition, currentPosition));
              }
               else {
                var currentLastChild = last(actualParent.children);
                actualParent.children.removeAt_za3lpa$(get_lastIndex(actualParent.children));
                actualParent.addChild_dsamor$(newParentNode);
                actualParent = last(actualParent.children);
                actualParent.addChild_dsamor$(currentLastChild);
              }
            }
             else {
              actualParent.addChild_dsamor$(newParentNode);
              actualParent = last(actualParent.children);
            }
          }
        }
      }
       else if (this.expression.charCodeAt(currentPosition) === 40 || this.expression.charCodeAt(currentPosition) === 123) {
        actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), '', startPosition, void 0, void 0, void 0, void 0, void 0, void 0, this.expression.charCodeAt(currentPosition) === 123));
        actualParent = last(actualParent.children);
        numberOfOpenBrackets = numberOfOpenBrackets + 1 | 0;
        currentPosition = currentPosition + 1 | 0;
      }
       else if (this.expression.charCodeAt(currentPosition) === 41 || this.expression.charCodeAt(currentPosition) === 125) {
        if (actualParent.needOneMoreBracket) {
          actualParent.endPosition = currentPosition + 1 | 0;
          actualParent = ensureNotNull(actualParent.parent);
        }
        if (actualParent.type !== MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance()) {
          if (equals(actualParent.value, 'mo')) {
            var upFunctionNode = ensureNotNull(actualParent.parent);
            var upBracketNode = ensureNotNull(upFunctionNode.parent);
            upBracketNode.children.removeAt_za3lpa$(get_lastIndex(upBracketNode.children));
            var parent_0 = ensureNotNull(upBracketNode.parent);
            parent_0.children.removeAt_za3lpa$(get_lastIndex(parent_0.children));
            upBracketNode.parent = null;
            parent_0.addChild_dsamor$(upFunctionNode);
            upBracketNode.endPosition = currentPosition + 1 | 0;
            actualParent.addChild_dsamor$(upBracketNode);
          }
           else
            return new ParserError(startPosition, "Unexpected ')'");
        }
         else if (!actualParent.needDoubleChild) {
          var node_0 = actualParent;
          actualParent.endPosition = currentPosition + 1 | 0;
          tmp$_4 = actualParent.parent;
          if (tmp$_4 == null) {
            return new ParserError(startPosition, "Unexpected ')'");
          }
          var parent_1 = tmp$_4;
          parent_1.children.removeAt_za3lpa$(get_lastIndex(parent_1.children));
          parent_1.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), '', startPosition, currentPosition + 1 | 0));
          last(parent_1.children).addChild_dsamor$(node_0);
          actualParent = parent_1;
        }
         else {
          actualParent.endPosition = currentPosition + 1 | 0;
          tmp$_5 = actualParent.parent;
          if (tmp$_5 == null) {
            return new ParserError(startPosition, "Unexpected ')'");
          }
          actualParent = tmp$_5;
        }
        numberOfOpenBrackets = numberOfOpenBrackets - 1 | 0;
        currentPosition = currentPosition + 1 | 0;
      }
       else if (this.expression.charCodeAt(currentPosition) === 44) {
        if (actualParent.needOneMoreBracket) {
          actualParent.endPosition = currentPosition;
          actualParent = ensureNotNull(actualParent.parent);
        }
        tmp$_6 = actualParent.parent;
        if (tmp$_6 == null) {
          return new ParserError(startPosition, "Unexpected ','");
        }
        var parent_2 = tmp$_6;
        if (!actualParent.needDoubleChild && parent_2.type === MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance()) {
          parent_2.children.removeAt_za3lpa$(get_lastIndex(parent_2.children));
          parent_2.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), '', actualParent.startPosition, currentPosition));
          last(parent_2.children).addChild_dsamor$(actualParent);
          actualParent = last(parent_2.children);
          actualParent.needDoubleChild = true;
        }
        if (actualParent.type !== MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance())
          return new ParserError(startPosition, "Unexpected ','");
        currentPosition = currentPosition + 1 | 0;
      }
       else if (this.expression.charCodeAt(currentPosition) === 61) {
        if (actualParent.needOneMoreBracket) {
          actualParent.endPosition = currentPosition;
          actualParent = ensureNotNull(actualParent.parent);
        }
        if (actualParent.type !== MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance())
          return new ParserError(startPosition, "Unexpected '='");
        currentPosition = currentPosition + 1 | 0;
      }
       else {
        while (currentPosition < this.expression.length && (inTag || (!this.isComplicatedTag_0(this.expression, currentPosition) && this.expression.charCodeAt(currentPosition) !== 40 && this.expression.charCodeAt(currentPosition) !== 41 && this.expression.charCodeAt(currentPosition) !== 123 && this.expression.charCodeAt(currentPosition) !== 125 && this.expression.charCodeAt(currentPosition) !== 44 && this.expression.charCodeAt(currentPosition) !== 61 && (this.expression.charCodeAt(currentPosition) !== 60 || actualParent.type !== MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance())))) {
          if (this.expression.charCodeAt(currentPosition) === 60)
            inTag = true;
          if (this.expression.charCodeAt(currentPosition) === 62)
            inTag = false;
          if (remainingExpressionStartsWith('\\left(', this.expression, currentPosition)) {
            currentPosition = currentPosition + 5 | 0;
            continue;
          }
           else if (remainingExpressionStartsWith('\\right)', this.expression, currentPosition)) {
            currentPosition = currentPosition + 6 | 0;
            continue;
          }
          value += String.fromCharCode(this.expression.charCodeAt(currentPosition));
          currentPosition = currentPosition + 1 | 0;
        }
        if (currentPosition < this.expression.length && this.expression.charCodeAt(currentPosition) === 61 && actualParent.isLatexArgument) {
          actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_getInstance(), value, startPosition, currentPosition));
          actualParent.endPosition = currentPosition;
          tmp$_7 = actualParent.parent;
          if (tmp$_7 == null) {
            return new ParserError(startPosition, "Unexpected '='");
          }
          var parent_3 = tmp$_7;
          parent_3.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), '', startPosition, void 0, void 0, void 0, void 0, void 0, void 0, true));
          actualParent = last(parent_3.children);
          currentPosition = currentPosition + 1 | 0;
        }
         else {
          if (currentPosition < this.expression.length && (this.expression.charCodeAt(currentPosition) === 44 || this.expression.charCodeAt(currentPosition) === 61 || this.expression.charCodeAt(currentPosition) === 41)) {
            if (actualParent.needOneMoreBracket) {
              actualParent.endPosition = currentPosition;
              actualParent = ensureNotNull(actualParent.parent);
            }
          }
          if (currentPosition < this.expression.length && (this.expression.charCodeAt(currentPosition) === 44 || this.expression.charCodeAt(currentPosition) === 61 || actualParent.needDoubleChild)) {
            if (actualParent.children.isEmpty() || actualParent.needDoubleChild || last(actualParent.children).type === MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance()) {
              actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), '', startPosition));
            }
            actualParent.needDoubleChild = true;
            last(actualParent.children).addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_getInstance(), value, startPosition, currentPosition));
            if (this.expression.charCodeAt(currentPosition) === 40) {
              actualParent = last(actualParent.children);
              actualParent.needOneMoreBracket = true;
            }
          }
           else {
            actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_getInstance(), value, startPosition, currentPosition));
          }
        }
      }
      value = '';
    }
    if (numberOfOpenBrackets > 0)
      return new ParserError(this.expression.length - 1 | 0, 'closing bracket missing');
    if (actualParent !== this.bracketCompleteTagTree_0)
      return new ParserError(this.expression.length - 1 | 0, 'data not ended');
    actualParent.endPosition = currentPosition;
    return null;
  };
  function ExpressionTreeParser$parseLeaveStringExpressionParts$lambda(it) {
    return unboxChar(it) !== 62;
  }
  function ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_0(it) {
    return isLatinLetter(unboxChar(it));
  }
  function ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_1(it) {
    return unboxChar(it) !== 62;
  }
  function ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_2(it) {
    return unboxChar(it) !== 62;
  }
  function ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_3(it) {
    return unboxChar(it) !== 59;
  }
  function ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_4(it) {
    return unboxChar(it) !== 62;
  }
  function ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_5(it) {
    return unboxChar(it) !== 59;
  }
  function ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_6(it) {
    return unboxChar(it) !== 59;
  }
  ExpressionTreeParser.prototype.parseLeaveStringExpressionParts_0 = function (oldTreeActualParent, newTreeActualParent) {
    var state = ExpressionTreeParser$ParserState$WAIT_FOR_NUMBER_getInstance();
    var newTreeActualParent_0 = newTreeActualParent;
    if (equals(newTreeActualParent_0.value, 'mrow')) {
      newTreeActualParent_0 = ensureNotNull(newTreeActualParent_0.parent);
      newTreeActualParent_0.children.removeAt_za3lpa$(get_lastIndex(newTreeActualParent_0.children));
    }
    var newNodeCurrentPosition = 0;
    var leavedActualParentExpectedArgumentsCount = 0;
    var nextTexArgumentType = MathMlTagTreeNode$TexArgumentType$USUAL_getInstance();
    var additionPowArgumentExpected = false;
    var nodeIndex = 0;
    while (nodeIndex < oldTreeActualParent.children.size) {
      var node = oldTreeActualParent.children.get_za3lpa$(nodeIndex);
      var isNewTexFunction = false;
      if (node.type === MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_getInstance()) {
        var actualParent = newTreeActualParent_0;
        var currentPosition = newNodeCurrentPosition;
        var value = '';
        node.value = node.value + ' ';
        while (currentPosition < node.value.length) {
          if (isWhitespace(node.value.charCodeAt(currentPosition))) {
            currentPosition = currentPosition + 1 | 0;
            continue;
          }
          if (this.isMathML && remainingExpressionStartsWith('&#xA0;', node.value, currentPosition)) {
            currentPosition = currentPosition + 6 | 0;
            continue;
          }
          if (remainingExpressionStartsWith('\\text', node.value, currentPosition)) {
            currentPosition = currentPosition + 5 | 0;
            continue;
          }
          if (this.isMathML && node.value.charCodeAt(currentPosition) === 60 && !this.isComplicatedTag_0(node.value, currentPosition)) {
            currentPosition = skipFromRemainingExpressionWhile(ExpressionTreeParser$parseLeaveStringExpressionParts$lambda, node.value, currentPosition);
            currentPosition = currentPosition + 1 | 0;
            continue;
          }
          if (leavedActualParentExpectedArgumentsCount > 0) {
            var isFunctionArgumentPart = leavedActualParentExpectedArgumentsCount === 1;
            if (isTexArgumentsSeparator(node.value.charCodeAt(currentPosition))) {
              if (node.value.charCodeAt(currentPosition) === 94) {
                nextTexArgumentType = MathMlTagTreeNode$TexArgumentType$POW_getInstance();
                if (additionPowArgumentExpected) {
                  leavedActualParentExpectedArgumentsCount = leavedActualParentExpectedArgumentsCount + 1 | 0;
                  additionPowArgumentExpected = false;
                }
              }
               else if (node.value.charCodeAt(currentPosition) === 95) {
                nextTexArgumentType = MathMlTagTreeNode$TexArgumentType$UNDERLINED_getInstance();
              }
              isFunctionArgumentPart = true;
              currentPosition = currentPosition + 1 | 0;
            }
            if (currentPosition >= node.value.length || isWhitespace(node.value.charCodeAt(currentPosition))) {
              currentPosition = currentPosition + 1 | 0;
              continue;
            }
            if (isFunctionArgumentPart) {
              actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$NAME_getInstance(), String.fromCharCode(node.value.charCodeAt(currentPosition)), node.startPosition + currentPosition | 0, node.startPosition + currentPosition + 1 | 0, void 0, void 0, void 0, void 0, void 0, void 0, nextTexArgumentType));
              nextTexArgumentType = MathMlTagTreeNode$TexArgumentType$USUAL_getInstance();
              leavedActualParentExpectedArgumentsCount = leavedActualParentExpectedArgumentsCount - 1 | 0;
              isNewTexFunction = true;
              if (leavedActualParentExpectedArgumentsCount === 0) {
                if (newTreeActualParent_0.parent != null) {
                  newTreeActualParent_0 = ensureNotNull(newTreeActualParent_0.parent);
                  actualParent = newTreeActualParent_0;
                }
                 else {
                  return new ParserError(node.startPosition + currentPosition | 0, 'Expected for closing bracket');
                }
              }
              currentPosition = currentPosition + 1 | 0;
              continue;
            }
          }
          var startPosition = currentPosition;
          if (node.value.charCodeAt(currentPosition) === 92 && (currentPosition + 1 | 0) < node.value.length && isLatinLetter(node.value.charCodeAt(currentPosition + 1 | 0))) {
            var other = readFromRemainingExpressionWhile(ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_0, node.value, currentPosition + 1 | 0);
            var texName = String.fromCharCode(92) + other;
            var texFunction = this.functionConfiguration.slashToSpaceFunctionDefinitionsMap.get_11rb$(texName);
            if (texFunction != null) {
              currentPosition = currentPosition + texName.length | 0;
              actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), texName, node.startPosition + startPosition | 0, node.startPosition + currentPosition - 1 | 0, void 0, texFunction.definitionType));
              leavedActualParentExpectedArgumentsCount = texFunction.definitionArgumentsCount;
              additionPowArgumentExpected = texFunction.powSeparatedAsPow;
              if (leavedActualParentExpectedArgumentsCount > 0) {
                newTreeActualParent_0 = last(actualParent.children);
                actualParent = newTreeActualParent_0;
                isNewTexFunction = true;
              }
              continue;
            }
            var variable = texToUnicode.get_11rb$(texName);
            if (variable != null) {
              currentPosition = currentPosition + texName.length | 0;
              actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$NAME_getInstance(), variable, node.startPosition + startPosition | 0, node.startPosition + startPosition - 1 | 0));
              state = ExpressionTreeParser$ParserState$NUMBER_READ_getInstance();
              continue;
            }
          }
          var completeSign = this.getCompleteSign_0(node.value, currentPosition);
          if (completeSign != null) {
            currentPosition = currentPosition + completeSign.first.length | 0;
            state = ExpressionTreeParser$ParserState$WAIT_FOR_NUMBER_getInstance();
            actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$OPERATION_getInstance(), ensureNotNull(completeSign).first, node.startPosition + startPosition | 0, node.startPosition + currentPosition - 1 | 0, void 0, completeSign.second));
            if (completeSign.second === StringDefinitionType$BINARY_OPERATION_getInstance()) {
              state = ExpressionTreeParser$ParserState$WAIT_FOR_NUMBER_getInstance();
            }
          }
           else if (isBinarySignPart(node.value.charCodeAt(currentPosition), this.isMathML)) {
            value += String.fromCharCode(node.value.charCodeAt(currentPosition));
            currentPosition = currentPosition + 1 | 0;
            while (currentPosition < node.value.length) {
              if (this.isMathML && node.value.charCodeAt(currentPosition) === 60 && !this.isComplicatedTag_0(node.value, currentPosition)) {
                currentPosition = skipFromRemainingExpressionWhile(ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_1, node.value, currentPosition);
                currentPosition = currentPosition + 1 | 0;
                continue;
              }
              if (isBinarySignPart(node.value.charCodeAt(currentPosition), this.isMathML) && this.getTexFunction_0(node.value, currentPosition) == null) {
                value += String.fromCharCode(node.value.charCodeAt(currentPosition));
                currentPosition = currentPosition + 1 | 0;
              }
               else {
                actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$OPERATION_getInstance(), value, node.startPosition + startPosition | 0, node.startPosition + currentPosition - 1 | 0, void 0, StringDefinitionType$BINARY_OPERATION_getInstance()));
                break;
              }
            }
            state = ExpressionTreeParser$ParserState$WAIT_FOR_NUMBER_getInstance();
          }
           else if (isUnarySignPart(node.value.charCodeAt(currentPosition))) {
            value += String.fromCharCode(node.value.charCodeAt(currentPosition));
            currentPosition = currentPosition + 1 | 0;
            while (currentPosition < node.value.length) {
              if (this.isMathML && node.value.charCodeAt(currentPosition) === 60 && !this.isComplicatedTag_0(node.value, currentPosition)) {
                currentPosition = skipFromRemainingExpressionWhile(ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_2, node.value, currentPosition);
                currentPosition = currentPosition + 1 | 0;
                continue;
              }
              if (isUnarySignPart(node.value.charCodeAt(currentPosition))) {
                value += String.fromCharCode(node.value.charCodeAt(currentPosition));
                currentPosition = currentPosition + 1 | 0;
              }
               else {
                actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$OPERATION_getInstance(), value, node.startPosition + startPosition | 0, node.startPosition + currentPosition - 1 | 0, void 0, state === ExpressionTreeParser$ParserState$WAIT_FOR_NUMBER_getInstance() ? StringDefinitionType$UNARY_LEFT_OPERATION_getInstance() : StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance()));
                break;
              }
            }
          }
           else if (isNamePart(node.value.charCodeAt(currentPosition)) || (node.value.charCodeAt(currentPosition) === 38 && this.isMathML)) {
            state = ExpressionTreeParser$ParserState$NUMBER_READ_getInstance();
            if (isNamePart(node.value.charCodeAt(currentPosition))) {
              value += String.fromCharCode(node.value.charCodeAt(currentPosition));
              currentPosition = currentPosition + 1 | 0;
            }
             else {
              var specialSymbol = readFromRemainingExpressionWhile(ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_3, node.value, currentPosition);
              currentPosition = currentPosition + (specialSymbol.length + 1) | 0;
              value += specialSymbol + ';';
            }
            while (currentPosition < node.value.length) {
              if (this.isMathML && node.value.charCodeAt(currentPosition) === 60 && !this.isComplicatedTag_0(node.value, currentPosition)) {
                currentPosition = skipFromRemainingExpressionWhile(ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_4, node.value, currentPosition);
                currentPosition = currentPosition + 1 | 0;
                continue;
              }
              if (isNamePart(node.value.charCodeAt(currentPosition)) || node.value.charCodeAt(currentPosition) === 46 || (node.value.charCodeAt(currentPosition) === 38 && this.isMathML)) {
                if (node.value.charCodeAt(currentPosition) !== 38) {
                  value += String.fromCharCode(node.value.charCodeAt(currentPosition));
                  currentPosition = currentPosition + 1 | 0;
                }
                 else {
                  var specialSymbol_0 = readFromRemainingExpressionWhile(ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_5, node.value, currentPosition);
                  currentPosition = currentPosition + (specialSymbol_0.length + 1) | 0;
                  value += specialSymbol_0 + ';';
                }
              }
               else {
                var i = 0;
                while (i < value.length) {
                  var currentValue = StringBuilder_init();
                  var startI = i;
                  if (isDigit(value.charCodeAt(i)) || value.charCodeAt(i) === 46) {
                    while (i < value.length && (isDigit(value.charCodeAt(i)) || value.charCodeAt(i) === 46)) {
                      currentValue.append_s8itvh$(value.charCodeAt(i));
                      i = i + 1 | 0;
                    }
                    if (currentValue.length > 0)
                      actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$NAME_getInstance(), currentValue.toString(), node.startPosition + startPosition + startI | 0, node.startPosition + startPosition + i | 0));
                  }
                   else if (value.charCodeAt(i) === 38) {
                    var specialSymbol_1 = readFromRemainingExpressionWhile(ExpressionTreeParser$parseLeaveStringExpressionParts$lambda_6, value, i);
                    i = i + (specialSymbol_1.length + 1) | 0;
                    currentValue.append_gw00v9$(specialSymbol_1);
                    if (!startsWith_1(currentValue, '&#xA0'))
                      actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$NAME_getInstance(), currentValue.toString(), node.startPosition + startPosition + startI | 0, node.startPosition + startPosition + i | 0));
                  }
                   else {
                    while (i < value.length && value.charCodeAt(i) !== 46 && value.charCodeAt(i) !== 38) {
                      currentValue.append_s8itvh$(value.charCodeAt(i));
                      i = i + 1 | 0;
                    }
                    if (currentValue.length > 0)
                      actualParent.addChild_dsamor$(new MathMlTagTreeNode(MathMlTagTreeNode$Type$NAME_getInstance(), currentValue.toString(), node.startPosition + startPosition + startI | 0, node.startPosition + startPosition + i | 0));
                  }
                }
                break;
              }
            }
          }
           else {
            return new ParserError(node.startPosition + startPosition | 0, "Unexpected: '" + String.fromCharCode(toBoxedChar(node.value.charCodeAt(currentPosition))) + "'");
          }
          value = '';
        }
        if (newTreeActualParent_0.value.length > 0 && !isNewTexFunction && actualParent.children.size === 0) {
          newTreeActualParent_0.children.removeAt_za3lpa$(get_lastIndex(newTreeActualParent_0.children));
        }
      }
       else {
        if (this.isMathML && (equals(node.value, 'math') || equals(node.value, 'mn') || equals(node.value, 'mo') || equals(node.value, 'mi') || equals(node.value, 'mspace') || equals(node.value, 'mtext') || equals(node.value, 'mstack') || equals(node.value, 'maction')))
          node.value = '';
        if (!this.isMathML || !equals(node.value, 'mstyle')) {
          newTreeActualParent_0.addChild_dsamor$(node.copy_hdzj83$());
          state = ExpressionTreeParser$ParserState$NUMBER_READ_getInstance();
          var res = this.parseLeaveStringExpressionParts_0(node, last(newTreeActualParent_0.children));
          if (res != null)
            return res;
          if (last(newTreeActualParent_0.children).value.length === 0 && last(newTreeActualParent_0.children).children.isEmpty())
            newTreeActualParent_0.children.removeAt_za3lpa$(get_lastIndex(newTreeActualParent_0.children));
        }
         else {
          state = ExpressionTreeParser$ParserState$NUMBER_READ_getInstance();
          var res_0 = this.parseLeaveStringExpressionParts_0(node, newTreeActualParent_0);
          if (res_0 != null)
            return res_0;
        }
      }
      if (leavedActualParentExpectedArgumentsCount > 0 && !isNewTexFunction) {
        last(newTreeActualParent_0.children).texArgumentType = nextTexArgumentType;
        nextTexArgumentType = MathMlTagTreeNode$TexArgumentType$USUAL_getInstance();
        leavedActualParentExpectedArgumentsCount = leavedActualParentExpectedArgumentsCount - 1 | 0;
        if (leavedActualParentExpectedArgumentsCount === 0) {
          if (newTreeActualParent_0.parent != null) {
            newTreeActualParent_0 = ensureNotNull(newTreeActualParent_0.parent);
          }
           else {
            return new ParserError(node.startPosition + this.currentPosition_0 | 0, 'Expected for closing bracket');
          }
        }
      }
      nodeIndex = nodeIndex + 1 | 0;
    }
    return null;
  };
  ExpressionTreeParser.prototype.multipleFunctionsHandling_0 = function (oldTreeActualParent, newTreeActualParent, curIndex) {
    if (curIndex === void 0)
      curIndex = 0;
    var tmp$;
    var i = 0;
    var currentNewNode = null;
    if (oldTreeActualParent.type === MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance() && this.isMathMlMultipleTag_0(oldTreeActualParent.value, 0)) {
      var tmp$_0 = !oldTreeActualParent.children.isEmpty();
      if (tmp$_0) {
        tmp$_0 = !oldTreeActualParent.children.get_za3lpa$(0).children.isEmpty();
      }
      var tmp$_1 = tmp$_0;
      if (tmp$_1) {
        tmp$_1 = !isBlank(oldTreeActualParent.children.get_za3lpa$(0).children.get_za3lpa$(0).value);
      }
      if (tmp$_1 && !contains_1(oldTreeActualParent.toString(), 39)) {
        newTreeActualParent.value = newTreeActualParent.value + oldTreeActualParent.children.get_za3lpa$(0).children.get_za3lpa$(0).value;
        if (oldTreeActualParent.children.get_za3lpa$(0).children.size > 1) {
          var exprParent = new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), '', void 0, void 0, oldTreeActualParent.parent);
          tmp$ = oldTreeActualParent.children.get_za3lpa$(0).children.size;
          for (var j = 1; j < tmp$; j++) {
            exprParent.addChild_dsamor$(oldTreeActualParent.children.get_za3lpa$(0).children.get_za3lpa$(j));
          }
          ensureNotNull(oldTreeActualParent.parent).children.add_wxm5ur$(curIndex + 1 | 0, exprParent);
        }
        i = i + 1 | 0;
      }
       else if (equals(oldTreeActualParent.value, 'msubsup')) {
        newTreeActualParent.value = newTreeActualParent.value + last(oldTreeActualParent.children).children.get_za3lpa$(0).value;
        newTreeActualParent.type = MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance();
        oldTreeActualParent.children.removeAt_za3lpa$(get_lastIndex(oldTreeActualParent.children));
      }
    }
    while (i < oldTreeActualParent.children.size) {
      if (equals(oldTreeActualParent.children.get_za3lpa$(i).value, 'mfenced')) {
        oldTreeActualParent.children.get_za3lpa$(i).value = '';
      }
      var tmp$_2 = (i + 1 | 0) < oldTreeActualParent.children.size && equals(oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).value, 'msup') && oldTreeActualParent.children.get_za3lpa$(i).type === MathMlTagTreeNode$Type$NAME_getInstance();
      if (tmp$_2) {
        tmp$_2 = oldTreeActualParent.children.get_za3lpa$(i).value.length > 0;
      }
      var tmp$_3 = tmp$_2 && isLetterOrUnderscore(oldTreeActualParent.children.get_za3lpa$(i).value.charCodeAt(0)) && oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.get_za3lpa$(0).children.size > 0;
      if (tmp$_3) {
        tmp$_3 = oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.get_za3lpa$(0).value.length === 0;
      }
      var tmp$_4 = tmp$_3 && oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.get_za3lpa$(0).children.get_za3lpa$(0).type === MathMlTagTreeNode$Type$NAME_getInstance();
      if (tmp$_4) {
        tmp$_4 = oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.get_za3lpa$(0).children.get_za3lpa$(0).value.length > 0;
      }
      if (tmp$_4 && isLetterOrUnderscore(oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.get_za3lpa$(0).children.get_za3lpa$(0).value.charCodeAt(0))) {
        oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.get_za3lpa$(0).children.get_za3lpa$(0).value = oldTreeActualParent.children.get_za3lpa$(i).value + oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.get_za3lpa$(0).children.get_za3lpa$(0).value;
        i = i + 1 | 0;
        continue;
      }
      var newNode = oldTreeActualParent.children.get_za3lpa$(i).copy_hdzj83$();
      this.multipleFunctionsHandling_0(oldTreeActualParent.children.get_za3lpa$(i), newNode, i);
      if (oldTreeActualParent.children.get_za3lpa$(i).type === MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance() && this.isMathMlMultipleTag_0(oldTreeActualParent.children.get_za3lpa$(i).value, 0) && !contains_1(newNode.toString(), 39)) {
        if ((i + 1 | 0) >= oldTreeActualParent.children.size || oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).type === MathMlTagTreeNode$Type$OPERATION_getInstance())
          return new ParserError(oldTreeActualParent.children.get_za3lpa$(i).startPosition, 'data is not complete');
        if (currentNewNode == null) {
          newTreeActualParent.addChild_dsamor$(newNode);
        }
         else {
          currentNewNode.addChild_dsamor$(newNode);
        }
        currentNewNode = newNode;
      }
       else {
        if (currentNewNode == null) {
          newTreeActualParent.addChild_dsamor$(newNode);
        }
         else {
          currentNewNode.addChild_dsamor$(newNode);
        }
        currentNewNode = null;
      }
      i = i + 1 | 0;
    }
    return null;
  };
  ExpressionTreeParser.prototype.getExpressionParserNodeOperationType_0 = function (value, type) {
    return isUnarySignPart(value.charCodeAt(0)) || equals(type, StringDefinitionType$UNARY_LEFT_OPERATION_getInstance()) || equals(type, StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance()) ? ExpressionParserNode$Type$UNARY_OPERATION_getInstance() : ExpressionParserNode$Type$BINARY_OPERATION_getInstance();
  };
  ExpressionTreeParser.prototype.mathMlTreeToExpressionTree_0 = function (oldTreeActualParent, newTreeActualParent) {
    var tmp$, tmp$_0;
    var i = 0;
    loop_label: while (i < oldTreeActualParent.children.size) {
      if (equals(oldTreeActualParent.children.get_za3lpa$(i).value, '')) {
        if (i > 0 && oldTreeActualParent.children.get_za3lpa$(i - 1 | 0).type === MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance() && newTreeActualParent.children.size > 0 && last(newTreeActualParent.children).children.size > 0) {
          var possibleFunctionNode = last(newTreeActualParent.children).getFirstListNodeAfterFunction_6taknv$();
          if (possibleFunctionNode != null && possibleFunctionNode.type === ExpressionParserNode$Type$VARIABLE_getInstance()) {
            var functionDefinition = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(possibleFunctionNode.value, StringDefinitionType$FUNCTION_getInstance(), oldTreeActualParent.children.get_za3lpa$(i).children.size, this.nameForRuleDesignationsPossible);
            if (functionDefinition != null) {
              possibleFunctionNode.type = ExpressionParserNode$Type$FUNCTION_getInstance();
              possibleFunctionNode.functionStringDefinition = functionDefinition;
              possibleFunctionNode.endPosition = oldTreeActualParent.children.get_za3lpa$(i).endPosition;
              var res = this.mathMlTreeToExpressionTree_0(oldTreeActualParent.children.get_za3lpa$(i), possibleFunctionNode);
              if (res != null)
                return res;
              i = i + 1 | 0;
              continue loop_label;
            }
          }
        }
        newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), '', oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition));
        var res_0 = this.mathMlTreeToExpressionTree_0(oldTreeActualParent.children.get_za3lpa$(i), last(newTreeActualParent.children));
        if (res_0 != null)
          return res_0;
        i = i + 1 | 0;
        continue loop_label;
      }
       else if (equals(oldTreeActualParent.children.get_za3lpa$(i).value, 'msub')) {
        var mainValue = oldTreeActualParent.children.get_za3lpa$(i).children.get_za3lpa$(0).getNodeString();
        var subValue = oldTreeActualParent.children.get_za3lpa$(i).children.get_za3lpa$(1).getNodeString();
        var newValue = mainValue + ',' + subValue;
        if (isUnarySignPart(newValue.charCodeAt(0)) || isBinarySignPart(newValue.charCodeAt(0), this.isMathML) || this.isCompleteBinarySign_0(newValue, 0)) {
          var functionDefinition_0 = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(newValue, ensureNotNull(oldTreeActualParent.children.get_za3lpa$(i).stringDefinitionType), -1);
          if (functionDefinition_0 == null)
            return new ParserError(oldTreeActualParent.children.get_za3lpa$(i).startPosition, "Unknown operation: '" + newValue + "'");
          else
            newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(this.getExpressionParserNodeOperationType_0(newValue, null), functionDefinition_0.function.function, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition, void 0, void 0, functionDefinition_0));
        }
         else {
          var functionDefinition_1 = null;
          if ((i + 1 | 0) < oldTreeActualParent.children.size)
            functionDefinition_1 = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(newValue, StringDefinitionType$FUNCTION_getInstance(), oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.size, this.nameForRuleDesignationsPossible);
          if (functionDefinition_1 == null || !equals(oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).value, '')) {
            if ((i + 1 | 0) < oldTreeActualParent.children.size)
              functionDefinition_1 = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(mainValue, StringDefinitionType$FUNCTION_getInstance(), oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.size + 1 | 0, this.nameForRuleDesignationsPossible, true);
            if (functionDefinition_1 == null || !equals(oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).value, ''))
              newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$VARIABLE_getInstance(), newValue, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition, subValue));
            else {
              if (oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.isEmpty()) {
                oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).addChild_dsamor$(oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).copy_hdzj83$());
                oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).value = '';
                oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).type = MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance();
              }
              oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).addChild_dsamor$(oldTreeActualParent.children.get_za3lpa$(i).children.get_za3lpa$(1));
              newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), functionDefinition_1.function.function, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).endPosition, void 0, void 0, functionDefinition_1));
              i = i + 1 | 0;
              var res_1 = this.mathMlTreeToExpressionTree_0(oldTreeActualParent.children.get_za3lpa$(i), last(newTreeActualParent.children));
              if (res_1 != null)
                return res_1;
            }
          }
           else {
            newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), functionDefinition_1.function.function, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).endPosition, void 0, void 0, functionDefinition_1));
            i = i + 1 | 0;
            var res_2 = this.mathMlTreeToExpressionTree_0(oldTreeActualParent.children.get_za3lpa$(i), last(newTreeActualParent.children));
            if (res_2 != null)
              return res_2;
          }
        }
        i = i + 1 | 0;
        continue loop_label;
      }
       else if (oldTreeActualParent.children.get_za3lpa$(i).type === MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance()) {
        tmp$ = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(oldTreeActualParent.children.get_za3lpa$(i).value, StringDefinitionType$FUNCTION_getInstance(), oldTreeActualParent.children.get_za3lpa$(i).children.size, this.nameForRuleDesignationsPossible);
        if (tmp$ == null) {
          return new ParserError(oldTreeActualParent.children.get_za3lpa$(i).startPosition, "Unknown function: '" + oldTreeActualParent.children.get_za3lpa$(i).value + "' with '" + toString(oldTreeActualParent.children.get_za3lpa$(i).children.size) + "' arguments");
        }
        var functionDefinition_2 = tmp$;
        newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), functionDefinition_2.function.function, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition, void 0, void 0, functionDefinition_2));
        var res_3 = this.mathMlTreeToExpressionTree_0(oldTreeActualParent.children.get_za3lpa$(i), last(newTreeActualParent.children));
        if (res_3 != null)
          return res_3;
        i = i + 1 | 0;
        continue loop_label;
      }
       else if ((i + 1 | 0) < oldTreeActualParent.children.size && oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).type === MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance() && equals(oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).value, 'msub')) {
        var mainValue_0 = oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.get_za3lpa$(0).getNodeString();
        var functionDefinition_3 = null;
        if ((i + 2 | 0) < oldTreeActualParent.children.size) {
          functionDefinition_3 = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(mainValue_0, StringDefinitionType$FUNCTION_getInstance(), oldTreeActualParent.children.get_za3lpa$(i + 2 | 0).children.size + 1 | 0, this.nameForRuleDesignationsPossible, true);
          if (functionDefinition_3 != null) {
            newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$VARIABLE_getInstance(), oldTreeActualParent.children.get_za3lpa$(i).value, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition));
            if (oldTreeActualParent.children.get_za3lpa$(i + 2 | 0).children.isEmpty()) {
              oldTreeActualParent.children.get_za3lpa$(i + 2 | 0).addChild_dsamor$(oldTreeActualParent.children.get_za3lpa$(i + 2 | 0).copy_hdzj83$());
              oldTreeActualParent.children.get_za3lpa$(i + 2 | 0).value = '';
              oldTreeActualParent.children.get_za3lpa$(i + 2 | 0).type = MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance();
            }
            oldTreeActualParent.children.get_za3lpa$(i + 2 | 0).addChild_dsamor$(oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.get_za3lpa$(1));
            newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), functionDefinition_3.function.function, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i + 2 | 0).endPosition, void 0, void 0, functionDefinition_3));
            i = i + 2 | 0;
            var res_4 = this.mathMlTreeToExpressionTree_0(oldTreeActualParent.children.get_za3lpa$(i), last(newTreeActualParent.children));
            if (res_4 != null)
              return res_4;
            i = i + 1 | 0;
            continue loop_label;
          }
        }
        var iPlusOneTypeOperation = isUnarySignPart(mainValue_0.charCodeAt(0)) || isBinarySignPart(mainValue_0.charCodeAt(0), this.isMathML) || this.isCompleteBinarySign_0(mainValue_0, 0);
        var iTypeOperation = isUnarySignPart(oldTreeActualParent.children.get_za3lpa$(i).value.charCodeAt(0)) || isBinarySignPart(oldTreeActualParent.children.get_za3lpa$(i).value.charCodeAt(0), this.isMathML) || this.isCompleteBinarySign_0(oldTreeActualParent.children.get_za3lpa$(i).value, 0);
        if (iPlusOneTypeOperation === iTypeOperation) {
          var subValue_0 = oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).children.get_za3lpa$(1).getNodeString();
          var newValue_0 = oldTreeActualParent.children.get_za3lpa$(i).value + mainValue_0 + ',' + subValue_0;
          if (isUnarySignPart(newValue_0.charCodeAt(0)) || isBinarySignPart(newValue_0.charCodeAt(0), this.isMathML) || this.isCompleteBinarySign_0(newValue_0, 0)) {
            var functionDefinition_4 = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(newValue_0, ensureNotNull(oldTreeActualParent.children.get_za3lpa$(i).stringDefinitionType), -1);
            if (functionDefinition_4 == null)
              return new ParserError(oldTreeActualParent.children.get_za3lpa$(i).startPosition, "Unknown operation: '" + newValue_0 + "'");
            else
              newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(this.getExpressionParserNodeOperationType_0(newValue_0, null), functionDefinition_4.function.function, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).endPosition, void 0, void 0, functionDefinition_4));
          }
           else {
            var functionDefinition_5 = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(newValue_0, StringDefinitionType$FUNCTION_getInstance(), oldTreeActualParent.children.get_za3lpa$(i + 2 | 0).children.size, this.nameForRuleDesignationsPossible);
            if (functionDefinition_5 == null || (i + 2 | 0) >= oldTreeActualParent.children.size || !equals(oldTreeActualParent.children.get_za3lpa$(i + 2 | 0).value, ''))
              newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$VARIABLE_getInstance(), newValue_0, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).endPosition, subValue_0));
            else {
              newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), functionDefinition_5.function.function, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i + 2 | 0).endPosition, void 0, void 0, functionDefinition_5));
              i = i + 1 | 0;
              var res_5 = this.mathMlTreeToExpressionTree_0(oldTreeActualParent.children.get_za3lpa$(i + 2 | 0), last(newTreeActualParent.children));
              if (res_5 != null)
                return res_5;
            }
          }
          i = i + 1 | 0;
          continue loop_label;
        }
      }
      if (oldTreeActualParent.children.get_za3lpa$(i).type === MathMlTagTreeNode$Type$OPERATION_getInstance()) {
        var functionDefinition_6 = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(oldTreeActualParent.children.get_za3lpa$(i).value, ensureNotNull(oldTreeActualParent.children.get_za3lpa$(i).stringDefinitionType), ensureNotNull(oldTreeActualParent.children.get_za3lpa$(i).stringDefinitionType) === StringDefinitionType$BINARY_OPERATION_getInstance() ? -1 : 1);
        if (functionDefinition_6 == null)
          return new ParserError(oldTreeActualParent.children.get_za3lpa$(i).startPosition, "Unknown operation: '" + oldTreeActualParent.children.get_za3lpa$(i).value + "'");
        else if (i === get_lastIndex(oldTreeActualParent.children) && ensureNotNull(oldTreeActualParent.children.get_za3lpa$(i).stringDefinitionType) !== StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance()) {
          return new ParserError(oldTreeActualParent.children.get_za3lpa$(i).startPosition, "Operation: '" + oldTreeActualParent.children.get_za3lpa$(i).value + "' is not right unary");
        }
         else
          newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(this.getExpressionParserNodeOperationType_0(oldTreeActualParent.children.get_za3lpa$(i).value, oldTreeActualParent.children.get_za3lpa$(i).stringDefinitionType), functionDefinition_6.function.function, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition, void 0, void 0, functionDefinition_6));
        i = i + 1 | 0;
        continue loop_label;
      }
       else if (oldTreeActualParent.children.get_za3lpa$(i).type === MathMlTagTreeNode$Type$NAME_getInstance() || oldTreeActualParent.children.get_za3lpa$(i).children.isEmpty()) {
        if (startsWith(oldTreeActualParent.children.get_za3lpa$(i).value, '&')) {
          var functionDefinition_7 = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(oldTreeActualParent.children.get_za3lpa$(i).value, StringDefinitionType$BINARY_OPERATION_getInstance(), -1);
          if (functionDefinition_7 == null)
            functionDefinition_7 = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(oldTreeActualParent.children.get_za3lpa$(i).value, StringDefinitionType$UNARY_LEFT_OPERATION_getInstance(), 1);
          else {
            newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$BINARY_OPERATION_getInstance(), functionDefinition_7.function.function, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition, void 0, void 0, functionDefinition_7));
            i = i + 1 | 0;
            continue loop_label;
          }
          if (functionDefinition_7 != null) {
            newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$UNARY_OPERATION_getInstance(), functionDefinition_7.function.function, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition, void 0, void 0, functionDefinition_7));
            i = i + 1 | 0;
            continue loop_label;
          }
        }
        if ((i + 1 | 0) >= oldTreeActualParent.children.size || !equals(oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).value, ''))
          newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$VARIABLE_getInstance(), oldTreeActualParent.children.get_za3lpa$(i).value, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition));
        else {
          var newParentNode = new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), '');
          var res_6 = this.mathMlTreeToExpressionTree_0(oldTreeActualParent.children.get_za3lpa$(i + 1 | 0), newParentNode);
          if (res_6 != null)
            return res_6;
          var functionDefinition_8 = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(oldTreeActualParent.children.get_za3lpa$(i).value, StringDefinitionType$FUNCTION_getInstance(), newParentNode.children.size, this.nameForRuleDesignationsPossible);
          if (functionDefinition_8 == null)
            newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$VARIABLE_getInstance(), oldTreeActualParent.children.get_za3lpa$(i).value, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition));
          else {
            newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), functionDefinition_8.function.function, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i + 1 | 0).endPosition, void 0, void 0, functionDefinition_8));
            var res_7 = this.mathMlTreeToExpressionTree_0(oldTreeActualParent.children.get_za3lpa$(i + 1 | 0), last(newTreeActualParent.children));
            if (res_7 != null)
              return res_7;
            i = i + 1 | 0;
          }
        }
        i = i + 1 | 0;
        continue loop_label;
      }
       else {
        tmp$_0 = this.functionConfiguration.findFunctionStringDefinition_7zakv9$(oldTreeActualParent.children.get_za3lpa$(i).value, StringDefinitionType$FUNCTION_getInstance(), oldTreeActualParent.children.get_za3lpa$(i).children.size, this.nameForRuleDesignationsPossible);
        if (tmp$_0 == null) {
          return new ParserError(oldTreeActualParent.children.get_za3lpa$(i).startPosition, "Unknown function: '" + oldTreeActualParent.children.get_za3lpa$(i).value + "' with '" + toString(oldTreeActualParent.children.get_za3lpa$(i).children.size) + "' arguments");
        }
        var functionDefinition_9 = tmp$_0;
        var tmp$_1 = functionDefinition_9.powSeparatedAsPow;
        if (tmp$_1) {
          var $receiver = oldTreeActualParent.children.get_za3lpa$(i).children;
          var any$result;
          any$break: do {
            var tmp$_2;
            if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
              any$result = false;
              break any$break;
            }
            tmp$_2 = $receiver.iterator();
            while (tmp$_2.hasNext()) {
              var element = tmp$_2.next();
              if (element.texArgumentType === MathMlTagTreeNode$TexArgumentType$POW_getInstance()) {
                any$result = true;
                break any$break;
              }
            }
            any$result = false;
          }
           while (false);
          tmp$_1 = any$result;
        }
        if (tmp$_1) {
          newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), '^', oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition, void 0, void 0, ensureNotNull(this.functionConfiguration.fastFindStringDefinitionByNameAndNumberOfArguments_bm4lxs$('^', -1))));
          var $receiver_0 = oldTreeActualParent.children.get_za3lpa$(i).children;
          var indexOfFirst$result;
          indexOfFirst$break: do {
            var tmp$_3;
            var index = 0;
            tmp$_3 = $receiver_0.iterator();
            while (tmp$_3.hasNext()) {
              var item = tmp$_3.next();
              if (item.texArgumentType === MathMlTagTreeNode$TexArgumentType$POW_getInstance()) {
                indexOfFirst$result = index;
                break indexOfFirst$break;
              }
              index = index + 1 | 0;
            }
            indexOfFirst$result = -1;
          }
           while (false);
          var powIndex = indexOfFirst$result;
          var pow = new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), '', oldTreeActualParent.children.get_za3lpa$(i).children.get_za3lpa$(powIndex).startPosition, oldTreeActualParent.children.get_za3lpa$(i).children.get_za3lpa$(powIndex).endPosition);
          pow.addChild_dsamor$(oldTreeActualParent.children.get_za3lpa$(i).children.get_za3lpa$(powIndex));
          oldTreeActualParent.children.get_za3lpa$(i).children.removeAt_za3lpa$(powIndex);
          var currentFunctionParent = new MathMlTagTreeNode(MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance(), '', oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition);
          currentFunctionParent.addChild_dsamor$(oldTreeActualParent.children.get_za3lpa$(i));
          var res_8 = this.mathMlTreeToExpressionTree_0(currentFunctionParent, last(newTreeActualParent.children));
          if (res_8 != null)
            return res_8;
          res_8 = this.mathMlTreeToExpressionTree_0(pow, last(newTreeActualParent.children));
          if (res_8 != null)
            return res_8;
        }
         else {
          newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$FUNCTION_getInstance(), functionDefinition_9.function.function, oldTreeActualParent.children.get_za3lpa$(i).startPosition, oldTreeActualParent.children.get_za3lpa$(i).endPosition, void 0, void 0, functionDefinition_9));
          if (functionDefinition_9.underlinedAsLast) {
            var $receiver_1 = oldTreeActualParent.children.get_za3lpa$(i).children;
            var indexOfFirst$result_0;
            indexOfFirst$break: do {
              var tmp$_4;
              var index_0 = 0;
              tmp$_4 = $receiver_1.iterator();
              while (tmp$_4.hasNext()) {
                var item_0 = tmp$_4.next();
                if (item_0.texArgumentType === MathMlTagTreeNode$TexArgumentType$UNDERLINED_getInstance()) {
                  indexOfFirst$result_0 = index_0;
                  break indexOfFirst$break;
                }
                index_0 = index_0 + 1 | 0;
              }
              indexOfFirst$result_0 = -1;
            }
             while (false);
            var underlinedIndex = indexOfFirst$result_0;
            swap(oldTreeActualParent.children.get_za3lpa$(i).children, underlinedIndex, get_lastIndex(oldTreeActualParent.children.get_za3lpa$(i).children));
          }
          var res_9 = this.mathMlTreeToExpressionTree_0(oldTreeActualParent.children.get_za3lpa$(i), last(newTreeActualParent.children));
          if (res_9 != null)
            return res_9;
        }
        i = i + 1 | 0;
        continue loop_label;
      }
    }
    return null;
  };
  ExpressionTreeParser.prototype.isCompleteBinarySign_0 = function (value, currentPosition) {
    var $receiver = this.completeBinarySigns_0;
    var any$result;
    any$break: do {
      var tmp$;
      if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
        any$result = false;
        break any$break;
      }
      tmp$ = $receiver.iterator();
      while (tmp$.hasNext()) {
        var element = tmp$.next();
        if (remainingExpressionStartsWith(element, value, currentPosition)) {
          any$result = true;
          break any$break;
        }
      }
      any$result = false;
    }
     while (false);
    return any$result;
  };
  ExpressionTreeParser.prototype.getCompleteSign_0 = function (value, currentPosition) {
    var tmp$, tmp$_0;
    tmp$ = this.completeBinarySigns_0.iterator();
    while (tmp$.hasNext()) {
      var sign = tmp$.next();
      if (remainingExpressionStartsWith(sign, value, currentPosition)) {
        return new Pair(sign, StringDefinitionType$BINARY_OPERATION_getInstance());
      }
    }
    tmp$_0 = this.functionConfiguration.slashToSpaceDefinitions.iterator();
    while (tmp$_0.hasNext()) {
      var sign_0 = tmp$_0.next();
      if (remainingExpressionStartsWith(sign_0.first, value, currentPosition)) {
        return sign_0;
      }
    }
    return null;
  };
  ExpressionTreeParser.prototype.getTexFunction_0 = function (value, currentPosition) {
    var tmp$;
    tmp$ = this.functionConfiguration.slashToSpaceFunctionDefinitions.iterator();
    while (tmp$.hasNext()) {
      var function_0 = tmp$.next();
      if (remainingExpressionStartsWith(function_0.first, value, currentPosition)) {
        return function_0;
      }
    }
    return null;
  };
  ExpressionTreeParser.prototype.addMultiplications_0 = function (oldTreeActualParent, newTreeActualParent) {
    if (oldTreeActualParent.children.size === 0)
      return null;
    var i = 0;
    if (oldTreeActualParent.value.length > 0)
      while (i < oldTreeActualParent.children.size) {
        newTreeActualParent.addChild_amp9w1$(oldTreeActualParent.children.get_za3lpa$(i).copy_i0rkrg$());
        var res = this.addMultiplications_0(oldTreeActualParent.children.get_za3lpa$(i), newTreeActualParent.children.get_za3lpa$(i));
        if (res != null)
          return res;
        i = i + 1 | 0;
      }
     else {
      newTreeActualParent.addChild_amp9w1$(oldTreeActualParent.children.get_za3lpa$(0).copy_i0rkrg$());
      var res_0 = this.addMultiplications_0(oldTreeActualParent.children.get_za3lpa$(0), newTreeActualParent.children.get_za3lpa$(0));
      if (res_0 != null)
        return res_0;
      i = i + 1 | 0;
      while (i < oldTreeActualParent.children.size) {
        if (oldTreeActualParent.children.get_za3lpa$(i).type !== ExpressionParserNode$Type$BINARY_OPERATION_getInstance() && oldTreeActualParent.children.get_za3lpa$(i - 1 | 0).type !== ExpressionParserNode$Type$BINARY_OPERATION_getInstance()) {
          newTreeActualParent.addChild_amp9w1$(new ExpressionParserNode(ExpressionParserNode$Type$BINARY_OPERATION_getInstance(), '*', oldTreeActualParent.children.get_za3lpa$(i).startPosition - 1 | 0, oldTreeActualParent.children.get_za3lpa$(i).startPosition, void 0, void 0, this.functionConfiguration.findFunctionStringDefinition_7zakv9$('*', StringDefinitionType$BINARY_OPERATION_getInstance(), -1)));
        }
         else if (oldTreeActualParent.children.get_za3lpa$(i).type === ExpressionParserNode$Type$BINARY_OPERATION_getInstance() && oldTreeActualParent.children.get_za3lpa$(i - 1 | 0).type === ExpressionParserNode$Type$BINARY_OPERATION_getInstance())
          return new ParserError(oldTreeActualParent.children.get_za3lpa$(i).startPosition, "Unexpected binary operation '" + ensureNotNull(oldTreeActualParent.children.get_za3lpa$(i).functionStringDefinition).definition + "'");
        newTreeActualParent.addChild_amp9w1$(oldTreeActualParent.children.get_za3lpa$(i).copy_i0rkrg$());
        var res_1 = this.addMultiplications_0(oldTreeActualParent.children.get_za3lpa$(i), last(newTreeActualParent.children));
        if (res_1 != null)
          return res_1;
        i = i + 1 | 0;
      }
    }
    return null;
  };
  ExpressionTreeParser.prototype.combineUnary_0 = function (oldTreeActualParent, newTreeActualParent) {
    if (oldTreeActualParent.children.size === 0)
      return null;
    var i = 0;
    var state = ExpressionTreeParser$TokenParserState$BINARY_OPERATION_getInstance();
    var currentBottomToken = null;
    while (i < oldTreeActualParent.children.size) {
      var node = oldTreeActualParent.children.get_za3lpa$(i).copy_i0rkrg$();
      if (oldTreeActualParent.children.get_za3lpa$(i).type === ExpressionParserNode$Type$VARIABLE_getInstance() || oldTreeActualParent.children.get_za3lpa$(i).type === ExpressionParserNode$Type$FUNCTION_getInstance()) {
        state = ExpressionTreeParser$TokenParserState$NAME_getInstance();
        if (currentBottomToken != null) {
          currentBottomToken.addChild_amp9w1$(node);
          currentBottomToken = node;
        }
         else
          newTreeActualParent.addChild_amp9w1$(node);
        var res = this.combineUnary_0(oldTreeActualParent.children.get_za3lpa$(i), node);
        if (res != null)
          return res;
      }
       else if (oldTreeActualParent.children.get_za3lpa$(i).type === ExpressionParserNode$Type$BINARY_OPERATION_getInstance()) {
        state = ExpressionTreeParser$TokenParserState$BINARY_OPERATION_getInstance();
        currentBottomToken = null;
        newTreeActualParent.addChild_amp9w1$(node);
      }
       else if (oldTreeActualParent.children.get_za3lpa$(i).type === ExpressionParserNode$Type$UNARY_OPERATION_getInstance()) {
        if (state === ExpressionTreeParser$TokenParserState$BINARY_OPERATION_getInstance()) {
          if (currentBottomToken == null) {
            newTreeActualParent.addChild_amp9w1$(node);
            currentBottomToken = node;
          }
           else {
            currentBottomToken.addChild_amp9w1$(node);
            currentBottomToken = node;
          }
        }
         else {
          if (currentBottomToken == null) {
            currentBottomToken = node;
            var lastElement = last(newTreeActualParent.children);
            newTreeActualParent.children.removeAt_za3lpa$(get_lastIndex(newTreeActualParent.children));
            node.addChild_amp9w1$(lastElement);
            newTreeActualParent.addChild_amp9w1$(node);
          }
           else {
            var parent = ensureNotNull(currentBottomToken.parent);
            node.addChild_amp9w1$(currentBottomToken);
            parent.children.removeAt_za3lpa$(get_lastIndex(parent.children));
            parent.addChild_amp9w1$(node);
            currentBottomToken = node;
          }
        }
      }
      i = i + 1 | 0;
    }
    return null;
  };
  ExpressionTreeParser.prototype.resolveBinaryOperations_0 = function (actualParent) {
    while (true) {
      var minPriority = actualParent.getMinPriorityOfBinaryOperationsWithoutOperands();
      if (minPriority === kotlin_js_internal_DoubleCompanionObject.MAX_VALUE)
        break;
      actualParent.resolveBinaryOperationsWithPriorityRecursive_z18lgg$(minPriority, this.functionConfiguration);
    }
  };
  ExpressionTreeParser.prototype.toExpressionTree_0 = function (oldTreeActualParent, newTreeActualParent) {
    var tmp$;
    var oldChildren = ArrayList_init();
    oldTreeActualParent.getNonEmptyChildren_mnxts8$(oldChildren);
    tmp$ = oldChildren.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      if (child.type === ExpressionParserNode$Type$VARIABLE_getInstance()) {
        newTreeActualParent.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), child.value, child.startPosition, child.endPosition, child.subValue, newTreeActualParent));
      }
       else {
        newTreeActualParent.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), child.value, child.startPosition, child.endPosition, child.subValue, newTreeActualParent, child.functionStringDefinition));
        this.toExpressionTree_0(child, last(newTreeActualParent.children));
      }
    }
  };
  ExpressionTreeParser.prototype.isComplicatedTag_0 = function (expression, currentPosition) {
    if (expression === void 0)
      expression = this.expression;
    if (currentPosition === void 0)
      currentPosition = this.currentPosition_0;
    return remainingExpressionStartsWith('<', expression, currentPosition) && (!(remainingExpressionStartsWith('<mo', expression, currentPosition) || remainingExpressionStartsWith('<mi', expression, currentPosition) || remainingExpressionStartsWith('<mn', expression, currentPosition) || remainingExpressionStartsWith('<\/mo', expression, currentPosition) || remainingExpressionStartsWith('<\/mi', expression, currentPosition) || remainingExpressionStartsWith('<\/mn', expression, currentPosition)) || remainingExpressionStartsWith('<minus', expression, currentPosition) || remainingExpressionStartsWith('<mover', expression, currentPosition) || remainingExpressionStartsWith('<\/minus', expression, currentPosition) || remainingExpressionStartsWith('<\/mover', expression, currentPosition));
  };
  ExpressionTreeParser.prototype.isMathMlMultipleTag_0 = function (expression, currentPosition) {
    if (expression === void 0)
      expression = this.expression;
    if (currentPosition === void 0)
      currentPosition = this.currentPosition_0;
    return remainingExpressionStartsWith('munderover', expression, currentPosition) || remainingExpressionStartsWith('msubsup', expression, currentPosition);
  };
  ExpressionTreeParser.prototype.isTexMultipleTag_0 = function (expression, currentPosition) {
    if (expression === void 0)
      expression = this.expression;
    if (currentPosition === void 0)
      currentPosition = this.currentPosition_0;
    return remainingExpressionStartsWith('\\sum', expression, currentPosition) || remainingExpressionStartsWith('\\prod', expression, currentPosition);
  };
  function ExpressionTreeParser$Companion() {
    ExpressionTreeParser$Companion_instance = this;
    this.mathMlTags = listOf_0(['mfenced', 'mfenced_|__|', 'mfrac', 'mi', 'minus', 'mn', 'mo', 'mover', 'mroot', 'msqrt', 'msub', 'msubsup', 'msup', 'munderover']);
  }
  ExpressionTreeParser$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var ExpressionTreeParser$Companion_instance = null;
  function ExpressionTreeParser$Companion_getInstance() {
    if (ExpressionTreeParser$Companion_instance === null) {
      new ExpressionTreeParser$Companion();
    }
    return ExpressionTreeParser$Companion_instance;
  }
  ExpressionTreeParser.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionTreeParser',
    interfaces: []
  };
  function ExpressionTreeAnalyzer(analyzingExpression) {
    this.analyzingExpression_0 = analyzingExpression;
    this.expressionDimension_0 = this.analyzingExpression_0.getVariableNames().size;
    this.functionByName_0 = mapOf_0([to('', ExpressionTreeAnalyzer$functionByName$lambda(this)), to('+', ExpressionTreeAnalyzer$functionByName$lambda_0(this)), to('*', ExpressionTreeAnalyzer$functionByName$lambda_1(this)), to('-', ExpressionTreeAnalyzer$functionByName$lambda_2(this)), to('/', ExpressionTreeAnalyzer$functionByName$lambda_3(this)), to('^', ExpressionTreeAnalyzer$functionByName$lambda_4(this)), to('mod', ExpressionTreeAnalyzer$functionByName$lambda_5(this)), to('S', ExpressionTreeAnalyzer$functionByName$lambda_6(this)), to('P', ExpressionTreeAnalyzer$functionByName$lambda_7(this)), to('and', ExpressionTreeAnalyzer$functionByName$lambda_8(this)), to('or', ExpressionTreeAnalyzer$functionByName$lambda_9(this)), to('xor', ExpressionTreeAnalyzer$functionByName$lambda_10(this)), to('alleq', ExpressionTreeAnalyzer$functionByName$lambda_11(this)), to('not', ExpressionTreeAnalyzer$functionByName$lambda_12(this)), to('sin', ExpressionTreeAnalyzer$functionByName$lambda_13(this)), to('cos', ExpressionTreeAnalyzer$functionByName$lambda_14(this)), to('sh', ExpressionTreeAnalyzer$functionByName$lambda_15(this)), to('ch', ExpressionTreeAnalyzer$functionByName$lambda_16(this)), to('tg', ExpressionTreeAnalyzer$functionByName$lambda_17(this)), to('th', ExpressionTreeAnalyzer$functionByName$lambda_18(this)), to('asin', ExpressionTreeAnalyzer$functionByName$lambda_19(this)), to('acos', ExpressionTreeAnalyzer$functionByName$lambda_20(this)), to('atg', ExpressionTreeAnalyzer$functionByName$lambda_21(this)), to('exp', ExpressionTreeAnalyzer$functionByName$lambda_22(this)), to('ln', ExpressionTreeAnalyzer$functionByName$lambda_23(this)), to('abs', ExpressionTreeAnalyzer$functionByName$lambda_24(this))]);
  }
  ExpressionTreeAnalyzer.prototype.findDomain = function () {
    return this.findDomain_0(this.analyzingExpression_0, LineSegmentHolder$Companion_getInstance().fullSegment);
  };
  ExpressionTreeAnalyzer.prototype.findDomain_0 = function (expression, possibleValues) {
    return this.findDomain_1(expression, listOf(possibleValues));
  };
  ExpressionTreeAnalyzer.prototype.findDomain_1 = function (expression, possibleValues) {
    return ensureNotNull(this.functionByName_0.get_11rb$(expression.value))(expression, possibleValues);
  };
  ExpressionTreeAnalyzer.prototype.plusDomain_0 = function (expression, possibleValues) {
    var tmp$;
    var childrenDomains = this.calculateChildrenDomains_0(expression, LineSegmentHolder$Companion_getInstance().fullSegment);
    tmp$ = childrenDomains.iterator();
    while (tmp$.hasNext()) {
      var domain = tmp$.next();
      if (domain.isEmpty()) {
        return domain;
      }
    }
    return CageHolder$Companion_getInstance().domainIntersection_p7f0kx$(childrenDomains, this.expressionDimension_0);
  };
  ExpressionTreeAnalyzer.prototype.minusDomain_0 = function (expression, possibleValues) {
    var tmp$;
    var childrenDomains = this.calculateChildrenDomains_0(expression, LineSegmentHolder$Companion_getInstance().fullSegment);
    tmp$ = childrenDomains.iterator();
    while (tmp$.hasNext()) {
      var domain = tmp$.next();
      if (domain.isEmpty()) {
        return domain;
      }
    }
    return CageHolder$Companion_getInstance().domainIntersection_p7f0kx$(childrenDomains, this.expressionDimension_0);
  };
  ExpressionTreeAnalyzer.prototype.mulDomain_0 = function (expression, possibleValues) {
    var tmp$;
    var childrenDomains = this.calculateChildrenDomains_0(expression, LineSegmentHolder$Companion_getInstance().fullSegment);
    tmp$ = childrenDomains.iterator();
    while (tmp$.hasNext()) {
      var domain = tmp$.next();
      if (domain.isEmpty()) {
        return domain;
      }
    }
    return CageHolder$Companion_getInstance().domainIntersection_p7f0kx$(childrenDomains, this.expressionDimension_0);
  };
  ExpressionTreeAnalyzer.prototype.divDomain_0 = function (expression, possibleValues) {
    var tmp$;
    var childrenDomains = this.calculateChildrenDomains_0(expression, LineSegmentHolder$Companion_getInstance().fullSegment);
    tmp$ = childrenDomains.iterator();
    while (tmp$.hasNext()) {
      var domain = tmp$.next();
      if (domain.isEmpty()) {
        return domain;
      }
    }
    return CageHolder$Companion_getInstance().domainIntersection_p7f0kx$(childrenDomains, this.expressionDimension_0);
  };
  ExpressionTreeAnalyzer.prototype.bracketsDomain_0 = function (expression, possibleValues) {
    return this.findDomain_1(expression.children.get_za3lpa$(0), possibleValues);
  };
  ExpressionTreeAnalyzer.prototype.modDomain_0 = function (expression, possibleValues) {
    var tmp$;
    var childrenDomains = this.calculateChildrenDomains_0(expression, LineSegmentHolder$Companion_getInstance().fullSegment);
    tmp$ = childrenDomains.iterator();
    while (tmp$.hasNext()) {
      var domain = tmp$.next();
      if (domain.isEmpty()) {
        return domain;
      }
    }
    return CageHolder$Companion_getInstance().domainIntersection_p7f0kx$(childrenDomains, this.expressionDimension_0);
  };
  ExpressionTreeAnalyzer.prototype.powDomain_0 = function (expression, possibleValues) {
    var tmp$;
    if (this.allSegmentsSubzero_0(possibleValues)) {
      return CageHolder$Companion_getInstance().emptyCageHolder_za3lpa$(this.expressionDimension_0);
    }
    var childrenDomains = ArrayList_init();
    tmp$ = childrenDomains.size - 1 | 0;
    for (var i = 0; i < tmp$; i++) {
      var domain = this.findDomain_0(expression.children.get_za3lpa$(i), LineSegmentHolder$Companion_getInstance().positiveSegment);
      if (domain.isEmpty()) {
        return domain;
      }
    }
    var lastChildDomain = this.findDomain_0(last(expression.children), LineSegmentHolder$Companion_getInstance().fullSegment);
    childrenDomains.add_11rb$(lastChildDomain);
    return CageHolder$Companion_getInstance().domainIntersection_p7f0kx$(childrenDomains, this.expressionDimension_0);
  };
  ExpressionTreeAnalyzer.prototype.sumNDomain_0 = function (expression, possibleValues) {
    throw new NotImplementedError_init('An operation is not implemented: ' + 'should be unfolded first');
  };
  ExpressionTreeAnalyzer.prototype.prodNDomain_0 = function (expression, possibleValues) {
    throw new NotImplementedError_init('An operation is not implemented: ' + 'should be unfolded first');
  };
  ExpressionTreeAnalyzer.prototype.andDomain_0 = function (expression, possibleValues) {
    var tmp$;
    if (this.pointInSegments_0(possibleValues, 1.0)) {
      throw new NotImplementedError_init('An operation is not implemented: ' + 'One of children should be equal to 0');
    }
    var childrenDomains = this.calculateChildrenDomains_0(expression, LineSegmentHolder$Companion_getInstance().fullSegment);
    tmp$ = childrenDomains.iterator();
    while (tmp$.hasNext()) {
      var domain = tmp$.next();
      if (domain.isEmpty()) {
        return domain;
      }
    }
    return CageHolder$Companion_getInstance().domainIntersection_p7f0kx$(childrenDomains, this.expressionDimension_0);
  };
  ExpressionTreeAnalyzer.prototype.orDomain_0 = function (expression, possibleValues) {
    var tmp$;
    if (this.pointInSegments_0(possibleValues, 1.0)) {
      throw new NotImplementedError_init('An operation is not implemented: ' + 'All children should be equal to 0');
    }
    var childrenDomains = this.calculateChildrenDomains_0(expression, LineSegmentHolder$Companion_getInstance().fullSegment);
    tmp$ = childrenDomains.iterator();
    while (tmp$.hasNext()) {
      var domain = tmp$.next();
      if (domain.isEmpty()) {
        return domain;
      }
    }
    return CageHolder$Companion_getInstance().domainIntersection_p7f0kx$(childrenDomains, this.expressionDimension_0);
  };
  ExpressionTreeAnalyzer.prototype.xorDomain_0 = function (expression, possibleValues) {
    var tmp$;
    if (this.pointInSegments_0(possibleValues, 0.0)) {
      throw new NotImplementedError_init('An operation is not implemented: ' + 'All children should be equal to 0');
    }
    var childrenDomains = this.calculateChildrenDomains_0(expression, LineSegmentHolder$Companion_getInstance().fullSegment);
    tmp$ = childrenDomains.iterator();
    while (tmp$.hasNext()) {
      var domain = tmp$.next();
      if (domain.isEmpty()) {
        return domain;
      }
    }
    return CageHolder$Companion_getInstance().domainIntersection_p7f0kx$(childrenDomains, this.expressionDimension_0);
  };
  ExpressionTreeAnalyzer.prototype.alleqDomain_0 = function (expression, possibleValues) {
    throw new NotImplementedError_init('An operation is not implemented: ' + 'No ideas, infinitely small domain');
  };
  ExpressionTreeAnalyzer.prototype.notDomain_0 = function (expression, possibleValues) {
    if (this.pointInSegments_0(possibleValues, 0.0)) {
      throw new NotImplementedError_init('An operation is not implemented: ' + 'Child should be equal to 0');
    }
    return this.findDomain_0(expression.children.get_za3lpa$(0), LineSegmentHolder$Companion_getInstance().fullSegment);
  };
  ExpressionTreeAnalyzer.prototype.sinDomain_0 = function (expression, possibleValues) {
    if (this.fullyContains_0(new LineSegmentHolder(0.0, 1.0), possibleValues)) {
      return this.findDomain_0(expression.children.get_za3lpa$(0), LineSegmentHolder$Companion_getInstance().fullSegment);
    }
    throw new NotImplementedError_init('An operation is not implemented: ' + 'Problems with periodicity');
  };
  ExpressionTreeAnalyzer.prototype.cosDomain_0 = function (expression, possibleValues) {
    if (this.fullyContains_0(new LineSegmentHolder(0.0, 1.0), possibleValues)) {
      return this.findDomain_0(expression.children.get_za3lpa$(0), LineSegmentHolder$Companion_getInstance().fullSegment);
    }
    throw new NotImplementedError_init('An operation is not implemented: ' + 'Problems with periodicity');
  };
  ExpressionTreeAnalyzer.prototype.tanDomain_0 = function (expression, possibleValues) {
    throw new NotImplementedError_init('An operation is not implemented: ' + 'Problems with periodicity');
  };
  ExpressionTreeAnalyzer.prototype.sinhDomain_0 = function (expression, possibleValues) {
    throw new NotImplementedError_init('An operation is not implemented: ' + 'Unclear how to do');
  };
  ExpressionTreeAnalyzer.prototype.coshDomain_0 = function (expression, possibleValues) {
    if (this.allSegmentsSubzero_0(possibleValues)) {
      return CageHolder$Companion_getInstance().emptyCageHolder_za3lpa$(this.expressionDimension_0);
    }
    throw new NotImplementedError_init('An operation is not implemented: ' + 'Unclear how to do');
  };
  ExpressionTreeAnalyzer.prototype.tanhDomain_0 = function (expression, possibleValues) {
    throw new NotImplementedError_init('An operation is not implemented: ' + 'Absolutely unclear how to do');
  };
  ExpressionTreeAnalyzer.prototype.asinDomain_0 = function (expression, possibleValues) {
    if (this.emptyIntersection_0(new LineSegmentHolder(-math.PI / 2, math.PI / 2), possibleValues)) {
      return CageHolder$Companion_getInstance().emptyCageHolder_za3lpa$(this.expressionDimension_0);
    }
    if (this.fullyContains_0(new LineSegmentHolder(-math.PI / 2, math.PI / 2), possibleValues)) {
      return this.findDomain_0(expression.children.get_za3lpa$(0), new LineSegmentHolder(0.0, 1.0));
    }
    throw new NotImplementedError_init('An operation is not implemented: ' + 'Not so hard');
  };
  ExpressionTreeAnalyzer.prototype.acosDomain_0 = function (expression, possibleValues) {
    if (this.emptyIntersection_0(new LineSegmentHolder(0.0, math.PI), possibleValues)) {
      return CageHolder$Companion_getInstance().emptyCageHolder_za3lpa$(this.expressionDimension_0);
    }
    if (this.fullyContains_0(new LineSegmentHolder(0.0, math.PI), possibleValues)) {
      return this.findDomain_0(expression.children.get_za3lpa$(0), new LineSegmentHolder(0.0, 1.0));
    }
    throw new NotImplementedError_init('An operation is not implemented: ' + 'Not so hard');
  };
  ExpressionTreeAnalyzer.prototype.atanDomain_0 = function (expression, possibleValues) {
    if (this.emptyIntersection_0(new LineSegmentHolder(-math.PI / 2, math.PI / 2), possibleValues)) {
      return CageHolder$Companion_getInstance().emptyCageHolder_za3lpa$(this.expressionDimension_0);
    }
    if (this.fullyContains_0(new LineSegmentHolder(-math.PI / 2, math.PI / 2), possibleValues)) {
      return this.findDomain_0(expression.children.get_za3lpa$(0), new LineSegmentHolder(0.0, 1.0));
    }
    throw new NotImplementedError_init('An operation is not implemented: ' + 'Not so hard');
  };
  ExpressionTreeAnalyzer.prototype.expDomain_0 = function (expression, possibleValues) {
    if (this.allSegmentsSubzero_0(possibleValues)) {
      return CageHolder$Companion_getInstance().emptyCageHolder_za3lpa$(this.expressionDimension_0);
    }
    throw new NotImplementedError_init('An operation is not implemented: ' + 'Not so hard');
  };
  ExpressionTreeAnalyzer.prototype.lnDomain_0 = function (expression, possibleValues) {
    throw new NotImplementedError_init('An operation is not implemented: ' + 'Not so hard');
  };
  ExpressionTreeAnalyzer.prototype.absDomain_0 = function (expression, possibleValues) {
    if (this.allSegmentsSubzero_0(possibleValues)) {
      return CageHolder$Companion_getInstance().emptyCageHolder_za3lpa$(this.expressionDimension_0);
    }
    throw new NotImplementedError_init('An operation is not implemented: ' + 'Not so hard');
  };
  ExpressionTreeAnalyzer.prototype.calculateChildrenDomains_0 = function (expression, segment) {
    var tmp$;
    var childrenDomains = ArrayList_init();
    tmp$ = expression.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      childrenDomains.add_11rb$(this.findDomain_0(child, segment));
    }
    return childrenDomains;
  };
  ExpressionTreeAnalyzer.prototype.pointInSegments_0 = function (possibleValues, point) {
    var tmp$;
    tmp$ = possibleValues.iterator();
    while (tmp$.hasNext()) {
      var segment = tmp$.next();
      if (segment.pointInSegment_14dthe$(point)) {
        return true;
      }
    }
    return false;
  };
  ExpressionTreeAnalyzer.prototype.allSegmentsSubzero_0 = function (segments) {
    var tmp$;
    tmp$ = segments.iterator();
    while (tmp$.hasNext()) {
      var segment = tmp$.next();
      if (!segment.isSubzero()) {
        return false;
      }
    }
    return true;
  };
  ExpressionTreeAnalyzer.prototype.fullyContains_0 = function (segment, possibleValues) {
    var tmp$;
    tmp$ = possibleValues.iterator();
    while (tmp$.hasNext()) {
      var possibleSegment = tmp$.next();
      if (segment.isSubSegment_271ndl$(possibleSegment)) {
        return true;
      }
    }
    return false;
  };
  ExpressionTreeAnalyzer.prototype.emptyIntersection_0 = function (segment, possibleValues) {
    var tmp$;
    tmp$ = possibleValues.iterator();
    while (tmp$.hasNext()) {
      var possibleSegment = tmp$.next();
      if (segment.hasIntersection_271ndl$(possibleSegment)) {
        return false;
      }
    }
    return true;
  };
  function ExpressionTreeAnalyzer$functionByName$lambda(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.bracketsDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_0(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.plusDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_1(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.mulDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_2(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.minusDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_3(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.divDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_4(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.powDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_5(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.modDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_6(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.sumNDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_7(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.prodNDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_8(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.andDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_9(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.orDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_10(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.xorDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_11(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.alleqDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_12(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.notDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_13(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.sinDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_14(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.cosDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_15(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.sinhDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_16(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.coshDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_17(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.tanDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_18(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.tanhDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_19(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.asinDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_20(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.acosDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_21(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.atanDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_22(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.expDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_23(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.lnDomain_0(expression, possibleValues);
    };
  }
  function ExpressionTreeAnalyzer$functionByName$lambda_24(this$ExpressionTreeAnalyzer) {
    return function (expression, possibleValues) {
      return this$ExpressionTreeAnalyzer.absDomain_0(expression, possibleValues);
    };
  }
  ExpressionTreeAnalyzer.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionTreeAnalyzer',
    interfaces: []
  };
  function shouldTakeLog(node) {
    if (node.value.length === 0) {
      if (node.children.size === 1)
        return shouldTakeLog(node.children.get_za3lpa$(0));
      return false;
    }
    return equals(node.value, 'exp') || equals(node.value, '^');
  }
  function getLog(node, compiledConfiguration) {
    var tmp$;
    if (node.value.length === 0) {
      var res = node.clone();
      if (res.children.size === 1)
        res.children.set_wxm5ur$(0, getLog(res.children.get_za3lpa$(0), compiledConfiguration));
      return res;
    }
     else {
      if (equals(node.value, 'exp') && node.children.size === 1)
        return node.children.get_za3lpa$(0).clone();
      if (equals(node.value, '^') && node.children.size > 1) {
        var res_0 = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('*', -1);
        res_0.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('ln', 1));
        res_0.children.get_za3lpa$(0).addChild_6718cy$(node.children.get_za3lpa$(0).clone());
        if (node.children.size === 2)
          res_0.addChild_6718cy$(node.children.get_za3lpa$(1).clone());
        else {
          var right = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('^', -1);
          tmp$ = node.children.size;
          for (var i = 1; i < tmp$; i++)
            right.addChild_6718cy$(node.children.get_za3lpa$(i).clone());
        }
        return res_0;
      }
    }
    return node.clone();
  }
  function alwaysPositiveFunction(node) {
    if (node.nodeType !== NodeType$FUNCTION_getInstance())
      return false;
    if (equals(node.value, 'exp') || equals(node.value, 'sqrt'))
      return true;
    var eps = 1.0E-6;
    if (equals(node.value, '^')) {
      if (node.children.size === 2) {
        var roundedPower = toIntOrNull(node.children.get_za3lpa$(1).value);
        if (roundedPower != null && (roundedPower % 2 === 0 || toDouble(node.children.get_za3lpa$(1).value) - roundedPower > eps))
          return true;
      }
    }
    return false;
  }
  function difference(left, right, compiledConfiguration) {
    var res = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('+', -1);
    if (left.value.length === 0 && left.children.size === 1)
      res.addChild_6718cy$(left.children.get_za3lpa$(0).clone());
    else
      res.addChild_6718cy$(left.clone());
    res.addChild_6718cy$(compiledConfiguration.createExpressionFunctionNode_bm4lxs$('-', -1));
    if (right.value.length === 0 && right.children.size === 1)
      last(res.children).addChild_6718cy$(right.children.get_za3lpa$(0).clone());
    else
      last(res.children).addChild_6718cy$(right.clone());
    return res;
  }
  function ratio(num, den, compiledConfiguration) {
    var res = compiledConfiguration.createExpressionFunctionNode_bm4lxs$('/', -1);
    if (num.value.length === 0 && num.children.size === 1)
      res.addChild_6718cy$(num.children.get_za3lpa$(0).clone());
    else
      res.addChild_6718cy$(num.clone());
    if (den.value.length === 0 && den.children.size === 1)
      res.addChild_6718cy$(den.children.get_za3lpa$(0).clone());
    else
      res.addChild_6718cy$(den.clone());
    return res;
  }
  function alwaysPositive(expression, compiledConfiguration) {
    var expressionNode = expression.clone();
    if (expressionNode.value.length === 0) {
      if (expressionNode.children.size === 1)
        expressionNode = expressionNode.children.get_za3lpa$(0);
    }
    if (expressionNode.nodeType === NodeType$FUNCTION_getInstance() && alwaysPositiveFunction(expressionNode))
      return true;
    var expressionMinimizer = new OptimizerUtils(difference(expression, compiledConfiguration.createExpressionVariableNode_14dthe$(1.0E-6), compiledConfiguration));
    if (!expressionMinimizer.canStart() && !expressionMinimizer.run_224j3y$(3))
      return true;
    return false;
  }
  function gradientDescentComparison(l, r, compiledConfiguration, comparisonType, domain) {
    if (domain === void 0)
      domain = null;
    var tmp$, tmp$_0, tmp$_1;
    var left = l.clone();
    var right = r.clone();
    var findDomainAgain = false;
    while (shouldTakeLog(left) && shouldTakeLog(right)) {
      left = getLog(left, compiledConfiguration);
      right = getLog(right, compiledConfiguration);
      findDomainAgain = true;
    }
    var dom = domain == null || findDomainAgain ? new DomainPointGenerator(arrayListOf([left, right])) : domain;
    switch (comparisonType.name) {
      case 'LEFT_MORE':
      case 'LEFT_MORE_OR_EQUAL':
        tmp$ = difference(left, right, compiledConfiguration);
        break;
      default:tmp$ = difference(right, left, compiledConfiguration);
        break;
    }
    var diff = tmp$;
    var diffMinizer = new OptimizerUtils(diff, void 0, compiledConfiguration, dom);
    if (diffMinizer.canStart() && diffMinizer.run_224j3y$())
      return false;
    switch (comparisonType.name) {
      case 'LEFT_MORE':
      case 'LEFT_MORE_OR_EQUAL':
        tmp$_0 = right;
        break;
      default:tmp$_0 = left;
        break;
    }
    var denominator = tmp$_0;
    if (alwaysPositive(denominator, compiledConfiguration)) {
      switch (comparisonType.name) {
        case 'LEFT_MORE':
        case 'LEFT_MORE_OR_EQUAL':
          tmp$_1 = ratio(left, right, compiledConfiguration);
          break;
        default:tmp$_1 = ratio(right, left, compiledConfiguration);
          break;
      }
      var ratio_0 = tmp$_1;
      var ratioMinimizer = new OptimizerUtils(ratio_0, void 0, compiledConfiguration, dom);
      if (ratioMinimizer.canStart() && ratioMinimizer.run_224j3y$(void 0, void 0, 1.0))
        return false;
    }
    return true;
  }
  var TREE_COMPUTATION_RULES_PRIORITY;
  var TREE_COMPUTATION_DEFAULT;
  function SimpleComputationRuleParams(ruleCodes, isIncluded, maxCalcComplexity, maxTenPowIterations, maxPlusArgRounded, maxMulArgRounded, maxDivBaseRounded, maxPowBaseRounded, maxPowDegRounded, maxLogBaseRounded, maxResRounded, operationsMap) {
    if (ruleCodes === void 0) {
      ruleCodes = emptySet();
    }
    if (isIncluded === void 0)
      isIncluded = true;
    if (maxCalcComplexity === void 0)
      maxCalcComplexity = 5;
    if (maxTenPowIterations === void 0)
      maxTenPowIterations = 10;
    if (maxPlusArgRounded === void 0)
      maxPlusArgRounded = 200;
    if (maxMulArgRounded === void 0)
      maxMulArgRounded = 50;
    if (maxDivBaseRounded === void 0)
      maxDivBaseRounded = 400;
    if (maxPowBaseRounded === void 0)
      maxPowBaseRounded = 50;
    if (maxPowDegRounded === void 0)
      maxPowDegRounded = 10;
    if (maxLogBaseRounded === void 0)
      maxLogBaseRounded = 400;
    if (maxResRounded === void 0)
      maxResRounded = 400;
    if (operationsMap === void 0) {
      operationsMap = emptyMap();
    }
    this.ruleCodes = ruleCodes;
    this.isIncluded = isIncluded;
    this.maxCalcComplexity = maxCalcComplexity;
    this.maxTenPowIterations = maxTenPowIterations;
    this.maxPlusArgRounded = maxPlusArgRounded;
    this.maxMulArgRounded = maxMulArgRounded;
    this.maxDivBaseRounded = maxDivBaseRounded;
    this.maxPowBaseRounded = maxPowBaseRounded;
    this.maxPowDegRounded = maxPowDegRounded;
    this.maxLogBaseRounded = maxLogBaseRounded;
    this.maxResRounded = maxResRounded;
    this.operationsMap = operationsMap;
    this.operationsMap = mapOf_0([to('+', SimpleComputationRuleParams_init$lambda(this)), to('-', SimpleComputationRuleParams_init$lambda_0(this)), to('*', SimpleComputationRuleParams_init$lambda_1(this)), to('/', SimpleComputationRuleParams_init$lambda_2(this)), to('^', SimpleComputationRuleParams_init$lambda_3(this)), to('log', SimpleComputationRuleParams_init$lambda_4(this))]);
    if (!this.ruleCodes.isEmpty()) {
      if (this.ruleCodes.contains_11rb$('SimpleComputationBeforeSchool')) {
        this.maxCalcComplexity = 2;
        this.maxTenPowIterations = 3;
        this.maxPlusArgRounded = 1;
        this.maxMulArgRounded = 1;
        this.maxDivBaseRounded = 1;
        this.maxPowBaseRounded = 1;
        this.maxPowDegRounded = 1;
        this.maxLogBaseRounded = 1;
        this.maxResRounded = 10;
      }
       else if (this.ruleCodes.contains_11rb$('SimpleComputationYoungSchool')) {
        this.maxCalcComplexity = 3;
        this.maxTenPowIterations = 5;
        this.maxPlusArgRounded = 100;
        this.maxMulArgRounded = 10;
        this.maxDivBaseRounded = 10;
        this.maxPowBaseRounded = 1;
        this.maxPowDegRounded = 1;
        this.maxLogBaseRounded = 1;
        this.maxResRounded = 100;
      }
       else if (this.ruleCodes.contains_11rb$('SimpleComputationMiddleSchool')) {
        this.maxCalcComplexity = 5;
        this.maxTenPowIterations = 10;
        this.maxPlusArgRounded = 200;
        this.maxMulArgRounded = 50;
        this.maxDivBaseRounded = 400;
        this.maxPowBaseRounded = 50;
        this.maxPowDegRounded = 10;
        this.maxLogBaseRounded = 400;
        this.maxResRounded = 400;
      }
       else if (this.ruleCodes.contains_11rb$('SimpleComputationUniversity')) {
        this.maxCalcComplexity = 2147483647;
        this.maxTenPowIterations = 11;
        this.maxPlusArgRounded = 2147483647;
        this.maxMulArgRounded = 2147483647;
        this.maxDivBaseRounded = 2147483647;
        this.maxPowBaseRounded = 2147483647;
        this.maxPowDegRounded = 2147483647;
        this.maxLogBaseRounded = 2147483647;
        this.maxResRounded = 2147483647;
      }
    }
  }
  function SimpleComputationRuleParams_init$lambda(this$SimpleComputationRuleParams) {
    return function (args) {
      return plus_1(args, this$SimpleComputationRuleParams);
    };
  }
  function SimpleComputationRuleParams_init$lambda_0(this$SimpleComputationRuleParams) {
    return function (args) {
      return minus(args, this$SimpleComputationRuleParams);
    };
  }
  function SimpleComputationRuleParams_init$lambda_1(this$SimpleComputationRuleParams) {
    return function (args) {
      return mul(args, this$SimpleComputationRuleParams);
    };
  }
  function SimpleComputationRuleParams_init$lambda_2(this$SimpleComputationRuleParams) {
    return function (args) {
      return div(args, this$SimpleComputationRuleParams);
    };
  }
  function SimpleComputationRuleParams_init$lambda_3(this$SimpleComputationRuleParams) {
    return function (args) {
      return pow(args, this$SimpleComputationRuleParams);
    };
  }
  function SimpleComputationRuleParams_init$lambda_4(this$SimpleComputationRuleParams) {
    return function (args) {
      return log_0(args, this$SimpleComputationRuleParams);
    };
  }
  SimpleComputationRuleParams.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'SimpleComputationRuleParams',
    interfaces: []
  };
  SimpleComputationRuleParams.prototype.component1 = function () {
    return this.ruleCodes;
  };
  SimpleComputationRuleParams.prototype.component2 = function () {
    return this.isIncluded;
  };
  SimpleComputationRuleParams.prototype.component3 = function () {
    return this.maxCalcComplexity;
  };
  SimpleComputationRuleParams.prototype.component4 = function () {
    return this.maxTenPowIterations;
  };
  SimpleComputationRuleParams.prototype.component5 = function () {
    return this.maxPlusArgRounded;
  };
  SimpleComputationRuleParams.prototype.component6 = function () {
    return this.maxMulArgRounded;
  };
  SimpleComputationRuleParams.prototype.component7 = function () {
    return this.maxDivBaseRounded;
  };
  SimpleComputationRuleParams.prototype.component8 = function () {
    return this.maxPowBaseRounded;
  };
  SimpleComputationRuleParams.prototype.component9 = function () {
    return this.maxPowDegRounded;
  };
  SimpleComputationRuleParams.prototype.component10 = function () {
    return this.maxLogBaseRounded;
  };
  SimpleComputationRuleParams.prototype.component11 = function () {
    return this.maxResRounded;
  };
  SimpleComputationRuleParams.prototype.component12 = function () {
    return this.operationsMap;
  };
  SimpleComputationRuleParams.prototype.copy_oq15gl$ = function (ruleCodes, isIncluded, maxCalcComplexity, maxTenPowIterations, maxPlusArgRounded, maxMulArgRounded, maxDivBaseRounded, maxPowBaseRounded, maxPowDegRounded, maxLogBaseRounded, maxResRounded, operationsMap) {
    return new SimpleComputationRuleParams(ruleCodes === void 0 ? this.ruleCodes : ruleCodes, isIncluded === void 0 ? this.isIncluded : isIncluded, maxCalcComplexity === void 0 ? this.maxCalcComplexity : maxCalcComplexity, maxTenPowIterations === void 0 ? this.maxTenPowIterations : maxTenPowIterations, maxPlusArgRounded === void 0 ? this.maxPlusArgRounded : maxPlusArgRounded, maxMulArgRounded === void 0 ? this.maxMulArgRounded : maxMulArgRounded, maxDivBaseRounded === void 0 ? this.maxDivBaseRounded : maxDivBaseRounded, maxPowBaseRounded === void 0 ? this.maxPowBaseRounded : maxPowBaseRounded, maxPowDegRounded === void 0 ? this.maxPowDegRounded : maxPowDegRounded, maxLogBaseRounded === void 0 ? this.maxLogBaseRounded : maxLogBaseRounded, maxResRounded === void 0 ? this.maxResRounded : maxResRounded, operationsMap === void 0 ? this.operationsMap : operationsMap);
  };
  SimpleComputationRuleParams.prototype.toString = function () {
    return 'SimpleComputationRuleParams(ruleCodes=' + Kotlin.toString(this.ruleCodes) + (', isIncluded=' + Kotlin.toString(this.isIncluded)) + (', maxCalcComplexity=' + Kotlin.toString(this.maxCalcComplexity)) + (', maxTenPowIterations=' + Kotlin.toString(this.maxTenPowIterations)) + (', maxPlusArgRounded=' + Kotlin.toString(this.maxPlusArgRounded)) + (', maxMulArgRounded=' + Kotlin.toString(this.maxMulArgRounded)) + (', maxDivBaseRounded=' + Kotlin.toString(this.maxDivBaseRounded)) + (', maxPowBaseRounded=' + Kotlin.toString(this.maxPowBaseRounded)) + (', maxPowDegRounded=' + Kotlin.toString(this.maxPowDegRounded)) + (', maxLogBaseRounded=' + Kotlin.toString(this.maxLogBaseRounded)) + (', maxResRounded=' + Kotlin.toString(this.maxResRounded)) + (', operationsMap=' + Kotlin.toString(this.operationsMap)) + ')';
  };
  SimpleComputationRuleParams.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.ruleCodes) | 0;
    result = result * 31 + Kotlin.hashCode(this.isIncluded) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxCalcComplexity) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxTenPowIterations) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxPlusArgRounded) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxMulArgRounded) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxDivBaseRounded) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxPowBaseRounded) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxPowDegRounded) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxLogBaseRounded) | 0;
    result = result * 31 + Kotlin.hashCode(this.maxResRounded) | 0;
    result = result * 31 + Kotlin.hashCode(this.operationsMap) | 0;
    return result;
  };
  SimpleComputationRuleParams.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.ruleCodes, other.ruleCodes) && Kotlin.equals(this.isIncluded, other.isIncluded) && Kotlin.equals(this.maxCalcComplexity, other.maxCalcComplexity) && Kotlin.equals(this.maxTenPowIterations, other.maxTenPowIterations) && Kotlin.equals(this.maxPlusArgRounded, other.maxPlusArgRounded) && Kotlin.equals(this.maxMulArgRounded, other.maxMulArgRounded) && Kotlin.equals(this.maxDivBaseRounded, other.maxDivBaseRounded) && Kotlin.equals(this.maxPowBaseRounded, other.maxPowBaseRounded) && Kotlin.equals(this.maxPowDegRounded, other.maxPowDegRounded) && Kotlin.equals(this.maxLogBaseRounded, other.maxLogBaseRounded) && Kotlin.equals(this.maxResRounded, other.maxResRounded) && Kotlin.equals(this.operationsMap, other.operationsMap)))));
  };
  var simpleComputationRuleParamsDefault;
  var simpleComputationRuleParamsNoLimits;
  function calcComplexity($receiver) {
    var tmp$;
    if ($receiver.nodeType === NodeType$VARIABLE_getInstance() && (equals($receiver.value, '1') || equals($receiver.value, '0') || (toDoubleOrNull($receiver.value) != null && toReal_0(roundNumber(toDouble($receiver.value)) - 1.0).additivelyEqualToZero()))) {
      return 0;
    }
     else if ($receiver.children.isEmpty()) {
      return 1;
    }
    switch ($receiver.value) {
      case '':
      case '-':
      case '+':
        tmp$ = 0;
        break;
      case '*':
      case '/':
        tmp$ = 1;
        break;
      default:tmp$ = 2;
        break;
    }
    var tmp$_0 = tmp$;
    var tmp$_1;
    var sum = 0;
    tmp$_1 = $receiver.children.iterator();
    while (tmp$_1.hasNext()) {
      var element = tmp$_1.next();
      sum = sum + calcComplexity(element) | 0;
    }
    var nodeComplexity = tmp$_0 + sum | 0;
    return nodeComplexity;
  }
  function computeNodeIfPossible($receiver) {
    var tmp$;
    tmp$ = computeNodeIfSimpleRecursive($receiver, simpleComputationRuleParamsNoLimits);
    if (tmp$ == null) {
      return null;
    }
    var result = tmp$;
    return result;
  }
  function computeNodeIfSimple($receiver, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    var tmp$;
    tmp$ = computeNodeIfSimpleRecursive($receiver, simpleComputationRuleParams);
    if (tmp$ == null) {
      return null;
    }
    var result = tmp$;
    return result;
  }
  function computeNodeIfSimpleRecursive($receiver, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    var tmp$, tmp$_0, tmp$_1;
    if ($receiver.nodeType === NodeType$VARIABLE_getInstance()) {
      return toDoubleOrNull($receiver.value);
    }
     else if ($receiver.children.isEmpty()) {
      return null;
    }
    var listOfArgs = ArrayList_init();
    tmp$ = $receiver.children.iterator();
    while (tmp$.hasNext()) {
      var childNode = tmp$.next();
      if (((tmp$_0 = computeNodeIfSimpleRecursive(childNode, simpleComputationRuleParams)) != null ? listOfArgs.add_11rb$(tmp$_0) : null) == null)
        return null;
    }
    return (tmp$_1 = simpleComputationRuleParams.operationsMap.get_11rb$($receiver.value)) != null ? tmp$_1(listOfArgs) : null;
  }
  function inZ(value) {
    return toReal_0(numberToInt(value) - value).additivelyEqualToZero();
  }
  function roundNumber(number) {
    var current = Math_0.abs(number);
    var leftIterations = 10;
    while (!toReal_0(current).additivelyEqualToZero() && inZ(current) && leftIterations > 0) {
      current /= 10;
      leftIterations = leftIterations - 1 | 0;
    }
    leftIterations = 10;
    while (!inZ(current) && leftIterations > 0) {
      current *= 10;
      leftIterations = leftIterations - 1 | 0;
    }
    return current;
  }
  function tenPowToMakeZ(number, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    var current = Math_0.abs(number);
    var iterations = 0;
    while (!inZ(current) && iterations < simpleComputationRuleParams.maxTenPowIterations) {
      current *= 10;
      iterations = iterations + 1 | 0;
    }
    return iterations;
  }
  function plus_1(args, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    var tmp$ = args.size === 2;
    if (tmp$) {
      var any$result;
      any$break: do {
        var tmp$_0;
        if (Kotlin.isType(args, Collection) && args.isEmpty()) {
          any$result = false;
          break any$break;
        }
        tmp$_0 = args.iterator();
        while (tmp$_0.hasNext()) {
          var element = tmp$_0.next();
          if (toReal_0(roundNumber(element) - 1.0).additivelyEqualToZero()) {
            any$result = true;
            break any$break;
          }
        }
        any$result = false;
      }
       while (false);
      tmp$ = any$result;
    }
    if (tmp$) {
      return sum(args);
    }
    var result = sum(args);
    var count$result;
    count$break: do {
      var tmp$_1;
      if (Kotlin.isType(args, Collection) && args.isEmpty()) {
        count$result = 0;
        break count$break;
      }
      var count = 0;
      tmp$_1 = args.iterator();
      while (tmp$_1.hasNext()) {
        var element_0 = tmp$_1.next();
        if (roundNumber(element_0) > simpleComputationRuleParams.maxPlusArgRounded)
          checkCountOverflow((count = count + 1 | 0, count));
      }
      count$result = count;
    }
     while (false);
    if (count$result > 1 && roundNumber(result) > simpleComputationRuleParams.maxResRounded) {
      return null;
    }
    return result;
  }
  function minus(args, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    if (args.size !== 1) {
      return null;
    }
    return -first(args);
  }
  function mul(args, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    var tmp$;
    var tmp$_0 = args.size === 2;
    if (tmp$_0) {
      var any$result;
      any$break: do {
        var tmp$_1;
        if (Kotlin.isType(args, Collection) && args.isEmpty()) {
          any$result = false;
          break any$break;
        }
        tmp$_1 = args.iterator();
        while (tmp$_1.hasNext()) {
          var element = tmp$_1.next();
          if (toReal_0(roundNumber(element) - 2.0).additivelyEqualToZero()) {
            any$result = true;
            break any$break;
          }
        }
        any$result = false;
      }
       while (false);
      tmp$_0 = any$result;
    }
    if (tmp$_0) {
      return first(args) * last(args);
    }
    var result = 1.0;
    tmp$ = args.iterator();
    while (tmp$.hasNext()) {
      var arg = tmp$.next();
      result *= arg;
    }
    var count$result;
    count$break: do {
      var tmp$_2;
      if (Kotlin.isType(args, Collection) && args.isEmpty()) {
        count$result = 0;
        break count$break;
      }
      var count = 0;
      tmp$_2 = args.iterator();
      while (tmp$_2.hasNext()) {
        var element_0 = tmp$_2.next();
        if (roundNumber(element_0) > simpleComputationRuleParams.maxMulArgRounded)
          checkCountOverflow((count = count + 1 | 0, count));
      }
      count$result = count;
    }
     while (false);
    if (count$result > 1 && roundNumber(result) > simpleComputationRuleParams.maxResRounded) {
      return null;
    }
    return result;
  }
  function div(args, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    if (args.size !== 2) {
      return null;
    }
    if (roundNumber(first(args)) > simpleComputationRuleParams.maxDivBaseRounded || roundNumber(last(args)) > simpleComputationRuleParams.maxMulArgRounded || last(args) === 0.0) {
      return null;
    }
    var result = first(args) / last(args);
    return result;
  }
  function pow(args, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    if (args.size !== 2) {
      return null;
    }
    var $receiver = first(args);
    var x = last(args);
    var result = Math_0.pow($receiver, x);
    if (!isFinite(result)) {
      return null;
    }
    if (roundNumber(result) > simpleComputationRuleParams.maxResRounded || (roundNumber(first(args)) > simpleComputationRuleParams.maxPowBaseRounded && roundNumber(last(args)) > simpleComputationRuleParams.maxPowDegRounded)) {
      return null;
    }
    return result;
  }
  function log_0(args, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    if (args.size !== 2) {
      return null;
    }
    var result = log(first(args), last(args));
    if (!isFinite(result) || (roundNumber(result) >= 1 && !inZ(result))) {
      return null;
    }
    if (roundNumber(result) > simpleComputationRuleParams.maxResRounded || (roundNumber(first(args)) > simpleComputationRuleParams.maxPowBaseRounded && roundNumber(last(args)) > simpleComputationRuleParams.maxLogBaseRounded)) {
      return null;
    }
    return result;
  }
  function sin(args, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    if (args.size !== 1) {
      return null;
    }
    var x = first(args);
    var result = Math_0.sin(x);
    if (!isFinite(result) || toReal_0(roundNumber(result)).additivelyEqualToZero() || toReal_0(roundNumber(result) - 0.5).additivelyEqualToZero() || toReal_0(roundNumber(result) - 1.0).additivelyEqualToZero()) {
      return null;
    }
    return result;
  }
  function cos(args, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    if (args.size !== 1) {
      return null;
    }
    var x = first(args);
    var result = Math_0.cos(x);
    if (!isFinite(result) || toReal_0(roundNumber(result)).additivelyEqualToZero() || toReal_0(roundNumber(result) - 0.5).additivelyEqualToZero() || toReal_0(roundNumber(result) - 1.0).additivelyEqualToZero()) {
      return null;
    }
    return result;
  }
  function tg(args, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    if (args.size !== 1) {
      return null;
    }
    var x = first(args);
    var result = Math_0.tan(x);
    if (!isFinite(result) || toReal_0(roundNumber(result)).additivelyEqualToZero() || toReal_0(roundNumber(result) - 1.0).additivelyEqualToZero()) {
      return null;
    }
    return result;
  }
  function ctg(args, simpleComputationRuleParams) {
    if (simpleComputationRuleParams === void 0)
      simpleComputationRuleParams = simpleComputationRuleParamsDefault;
    if (args.size !== 1) {
      return null;
    }
    var x = first(args);
    var result = 1 / Math_0.tan(x);
    if (!isFinite(result) || toReal_0(roundNumber(result)).additivelyEqualToZero() || toReal_0(roundNumber(result) - 1.0).additivelyEqualToZero()) {
      return null;
    }
    return result;
  }
  function ComparableTransformationPartType(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function ComparableTransformationPartType_initFields() {
    ComparableTransformationPartType_initFields = function () {
    };
    ComparableTransformationPartType$EXPRESSION_instance = new ComparableTransformationPartType('EXPRESSION', 0);
    ComparableTransformationPartType$EXPRESSION_COMPARISON_instance = new ComparableTransformationPartType('EXPRESSION_COMPARISON', 1);
    ComparableTransformationPartType$MAIN_LINE_AND_NODE_instance = new ComparableTransformationPartType('MAIN_LINE_AND_NODE', 2);
    ComparableTransformationPartType$MAIN_LINE_OR_NODE_instance = new ComparableTransformationPartType('MAIN_LINE_OR_NODE', 3);
    ComparableTransformationPartType$EXPRESSION_CHAIN_instance = new ComparableTransformationPartType('EXPRESSION_CHAIN', 4);
    ComparableTransformationPartType$RULE_instance = new ComparableTransformationPartType('RULE', 5);
    ComparableTransformationPartType$RULE_POINTER_instance = new ComparableTransformationPartType('RULE_POINTER', 6);
    ComparableTransformationPartType$EMPTY_instance = new ComparableTransformationPartType('EMPTY', 7);
  }
  var ComparableTransformationPartType$EXPRESSION_instance;
  function ComparableTransformationPartType$EXPRESSION_getInstance() {
    ComparableTransformationPartType_initFields();
    return ComparableTransformationPartType$EXPRESSION_instance;
  }
  var ComparableTransformationPartType$EXPRESSION_COMPARISON_instance;
  function ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance() {
    ComparableTransformationPartType_initFields();
    return ComparableTransformationPartType$EXPRESSION_COMPARISON_instance;
  }
  var ComparableTransformationPartType$MAIN_LINE_AND_NODE_instance;
  function ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() {
    ComparableTransformationPartType_initFields();
    return ComparableTransformationPartType$MAIN_LINE_AND_NODE_instance;
  }
  var ComparableTransformationPartType$MAIN_LINE_OR_NODE_instance;
  function ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance() {
    ComparableTransformationPartType_initFields();
    return ComparableTransformationPartType$MAIN_LINE_OR_NODE_instance;
  }
  var ComparableTransformationPartType$EXPRESSION_CHAIN_instance;
  function ComparableTransformationPartType$EXPRESSION_CHAIN_getInstance() {
    ComparableTransformationPartType_initFields();
    return ComparableTransformationPartType$EXPRESSION_CHAIN_instance;
  }
  var ComparableTransformationPartType$RULE_instance;
  function ComparableTransformationPartType$RULE_getInstance() {
    ComparableTransformationPartType_initFields();
    return ComparableTransformationPartType$RULE_instance;
  }
  var ComparableTransformationPartType$RULE_POINTER_instance;
  function ComparableTransformationPartType$RULE_POINTER_getInstance() {
    ComparableTransformationPartType_initFields();
    return ComparableTransformationPartType$RULE_POINTER_instance;
  }
  var ComparableTransformationPartType$EMPTY_instance;
  function ComparableTransformationPartType$EMPTY_getInstance() {
    ComparableTransformationPartType_initFields();
    return ComparableTransformationPartType$EMPTY_instance;
  }
  ComparableTransformationPartType.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ComparableTransformationPartType',
    interfaces: [Enum]
  };
  function ComparableTransformationPartType$values() {
    return [ComparableTransformationPartType$EXPRESSION_getInstance(), ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance(), ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance(), ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance(), ComparableTransformationPartType$EXPRESSION_CHAIN_getInstance(), ComparableTransformationPartType$RULE_getInstance(), ComparableTransformationPartType$RULE_POINTER_getInstance(), ComparableTransformationPartType$EMPTY_getInstance()];
  }
  ComparableTransformationPartType.values = ComparableTransformationPartType$values;
  function ComparableTransformationPartType$valueOf(name) {
    switch (name) {
      case 'EXPRESSION':
        return ComparableTransformationPartType$EXPRESSION_getInstance();
      case 'EXPRESSION_COMPARISON':
        return ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance();
      case 'MAIN_LINE_AND_NODE':
        return ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance();
      case 'MAIN_LINE_OR_NODE':
        return ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance();
      case 'EXPRESSION_CHAIN':
        return ComparableTransformationPartType$EXPRESSION_CHAIN_getInstance();
      case 'RULE':
        return ComparableTransformationPartType$RULE_getInstance();
      case 'RULE_POINTER':
        return ComparableTransformationPartType$RULE_POINTER_getInstance();
      case 'EMPTY':
        return ComparableTransformationPartType$EMPTY_getInstance();
      default:throwISE('No enum constant factstransformations.ComparableTransformationPartType.' + name);
    }
  }
  ComparableTransformationPartType.valueOf_61zpoe$ = ComparableTransformationPartType$valueOf;
  function ComparableTransformationsPart() {
  }
  ComparableTransformationsPart.$metadata$ = {
    kind: Kind_INTERFACE,
    simpleName: 'ComparableTransformationsPart',
    interfaces: [TransformationsPart]
  };
  function ComparisonResult(isCorrect, coloringTasks, left, right, description, additionalFactUsed) {
    if (description === void 0)
      description = '';
    if (additionalFactUsed === void 0)
      additionalFactUsed = false;
    this.isCorrect = isCorrect;
    this.coloringTasks = coloringTasks;
    this.left = left;
    this.right = right;
    this.description = description;
    this.additionalFactUsed = additionalFactUsed;
  }
  ComparisonResult.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ComparisonResult',
    interfaces: []
  };
  ComparisonResult.prototype.component1 = function () {
    return this.isCorrect;
  };
  ComparisonResult.prototype.component2 = function () {
    return this.coloringTasks;
  };
  ComparisonResult.prototype.component3 = function () {
    return this.left;
  };
  ComparisonResult.prototype.component4 = function () {
    return this.right;
  };
  ComparisonResult.prototype.component5 = function () {
    return this.description;
  };
  ComparisonResult.prototype.component6 = function () {
    return this.additionalFactUsed;
  };
  ComparisonResult.prototype.copy_i9bv5a$ = function (isCorrect, coloringTasks, left, right, description, additionalFactUsed) {
    return new ComparisonResult(isCorrect === void 0 ? this.isCorrect : isCorrect, coloringTasks === void 0 ? this.coloringTasks : coloringTasks, left === void 0 ? this.left : left, right === void 0 ? this.right : right, description === void 0 ? this.description : description, additionalFactUsed === void 0 ? this.additionalFactUsed : additionalFactUsed);
  };
  ComparisonResult.prototype.toString = function () {
    return 'ComparisonResult(isCorrect=' + Kotlin.toString(this.isCorrect) + (', coloringTasks=' + Kotlin.toString(this.coloringTasks)) + (', left=' + Kotlin.toString(this.left)) + (', right=' + Kotlin.toString(this.right)) + (', description=' + Kotlin.toString(this.description)) + (', additionalFactUsed=' + Kotlin.toString(this.additionalFactUsed)) + ')';
  };
  ComparisonResult.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.isCorrect) | 0;
    result = result * 31 + Kotlin.hashCode(this.coloringTasks) | 0;
    result = result * 31 + Kotlin.hashCode(this.left) | 0;
    result = result * 31 + Kotlin.hashCode(this.right) | 0;
    result = result * 31 + Kotlin.hashCode(this.description) | 0;
    result = result * 31 + Kotlin.hashCode(this.additionalFactUsed) | 0;
    return result;
  };
  ComparisonResult.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.isCorrect, other.isCorrect) && Kotlin.equals(this.coloringTasks, other.coloringTasks) && Kotlin.equals(this.left, other.left) && Kotlin.equals(this.right, other.right) && Kotlin.equals(this.description, other.description) && Kotlin.equals(this.additionalFactUsed, other.additionalFactUsed)))));
  };
  function MainChainPart() {
  }
  MainChainPart.prototype.isSolutionForVariables_axkv0l$ = function (targetVariables, left, allowedVariables, callback$default) {
    if (left === void 0)
      left = false;
    return callback$default ? callback$default(targetVariables, left, allowedVariables) : this.isSolutionForVariables_axkv0l$$default(targetVariables, left, allowedVariables);
  };
  MainChainPart.$metadata$ = {
    kind: Kind_INTERFACE,
    simpleName: 'MainChainPart',
    interfaces: [ComparableTransformationsPart]
  };
  function MainLineNode() {
  }
  MainLineNode.prototype.isEmpty = function () {
    return this.factTransformationChains.isEmpty() && this.inFacts.isEmpty() && this.outFacts.isEmpty() && this.expressionTransformationChains.isEmpty() && this.rules.isEmpty();
  };
  MainLineNode.$metadata$ = {
    kind: Kind_INTERFACE,
    simpleName: 'MainLineNode',
    interfaces: [MainChainPart]
  };
  function Expression(startPosition, endPosition, data, identifier, parent) {
    Expression$Companion_getInstance();
    if (startPosition === void 0)
      startPosition = 0;
    if (endPosition === void 0)
      endPosition = 0;
    if (identifier === void 0)
      identifier = '';
    if (parent === void 0)
      parent = null;
    this.startPosition_vu2w9m$_0 = startPosition;
    this.endPosition_8sefun$_0 = endPosition;
    this.data = data;
    this.identifier_h2iili$_0 = identifier;
    this.parent_70ee6d$_0 = parent;
  }
  Object.defineProperty(Expression.prototype, 'startPosition', {
    get: function () {
      return this.startPosition_vu2w9m$_0;
    }
  });
  Object.defineProperty(Expression.prototype, 'endPosition', {
    get: function () {
      return this.endPosition_8sefun$_0;
    }
  });
  Object.defineProperty(Expression.prototype, 'identifier', {
    get: function () {
      return this.identifier_h2iili$_0;
    },
    set: function (identifier) {
      this.identifier_h2iili$_0 = identifier;
    }
  });
  Object.defineProperty(Expression.prototype, 'parent', {
    get: function () {
      return this.parent_70ee6d$_0;
    },
    set: function (parent) {
      this.parent_70ee6d$_0 = parent;
    }
  });
  Expression.prototype.getLastExpression = function () {
    return this;
  };
  Expression.prototype.isSolutionWithoutFunctions_cbql57$ = function (forbidden, targetExpression, factComporator) {
    var tmp$;
    tmp$ = forbidden.iterator();
    while (tmp$.hasNext()) {
      var function_0 = tmp$.next();
      if (this.data.containsFunction_bm4lxs$(function_0.first, function_0.second)) {
        return new GeneralError('Answer contains forbidden function or operation');
      }
    }
    return null;
  };
  Expression.prototype.isFactorizationForVariables_3b7jn6$ = function (minNumberOfMultipliers, targetVariables, targetExpression, factComporator) {
    var tmp$;
    var tmp$_0 = factComporator.expressionComporator;
    var tmp$_1 = this.data;
    var tmp$_2 = void 0;
    var $receiver = (new FunctionConfiguration()).notChangesOnVariablesInComparisonFunction;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$_3;
    tmp$_3 = $receiver.iterator();
    while (tmp$_3.hasNext()) {
      var item = tmp$_3.next();
      destination.add_11rb$(item.getIdentifier());
    }
    var comparisonResult = tmp$_0.compareWithoutSubstitutions_15tjed$(tmp$_1, targetExpression, tmp$_2, toSet(destination));
    if (!comparisonResult) {
      return new GeneralError('Answer not equal to original expression');
    }
    if (minNumberOfMultipliers <= 1) {
      return null;
    }
    var topNode = this.data;
    while (isBlank(topNode.value) && topNode.children.size === 1) {
      topNode = first(topNode.children);
    }
    if (!equals(topNode.value, '*')) {
      return new GeneralError('Answer is not factorized');
    }
    var numberOfMultipliers = 0;
    tmp$ = topNode.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      var containedVariables = this.data.getContainedVariables_ywdfdh$(targetVariables);
      if (!containedVariables.isEmpty()) {
        numberOfMultipliers = numberOfMultipliers + 1 | 0;
      }
    }
    if (numberOfMultipliers < minNumberOfMultipliers) {
      return new GeneralError('Not enough multipliers in the answer');
    }
    return null;
  };
  Expression.prototype.hasNoFractions_5ah4l7$ = function (maxNumberOfDivisions, targetExpression, factComporator) {
    var tmp$ = factComporator.expressionComporator;
    var tmp$_0 = this.data;
    var tmp$_1 = void 0;
    var $receiver = (new FunctionConfiguration()).notChangesOnVariablesInComparisonFunction;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$_2;
    tmp$_2 = $receiver.iterator();
    while (tmp$_2.hasNext()) {
      var item = tmp$_2.next();
      destination.add_11rb$(item.getIdentifier());
    }
    var comparisonResult = tmp$.compareWithoutSubstitutions_15tjed$(tmp$_0, targetExpression, tmp$_1, toSet(destination));
    if (!comparisonResult) {
      return new GeneralError('Answer not equal to original expression');
    }
    if (this.data.canContainDivisions()) {
      return new GeneralError('Answer contains fraction');
    }
    return null;
  };
  function Expression$isSolutionForVariables$lambda(it) {
    return "'" + it + "'";
  }
  function Expression$isSolutionForVariables$lambda_0(it) {
    return "'" + it + "'";
  }
  function Expression$isSolutionForVariables$lambda_1(it) {
    return "'" + it + "'";
  }
  Expression.prototype.isSolutionForVariables_axkv0l$$default = function (targetVariables, left, allowedVariables) {
    if (left) {
      if (this.data.containsFunctions()) {
        return new GeneralError('left part of the result contains functions or operations');
      }
      var containedVariables = this.data.getVariableNames();
      if (containedVariables.size > 1) {
        return new GeneralError('left part of the result contains more than one variable: ' + joinToString(containedVariables, void 0, void 0, void 0, void 0, void 0, Expression$isSolutionForVariables$lambda));
      }
       else if (containedVariables.size === 1) {
        targetVariables.put_xwzc9p$(first_2(containedVariables), true);
      }
      return null;
    }
     else {
      var containedVariables_0 = this.data.getContainedVariables_ywdfdh$(targetVariables.keys);
      if (!containedVariables_0.isEmpty()) {
        return new GeneralError('right part of the result contains unknown variables: ' + joinToString(containedVariables_0, void 0, void 0, void 0, void 0, void 0, Expression$isSolutionForVariables$lambda_0));
      }
       else {
        if (!allowedVariables.isEmpty()) {
          var notContainedVariables = this.data.getNotContainedVariables_ywdfdh$(allowedVariables);
          if (!notContainedVariables.isEmpty()) {
            return new GeneralError('right part of the result contains unknown variables: ' + joinToString(notContainedVariables, void 0, void 0, void 0, void 0, void 0, Expression$isSolutionForVariables$lambda_1));
          }
        }
      }
      return null;
    }
  };
  Expression.prototype.variableReplacement_y0zsll$ = function (replacements) {
    this.data.variableReplacement_y0zsll$(replacements);
  };
  Expression.prototype.computeIfNumeric_z3m4ac$ = function (substitutionInstance, baseOperationsDefinitions) {
    var tmp$, tmp$_0;
    var variableNames = this.data.getVariableNames();
    var pointI = LinkedHashMap_init_0();
    tmp$ = variableNames.iterator();
    while (tmp$.hasNext()) {
      var variableName = tmp$.next();
      tmp$_0 = substitutionInstance.getExprVar_61zpoe$(variableName);
      if (tmp$_0 == null) {
        continue;
      }
      var node = tmp$_0;
      var value = baseOperationsDefinitions.computeExpressionTree_6718cy$(node.clone()).value;
      pointI.put_xwzc9p$(variableName, value);
    }
    var result = toDoubleOrNull(baseOperationsDefinitions.computeExpressionTree_6718cy$(this.data.cloneWithNormalization_1g1bdl$(pointI, false)).value);
    return result;
  };
  Expression.prototype.clone = function () {
    return new Expression(this.startPosition, this.endPosition, this.data.clone(), void 0, this.parent);
  };
  Expression.prototype.cloneWithNormalization_1g1bdl$ = function (nameArgsMap, sorted) {
    return new Expression(this.startPosition, this.endPosition, this.data.cloneWithNormalization_1g1bdl$(nameArgsMap, sorted), void 0, this.parent);
  };
  Expression.prototype.normalizeSubTree_f8z7ch$ = function (currentDeep, nameArgsMap, sorted) {
    this.data.normalizeSubTree_f8z7ch$(currentDeep, nameArgsMap, sorted);
  };
  Expression.prototype.applyAllExpressionSubstitutions_8sufjw$ = function (expressionSubstitutions) {
    applyAllSubstitutions(this.data, expressionSubstitutions);
  };
  Expression.prototype.computeExpressionTrees_dq72cu$ = function (baseOperationsDefinitions) {
    this.data = baseOperationsDefinitions.computeExpressionTree_6718cy$(this.data);
  };
  Expression.prototype.replaceNotDefinedFunctionsOnVariables_1vzej0$ = function (functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet) {
    this.data.replaceNotDefinedFunctionsOnVariables_g22vlb$(functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet);
  };
  Expression.prototype.copyNode = function () {
    return new Expression(this.startPosition, this.endPosition, new ExpressionNode(NodeType$EMPTY_getInstance(), ''), void 0, this.parent);
  };
  function Expression$check$lambda() {
    return 'This method must not been called. Undefined behaviour. MSG_CODE_1537133804710';
  }
  Expression.prototype.check_l8pk6u$ = function (factComporator, onExpressionLevel, factsTransformations, expressionTransformations, additionalFacts) {
    log_1.addMessage_bda5c9$(Expression$check$lambda);
    return new ComparisonResult(true, ArrayList_init(), this, this);
  };
  Expression.prototype.type = function () {
    return ComparableTransformationPartType$EXPRESSION_getInstance();
  };
  Expression.prototype.toString = function () {
    return this.data.toString();
  };
  Expression.prototype.computeIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.identifier) || recomputeIfComputed) {
      this.identifier = this.data.computeIdentifier_t6ztn0$();
    }
    return this.identifier;
  };
  Expression.prototype.computeInIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  Expression.prototype.computeOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  Expression.prototype.computeSortedOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  Expression.prototype.getDesignation = function () {
    return this.data.nodeType === NodeType$VARIABLE_getInstance() ? this.data.value : equals(this.data.value, '') && this.data.children.size === 1 && this.data.children.get_za3lpa$(0).nodeType === NodeType$VARIABLE_getInstance() ? this.data.children.get_za3lpa$(0).value : '';
  };
  Expression.prototype.isDesignation = function () {
    return this.data.nodeType === NodeType$VARIABLE_getInstance() ? true : equals(this.data.value, '') && this.data.children.size === 1 && this.data.children.get_za3lpa$(0).nodeType === NodeType$VARIABLE_getInstance() ? true : false;
  };
  function Expression$Companion() {
    Expression$Companion_instance = this;
  }
  Expression$Companion.prototype.parseFromFactIdentifier_yhp8gb$ = function (string, parent, functionConfiguration) {
    if (parent === void 0)
      parent = null;
    var $receiver = (new VariableConfiguration()).variableImmediateReplacementRules;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var item = tmp$.next();
      destination.add_11rb$(new Pair(item.left, item.right));
    }
    var expressionTreeParser = new ExpressionTreeParser(string, true, functionConfiguration, mapOf_0(copyToArray(destination).slice()));
    var error = expressionTreeParser.parse();
    return new Expression(0, 0, expressionTreeParser.root, void 0, parent);
  };
  Expression$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var Expression$Companion_instance = null;
  function Expression$Companion_getInstance() {
    if (Expression$Companion_instance === null) {
      new Expression$Companion();
    }
    return Expression$Companion_instance;
  }
  Expression.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'Expression',
    interfaces: [MainChainPart]
  };
  function emptyExpression() {
    return new Expression(0, 0, new ExpressionNode(NodeType$EMPTY_getInstance(), ''));
  }
  function ExpressionChain(startPosition, endPosition, comparisonType, chain, identifier) {
    if (startPosition === void 0)
      startPosition = 0;
    if (endPosition === void 0)
      endPosition = 0;
    if (chain === void 0) {
      chain = ArrayList_init();
    }
    if (identifier === void 0)
      identifier = '';
    this.startPosition_wh0vy7$_0 = startPosition;
    this.endPosition_pcyana$_0 = endPosition;
    this.comparisonType = comparisonType;
    this.chain = chain;
    this.identifier_bapi3l$_0 = identifier;
  }
  Object.defineProperty(ExpressionChain.prototype, 'startPosition', {
    get: function () {
      return this.startPosition_wh0vy7$_0;
    }
  });
  Object.defineProperty(ExpressionChain.prototype, 'endPosition', {
    get: function () {
      return this.endPosition_pcyana$_0;
    }
  });
  Object.defineProperty(ExpressionChain.prototype, 'identifier', {
    get: function () {
      return this.identifier_bapi3l$_0;
    },
    set: function (identifier) {
      this.identifier_bapi3l$_0 = identifier;
    }
  });
  ExpressionChain.prototype.type = function () {
    return ComparableTransformationPartType$EXPRESSION_CHAIN_getInstance();
  };
  function ExpressionChain$toString$lambda(it) {
    return it.toString();
  }
  ExpressionChain.prototype.toString = function () {
    return joinToString(this.chain, this.comparisonType.string, void 0, void 0, void 0, void 0, ExpressionChain$toString$lambda);
  };
  ExpressionChain.prototype.copyNode = function () {
    return new ExpressionChain(this.startPosition, this.endPosition, this.comparisonType, ArrayList_init());
  };
  ExpressionChain.prototype.cloneWithNormalization_1g1bdl$ = function (nameArgsMap, sorted) {
    var tmp$ = this.startPosition;
    var tmp$_0 = this.endPosition;
    var tmp$_1 = this.comparisonType;
    var $receiver = this.chain;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$_2;
    tmp$_2 = $receiver.iterator();
    while (tmp$_2.hasNext()) {
      var item = tmp$_2.next();
      destination.add_11rb$(item.cloneWithNormalization_1g1bdl$(nameArgsMap, sorted));
    }
    return new ExpressionChain(tmp$, tmp$_0, tmp$_1, toMutableList(destination));
  };
  ExpressionChain.prototype.variableReplacement_y0zsll$ = function (replacements) {
    var tmp$;
    tmp$ = this.chain.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.variableReplacement_y0zsll$(replacements);
    }
  };
  function ExpressionChain$computeIdentifier$lambda(closure$recomputeIfComputed) {
    return function (it) {
      return it.computeIdentifier_6taknv$(closure$recomputeIfComputed);
    };
  }
  ExpressionChain.prototype.computeIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.identifier) || recomputeIfComputed) {
      this.identifier = joinToString(this.chain, this.comparisonType.string, void 0, void 0, void 0, void 0, ExpressionChain$computeIdentifier$lambda(recomputeIfComputed));
    }
    return this.identifier;
  };
  ExpressionChain.prototype.computeInIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  ExpressionChain.prototype.computeOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  ExpressionChain.prototype.computeSortedOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  function ExpressionChain$check$lambda() {
    return 'Start checking expression chain';
  }
  function ExpressionChain$check$lambda_0() {
    return 'expression chain: ';
  }
  function ExpressionChain$check$lambda_1() {
    return '';
  }
  function ExpressionChain$check$lambda_2(closure$currentLogLevel) {
    return function () {
      return 'Current log level: ' + closure$currentLogLevel.v;
    };
  }
  function ExpressionChain$check$lambda_3() {
    return 'currentLeftIndex';
  }
  function ExpressionChain$check$lambda_4() {
    return 'currentRightIndex';
  }
  function ExpressionChain$check$lambda_5() {
    return 'Check RULE';
  }
  function ExpressionChain$check$lambda_6() {
    return 'Expression transformation recognized:';
  }
  function ExpressionChain$check$lambda_7() {
    return 'RULE VERIFICATION_FAILED';
  }
  function ExpressionChain$check$lambda_8() {
    return 'RULE CANNOT_BE_APPLIED_TO_EXPRESSIONS -> VERIFICATION_FAILED';
  }
  function ExpressionChain$check$lambda_9() {
    return "Coloring task on positions: '";
  }
  function ExpressionChain$check$lambda_10() {
    return "' - '";
  }
  function ExpressionChain$check$lambda_11() {
    return "', factNotHelpFactColor = '";
  }
  function ExpressionChain$check$lambda_12() {
    return '';
  }
  function ExpressionChain$check$lambda_13() {
    return "Handling RULE_REFERENCE '";
  }
  function ExpressionChain$check$lambda_14() {
    return "'";
  }
  function ExpressionChain$check$lambda_15() {
    return "ERROR: RULE_REFERENCE '";
  }
  function ExpressionChain$check$lambda_16() {
    return "' not found";
  }
  function ExpressionChain$check$lambda_17() {
    return "Coloring task on positions: '";
  }
  function ExpressionChain$check$lambda_18() {
    return "' - '";
  }
  function ExpressionChain$check$lambda_19() {
    return "', wrongFactColor = '";
  }
  function ExpressionChain$check$lambda_20() {
    return '';
  }
  function ExpressionChain$check$lambda_21(it) {
    return "'" + it + "'";
  }
  function ExpressionChain$check$lambda_22() {
    return 'currentRightIndex';
  }
  function ExpressionChain$check$lambda_23() {
    return 'Check transformation from left fact to right fact:';
  }
  function ExpressionChain$check$lambda_24() {
    return 'Left expression: ';
  }
  function ExpressionChain$check$lambda_25() {
    return 'Right expression: ';
  }
  function ExpressionChain$check$lambda_26() {
    return "Coloring task on positions: '";
  }
  function ExpressionChain$check$lambda_27() {
    return "' - '";
  }
  function ExpressionChain$check$lambda_28() {
    return "', color = '";
  }
  function ExpressionChain$check$lambda_29() {
    return '';
  }
  function ExpressionChain$check$lambda_30() {
    return "Transformation verified, isInTaskContext: '";
  }
  function ExpressionChain$check$lambda_31() {
    return "'";
  }
  function ExpressionChain$check$lambda_32() {
    return 'additionalFactUsed';
  }
  function ExpressionChain$check$lambda_33() {
    return "Coloring task on positions: '";
  }
  function ExpressionChain$check$lambda_34() {
    return "' - '";
  }
  function ExpressionChain$check$lambda_35() {
    return "', factNotHelpFactColor = '";
  }
  function ExpressionChain$check$lambda_36() {
    return '';
  }
  function ExpressionChain$check$lambda_37() {
    return 'VERIFICATION_FAILED';
  }
  function ExpressionChain$check$lambda_38() {
    return 'Left expression: ';
  }
  function ExpressionChain$check$lambda_39() {
    return 'Right expression: ';
  }
  function ExpressionChain$check$lambda_40() {
    return "Coloring task on positions: '";
  }
  function ExpressionChain$check$lambda_41() {
    return "' - '";
  }
  function ExpressionChain$check$lambda_42() {
    return "', correctFactColor = '";
  }
  function ExpressionChain$check$lambda_43() {
    return '';
  }
  function ExpressionChain$check$lambda_44() {
    return 'TRANSFORMATION_VERIFIED and correct not only in task context';
  }
  function ExpressionChain$check$lambda_45() {
    return 'VERIFICATION_FAILED not only in task context. Try to check transformation only in task context';
  }
  function ExpressionChain$check$lambda_46() {
    return "Coloring task on positions: '";
  }
  function ExpressionChain$check$lambda_47() {
    return "' - '";
  }
  function ExpressionChain$check$lambda_48() {
    return "', correctFactColor = '";
  }
  function ExpressionChain$check$lambda_49() {
    return '';
  }
  function ExpressionChain$check$lambda_50() {
    return 'TRANSFORMATION_VERIFIED and correct only in task context';
  }
  function ExpressionChain$check$lambda_51() {
    return 'additionalFactUsed';
  }
  function ExpressionChain$check$lambda_52() {
    return 'Transformation not verified, try to check transformation with rules and additional facts';
  }
  function ExpressionChain$check$lambda_53() {
    return "Coloring task on positions: '";
  }
  function ExpressionChain$check$lambda_54() {
    return "' - '";
  }
  function ExpressionChain$check$lambda_55() {
    return "', color = '";
  }
  function ExpressionChain$check$lambda_56() {
    return '';
  }
  function ExpressionChain$check$lambda_57() {
    return 'additionalFactUsed';
  }
  function ExpressionChain$check$lambda_58() {
    return "Coloring task on positions: '";
  }
  function ExpressionChain$check$lambda_59() {
    return "' - '";
  }
  function ExpressionChain$check$lambda_60() {
    return "', wrongFactColor = '";
  }
  function ExpressionChain$check$lambda_61() {
    return '';
  }
  function ExpressionChain$check$lambda_62() {
    return 'VERIFICATION_FAILED';
  }
  function ExpressionChain$check$lambda_63() {
    return 'currentLeftIndex';
  }
  function ExpressionChain$check$lambda_64() {
    return 'currentRightIndex';
  }
  function ExpressionChain$check$lambda_65(this$ExpressionChain) {
    return function () {
      return CheckingKeyWords$Companion_getInstance().expressionChainVerified + ". '" + first(this$ExpressionChain.chain) + "' " + this$ExpressionChain.comparisonType.string + " '" + last(this$ExpressionChain.chain) + "'";
    };
  }
  ExpressionChain.prototype.check_l8pk6u$ = function (factComporator, onExpressionLevel, factsTransformations, expressionTransformations, additionalFacts) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11, tmp$_12, tmp$_13, tmp$_14, tmp$_15, tmp$_16, tmp$_17, tmp$_18, tmp$_19, tmp$_20;
    log_1.addMessage_bda5c9$(ExpressionChain$check$lambda, MessageType$USER_getInstance(), void 0, 1);
    log_1.add_f1hiuo$(this.chain.toString(), ExpressionChain$check$lambda_0, ExpressionChain$check$lambda_1);
    var currentLogLevel = {v: log_1.currentLevel};
    log_1.addMessage_bda5c9$(ExpressionChain$check$lambda_2(currentLogLevel), void 0, currentLogLevel.v);
    var coloringTasks = ArrayList_init();
    var currentLeftIndex = log_1.assignAndLog_746w4o$(0, currentLogLevel.v, ExpressionChain$check$lambda_3);
    var currentRightIndex = log_1.assignAndLog_746w4o$(1, currentLogLevel.v, ExpressionChain$check$lambda_4);
    var additionalFactUsed = false;
    while (currentRightIndex < this.chain.size) {
      if (this.chain.get_za3lpa$(currentRightIndex).type() !== ComparableTransformationPartType$EXPRESSION_getInstance()) {
        if (this.chain.get_za3lpa$(currentRightIndex).type() === ComparableTransformationPartType$RULE_getInstance()) {
          var rule = Kotlin.isType(tmp$ = this.chain.get_za3lpa$(currentRightIndex), Rule) ? tmp$ : throwCCE();
          log_1.addMessageWithFactDetail_5zaetr$(ExpressionChain$check$lambda_5, rule.root, MessageType$USER_getInstance(), currentLogLevel.v);
          var checkingResult = rule.check_l8pk6u$(factComporator, false, factsTransformations, expressionTransformations, additionalFacts);
          if (checkingResult.isCorrect && rule.expressionSubstitution != null) {
            log_1.addMessageWithExpressionSubstitutionShort_ht2yvq$(ExpressionChain$check$lambda_6, ensureNotNull(rule.expressionSubstitution), MessageType$USER_getInstance(), currentLogLevel.v);
            tmp$_1 = ensureNotNull(rule.expressionSubstitution);
          }
           else {
            if (!checkingResult.isCorrect) {
              log_1.addMessage_bda5c9$(ExpressionChain$check$lambda_7, MessageType$USER_getInstance(), currentLogLevel.v);
              coloringTasks.addAll_brywnq$(checkingResult.coloringTasks);
              return new ComparisonResult(false, coloringTasks, this.chain.get_za3lpa$(currentLeftIndex), this.chain.get_za3lpa$(currentRightIndex + 1 | 0), 'RULE VERIFICATION_FAILED');
            }
             else {
              log_1.addMessage_bda5c9$(ExpressionChain$check$lambda_8, MessageType$USER_getInstance(), currentLogLevel.v);
              log_1.add_sf5b3k$(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex + 1 | 0).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.factNotHelpFactColor, ExpressionChain$check$lambda_9, ExpressionChain$check$lambda_10, ExpressionChain$check$lambda_11, ExpressionChain$check$lambda_12, currentLogLevel.v);
              coloringTasks.add_11rb$(new ColoringTask(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex + 1 | 0).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.factNotHelpFactColor));
              return new ComparisonResult(false, coloringTasks, this.chain.get_za3lpa$(currentLeftIndex), this.chain.get_za3lpa$(currentRightIndex + 1 | 0), 'RULE CANNOT_BE_APPLIED_TO_EXPRESSIONS');
            }
          }
        }
         else {
          var ruleName = (Kotlin.isType(tmp$_0 = this.chain.get_za3lpa$(currentRightIndex), RulePointer) ? tmp$_0 : throwCCE()).nameLink;
          log_1.add_f1hiuo$(ruleName, ExpressionChain$check$lambda_13, ExpressionChain$check$lambda_14, currentLogLevel.v, void 0, MessageType$USER_getInstance());
          var destination = ArrayList_init();
          var tmp$_21;
          tmp$_21 = expressionTransformations.iterator();
          while (tmp$_21.hasNext()) {
            var element = tmp$_21.next();
            if (equals(element.code, ruleName))
              destination.add_11rb$(element);
          }
          var rules = destination;
          if (rules.isEmpty()) {
            log_1.add_f1hiuo$(ruleName, ExpressionChain$check$lambda_15, ExpressionChain$check$lambda_16, currentLogLevel.v, void 0, MessageType$USER_getInstance());
            log_1.add_sf5b3k$(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex + 1 | 0).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.wrongFactColor, ExpressionChain$check$lambda_17, ExpressionChain$check$lambda_18, ExpressionChain$check$lambda_19, ExpressionChain$check$lambda_20, currentLogLevel.v);
            coloringTasks.add_11rb$(new ColoringTask(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex + 1 | 0).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.wrongFactColor));
            var tmp$_22 = this.chain.get_za3lpa$(currentLeftIndex);
            var tmp$_23 = this.chain.get_za3lpa$(currentRightIndex + 1 | 0);
            var tmp$_24 = "Rule with name '" + ruleName + "' not found. Exists only rules with names: ";
            var destination_0 = ArrayList_init_0(collectionSizeOrDefault(expressionTransformations, 10));
            var tmp$_25;
            tmp$_25 = expressionTransformations.iterator();
            while (tmp$_25.hasNext()) {
              var item = tmp$_25.next();
              destination_0.add_11rb$(item.code);
            }
            var destination_1 = ArrayList_init();
            var tmp$_26;
            tmp$_26 = destination_0.iterator();
            while (tmp$_26.hasNext()) {
              var element_0 = tmp$_26.next();
              if (!isBlank(element_0))
                destination_1.add_11rb$(element_0);
            }
            return new ComparisonResult(false, coloringTasks, tmp$_22, tmp$_23, tmp$_24 + joinToString(destination_1, void 0, void 0, void 0, void 0, void 0, ExpressionChain$check$lambda_21));
          }
          tmp$_1 = first(rules);
        }
        var transformation = tmp$_1;
        currentRightIndex = log_1.assignAndLog_746w4o$(currentRightIndex + 1 | 0, currentLogLevel.v, ExpressionChain$check$lambda_22);
        log_1.addMessage_bda5c9$(ExpressionChain$check$lambda_23, MessageType$USER_getInstance(), currentLogLevel.v);
        currentLogLevel.v = currentLogLevel.v + 1 | 0;
        log_1.addMessageWithExpression_kf0d7z$(ExpressionChain$check$lambda_24, (Kotlin.isType(tmp$_2 = this.chain.get_za3lpa$(currentLeftIndex), Expression) ? tmp$_2 : throwCCE()).data, MessageType$USER_getInstance(), currentLogLevel.v);
        log_1.addMessageWithExpression_kf0d7z$(ExpressionChain$check$lambda_25, (Kotlin.isType(tmp$_3 = this.chain.get_za3lpa$(currentRightIndex), Expression) ? tmp$_3 : throwCCE()).data, MessageType$USER_getInstance(), currentLogLevel.v);
        var result = factComporator.expressionComporator.compareWithTreeTransformationRules_ob15jn$((Kotlin.isType(tmp$_4 = this.chain.get_za3lpa$(currentLeftIndex), Expression) ? tmp$_4 : throwCCE()).data, (Kotlin.isType(tmp$_5 = this.chain.get_za3lpa$(currentRightIndex), Expression) ? tmp$_5 : throwCCE()).data, listOf(transformation), void 0, void 0, void 0, this.comparisonType, factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
        if (result) {
          log_1.add_sf5b3k$(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.correctFactColor, ExpressionChain$check$lambda_26, ExpressionChain$check$lambda_27, ExpressionChain$check$lambda_28, ExpressionChain$check$lambda_29, currentLogLevel.v);
          coloringTasks.add_11rb$(new ColoringTask(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.correctFactColor));
          log_1.add_f1hiuo$(transformation.basedOnTaskContext, ExpressionChain$check$lambda_30, ExpressionChain$check$lambda_31, currentLogLevel.v, void 0, MessageType$USER_getInstance());
          if (transformation.basedOnTaskContext) {
            additionalFactUsed = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, ExpressionChain$check$lambda_32);
          }
        }
         else {
          log_1.add_sf5b3k$(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.factNotHelpFactColor, ExpressionChain$check$lambda_33, ExpressionChain$check$lambda_34, ExpressionChain$check$lambda_35, ExpressionChain$check$lambda_36, currentLogLevel.v);
          coloringTasks.add_11rb$(new ColoringTask(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.factNotHelpFactColor));
          log_1.addMessage_bda5c9$(ExpressionChain$check$lambda_37, MessageType$USER_getInstance(), currentLogLevel.v);
          return new ComparisonResult(false, coloringTasks, this.chain.get_za3lpa$(currentLeftIndex), this.chain.get_za3lpa$(currentRightIndex), "Unclear transformation between '" + (Kotlin.isType(tmp$_6 = this.chain.get_za3lpa$(currentLeftIndex), Expression) ? tmp$_6 : throwCCE()).data + "' and '" + (Kotlin.isType(tmp$_7 = this.chain.get_za3lpa$(currentRightIndex), Expression) ? tmp$_7 : throwCCE()).data + "' even with rule");
        }
        currentLogLevel.v = currentLogLevel.v - 1 | 0;
      }
       else {
        log_1.addMessageWithExpression_kf0d7z$(ExpressionChain$check$lambda_38, (Kotlin.isType(tmp$_8 = this.chain.get_za3lpa$(currentLeftIndex), Expression) ? tmp$_8 : throwCCE()).data, MessageType$USER_getInstance(), currentLogLevel.v);
        log_1.addMessageWithExpression_kf0d7z$(ExpressionChain$check$lambda_39, (Kotlin.isType(tmp$_9 = this.chain.get_za3lpa$(currentRightIndex), Expression) ? tmp$_9 : throwCCE()).data, MessageType$USER_getInstance(), currentLogLevel.v);
        tmp$_14 = factComporator.expressionComporator;
        tmp$_11 = (Kotlin.isType(tmp$_10 = this.chain.get_za3lpa$(currentLeftIndex), Expression) ? tmp$_10 : throwCCE()).data;
        tmp$_13 = (Kotlin.isType(tmp$_12 = this.chain.get_za3lpa$(currentRightIndex), Expression) ? tmp$_12 : throwCCE()).data;
        var destination_2 = ArrayList_init();
        var tmp$_27;
        tmp$_27 = expressionTransformations.iterator();
        while (tmp$_27.hasNext()) {
          var element_1 = tmp$_27.next();
          if (!element_1.basedOnTaskContext)
            destination_2.add_11rb$(element_1);
        }
        var $receiver = factComporator.compiledConfiguration.compiledExpressionTreeTransformationRules;
        var destination_3 = ArrayList_init();
        var tmp$_28;
        tmp$_28 = $receiver.iterator();
        while (tmp$_28.hasNext()) {
          var element_2 = tmp$_28.next();
          if (!element_2.basedOnTaskContext)
            destination_3.add_11rb$(element_2);
        }
        var result_0 = tmp$_14.compareWithTreeTransformationRules_ob15jn$(tmp$_11, tmp$_13, plus(destination_2, destination_3), void 0, void 0, void 0, this.comparisonType, factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
        if (result_0) {
          log_1.add_sf5b3k$(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.correctFactColor, ExpressionChain$check$lambda_40, ExpressionChain$check$lambda_41, ExpressionChain$check$lambda_42, ExpressionChain$check$lambda_43, currentLogLevel.v);
          coloringTasks.add_11rb$(new ColoringTask(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.correctFactColor));
          log_1.addMessage_bda5c9$(ExpressionChain$check$lambda_44, MessageType$USER_getInstance(), currentLogLevel.v);
        }
         else {
          log_1.addMessage_bda5c9$(ExpressionChain$check$lambda_45, MessageType$USER_getInstance(), currentLogLevel.v);
          var resultInContext = factComporator.expressionComporator.compareWithTreeTransformationRules_ob15jn$((Kotlin.isType(tmp$_15 = this.chain.get_za3lpa$(currentLeftIndex), Expression) ? tmp$_15 : throwCCE()).data, (Kotlin.isType(tmp$_16 = this.chain.get_za3lpa$(currentRightIndex), Expression) ? tmp$_16 : throwCCE()).data, plus(expressionTransformations, factComporator.compiledConfiguration.compiledExpressionTreeTransformationRules), void 0, void 0, void 0, this.comparisonType, factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
          if (resultInContext) {
            log_1.add_sf5b3k$(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.correctFactColor, ExpressionChain$check$lambda_46, ExpressionChain$check$lambda_47, ExpressionChain$check$lambda_48, ExpressionChain$check$lambda_49, currentLogLevel.v);
            coloringTasks.add_11rb$(new ColoringTask(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.correctFactColor));
            log_1.addMessage_bda5c9$(ExpressionChain$check$lambda_50, MessageType$USER_getInstance(), currentLogLevel.v);
            additionalFactUsed = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, ExpressionChain$check$lambda_51);
          }
           else {
            log_1.addMessage_bda5c9$(ExpressionChain$check$lambda_52);
            var fullFact = new ExpressionComparison(void 0, void 0, Kotlin.isType(tmp$_17 = this.chain.get_za3lpa$(currentLeftIndex), Expression) ? tmp$_17 : throwCCE(), Kotlin.isType(tmp$_18 = this.chain.get_za3lpa$(currentRightIndex), Expression) ? tmp$_18 : throwCCE(), this.comparisonType);
            var tmp$_29 = new MainLineAndNode();
            var tmp$_30 = new MainLineAndNode(void 0, void 0, void 0, void 0, mutableListOf([fullFact]));
            var destination_4 = ArrayList_init_0(collectionSizeOrDefault(additionalFacts, 10));
            var tmp$_31;
            tmp$_31 = additionalFacts.iterator();
            while (tmp$_31.hasNext()) {
              var item_0 = tmp$_31.next();
              destination_4.add_11rb$(item_0.computeOutIdentifier_6taknv$(true));
            }
            var result_1 = factComporator.compareAsIs_hsjydo$(tmp$_29, tmp$_30, sorted(destination_4));
            if (result_1) {
              log_1.add_sf5b3k$(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.factHelpFactColor, ExpressionChain$check$lambda_53, ExpressionChain$check$lambda_54, ExpressionChain$check$lambda_55, ExpressionChain$check$lambda_56, currentLogLevel.v);
              coloringTasks.add_11rb$(new ColoringTask(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.factHelpFactColor));
              additionalFactUsed = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, ExpressionChain$check$lambda_57);
            }
             else {
              log_1.add_sf5b3k$(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.wrongTransformationFactColor, ExpressionChain$check$lambda_58, ExpressionChain$check$lambda_59, ExpressionChain$check$lambda_60, ExpressionChain$check$lambda_61, currentLogLevel.v);
              coloringTasks.add_11rb$(new ColoringTask(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.wrongTransformationFactColor));
              log_1.addMessage_bda5c9$(ExpressionChain$check$lambda_62, MessageType$USER_getInstance(), currentLogLevel.v);
              return new ComparisonResult(false, coloringTasks, this.chain.get_za3lpa$(currentLeftIndex), this.chain.get_za3lpa$(currentRightIndex), "Unclear transformation between '" + (Kotlin.isType(tmp$_19 = this.chain.get_za3lpa$(currentLeftIndex), Expression) ? tmp$_19 : throwCCE()).data + "' and '" + (Kotlin.isType(tmp$_20 = this.chain.get_za3lpa$(currentRightIndex), Expression) ? tmp$_20 : throwCCE()).data + "' ");
            }
          }
        }
      }
      currentLeftIndex = log_1.assignAndLog_746w4o$(currentRightIndex, currentLogLevel.v, ExpressionChain$check$lambda_63);
      currentRightIndex = log_1.assignAndLog_746w4o$(currentRightIndex + 1 | 0, currentLogLevel.v, ExpressionChain$check$lambda_64);
    }
    log_1.addMessage_bda5c9$(ExpressionChain$check$lambda_65(this), MessageType$USER_getInstance(), currentLogLevel.v);
    return new ComparisonResult(true, coloringTasks, first(this.chain), last(this.chain), void 0, additionalFactUsed);
  };
  ExpressionChain.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionChain',
    interfaces: [ComparableTransformationsPart]
  };
  function ExpressionComparison(startPosition, endPosition, leftExpression, rightExpression, comparisonType, parent, identifier) {
    ExpressionComparison$Companion_getInstance();
    if (startPosition === void 0)
      startPosition = 0;
    if (endPosition === void 0)
      endPosition = 0;
    if (parent === void 0)
      parent = null;
    if (identifier === void 0)
      identifier = '';
    this.startPosition_pwf2cv$_0 = startPosition;
    this.endPosition_dmcg3c$_0 = endPosition;
    this.leftExpression = leftExpression;
    this.rightExpression = rightExpression;
    this.comparisonType = comparisonType;
    this.parent_nd1ewe$_0 = parent;
    this.identifier_54c48h$_0 = identifier;
  }
  Object.defineProperty(ExpressionComparison.prototype, 'startPosition', {
    get: function () {
      return this.startPosition_pwf2cv$_0;
    }
  });
  Object.defineProperty(ExpressionComparison.prototype, 'endPosition', {
    get: function () {
      return this.endPosition_dmcg3c$_0;
    }
  });
  Object.defineProperty(ExpressionComparison.prototype, 'parent', {
    get: function () {
      return this.parent_nd1ewe$_0;
    },
    set: function (parent) {
      this.parent_nd1ewe$_0 = parent;
    }
  });
  Object.defineProperty(ExpressionComparison.prototype, 'identifier', {
    get: function () {
      return this.identifier_54c48h$_0;
    },
    set: function (identifier) {
      this.identifier_54c48h$_0 = identifier;
    }
  });
  ExpressionComparison.prototype.getLastExpression = function () {
    return this.rightExpression.getLastExpression();
  };
  ExpressionComparison.prototype.isSolutionWithoutFunctions_cbql57$ = function (forbidden, targetExpression, factComporator) {
    if (!targetExpression.children.isEmpty() && !factComporator.expressionComporator.compareAsIs_98xwbf$(this.leftExpression.data, targetExpression)) {
      return new GeneralError('Wrong start expression');
    }
    return this.rightExpression.isSolutionWithoutFunctions_cbql57$(forbidden, targetExpression, factComporator);
  };
  ExpressionComparison.prototype.isFactorizationForVariables_3b7jn6$ = function (minNumberOfMultipliers, targetVariables, targetExpression, factComporator) {
    if (!factComporator.expressionComporator.compareAsIs_98xwbf$(this.leftExpression.data, targetExpression)) {
      return new GeneralError('Wrong start expression');
    }
    return this.rightExpression.isFactorizationForVariables_3b7jn6$(minNumberOfMultipliers, targetVariables, targetExpression, factComporator);
  };
  ExpressionComparison.prototype.hasNoFractions_5ah4l7$ = function (maxNumberOfDivisions, targetExpression, factComporator) {
    if (!factComporator.expressionComporator.compareAsIs_98xwbf$(this.leftExpression.data, targetExpression)) {
      return new GeneralError('Wrong start expression');
    }
    return this.rightExpression.hasNoFractions_5ah4l7$(maxNumberOfDivisions, targetExpression, factComporator);
  };
  ExpressionComparison.prototype.isSolutionForVariables_axkv0l$$default = function (targetVariables, left, allowedVariables) {
    var error = this.leftExpression.isSolutionForVariables_axkv0l$(targetVariables, true, allowedVariables);
    if (error != null) {
      return error;
    }
    return this.rightExpression.isSolutionForVariables_axkv0l$(targetVariables, false, allowedVariables);
  };
  ExpressionComparison.prototype.variableReplacement_y0zsll$ = function (replacements) {
    this.leftExpression.variableReplacement_y0zsll$(replacements);
    this.rightExpression.variableReplacement_y0zsll$(replacements);
  };
  function ExpressionComparison$check$lambda() {
    return 'Start checking expression comparison';
  }
  function ExpressionComparison$check$lambda_0(closure$currentLogLevel) {
    return function () {
      return 'Current log level: ' + closure$currentLogLevel.v;
    };
  }
  function ExpressionComparison$check$lambda_1() {
    return 'Left expression: ';
  }
  function ExpressionComparison$check$lambda_2() {
    return 'Right expression: ';
  }
  function ExpressionComparison$check$lambda_3() {
    return "Coloring task on positions: '";
  }
  function ExpressionComparison$check$lambda_4() {
    return "' - '";
  }
  function ExpressionComparison$check$lambda_5() {
    return "', correctFactColor = '";
  }
  function ExpressionComparison$check$lambda_6() {
    return '';
  }
  function ExpressionComparison$check$lambda_7() {
    return 'TRANSFORMATION_VERIFIED and correct not only in task context';
  }
  function ExpressionComparison$check$lambda_8() {
    return 'VERIFICATION_FAILED not only in task context. Try to check transformation only in task context';
  }
  function ExpressionComparison$check$lambda_9() {
    return "Coloring task on positions: '";
  }
  function ExpressionComparison$check$lambda_10() {
    return "' - '";
  }
  function ExpressionComparison$check$lambda_11() {
    return "', correctFactColor = '";
  }
  function ExpressionComparison$check$lambda_12() {
    return '';
  }
  function ExpressionComparison$check$lambda_13() {
    return 'TRANSFORMATION_VERIFIED and correct only in task context';
  }
  function ExpressionComparison$check$lambda_14() {
    return 'additionalFactUsed';
  }
  function ExpressionComparison$check$lambda_15() {
    return 'Transformation not verified, try to check transformation with rules and additional facts';
  }
  function ExpressionComparison$check$lambda_16() {
    return "Coloring task on positions: '";
  }
  function ExpressionComparison$check$lambda_17() {
    return "' - '";
  }
  function ExpressionComparison$check$lambda_18() {
    return "', color = '";
  }
  function ExpressionComparison$check$lambda_19() {
    return '';
  }
  function ExpressionComparison$check$lambda_20() {
    return 'additionalFactUsed';
  }
  function ExpressionComparison$check$lambda_21() {
    return "Coloring task on positions: '";
  }
  function ExpressionComparison$check$lambda_22() {
    return "' - '";
  }
  function ExpressionComparison$check$lambda_23() {
    return "', wrongFactColor = '";
  }
  function ExpressionComparison$check$lambda_24() {
    return '';
  }
  function ExpressionComparison$check$lambda_25() {
    return 'VERIFICATION_FAILED';
  }
  ExpressionComparison.prototype.check_l8pk6u$ = function (factComporator, onExpressionLevel, factsTransformations, expressionTransformations, additionalFacts) {
    log_1.addMessage_bda5c9$(ExpressionComparison$check$lambda, MessageType$USER_getInstance(), void 0, 1);
    var currentLogLevel = {v: log_1.currentLevel};
    log_1.addMessage_bda5c9$(ExpressionComparison$check$lambda_0(currentLogLevel), void 0, currentLogLevel.v);
    log_1.addMessageWithExpression_kf0d7z$(ExpressionComparison$check$lambda_1, this.leftExpression.data, MessageType$USER_getInstance(), currentLogLevel.v);
    log_1.addMessageWithExpression_kf0d7z$(ExpressionComparison$check$lambda_2, this.rightExpression.data, MessageType$USER_getInstance(), currentLogLevel.v);
    var coloringTasks = ArrayList_init();
    var additionalFactUsed = false;
    var tmp$ = factComporator.expressionComporator;
    var tmp$_0 = this.leftExpression.data;
    var tmp$_1 = this.rightExpression.data;
    var destination = ArrayList_init();
    var tmp$_2;
    tmp$_2 = expressionTransformations.iterator();
    while (tmp$_2.hasNext()) {
      var element = tmp$_2.next();
      if (!element.basedOnTaskContext)
        destination.add_11rb$(element);
    }
    var result = tmp$.compareWithTreeTransformationRules_ob15jn$(tmp$_0, tmp$_1, plus(destination, factComporator.compiledConfiguration.compiledExpressionTreeTransformationRules), void 0, void 0, void 0, this.comparisonType, factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
    if (result) {
      log_1.add_sf5b3k$(this.leftExpression.endPosition, this.rightExpression.startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.correctFactColor, ExpressionComparison$check$lambda_3, ExpressionComparison$check$lambda_4, ExpressionComparison$check$lambda_5, ExpressionComparison$check$lambda_6, currentLogLevel.v);
      coloringTasks.add_11rb$(new ColoringTask(this.leftExpression.endPosition, this.rightExpression.startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.correctFactColor));
      log_1.addMessage_bda5c9$(ExpressionComparison$check$lambda_7, MessageType$USER_getInstance(), currentLogLevel.v);
    }
     else {
      log_1.addMessage_bda5c9$(ExpressionComparison$check$lambda_8, MessageType$USER_getInstance(), currentLogLevel.v);
      var tmp$_3 = factComporator.expressionComporator;
      var tmp$_4 = this.leftExpression.data;
      var tmp$_5 = this.rightExpression.data;
      var destination_0 = ArrayList_init();
      var tmp$_6;
      tmp$_6 = expressionTransformations.iterator();
      while (tmp$_6.hasNext()) {
        var element_0 = tmp$_6.next();
        if (element_0.basedOnTaskContext)
          destination_0.add_11rb$(element_0);
      }
      var resultInContext = tmp$_3.compareWithTreeTransformationRules_ob15jn$(tmp$_4, tmp$_5, destination_0, void 0, void 0, void 0, this.comparisonType, factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
      if (resultInContext) {
        log_1.add_sf5b3k$(this.leftExpression.endPosition, this.rightExpression.startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.correctFactColor, ExpressionComparison$check$lambda_9, ExpressionComparison$check$lambda_10, ExpressionComparison$check$lambda_11, ExpressionComparison$check$lambda_12, currentLogLevel.v);
        coloringTasks.add_11rb$(new ColoringTask(this.leftExpression.endPosition, this.rightExpression.startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.correctFactColor));
        log_1.addMessage_bda5c9$(ExpressionComparison$check$lambda_13, MessageType$USER_getInstance(), currentLogLevel.v);
        additionalFactUsed = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, ExpressionComparison$check$lambda_14);
      }
       else {
        log_1.addMessage_bda5c9$(ExpressionComparison$check$lambda_15);
        var tmp$_7 = new MainLineAndNode();
        var tmp$_8 = new MainLineAndNode(void 0, void 0, void 0, void 0, mutableListOf([this]));
        var destination_1 = ArrayList_init_0(collectionSizeOrDefault(additionalFacts, 10));
        var tmp$_9;
        tmp$_9 = additionalFacts.iterator();
        while (tmp$_9.hasNext()) {
          var item = tmp$_9.next();
          destination_1.add_11rb$(item.computeOutIdentifier_6taknv$(true));
        }
        var result_0 = factComporator.compareAsIs_hsjydo$(tmp$_7, tmp$_8, sorted(destination_1));
        if (result_0) {
          log_1.add_sf5b3k$(this.leftExpression.endPosition, this.rightExpression.startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.factHelpFactColor, ExpressionComparison$check$lambda_16, ExpressionComparison$check$lambda_17, ExpressionComparison$check$lambda_18, ExpressionComparison$check$lambda_19, currentLogLevel.v);
          coloringTasks.add_11rb$(new ColoringTask(this.leftExpression.endPosition, this.rightExpression.startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.factHelpFactColor));
          additionalFactUsed = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, ExpressionComparison$check$lambda_20);
        }
         else {
          log_1.add_sf5b3k$(this.leftExpression.endPosition, this.rightExpression.startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.wrongTransformationFactColor, ExpressionComparison$check$lambda_21, ExpressionComparison$check$lambda_22, ExpressionComparison$check$lambda_23, ExpressionComparison$check$lambda_24, currentLogLevel.v);
          coloringTasks.add_11rb$(new ColoringTask(this.leftExpression.endPosition, this.rightExpression.startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.wrongTransformationFactColor));
          log_1.addMessage_bda5c9$(ExpressionComparison$check$lambda_25, MessageType$USER_getInstance(), currentLogLevel.v);
          return new ComparisonResult(false, coloringTasks, this.leftExpression, this.rightExpression, "Unclear transformation between '" + this.leftExpression.data + "' and '" + this.rightExpression.data + "' ");
        }
      }
    }
    return new ComparisonResult(true, coloringTasks, this.leftExpression, this.rightExpression, void 0, additionalFactUsed);
  };
  ExpressionComparison.prototype.computeIfNumeric_z3m4ac$ = function (substitutionInstance, baseOperationsDefinitions) {
    var tmp$, tmp$_0, tmp$_1;
    tmp$ = this.leftExpression.computeIfNumeric_z3m4ac$(substitutionInstance, baseOperationsDefinitions);
    if (tmp$ == null) {
      return null;
    }
    var l = tmp$;
    tmp$_0 = this.rightExpression.computeIfNumeric_z3m4ac$(substitutionInstance, baseOperationsDefinitions);
    if (tmp$_0 == null) {
      return null;
    }
    var r = tmp$_0;
    switch (this.comparisonType.name) {
      case 'EQUAL':
        tmp$_1 = baseOperationsDefinitions.additivelyEqual_lu1900$(l, r);
        break;
      case 'LEFT_MORE_OR_EQUAL':
        tmp$_1 = l >= r;
        break;
      case 'LEFT_MORE':
        tmp$_1 = l > r;
        break;
      case 'LEFT_LESS_OR_EQUAL':
        tmp$_1 = l <= r;
        break;
      case 'LEFT_LESS':
        tmp$_1 = l < r;
        break;
      default:tmp$_1 = Kotlin.noWhenBranchMatched();
        break;
    }
    return tmp$_1;
  };
  ExpressionComparison.prototype.copyNode = function () {
    return new ExpressionComparison(this.startPosition, this.endPosition, emptyExpression(), emptyExpression(), this.comparisonType, this.parent, '');
  };
  ExpressionComparison.prototype.clone = function () {
    return new ExpressionComparison(this.startPosition, this.endPosition, this.leftExpression.clone(), this.rightExpression.clone(), this.comparisonType, this.parent);
  };
  ExpressionComparison.prototype.cloneWithNormalization_1g1bdl$ = function (nameArgsMap, sorted) {
    return new ExpressionComparison(this.startPosition, this.endPosition, this.leftExpression.cloneWithNormalization_1g1bdl$(nameArgsMap, sorted), this.rightExpression.cloneWithNormalization_1g1bdl$(nameArgsMap, sorted), this.comparisonType, this.parent);
  };
  ExpressionComparison.prototype.normalizeSubTree_f8z7ch$ = function (currentDeep, nameArgsMap, sorted) {
    this.leftExpression.normalizeSubTree_f8z7ch$(currentDeep, nameArgsMap, sorted);
    this.rightExpression.normalizeSubTree_f8z7ch$(currentDeep, nameArgsMap, sorted);
  };
  ExpressionComparison.prototype.applyAllExpressionSubstitutions_8sufjw$ = function (expressionSubstitutions) {
    this.leftExpression.applyAllExpressionSubstitutions_8sufjw$(expressionSubstitutions);
    this.rightExpression.applyAllExpressionSubstitutions_8sufjw$(expressionSubstitutions);
  };
  ExpressionComparison.prototype.computeExpressionTrees_dq72cu$ = function (baseOperationsDefinitions) {
    this.leftExpression.computeExpressionTrees_dq72cu$(baseOperationsDefinitions);
    this.rightExpression.computeExpressionTrees_dq72cu$(baseOperationsDefinitions);
  };
  ExpressionComparison.prototype.replaceNotDefinedFunctionsOnVariables_1vzej0$ = function (functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet) {
    this.leftExpression.replaceNotDefinedFunctionsOnVariables_1vzej0$(functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet);
    this.rightExpression.replaceNotDefinedFunctionsOnVariables_1vzej0$(functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet);
  };
  ExpressionComparison.prototype.type = function () {
    return ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance();
  };
  ExpressionComparison.prototype.toString = function () {
    return this.leftExpression.toString() + ';' + this.comparisonType.string + ';' + this.rightExpression;
  };
  ExpressionComparison.prototype.computeIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.identifier) || recomputeIfComputed) {
      this.identifier = this.leftExpression.computeIdentifier_6taknv$(recomputeIfComputed) + ';ec;' + this.comparisonType.string + ';ec;' + this.rightExpression.computeIdentifier_6taknv$(recomputeIfComputed);
    }
    return this.identifier;
  };
  ExpressionComparison.prototype.computeInIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  ExpressionComparison.prototype.computeOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  ExpressionComparison.prototype.computeSortedOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  function ExpressionComparison$Companion() {
    ExpressionComparison$Companion_instance = this;
  }
  ExpressionComparison$Companion.prototype.parseFromFactIdentifier_yhp8gb$ = function (string, parent, functionConfiguration) {
    if (parent === void 0)
      parent = null;
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration();
    var parts = split(string, [';ec;']);
    var result = new ExpressionComparison(0, 0, emptyExpression(), emptyExpression(), valueOfComparisonType(parts.get_za3lpa$(1)), parent);
    result.leftExpression = ensureNotNull(Expression$Companion_getInstance().parseFromFactIdentifier_yhp8gb$(parts.get_za3lpa$(0), void 0, functionConfiguration));
    result.rightExpression = ensureNotNull(Expression$Companion_getInstance().parseFromFactIdentifier_yhp8gb$(parts.get_za3lpa$(2), void 0, functionConfiguration));
    return result;
  };
  ExpressionComparison$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var ExpressionComparison$Companion_instance = null;
  function ExpressionComparison$Companion_getInstance() {
    if (ExpressionComparison$Companion_instance === null) {
      new ExpressionComparison$Companion();
    }
    return ExpressionComparison$Companion_instance;
  }
  ExpressionComparison.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ExpressionComparison',
    interfaces: [MainChainPart]
  };
  function RulePointer(startPosition, endPosition, parent, nameLink, identifier) {
    if (parent === void 0)
      parent = null;
    if (nameLink === void 0)
      nameLink = '';
    if (identifier === void 0)
      identifier = '';
    this.startPosition_692qp3$_0 = startPosition;
    this.endPosition_5qu2j2$_0 = endPosition;
    this.parent_nduxaw$_0 = parent;
    this.nameLink = nameLink;
    this.identifier_si96v$_0 = identifier;
  }
  Object.defineProperty(RulePointer.prototype, 'startPosition', {
    get: function () {
      return this.startPosition_692qp3$_0;
    }
  });
  Object.defineProperty(RulePointer.prototype, 'endPosition', {
    get: function () {
      return this.endPosition_5qu2j2$_0;
    }
  });
  Object.defineProperty(RulePointer.prototype, 'parent', {
    get: function () {
      return this.parent_nduxaw$_0;
    },
    set: function (parent) {
      this.parent_nduxaw$_0 = parent;
    }
  });
  Object.defineProperty(RulePointer.prototype, 'identifier', {
    get: function () {
      return this.identifier_si96v$_0;
    },
    set: function (identifier) {
      this.identifier_si96v$_0 = identifier;
    }
  });
  function RulePointer$check$lambda() {
    return 'ERROR: This RulePointer method must not been called. Undefined behaviour. ';
  }
  RulePointer.prototype.check_l8pk6u$ = function (factComporator, onExpressionLevel, factsTransformations, expressionTransformations, additionalFacts) {
    log_1.addMessage_bda5c9$(RulePointer$check$lambda);
    return new ComparisonResult(true, ArrayList_init(), this, this);
  };
  RulePointer.prototype.type = function () {
    return ComparableTransformationPartType$RULE_POINTER_getInstance();
  };
  RulePointer.prototype.toString = function () {
    return '[' + this.nameLink + ':]';
  };
  RulePointer.prototype.copyNode = function () {
    return new RulePointer(this.startPosition, this.endPosition, this.parent, this.nameLink);
  };
  RulePointer.prototype.clone = function () {
    return new RulePointer(this.startPosition, this.endPosition, this.parent, this.nameLink);
  };
  RulePointer.prototype.cloneWithNormalization_1g1bdl$ = function (nameArgsMap, sorted) {
    return new RulePointer(this.startPosition, this.endPosition, this.parent, this.nameLink);
  };
  RulePointer.prototype.computeIdentifier_6taknv$ = function (recomputeIfComputed) {
    this.identifier = '[' + this.nameLink + ':]';
    return this.identifier;
  };
  RulePointer.prototype.variableReplacement_y0zsll$ = function (replacements) {
  };
  RulePointer.prototype.computeInIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  RulePointer.prototype.computeOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  RulePointer.prototype.computeSortedOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  RulePointer.prototype.normalizeSubTree_f8z7ch$ = function (currentDeep, nameArgsMap, sorted) {
  };
  RulePointer.prototype.applyAllExpressionSubstitutions_8sufjw$ = function (expressionSubstitutions) {
  };
  RulePointer.prototype.computeExpressionTrees_dq72cu$ = function (baseOperationsDefinitions) {
  };
  RulePointer.prototype.replaceNotDefinedFunctionsOnVariables_1vzej0$ = function (functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet) {
  };
  RulePointer.prototype.isSolutionForVariables_axkv0l$$default = function (targetVariables, left, allowedVariables) {
    return null;
  };
  RulePointer.prototype.isFactorizationForVariables_3b7jn6$ = function (minNumberOfMultipliers, targetVariables, targetExpression, factComporator) {
    return null;
  };
  RulePointer.prototype.hasNoFractions_5ah4l7$ = function (maxNumberOfDivisions, targetExpression, factComporator) {
    return null;
  };
  RulePointer.prototype.isSolutionWithoutFunctions_cbql57$ = function (forbidden, targetExpression, factComporator) {
    return null;
  };
  RulePointer.prototype.getLastExpression = function () {
    return null;
  };
  RulePointer.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'RulePointer',
    interfaces: [MainChainPart]
  };
  function Rule(startPosition, endPosition, parent, root, name, identifier, factSubstitution, expressionSubstitution) {
    if (parent === void 0)
      parent = null;
    if (name === void 0)
      name = '';
    if (identifier === void 0)
      identifier = '';
    if (factSubstitution === void 0)
      factSubstitution = null;
    if (expressionSubstitution === void 0)
      expressionSubstitution = null;
    this.startPosition_klzdme$_0 = startPosition;
    this.endPosition_mp2go3$_0 = endPosition;
    this.parent_wwrtw7$_0 = parent;
    this.root = root;
    this.name = name;
    this.identifier_9qwg22$_0 = identifier;
    this.factSubstitution = factSubstitution;
    this.expressionSubstitution = expressionSubstitution;
  }
  Object.defineProperty(Rule.prototype, 'startPosition', {
    get: function () {
      return this.startPosition_klzdme$_0;
    }
  });
  Object.defineProperty(Rule.prototype, 'endPosition', {
    get: function () {
      return this.endPosition_mp2go3$_0;
    }
  });
  Object.defineProperty(Rule.prototype, 'parent', {
    get: function () {
      return this.parent_wwrtw7$_0;
    },
    set: function (parent) {
      this.parent_wwrtw7$_0 = parent;
    }
  });
  Object.defineProperty(Rule.prototype, 'identifier', {
    get: function () {
      return this.identifier_9qwg22$_0;
    },
    set: function (identifier) {
      this.identifier_9qwg22$_0 = identifier;
    }
  });
  function Rule$check$lambda(this$Rule) {
    return function () {
      return 'Start checking rule ' + (!isBlank(this$Rule.name) ? " '" + this$Rule.name + "'" : '') + ': ';
    };
  }
  function Rule$check$lambda_0(closure$currentLogLevel) {
    return function () {
      return 'Current log level: ' + closure$currentLogLevel.v;
    };
  }
  function Rule$check$lambda_1(this$Rule) {
    return function () {
      return CheckingKeyWords$Companion_getInstance().rule + (!isBlank(this$Rule.name) ? " '" + this$Rule.name + "'" : '') + ' is correct';
    };
  }
  function Rule$check$lambda_2() {
    return 'Expression substitution deduced from rule: ';
  }
  function Rule$check$lambda_3() {
    return 'Fact substitution deduced from rule: ';
  }
  function Rule$check$lambda_4(this$Rule) {
    return function () {
      return CheckingKeyWords$Companion_getInstance().rule + (!isBlank(this$Rule.name) ? " '" + this$Rule.name + "'" : '') + ' ' + CheckingKeyWords$Companion_getInstance().verificationFailed;
    };
  }
  Rule.prototype.check_l8pk6u$ = function (factComporator, onExpressionLevel, factsTransformations, expressionTransformations, additionalFacts) {
    var tmp$, tmp$_0;
    log_1.addMessageWithFactDetail_5zaetr$(Rule$check$lambda(this), this.root, MessageType$USER_getInstance(), void 0, 1);
    var currentLogLevel = {v: log_1.currentLevel};
    log_1.addMessage_bda5c9$(Rule$check$lambda_0(currentLogLevel), void 0, currentLogLevel.v);
    log_1.logCheckParams_f38nyx$(onExpressionLevel, factsTransformations, expressionTransformations, additionalFacts);
    var comparisonResult = this.root.check_l8pk6u$(factComporator, false, factsTransformations, expressionTransformations, additionalFacts);
    if (comparisonResult.isCorrect) {
      log_1.addMessage_bda5c9$(Rule$check$lambda_1(this), void 0, currentLogLevel.v);
      if (!this.root.expressionTransformationChains.isEmpty()) {
        var left = Kotlin.isType(tmp$ = first(first(this.root.expressionTransformationChains).chain), Expression) ? tmp$ : throwCCE();
        var right = Kotlin.isType(tmp$_0 = last(first(this.root.expressionTransformationChains).chain), Expression) ? tmp$_0 : throwCCE();
        applyAllImmediateSubstitutions(left.data, factComporator.compiledConfiguration);
        applyAllImmediateSubstitutions(right.data, factComporator.compiledConfiguration);
        if (!factComporator.expressionComporator.compareAsIs_98xwbf$(left.data, right.data)) {
          this.expressionSubstitution = new ExpressionSubstitution(left.data, right.data, void 0, comparisonResult.additionalFactUsed, this.name, void 0, void 0, first(this.root.expressionTransformationChains).comparisonType);
          log_1.addMessageWithExpressionSubstitutionShort_ht2yvq$(Rule$check$lambda_2, ensureNotNull(this.expressionSubstitution), MessageType$USER_getInstance(), currentLogLevel.v);
        }
      }
       else {
        if (!this.root.factTransformationChains.isEmpty()) {
          var left_0 = first(first(this.root.factTransformationChains).chain);
          var right_0 = last(first(this.root.factTransformationChains).chain);
          if (!factComporator.compareAsIs_hsjydo$(left_0, right_0)) {
            this.factSubstitution = new FactSubstitution(left_0, right_0, void 0, comparisonResult.additionalFactUsed, void 0, this.name, factComporator);
            log_1.addMessageWithFactSubstitutionDetail_v23yj3$(Rule$check$lambda_3, ensureNotNull(this.factSubstitution), MessageType$USER_getInstance(), currentLogLevel.v);
          }
        }
      }
    }
     else {
      log_1.addMessage_bda5c9$(Rule$check$lambda_4(this), void 0, currentLogLevel.v);
    }
    return comparisonResult;
  };
  Rule.prototype.type = function () {
    return ComparableTransformationPartType$RULE_getInstance();
  };
  Rule.prototype.toString = function () {
    return '[' + this.name + ':' + this.root + ']';
  };
  Rule.prototype.copyNode = function () {
    return new Rule(this.startPosition, this.endPosition, this.parent, this.root, this.name);
  };
  Rule.prototype.clone = function () {
    return new Rule(this.startPosition, this.endPosition, this.parent, this.root.clone(), this.name);
  };
  Rule.prototype.cloneWithNormalization_1g1bdl$ = function (nameArgsMap, sorted) {
    return new Rule(this.startPosition, this.endPosition, this.parent, this.root.cloneWithNormalization_1g1bdl$(nameArgsMap, sorted), this.name);
  };
  Rule.prototype.variableReplacement_y0zsll$ = function (replacements) {
    this.root.variableReplacement_y0zsll$(replacements);
  };
  Rule.prototype.computeIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.identifier) || recomputeIfComputed) {
      this.identifier = '[' + this.name + ':]';
    }
    return this.identifier;
  };
  Rule.prototype.computeInIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  Rule.prototype.computeOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  Rule.prototype.computeSortedOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    return this.computeIdentifier_6taknv$(recomputeIfComputed);
  };
  Rule.prototype.normalizeSubTree_f8z7ch$ = function (currentDeep, nameArgsMap, sorted) {
  };
  Rule.prototype.applyAllExpressionSubstitutions_8sufjw$ = function (expressionSubstitutions) {
  };
  Rule.prototype.computeExpressionTrees_dq72cu$ = function (baseOperationsDefinitions) {
  };
  Rule.prototype.replaceNotDefinedFunctionsOnVariables_1vzej0$ = function (functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet) {
  };
  Rule.prototype.isSolutionForVariables_axkv0l$$default = function (targetVariables, left, allowedVariables) {
    return null;
  };
  Rule.prototype.isFactorizationForVariables_3b7jn6$ = function (minNumberOfMultipliers, targetVariables, targetExpression, factComporator) {
    return null;
  };
  Rule.prototype.hasNoFractions_5ah4l7$ = function (maxNumberOfDivisions, targetExpression, factComporator) {
    return null;
  };
  Rule.prototype.isSolutionWithoutFunctions_cbql57$ = function (forbidden, targetExpression, factComporator) {
    return null;
  };
  Rule.prototype.getLastExpression = function () {
    return null;
  };
  Rule.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'Rule',
    interfaces: [MainChainPart]
  };
  function MainChain(chain) {
    if (chain === void 0) {
      chain = ArrayList_init();
    }
    this.chain = chain;
    this.identifier = '';
  }
  function MainChain$toString$lambda(it) {
    return '(' + it.toString() + ')';
  }
  MainChain.prototype.toString = function () {
    return joinToString(this.chain, ';', void 0, void 0, void 0, void 0, MainChain$toString$lambda);
  };
  function MainChain$computeIdentifier$lambda(closure$recomputeIfComputed) {
    return function (it) {
      return '(' + it.computeIdentifier_6taknv$(closure$recomputeIfComputed) + ')';
    };
  }
  MainChain.prototype.computeIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.identifier)) {
      this.identifier = joinToString(this.chain, ';', void 0, void 0, void 0, void 0, MainChain$computeIdentifier$lambda(recomputeIfComputed));
    }
    return this.identifier;
  };
  function MainChain$check$lambda() {
    return 'Start checking fact chain';
  }
  function MainChain$check$lambda_0() {
    return 'fact chain: ';
  }
  function MainChain$check$lambda_1() {
    return '';
  }
  function MainChain$check$lambda_2(closure$currentLogLevel) {
    return function () {
      return 'Current log level: ' + closure$currentLogLevel.v;
    };
  }
  function MainChain$check$lambda_3() {
    return 'currentLeftIndex';
  }
  function MainChain$check$lambda_4() {
    return 'currentRightIndex';
  }
  function MainChain$check$lambda_5() {
    return 'additionalFactUsed';
  }
  function MainChain$check$lambda_6() {
    return 'Check RULE';
  }
  function MainChain$check$lambda_7() {
    return 'Fact transformation recognized:';
  }
  function MainChain$check$lambda_8() {
    return 'Expression transformation recognized:';
  }
  function MainChain$check$lambda_9() {
    return 'RULE VERIFICATION_FAILED';
  }
  function MainChain$check$lambda_10() {
    return "Handling RULE_REFERENCE '";
  }
  function MainChain$check$lambda_11() {
    return "'";
  }
  function MainChain$check$lambda_12() {
    return "ERROR: RULE_REFERENCE '";
  }
  function MainChain$check$lambda_13() {
    return "' not found";
  }
  function MainChain$check$lambda_14() {
    return "Coloring task on positions: '";
  }
  function MainChain$check$lambda_15() {
    return "' - '";
  }
  function MainChain$check$lambda_16() {
    return "', wrongFactColor = '";
  }
  function MainChain$check$lambda_17() {
    return '';
  }
  function MainChain$check$lambda_18(it) {
    return "'" + it + "'";
  }
  function MainChain$check$lambda_19() {
    return 'currentRightIndex';
  }
  function MainChain$check$lambda_20() {
    return 'Check transformation from left fact to right fact:';
  }
  function MainChain$check$lambda_21() {
    return 'Left fact: ';
  }
  function MainChain$check$lambda_22() {
    return 'Right fact: ';
  }
  function MainChain$check$lambda_23() {
    return 'transformationVerified';
  }
  function MainChain$check$lambda_24() {
    return 'Left and right facts types are the same';
  }
  function MainChain$check$lambda_25() {
    return 'Comparison types are the same';
  }
  function MainChain$check$lambda_26() {
    return 'transformationVerified';
  }
  function MainChain$check$lambda_27() {
    return "Transformation verified: 'left.left - left.right = right.left - right.right'";
  }
  function MainChain$check$lambda_28() {
    return "Left expressions are equal: '";
  }
  function MainChain$check$lambda_29() {
    return "'";
  }
  function MainChain$check$lambda_30() {
    return "Right expressions are equal: '";
  }
  function MainChain$check$lambda_31() {
    return "'";
  }
  function MainChain$check$lambda_32() {
    return 'transformationVerified';
  }
  function MainChain$check$lambda_33() {
    return "Transformation verified: 'left.left = right.left' and 'left.right = right.right'";
  }
  function MainChain$check$lambda_34() {
    return 'Transformation not verified';
  }
  function MainChain$check$lambda_35() {
    return "left.left are equal to right.right: '";
  }
  function MainChain$check$lambda_36() {
    return "'";
  }
  function MainChain$check$lambda_37() {
    return "left.right are equal to right.left: '";
  }
  function MainChain$check$lambda_38() {
    return "'";
  }
  function MainChain$check$lambda_39() {
    return 'transformationVerified';
  }
  function MainChain$check$lambda_40() {
    return "Transformation verified: 'left.left = right.right' and 'left.right = right.left'";
  }
  function MainChain$check$lambda_41() {
    return 'Transformation not verified';
  }
  function MainChain$check$lambda_42() {
    return 'transformationVerified';
  }
  function MainChain$check$lambda_43() {
    return "Transformation verified: 'left.left / left.right = right.left / right.right'";
  }
  function MainChain$check$lambda_44() {
    return "left.left <= right.left: '";
  }
  function MainChain$check$lambda_45() {
    return "'";
  }
  function MainChain$check$lambda_46() {
    return "left.right >= right.right: '";
  }
  function MainChain$check$lambda_47() {
    return "'";
  }
  function MainChain$check$lambda_48() {
    return 'transformationVerified';
  }
  function MainChain$check$lambda_49() {
    return "Transformation verified: 'left.left <= right.left' and 'left.right >= right.right'";
  }
  function MainChain$check$lambda_50() {
    return 'Transformation not verified';
  }
  function MainChain$check$lambda_51() {
    return "left.left >= right.left: '";
  }
  function MainChain$check$lambda_52() {
    return "'";
  }
  function MainChain$check$lambda_53() {
    return "left.right <= right.right: '";
  }
  function MainChain$check$lambda_54() {
    return "'";
  }
  function MainChain$check$lambda_55() {
    return 'transformationVerified';
  }
  function MainChain$check$lambda_56() {
    return "Transformation verified: 'left.left >= right.left' and 'left.right <= right.right'";
  }
  function MainChain$check$lambda_57() {
    return 'Transformation not verified';
  }
  function MainChain$check$lambda_58() {
    return 'Two expression comparisons systems with equal sizes identified';
  }
  function MainChain$check$lambda_59() {
    return 'left';
  }
  function MainChain$check$lambda_60() {
    return 'right';
  }
  function MainChain$check$lambda_61() {
    return 'hasDifferentComparisonType';
  }
  function MainChain$check$lambda_62() {
    return 'Expression substitution got from left system: ';
  }
  function MainChain$check$lambda_63() {
    return "Two expression comparisons has different signs at facts number '";
  }
  function MainChain$check$lambda_64() {
    return "'";
  }
  function MainChain$check$lambda_65() {
    return 'hasDifferentComparisonType';
  }
  function MainChain$check$lambda_66() {
    return 'Check expression comparisons pairs on the same positions';
  }
  function MainChain$check$lambda_67() {
    return 'uncorrectTransformationFound';
  }
  function MainChain$check$lambda_68() {
    return 'uncorrectTransformationFound';
  }
  function MainChain$check$lambda_69() {
    return "Uncorrect transformation found at '";
  }
  function MainChain$check$lambda_70() {
    return "'";
  }
  function MainChain$check$lambda_71() {
    return 'Transformation verified, all pairs of expression comparisons are transformed correctly';
  }
  function MainChain$check$lambda_72() {
    return 'transformationVerified';
  }
  function MainChain$check$lambda_73() {
    return 'Transformation not verified, try to check transformation with rules and additional facts';
  }
  function MainChain$check$lambda_74() {
    return "Coloring task on positions: '";
  }
  function MainChain$check$lambda_75() {
    return "' - '";
  }
  function MainChain$check$lambda_76() {
    return "', factHelpFactColor = '";
  }
  function MainChain$check$lambda_77() {
    return '';
  }
  function MainChain$check$lambda_78() {
    return "Transformation verified, isInTaskContext: '";
  }
  function MainChain$check$lambda_79() {
    return "'";
  }
  function MainChain$check$lambda_80() {
    return 'additionalFactUsed';
  }
  function MainChain$check$lambda_81() {
    return "Coloring task on positions: '";
  }
  function MainChain$check$lambda_82() {
    return "' - '";
  }
  function MainChain$check$lambda_83() {
    return "', wrongFactColor = '";
  }
  function MainChain$check$lambda_84() {
    return '';
  }
  function MainChain$check$lambda_85() {
    return 'VERIFICATION_FAILED';
  }
  function MainChain$check$lambda_86() {
    return "Coloring task on positions: '";
  }
  function MainChain$check$lambda_87() {
    return "' - '";
  }
  function MainChain$check$lambda_88() {
    return "', correctFactColor = '";
  }
  function MainChain$check$lambda_89() {
    return '';
  }
  function MainChain$check$lambda_90() {
    return 'TRANSFORMATION_VERIFIED';
  }
  function MainChain$check$lambda_91() {
    return 'currentLeftIndex';
  }
  function MainChain$check$lambda_92() {
    return 'currentRightIndex';
  }
  function MainChain$check$lambda_93(this$MainChain) {
    return function () {
      return CheckingKeyWords$Companion_getInstance().factChainVerified + ". '" + first(this$MainChain.chain) + "' -> '" + last(this$MainChain.chain) + "'";
    };
  }
  MainChain.prototype.check_l8pk6u$ = function (factComporator, onExpressionLevel, factsTransformations, expressionTransformations, additionalFacts) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11, tmp$_12, tmp$_13, tmp$_14, tmp$_15, tmp$_16, tmp$_17, tmp$_18, tmp$_19, tmp$_20, tmp$_21, tmp$_22, tmp$_23, tmp$_24, tmp$_25, tmp$_26, tmp$_27, tmp$_28;
    log_1.addMessage_bda5c9$(MainChain$check$lambda, MessageType$USER_getInstance(), void 0, 1);
    log_1.add_f1hiuo$(this.chain.toString(), MainChain$check$lambda_0, MainChain$check$lambda_1);
    var currentLogLevel = {v: log_1.currentLevel};
    log_1.addMessage_bda5c9$(MainChain$check$lambda_2(currentLogLevel), void 0, currentLogLevel.v);
    log_1.logCheckParams_f38nyx$(onExpressionLevel, factsTransformations, expressionTransformations, additionalFacts);
    var coloringTasks = ArrayList_init();
    var currentLeftIndex = log_1.assignAndLog_746w4o$(0, currentLogLevel.v, MainChain$check$lambda_3);
    var currentRightIndex = log_1.assignAndLog_746w4o$(1, currentLogLevel.v, MainChain$check$lambda_4);
    var additionalFactUsed = log_1.assignAndLog_746w4o$(false, currentLogLevel.v, MainChain$check$lambda_5);
    loop_label: while (currentRightIndex < this.chain.size) {
      var actualFactsTransformations = null;
      var actualExpressionTransformations = null;
      if (this.chain.get_za3lpa$(currentRightIndex).type() === ComparableTransformationPartType$RULE_getInstance() || this.chain.get_za3lpa$(currentRightIndex).type() === ComparableTransformationPartType$RULE_POINTER_getInstance()) {
        if (this.chain.get_za3lpa$(currentRightIndex).type() === ComparableTransformationPartType$RULE_getInstance()) {
          var rule = Kotlin.isType(tmp$ = this.chain.get_za3lpa$(currentRightIndex), Rule) ? tmp$ : throwCCE();
          log_1.addMessageWithFactDetail_5zaetr$(MainChain$check$lambda_6, rule.root, MessageType$USER_getInstance(), currentLogLevel.v);
          var checkingResult = rule.check_l8pk6u$(factComporator, false, factsTransformations, expressionTransformations, additionalFacts);
          if (checkingResult.isCorrect) {
            if (rule.factSubstitution != null) {
              actualFactsTransformations = listOf(ensureNotNull(rule.factSubstitution));
              log_1.addMessageWithFactSubstitutionDetail_v23yj3$(MainChain$check$lambda_7, ensureNotNull(rule.factSubstitution), MessageType$USER_getInstance(), currentLogLevel.v);
            }
             else if (rule.expressionSubstitution != null) {
              actualExpressionTransformations = listOf(ensureNotNull(rule.expressionSubstitution));
              log_1.addMessageWithExpressionSubstitutionShort_ht2yvq$(MainChain$check$lambda_8, ensureNotNull(rule.expressionSubstitution), MessageType$USER_getInstance(), currentLogLevel.v);
            }
          }
           else {
            log_1.addMessage_bda5c9$(MainChain$check$lambda_9, MessageType$USER_getInstance(), currentLogLevel.v);
            new ComparisonResult(false, coloringTasks, this.chain.get_za3lpa$(currentLeftIndex), this.chain.get_za3lpa$(currentRightIndex + 1 | 0), 'RULE VERIFICATION_FAILED');
          }
        }
         else {
          var ruleName = (Kotlin.isType(tmp$_0 = this.chain.get_za3lpa$(currentRightIndex), RulePointer) ? tmp$_0 : throwCCE()).nameLink;
          log_1.add_f1hiuo$(ruleName, MainChain$check$lambda_10, MainChain$check$lambda_11, currentLogLevel.v, void 0, MessageType$USER_getInstance());
          var destination = ArrayList_init();
          var tmp$_29;
          tmp$_29 = factsTransformations.iterator();
          while (tmp$_29.hasNext()) {
            var element = tmp$_29.next();
            if (equals(element.name, ruleName))
              destination.add_11rb$(element);
          }
          actualFactsTransformations = destination;
          var destination_0 = ArrayList_init();
          var tmp$_30;
          tmp$_30 = expressionTransformations.iterator();
          while (tmp$_30.hasNext()) {
            var element_0 = tmp$_30.next();
            if (equals(element_0.code, ruleName))
              destination_0.add_11rb$(element_0);
          }
          actualExpressionTransformations = destination_0;
          if (actualFactsTransformations.isEmpty() && actualExpressionTransformations.isEmpty()) {
            log_1.add_f1hiuo$(ruleName, MainChain$check$lambda_12, MainChain$check$lambda_13, currentLogLevel.v, void 0, MessageType$USER_getInstance());
            log_1.add_sf5b3k$(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex + 1 | 0).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.wrongFactColor, MainChain$check$lambda_14, MainChain$check$lambda_15, MainChain$check$lambda_16, MainChain$check$lambda_17, currentLogLevel.v);
            coloringTasks.add_11rb$(new ColoringTask(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex + 1 | 0).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.wrongFactColor));
            var tmp$_31 = this.chain.get_za3lpa$(currentLeftIndex);
            var tmp$_32 = this.chain.get_za3lpa$(currentRightIndex + 1 | 0);
            var tmp$_33 = "Rule with name '" + ruleName + "' not found. Exists only rules with names: ";
            var destination_1 = ArrayList_init_0(collectionSizeOrDefault(expressionTransformations, 10));
            var tmp$_34;
            tmp$_34 = expressionTransformations.iterator();
            while (tmp$_34.hasNext()) {
              var item = tmp$_34.next();
              destination_1.add_11rb$(item.code);
            }
            var destination_2 = ArrayList_init();
            var tmp$_35;
            tmp$_35 = destination_1.iterator();
            while (tmp$_35.hasNext()) {
              var element_1 = tmp$_35.next();
              if (!isBlank(element_1))
                destination_2.add_11rb$(element_1);
            }
            return new ComparisonResult(false, coloringTasks, tmp$_31, tmp$_32, tmp$_33 + joinToString(destination_2, void 0, void 0, void 0, void 0, void 0, MainChain$check$lambda_18));
          }
        }
        currentRightIndex = log_1.assignAndLog_746w4o$(currentRightIndex + 1 | 0, currentLogLevel.v, MainChain$check$lambda_19);
      }
      actualExpressionTransformations = actualExpressionTransformations != null ? actualExpressionTransformations : expressionTransformations;
      actualFactsTransformations = actualFactsTransformations != null ? actualFactsTransformations : factsTransformations;
      if (this.chain.get_za3lpa$(currentRightIndex).type() === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() || this.chain.get_za3lpa$(currentRightIndex).type() === ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance()) {
        tmp$_2 = (Kotlin.isType(tmp$_1 = this.chain.get_za3lpa$(currentRightIndex), MainLineNode) ? tmp$_1 : throwCCE()).factTransformationChains.iterator();
        while (tmp$_2.hasNext()) {
          var transformationChain = tmp$_2.next();
          (Kotlin.isType(tmp$_3 = this.chain.get_za3lpa$(currentRightIndex), MainLineNode) ? tmp$_3 : throwCCE()).inFacts.add_11rb$(first(transformationChain.chain));
        }
      }
      log_1.addMessage_bda5c9$(MainChain$check$lambda_20, MessageType$USER_getInstance(), currentLogLevel.v);
      currentLogLevel.v = currentLogLevel.v + 1 | 0;
      log_1.addMessageWithFactDetail_5zaetr$(MainChain$check$lambda_21, this.chain.get_za3lpa$(currentLeftIndex), MessageType$USER_getInstance(), currentLogLevel.v);
      log_1.addMessageWithFactDetail_5zaetr$(MainChain$check$lambda_22, this.chain.get_za3lpa$(currentRightIndex), MessageType$USER_getInstance(), currentLogLevel.v);
      var transformationVerified = log_1.assignAndLog_746w4o$(false, currentLogLevel.v, MainChain$check$lambda_23);
      if (this.chain.get_za3lpa$(currentLeftIndex).type() === this.chain.get_za3lpa$(currentRightIndex).type()) {
        log_1.addMessage_bda5c9$(MainChain$check$lambda_24, MessageType$USER_getInstance(), currentLogLevel.v);
        if (this.chain.get_za3lpa$(currentLeftIndex).type() === ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance()) {
          var leftExpressionComparison = Kotlin.isType(tmp$_4 = this.chain.get_za3lpa$(currentLeftIndex), ExpressionComparison) ? tmp$_4 : throwCCE();
          var rightExpressionComparison = Kotlin.isType(tmp$_5 = this.chain.get_za3lpa$(currentRightIndex), ExpressionComparison) ? tmp$_5 : throwCCE();
          if (leftExpressionComparison.comparisonType === rightExpressionComparison.comparisonType) {
            log_1.addMessage_bda5c9$(MainChain$check$lambda_25, MessageType$USER_getInstance(), currentLogLevel.v);
            var leftSubtraction = subtractionTree(leftExpressionComparison.leftExpression.data, leftExpressionComparison.rightExpression.data);
            var rightSubtraction = subtractionTree(rightExpressionComparison.leftExpression.data, rightExpressionComparison.rightExpression.data);
            var subtractionResult = factComporator.expressionComporator.compareWithoutSubstitutions_15tjed$(leftSubtraction, rightSubtraction, ComparisonType$EQUAL_getInstance());
            if (subtractionResult) {
              transformationVerified = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainChain$check$lambda_26);
              log_1.addMessage_bda5c9$(MainChain$check$lambda_27, MessageType$USER_getInstance(), currentLogLevel.v);
            }
            if (!transformationVerified) {
              switch (leftExpressionComparison.comparisonType.name) {
                case 'EQUAL':
                  var ll = factComporator.expressionComporator.compareWithTreeTransformationRules_ob15jn$(leftExpressionComparison.leftExpression.data, rightExpressionComparison.leftExpression.data, actualExpressionTransformations, void 0, void 0, void 0, void 0, factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
                  log_1.add_f1hiuo$(ll, MainChain$check$lambda_28, MainChain$check$lambda_29, currentLogLevel.v, void 0, MessageType$USER_getInstance());
                  var rr = factComporator.expressionComporator.compareWithTreeTransformationRules_ob15jn$(leftExpressionComparison.rightExpression.data, rightExpressionComparison.rightExpression.data, actualExpressionTransformations, void 0, void 0, void 0, void 0, factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
                  log_1.add_f1hiuo$(rr, MainChain$check$lambda_30, MainChain$check$lambda_31, currentLogLevel.v, void 0, MessageType$USER_getInstance());
                  if (ll && rr) {
                    transformationVerified = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainChain$check$lambda_32);
                    log_1.addMessage_bda5c9$(MainChain$check$lambda_33, MessageType$USER_getInstance(), currentLogLevel.v);
                  }
                   else {
                    log_1.addMessage_bda5c9$(MainChain$check$lambda_34);
                    var lr = factComporator.expressionComporator.compareWithTreeTransformationRules_ob15jn$(leftExpressionComparison.leftExpression.data, rightExpressionComparison.rightExpression.data, actualExpressionTransformations, void 0, void 0, void 0, void 0, factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
                    log_1.add_f1hiuo$(lr, MainChain$check$lambda_35, MainChain$check$lambda_36, currentLogLevel.v, void 0, MessageType$USER_getInstance());
                    var rl = factComporator.expressionComporator.compareWithTreeTransformationRules_ob15jn$(leftExpressionComparison.rightExpression.data, rightExpressionComparison.leftExpression.data, actualExpressionTransformations, void 0, void 0, void 0, void 0, factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
                    log_1.add_f1hiuo$(lr, MainChain$check$lambda_37, MainChain$check$lambda_38, currentLogLevel.v, void 0, MessageType$USER_getInstance());
                    if (lr && rl) {
                      transformationVerified = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainChain$check$lambda_39);
                      log_1.addMessage_bda5c9$(MainChain$check$lambda_40, MessageType$USER_getInstance(), currentLogLevel.v);
                    }
                     else {
                      log_1.addMessage_bda5c9$(MainChain$check$lambda_41, MessageType$USER_getInstance(), currentLogLevel.v);
                    }
                  }

                  if (!transformationVerified) {
                    var leftDivision = divisionTree(leftExpressionComparison.leftExpression.data, leftExpressionComparison.rightExpression.data);
                    var rightDivision = divisionTree(rightExpressionComparison.leftExpression.data, rightExpressionComparison.rightExpression.data);
                    var divisionResult = factComporator.expressionComporator.compareWithoutSubstitutions_15tjed$(leftDivision, rightDivision, ComparisonType$EQUAL_getInstance(), void 0, true);
                    if (divisionResult) {
                      transformationVerified = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainChain$check$lambda_42);
                      log_1.addMessage_bda5c9$(MainChain$check$lambda_43, MessageType$USER_getInstance(), currentLogLevel.v);
                    }
                  }

                  break;
                case 'LEFT_MORE':
                case 'LEFT_MORE_OR_EQUAL':
                  var ll_0 = factComporator.expressionComporator.compareWithTreeTransformationRules_ob15jn$(leftExpressionComparison.leftExpression.data, rightExpressionComparison.leftExpression.data, actualExpressionTransformations, void 0, void 0, void 0, ComparisonType$LEFT_LESS_OR_EQUAL_getInstance(), factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
                  log_1.add_f1hiuo$(ll_0, MainChain$check$lambda_44, MainChain$check$lambda_45, currentLogLevel.v, void 0, MessageType$USER_getInstance());
                  var rr_0 = factComporator.expressionComporator.compareWithTreeTransformationRules_ob15jn$(leftExpressionComparison.rightExpression.data, rightExpressionComparison.rightExpression.data, actualExpressionTransformations, void 0, void 0, void 0, ComparisonType$LEFT_MORE_OR_EQUAL_getInstance(), factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
                  log_1.add_f1hiuo$(rr_0, MainChain$check$lambda_46, MainChain$check$lambda_47, currentLogLevel.v, void 0, MessageType$USER_getInstance());
                  if (ll_0 && rr_0) {
                    transformationVerified = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainChain$check$lambda_48);
                    log_1.addMessage_bda5c9$(MainChain$check$lambda_49, MessageType$USER_getInstance(), currentLogLevel.v);
                  }
                   else {
                    log_1.addMessage_bda5c9$(MainChain$check$lambda_50, MessageType$USER_getInstance(), currentLogLevel.v);
                  }

                  break;
                case 'LEFT_LESS':
                case 'LEFT_LESS_OR_EQUAL':
                  var ll_1 = factComporator.expressionComporator.compareWithTreeTransformationRules_ob15jn$(leftExpressionComparison.leftExpression.data, rightExpressionComparison.leftExpression.data, actualExpressionTransformations, void 0, void 0, void 0, ComparisonType$LEFT_MORE_OR_EQUAL_getInstance(), factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
                  log_1.add_f1hiuo$(ll_1, MainChain$check$lambda_51, MainChain$check$lambda_52, currentLogLevel.v, void 0, MessageType$USER_getInstance());
                  var rr_1 = factComporator.expressionComporator.compareWithTreeTransformationRules_ob15jn$(leftExpressionComparison.rightExpression.data, rightExpressionComparison.rightExpression.data, actualExpressionTransformations, void 0, void 0, void 0, ComparisonType$LEFT_LESS_OR_EQUAL_getInstance(), factComporator.compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps);
                  log_1.add_f1hiuo$(rr_1, MainChain$check$lambda_53, MainChain$check$lambda_54, currentLogLevel.v, void 0, MessageType$USER_getInstance());
                  if (ll_1 && rr_1) {
                    transformationVerified = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainChain$check$lambda_55);
                    log_1.addMessage_bda5c9$(MainChain$check$lambda_56, MessageType$USER_getInstance(), currentLogLevel.v);
                  }
                   else {
                    log_1.addMessage_bda5c9$(MainChain$check$lambda_57, MessageType$USER_getInstance(), currentLogLevel.v);
                  }

                  break;
              }
            }
          }
        }
         else {
          var leftFacts = null;
          var rightFacts = null;
          var tmp$_36 = this.chain.get_za3lpa$(currentLeftIndex).type() === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() && (Kotlin.isType(tmp$_6 = this.chain.get_za3lpa$(currentLeftIndex), MainLineAndNode) ? tmp$_6 : throwCCE()).outFacts.size === (Kotlin.isType(tmp$_7 = this.chain.get_za3lpa$(currentRightIndex), MainLineAndNode) ? tmp$_7 : throwCCE()).inFacts.size;
          if (tmp$_36) {
            var $receiver = (Kotlin.isType(tmp$_8 = this.chain.get_za3lpa$(currentLeftIndex), MainLineAndNode) ? tmp$_8 : throwCCE()).outFacts;
            var count$result;
            count$break: do {
              var tmp$_37;
              if (Kotlin.isType($receiver, Collection) && $receiver.isEmpty()) {
                count$result = 0;
                break count$break;
              }
              var count = 0;
              tmp$_37 = $receiver.iterator();
              while (tmp$_37.hasNext()) {
                var element_2 = tmp$_37.next();
                if (element_2.type() !== ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance())
                  checkCountOverflow((count = count + 1 | 0, count));
              }
              count$result = count;
            }
             while (false);
            tmp$_36 = count$result === 0;
          }
          var tmp$_38 = tmp$_36;
          if (tmp$_38) {
            var $receiver_0 = (Kotlin.isType(tmp$_9 = this.chain.get_za3lpa$(currentRightIndex), MainLineAndNode) ? tmp$_9 : throwCCE()).inFacts;
            var count$result_0;
            count$break: do {
              var tmp$_39;
              if (Kotlin.isType($receiver_0, Collection) && $receiver_0.isEmpty()) {
                count$result_0 = 0;
                break count$break;
              }
              var count_0 = 0;
              tmp$_39 = $receiver_0.iterator();
              while (tmp$_39.hasNext()) {
                var element_3 = tmp$_39.next();
                if (element_3.type() !== ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance())
                  checkCountOverflow((count_0 = count_0 + 1 | 0, count_0));
              }
              count$result_0 = count_0;
            }
             while (false);
            tmp$_38 = count$result_0 === 0;
          }
          if (tmp$_38) {
            leftFacts = (Kotlin.isType(tmp$_10 = this.chain.get_za3lpa$(currentLeftIndex), MainLineAndNode) ? tmp$_10 : throwCCE()).outFacts;
            rightFacts = (Kotlin.isType(tmp$_11 = this.chain.get_za3lpa$(currentRightIndex), MainLineAndNode) ? tmp$_11 : throwCCE()).inFacts;
          }
           else {
            var tmp$_40 = this.chain.get_za3lpa$(currentLeftIndex).type() === ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance() && (Kotlin.isType(tmp$_12 = this.chain.get_za3lpa$(currentLeftIndex), MainLineOrNode) ? tmp$_12 : throwCCE()).outFacts.size === (Kotlin.isType(tmp$_13 = this.chain.get_za3lpa$(currentRightIndex), MainLineOrNode) ? tmp$_13 : throwCCE()).inFacts.size;
            if (tmp$_40) {
              var $receiver_1 = (Kotlin.isType(tmp$_14 = this.chain.get_za3lpa$(currentLeftIndex), MainLineOrNode) ? tmp$_14 : throwCCE()).outFacts;
              var count$result_1;
              count$break: do {
                var tmp$_41;
                if (Kotlin.isType($receiver_1, Collection) && $receiver_1.isEmpty()) {
                  count$result_1 = 0;
                  break count$break;
                }
                var count_1 = 0;
                tmp$_41 = $receiver_1.iterator();
                while (tmp$_41.hasNext()) {
                  var element_4 = tmp$_41.next();
                  if (element_4.type() !== ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance())
                    checkCountOverflow((count_1 = count_1 + 1 | 0, count_1));
                }
                count$result_1 = count_1;
              }
               while (false);
              tmp$_40 = count$result_1 === 0;
            }
            var tmp$_42 = tmp$_40;
            if (tmp$_42) {
              var $receiver_2 = (Kotlin.isType(tmp$_15 = this.chain.get_za3lpa$(currentRightIndex), MainLineOrNode) ? tmp$_15 : throwCCE()).inFacts;
              var count$result_2;
              count$break: do {
                var tmp$_43;
                if (Kotlin.isType($receiver_2, Collection) && $receiver_2.isEmpty()) {
                  count$result_2 = 0;
                  break count$break;
                }
                var count_2 = 0;
                tmp$_43 = $receiver_2.iterator();
                while (tmp$_43.hasNext()) {
                  var element_5 = tmp$_43.next();
                  if (element_5.type() !== ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance())
                    checkCountOverflow((count_2 = count_2 + 1 | 0, count_2));
                }
                count$result_2 = count_2;
              }
               while (false);
              tmp$_42 = count$result_2 === 0;
            }
            if (tmp$_42) {
              leftFacts = (Kotlin.isType(tmp$_16 = this.chain.get_za3lpa$(currentLeftIndex), MainLineOrNode) ? tmp$_16 : throwCCE()).outFacts;
              rightFacts = (Kotlin.isType(tmp$_17 = this.chain.get_za3lpa$(currentRightIndex), MainLineOrNode) ? tmp$_17 : throwCCE()).inFacts;
            }
          }
          if (leftFacts != null && rightFacts != null) {
            log_1.addMessage_bda5c9$(MainChain$check$lambda_58, MessageType$USER_getInstance(), currentLogLevel.v);
            log_1.logSystemFacts_zi2lc5$(this.chain.get_za3lpa$(currentLeftIndex).type(), leftFacts, MainChain$check$lambda_59, MessageType$USER_getInstance());
            log_1.logSystemFacts_zi2lc5$(this.chain.get_za3lpa$(currentRightIndex).type(), rightFacts, MainChain$check$lambda_60, MessageType$USER_getInstance());
            var hasDifferentComparisonType = log_1.assignAndLog_746w4o$(false, currentLogLevel.v, MainChain$check$lambda_61);
            var expressionTransformationRulesFromLeftFact = ArrayList_init();
            tmp$_18 = get_lastIndex(leftFacts);
            for (var i = 0; i <= tmp$_18; i++) {
              expressionTransformationRulesFromLeftFact.add_11rb$(new ExpressionSubstitution((Kotlin.isType(tmp$_19 = leftFacts.get_za3lpa$(i), ExpressionComparison) ? tmp$_19 : throwCCE()).leftExpression.data, (Kotlin.isType(tmp$_20 = leftFacts.get_za3lpa$(i), ExpressionComparison) ? tmp$_20 : throwCCE()).rightExpression.data, void 0, true, void 0, void 0, void 0, (Kotlin.isType(tmp$_21 = leftFacts.get_za3lpa$(i), ExpressionComparison) ? tmp$_21 : throwCCE()).comparisonType));
              log_1.addMessageWithExpressionSubstitutionShort_ht2yvq$(MainChain$check$lambda_62, last(expressionTransformationRulesFromLeftFact), MessageType$USER_getInstance(), currentLogLevel.v);
            }
            tmp$_22 = get_lastIndex(leftFacts);
            for (var i_0 = 0; i_0 <= tmp$_22; i_0++) {
              if ((Kotlin.isType(tmp$_23 = leftFacts.get_za3lpa$(i_0), ExpressionComparison) ? tmp$_23 : throwCCE()).comparisonType !== (Kotlin.isType(tmp$_24 = rightFacts.get_za3lpa$(i_0), ExpressionComparison) ? tmp$_24 : throwCCE()).comparisonType) {
                log_1.add_f1hiuo$(i_0, MainChain$check$lambda_63, MainChain$check$lambda_64, currentLogLevel.v, void 0, MessageType$USER_getInstance());
                hasDifferentComparisonType = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainChain$check$lambda_65);
                break;
              }
            }
            if (!hasDifferentComparisonType) {
              log_1.addMessage_bda5c9$(MainChain$check$lambda_66, MessageType$USER_getInstance(), currentLogLevel.v);
              var uncorrectTransformationFound = log_1.assignAndLog_746w4o$(false, currentLogLevel.v, MainChain$check$lambda_67);
              tmp$_25 = get_lastIndex(leftFacts);
              for (var i_1 = 0; i_1 <= tmp$_25; i_1++) {
                var mainChain = new MainChain(mutableListOf([leftFacts.get_za3lpa$(i_1), rightFacts.get_za3lpa$(i_1)]));
                var result = mainChain.check_l8pk6u$(factComporator, true, actualFactsTransformations, plus(actualExpressionTransformations, expressionTransformationRulesFromLeftFact), emptyList());
                if (!result.isCorrect) {
                  uncorrectTransformationFound = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainChain$check$lambda_68);
                  log_1.add_f1hiuo$(i_1, MainChain$check$lambda_69, MainChain$check$lambda_70, currentLogLevel.v, void 0, MessageType$USER_getInstance());
                  break;
                }
              }
              if (!uncorrectTransformationFound) {
                log_1.addMessage_bda5c9$(MainChain$check$lambda_71, MessageType$USER_getInstance(), currentLogLevel.v);
                transformationVerified = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainChain$check$lambda_72);
              }
            }
          }
        }
      }
      if (!transformationVerified) {
        log_1.addMessage_bda5c9$(MainChain$check$lambda_73);
        var additionalFactInCurrentTransformationApplicationUsed = ArrayList_init();
        var result_0 = factComporator.compareWithTreeTransformationRules_90aq3c$(this.chain.get_za3lpa$(currentLeftIndex), this.chain.get_za3lpa$(currentRightIndex), additionalFacts, actualFactsTransformations, void 0, void 0, void 0, void 0, additionalFactInCurrentTransformationApplicationUsed);
        if (result_0) {
          log_1.add_sf5b3k$(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.factHelpFactColor, MainChain$check$lambda_74, MainChain$check$lambda_75, MainChain$check$lambda_76, MainChain$check$lambda_77, currentLogLevel.v);
          coloringTasks.add_11rb$(new ColoringTask(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.factHelpFactColor));
          var isInTaskContext = !additionalFactInCurrentTransformationApplicationUsed.isEmpty();
          log_1.add_f1hiuo$(isInTaskContext, MainChain$check$lambda_78, MainChain$check$lambda_79, currentLogLevel.v, void 0, MessageType$USER_getInstance());
          if (isInTaskContext) {
            additionalFactUsed = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainChain$check$lambda_80);
          }
        }
         else {
          log_1.add_sf5b3k$(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.wrongFactColor, MainChain$check$lambda_81, MainChain$check$lambda_82, MainChain$check$lambda_83, MainChain$check$lambda_84, currentLogLevel.v);
          coloringTasks.add_11rb$(new ColoringTask(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.wrongFactColor));
          log_1.addMessage_bda5c9$(MainChain$check$lambda_85, MessageType$USER_getInstance(), currentLogLevel.v);
          return new ComparisonResult(false, coloringTasks, this.chain.get_za3lpa$(currentLeftIndex), this.chain.get_za3lpa$(currentRightIndex), "Unclear transformation between '" + this.chain.get_za3lpa$(currentLeftIndex) + "' and '" + this.chain.get_za3lpa$(currentRightIndex) + "' ");
        }
      }
       else {
        log_1.add_sf5b3k$(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.correctFactColor, MainChain$check$lambda_86, MainChain$check$lambda_87, MainChain$check$lambda_88, MainChain$check$lambda_89, currentLogLevel.v);
        coloringTasks.add_11rb$(new ColoringTask(this.chain.get_za3lpa$(currentLeftIndex).endPosition, this.chain.get_za3lpa$(currentRightIndex).startPosition, factComporator.compiledConfiguration.checkedFactAccentuation.checkedFactColor.correctFactColor));
        log_1.addMessage_bda5c9$(MainChain$check$lambda_90, MessageType$USER_getInstance(), currentLogLevel.v);
      }
      if (this.chain.get_za3lpa$(currentRightIndex).type() === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() || this.chain.get_za3lpa$(currentRightIndex).type() === ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance()) {
        tmp$_27 = (Kotlin.isType(tmp$_26 = this.chain.get_za3lpa$(currentRightIndex), MainLineNode) ? tmp$_26 : throwCCE()).factTransformationChains.iterator();
        while (tmp$_27.hasNext()) {
          var transformationChain_0 = tmp$_27.next();
          (Kotlin.isType(tmp$_28 = this.chain.get_za3lpa$(currentRightIndex), MainLineNode) ? tmp$_28 : throwCCE()).outFacts.add_11rb$(last(transformationChain_0.chain));
        }
      }
      currentLogLevel.v = currentLogLevel.v - 1 | 0;
      currentLeftIndex = log_1.assignAndLog_746w4o$(currentRightIndex, currentLogLevel.v, MainChain$check$lambda_91);
      currentRightIndex = log_1.assignAndLog_746w4o$(currentRightIndex + 1 | 0, currentLogLevel.v, MainChain$check$lambda_92);
    }
    log_1.addMessage_bda5c9$(MainChain$check$lambda_93(this), MessageType$USER_getInstance(), currentLogLevel.v);
    return new ComparisonResult(true, coloringTasks, first(this.chain), last(this.chain), void 0, additionalFactUsed);
  };
  MainChain.prototype.variableReplacement_y0zsll$ = function (replacements) {
    var tmp$;
    tmp$ = this.chain.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.variableReplacement_y0zsll$(replacements);
    }
  };
  MainChain.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'MainChain',
    interfaces: []
  };
  function MainLineAndNode(startPosition, endPosition, parent, factTransformationChains, inFacts, outFacts, expressionTransformationChains, rules, identifier) {
    MainLineAndNode$Companion_getInstance();
    if (startPosition === void 0)
      startPosition = 0;
    if (endPosition === void 0)
      endPosition = 0;
    if (parent === void 0)
      parent = null;
    if (factTransformationChains === void 0) {
      factTransformationChains = ArrayList_init();
    }
    if (inFacts === void 0) {
      inFacts = ArrayList_init();
    }
    if (outFacts === void 0) {
      outFacts = ArrayList_init();
    }
    if (expressionTransformationChains === void 0) {
      expressionTransformationChains = ArrayList_init();
    }
    if (rules === void 0) {
      rules = ArrayList_init();
    }
    if (identifier === void 0)
      identifier = '';
    this.startPosition_6tkjyc$_0 = startPosition;
    this.endPosition_vyyktf$_0 = endPosition;
    this.parent_w00vab$_0 = parent;
    this.factTransformationChains_bql9i$_0 = factTransformationChains;
    this.inFacts_y9ezh7$_0 = inFacts;
    this.outFacts_m707fw$_0 = outFacts;
    this.expressionTransformationChains_vr3006$_0 = expressionTransformationChains;
    this.rules_dr9psg$_0 = rules;
    this.identifier_ybd3r0$_0 = identifier;
    this.inIdentifier = '';
    this.outIdentifier = '';
  }
  Object.defineProperty(MainLineAndNode.prototype, 'startPosition', {
    get: function () {
      return this.startPosition_6tkjyc$_0;
    }
  });
  Object.defineProperty(MainLineAndNode.prototype, 'endPosition', {
    get: function () {
      return this.endPosition_vyyktf$_0;
    }
  });
  Object.defineProperty(MainLineAndNode.prototype, 'parent', {
    get: function () {
      return this.parent_w00vab$_0;
    },
    set: function (parent) {
      this.parent_w00vab$_0 = parent;
    }
  });
  Object.defineProperty(MainLineAndNode.prototype, 'factTransformationChains', {
    get: function () {
      return this.factTransformationChains_bql9i$_0;
    }
  });
  Object.defineProperty(MainLineAndNode.prototype, 'inFacts', {
    get: function () {
      return this.inFacts_y9ezh7$_0;
    }
  });
  Object.defineProperty(MainLineAndNode.prototype, 'outFacts', {
    get: function () {
      return this.outFacts_m707fw$_0;
    }
  });
  Object.defineProperty(MainLineAndNode.prototype, 'expressionTransformationChains', {
    get: function () {
      return this.expressionTransformationChains_vr3006$_0;
    }
  });
  Object.defineProperty(MainLineAndNode.prototype, 'rules', {
    get: function () {
      return this.rules_dr9psg$_0;
    }
  });
  Object.defineProperty(MainLineAndNode.prototype, 'identifier', {
    get: function () {
      return this.identifier_ybd3r0$_0;
    },
    set: function (identifier) {
      this.identifier_ybd3r0$_0 = identifier;
    }
  });
  MainLineAndNode.prototype.getLastExpression = function () {
    return last(this.outFacts).getLastExpression();
  };
  MainLineAndNode.prototype.isSolutionForVariables_axkv0l$$default = function (targetVariables, left, allowedVariables) {
    var tmp$;
    tmp$ = this.outFacts.iterator();
    while (tmp$.hasNext()) {
      var fact = tmp$.next();
      var error = fact.isSolutionForVariables_axkv0l$(targetVariables, void 0, allowedVariables);
      if (error != null)
        return error;
    }
    return null;
  };
  MainLineAndNode.prototype.computeIfNumeric_7do60d$ = function (substitutionInstance, baseOperationsDefinitions, checkOutMainLineNodePart) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    var actualFacts = checkOutMainLineNodePart ? getOutFactsFromMainLineNode(this) : getInFactsFromMainLineNode(this);
    var isNull = false;
    tmp$ = actualFacts.iterator();
    while (tmp$.hasNext()) {
      var fact = tmp$.next();
      switch (fact.type().name) {
        case 'EXPRESSION_COMPARISON':
          tmp$_2 = (Kotlin.isType(tmp$_0 = fact, ExpressionComparison) ? tmp$_0 : throwCCE()).computeIfNumeric_z3m4ac$(substitutionInstance, baseOperationsDefinitions);
          break;
        case 'MAIN_LINE_AND_NODE':
        case 'MAIN_LINE_OR_NODE':
          tmp$_2 = (Kotlin.isType(tmp$_1 = fact, MainLineNode) ? tmp$_1 : throwCCE()).computeIfNumeric_7do60d$(substitutionInstance, baseOperationsDefinitions, checkOutMainLineNodePart);
          break;
        default:tmp$_2 = null;
          break;
      }
      var isCorrect = tmp$_2;
      if (isCorrect == null) {
        isNull = true;
      }
       else if (!isCorrect) {
        return false;
      }
    }
    return isNull ? null : true;
  };
  MainLineAndNode.prototype.copyNode = function () {
    return new MainLineAndNode(this.startPosition, this.endPosition, this.parent);
  };
  MainLineAndNode.prototype.clone = function () {
    var tmp$ = this.startPosition;
    var tmp$_0 = this.endPosition;
    var tmp$_1 = this.parent;
    var tmp$_2 = void 0;
    var $receiver = this.inFacts;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$_3;
    tmp$_3 = $receiver.iterator();
    while (tmp$_3.hasNext()) {
      var item = tmp$_3.next();
      destination.add_11rb$(item.clone());
    }
    var tmp$_4 = toMutableList(destination);
    var $receiver_0 = this.outFacts;
    var destination_0 = ArrayList_init_0(collectionSizeOrDefault($receiver_0, 10));
    var tmp$_5;
    tmp$_5 = $receiver_0.iterator();
    while (tmp$_5.hasNext()) {
      var item_0 = tmp$_5.next();
      destination_0.add_11rb$(item_0.clone());
    }
    return new MainLineAndNode(tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_4, toMutableList(destination_0));
  };
  MainLineAndNode.prototype.cloneWithNormalization_1g1bdl$ = function (nameArgsMap, sorted) {
    var tmp$ = this.startPosition;
    var tmp$_0 = this.endPosition;
    var tmp$_1 = this.parent;
    var tmp$_2 = void 0;
    var $receiver = this.inFacts;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$_3;
    tmp$_3 = $receiver.iterator();
    while (tmp$_3.hasNext()) {
      var item = tmp$_3.next();
      destination.add_11rb$(item.cloneWithNormalization_1g1bdl$(nameArgsMap, sorted));
    }
    var tmp$_4 = toMutableList(destination);
    var $receiver_0 = this.outFacts;
    var destination_0 = ArrayList_init_0(collectionSizeOrDefault($receiver_0, 10));
    var tmp$_5;
    tmp$_5 = $receiver_0.iterator();
    while (tmp$_5.hasNext()) {
      var item_0 = tmp$_5.next();
      destination_0.add_11rb$(item_0.cloneWithNormalization_1g1bdl$(nameArgsMap, sorted));
    }
    return new MainLineAndNode(tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_4, toMutableList(destination_0));
  };
  MainLineAndNode.prototype.normalizeSubTree_f8z7ch$ = function (currentDeep, nameArgsMap, sorted) {
    var tmp$;
    tmp$ = this.inFacts.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.normalizeSubTree_f8z7ch$(currentDeep, nameArgsMap, sorted);
    }
    var tmp$_0;
    tmp$_0 = this.outFacts.iterator();
    while (tmp$_0.hasNext()) {
      var element_0 = tmp$_0.next();
      element_0.normalizeSubTree_f8z7ch$(currentDeep, nameArgsMap, sorted);
    }
  };
  MainLineAndNode.prototype.variableReplacement_y0zsll$ = function (replacements) {
    var tmp$;
    tmp$ = this.inFacts.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.variableReplacement_y0zsll$(replacements);
    }
    var tmp$_0;
    tmp$_0 = this.outFacts.iterator();
    while (tmp$_0.hasNext()) {
      var element_0 = tmp$_0.next();
      element_0.variableReplacement_y0zsll$(replacements);
    }
    var tmp$_1;
    tmp$_1 = this.rules.iterator();
    while (tmp$_1.hasNext()) {
      var element_1 = tmp$_1.next();
      element_1.variableReplacement_y0zsll$(replacements);
    }
    var tmp$_2;
    tmp$_2 = this.expressionTransformationChains.iterator();
    while (tmp$_2.hasNext()) {
      var element_2 = tmp$_2.next();
      element_2.variableReplacement_y0zsll$(replacements);
    }
    var tmp$_3;
    tmp$_3 = this.factTransformationChains.iterator();
    while (tmp$_3.hasNext()) {
      var element_3 = tmp$_3.next();
      element_3.variableReplacement_y0zsll$(replacements);
    }
  };
  MainLineAndNode.prototype.applyAllExpressionSubstitutions_8sufjw$ = function (expressionSubstitutions) {
    var tmp$;
    tmp$ = this.inFacts.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.applyAllExpressionSubstitutions_8sufjw$(expressionSubstitutions);
    }
    var tmp$_0;
    tmp$_0 = this.outFacts.iterator();
    while (tmp$_0.hasNext()) {
      var element_0 = tmp$_0.next();
      element_0.applyAllExpressionSubstitutions_8sufjw$(expressionSubstitutions);
    }
  };
  MainLineAndNode.prototype.computeExpressionTrees_dq72cu$ = function (baseOperationsDefinitions) {
    var tmp$;
    tmp$ = this.inFacts.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.computeExpressionTrees_dq72cu$(baseOperationsDefinitions);
    }
    var tmp$_0;
    tmp$_0 = this.outFacts.iterator();
    while (tmp$_0.hasNext()) {
      var element_0 = tmp$_0.next();
      element_0.computeExpressionTrees_dq72cu$(baseOperationsDefinitions);
    }
  };
  MainLineAndNode.prototype.replaceNotDefinedFunctionsOnVariables_1vzej0$ = function (functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet) {
    var tmp$;
    tmp$ = this.inFacts.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.replaceNotDefinedFunctionsOnVariables_1vzej0$(functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet);
    }
    var tmp$_0;
    tmp$_0 = this.outFacts.iterator();
    while (tmp$_0.hasNext()) {
      var element_0 = tmp$_0.next();
      element_0.replaceNotDefinedFunctionsOnVariables_1vzej0$(functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet);
    }
  };
  function MainLineAndNode$check$lambda() {
    return 'Start checking fact: ';
  }
  function MainLineAndNode$check$lambda_0(closure$currentLogLevel) {
    return function () {
      return 'Current log level: ' + closure$currentLogLevel.v;
    };
  }
  function MainLineAndNode$check$lambda_1() {
    return 'additionalFactUsed';
  }
  function MainLineAndNode$check$lambda_2() {
    return '0. KNOWN_FACT extraction';
  }
  function MainLineAndNode$check$lambda_3() {
    return 'fact checked: ';
  }
  function MainLineAndNode$check$lambda_4() {
    return 'additionalFactUsed';
  }
  function MainLineAndNode$check$lambda_5() {
    return 'FACT VERIFICATION_FAILED';
  }
  function MainLineAndNode$check$lambda_6() {
    return "FACT '''";
  }
  function MainLineAndNode$check$lambda_7() {
    return "''' VERIFICATION_FAILED";
  }
  function MainLineAndNode$check$lambda_8() {
    return '1. RULE checking';
  }
  function MainLineAndNode$check$lambda_9() {
    return 'FACT_RULE ADDED:';
  }
  function MainLineAndNode$check$lambda_10() {
    return 'leftFactIsKnown';
  }
  function MainLineAndNode$check$lambda_11() {
    return 'compare left rule part with known fact: ';
  }
  function MainLineAndNode$check$lambda_12() {
    return 'leftFactIsKnown';
  }
  function MainLineAndNode$check$lambda_13() {
    return 'left rule fact is known, so right rule fact is added to known facts';
  }
  function MainLineAndNode$check$lambda_14() {
    return 'rule is expression comparison, so EXPRESSION_RULE ' + CheckingKeyWords$Companion_getInstance().ruleAddedInContext;
  }
  function MainLineAndNode$check$lambda_15() {
    return 'EXPRESSION_RULE ADDED:';
  }
  function MainLineAndNode$check$lambda_16() {
    return 'RULE VERIFICATION_FAILED';
  }
  function MainLineAndNode$check$lambda_17() {
    return "RULE '''";
  }
  function MainLineAndNode$check$lambda_18() {
    return "''' VERIFICATION_FAILED";
  }
  function MainLineAndNode$check$lambda_19() {
    return '2. EXPRESSION_CHAIN checking';
  }
  function MainLineAndNode$check$lambda_20() {
    return 'To out facts added fact: ';
  }
  function MainLineAndNode$check$lambda_21() {
    return 'additionalFactUsed';
  }
  function MainLineAndNode$check$lambda_22() {
    return 'EXPRESSION_CHAIN VERIFICATION_FAILED';
  }
  function MainLineAndNode$check$lambda_23() {
    return "EXPRESSION_CHAIN '''";
  }
  function MainLineAndNode$check$lambda_24() {
    return "''' VERIFICATION_FAILED";
  }
  function MainLineAndNode$check$lambda_25() {
    return '3. FACT_CHAIN checking';
  }
  function MainLineAndNode$check$lambda_26() {
    return 'To out facts added fact: ';
  }
  function MainLineAndNode$check$lambda_27() {
    return 'additionalFactUsed';
  }
  function MainLineAndNode$check$lambda_28() {
    return 'FACT_CHAIN VERIFICATION_FAILED';
  }
  function MainLineAndNode$check$lambda_29() {
    return "FACT_CHAIN '''";
  }
  function MainLineAndNode$check$lambda_30() {
    return "''' VERIFICATION_FAILED";
  }
  function MainLineAndNode$check$lambda_31() {
    return 'Fact node checked and it is correct, out facts are computed: ';
  }
  MainLineAndNode.prototype.check_l8pk6u$ = function (factComporator, onExpressionLevel, factsTransformations, expressionTransformations, additionalFacts) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6;
    log_1.addMessageWithFactDetail_5zaetr$(MainLineAndNode$check$lambda, this, MessageType$USER_getInstance(), void 0, 1);
    var currentLogLevel = {v: log_1.currentLevel};
    log_1.addMessage_bda5c9$(MainLineAndNode$check$lambda_0(currentLogLevel), void 0, currentLogLevel.v);
    log_1.logCheckParams_f38nyx$(onExpressionLevel, factsTransformations, expressionTransformations, additionalFacts);
    var coloringTasks = ArrayList_init();
    var additionalFactUsed = log_1.assignAndLog_746w4o$(false, currentLogLevel.v, MainLineAndNode$check$lambda_1);
    var nodeExpressionTransformations = ArrayList_init();
    var nodeFactsTransformations = ArrayList_init();
    log_1.addMessage_bda5c9$(MainLineAndNode$check$lambda_2, MessageType$USER_getInstance(), currentLogLevel.v);
    tmp$ = this.factTransformationChains.iterator();
    while (tmp$.hasNext()) {
      var factChain = tmp$.next();
      var checkingResult = first(factChain.chain).check_l8pk6u$(factComporator, false, factsTransformations, expressionTransformations, additionalFacts);
      coloringTasks.addAll_brywnq$(checkingResult.coloringTasks);
      if (checkingResult.isCorrect) {
        log_1.addMessageWithFactDetail_5zaetr$(MainLineAndNode$check$lambda_3, first(factChain.chain), MessageType$USER_getInstance(), currentLogLevel.v);
        if (checkingResult.additionalFactUsed) {
          additionalFactUsed = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainLineAndNode$check$lambda_4);
        }
      }
       else {
        log_1.addMessage_bda5c9$(MainLineAndNode$check$lambda_5, MessageType$USER_getInstance(), currentLogLevel.v);
        log_1.add_f1hiuo$(first(factChain.chain), MainLineAndNode$check$lambda_6, MainLineAndNode$check$lambda_7, currentLogLevel.v);
        return checkingResult;
      }
    }
    log_1.addMessage_bda5c9$(MainLineAndNode$check$lambda_8, MessageType$USER_getInstance(), currentLogLevel.v);
    currentLogLevel.v = currentLogLevel.v + 1 | 0;
    var knownFacts = toMutableList(plus(additionalFacts, this.inFacts));
    tmp$_0 = this.rules.iterator();
    while (tmp$_0.hasNext()) {
      var rule = tmp$_0.next();
      var checkingResult_0 = rule.check_l8pk6u$(factComporator, false, plus(factsTransformations, nodeFactsTransformations), plus(expressionTransformations, nodeExpressionTransformations), plus(additionalFacts, this.inFacts));
      coloringTasks.addAll_brywnq$(checkingResult_0.coloringTasks);
      if (checkingResult_0.isCorrect) {
        if (rule.factSubstitution != null || rule.expressionSubstitution != null) {
          if (rule.factSubstitution != null) {
            nodeFactsTransformations.add_11rb$(ensureNotNull(rule.factSubstitution));
            log_1.addMessageWithFactSubstitutionDetail_v23yj3$(MainLineAndNode$check$lambda_9, ensureNotNull(rule.factSubstitution), MessageType$USER_getInstance(), currentLogLevel.v);
            var leftFactIsKnown = log_1.assignAndLog_746w4o$(false, currentLogLevel.v, MainLineAndNode$check$lambda_10);
            tmp$_1 = knownFacts.iterator();
            while (tmp$_1.hasNext()) {
              var knownFact = tmp$_1.next();
              log_1.addMessageWithFactShort_5zaetr$(MainLineAndNode$check$lambda_11, knownFact, void 0, currentLogLevel.v);
              if (factComporator.compareAsIs_hsjydo$(knownFact, ensureNotNull(rule.factSubstitution).left)) {
                leftFactIsKnown = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainLineAndNode$check$lambda_12);
                break;
              }
            }
            if (leftFactIsKnown) {
              knownFacts.add_11rb$(ensureNotNull(rule.factSubstitution).right);
              log_1.addMessage_bda5c9$(MainLineAndNode$check$lambda_13, MessageType$USER_getInstance(), currentLogLevel.v);
              if (ensureNotNull(rule.factSubstitution).right.type() === ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance()) {
                var ruleData = Kotlin.isType(tmp$_2 = ensureNotNull(rule.factSubstitution).right, ExpressionComparison) ? tmp$_2 : throwCCE();
                var expressionSubstitution = new ExpressionSubstitution(ruleData.leftExpression.data, ruleData.rightExpression.data, void 0, true, void 0, void 0, void 0, ruleData.comparisonType);
                nodeExpressionTransformations.add_11rb$(expressionSubstitution);
                log_1.addMessageWithExpressionSubstitutionShort_ht2yvq$(MainLineAndNode$check$lambda_14, expressionSubstitution, void 0, currentLogLevel.v);
              }
            }
          }
           else {
            nodeExpressionTransformations.add_11rb$(ensureNotNull(rule.expressionSubstitution));
            log_1.addMessageWithExpressionSubstitutionShort_ht2yvq$(MainLineAndNode$check$lambda_15, ensureNotNull(rule.expressionSubstitution), MessageType$USER_getInstance(), currentLogLevel.v);
          }
        }
      }
       else {
        log_1.addMessage_bda5c9$(MainLineAndNode$check$lambda_16, MessageType$USER_getInstance(), currentLogLevel.v);
        log_1.add_f1hiuo$(rule, MainLineAndNode$check$lambda_17, MainLineAndNode$check$lambda_18, currentLogLevel.v);
        return new ComparisonResult(false, coloringTasks, this, this, checkingResult_0.description);
      }
    }
    log_1.addMessage_bda5c9$(MainLineAndNode$check$lambda_19, MessageType$USER_getInstance(), currentLogLevel.v - 1 | 0);
    tmp$_3 = this.expressionTransformationChains.iterator();
    while (tmp$_3.hasNext()) {
      var expressionChain = tmp$_3.next();
      var checkingResult_1 = expressionChain.check_l8pk6u$(factComporator, false, plus(factsTransformations, nodeFactsTransformations), plus(expressionTransformations, nodeExpressionTransformations), plus(additionalFacts, this.inFacts));
      coloringTasks.addAll_brywnq$(checkingResult_1.coloringTasks);
      if (checkingResult_1.isCorrect) {
        this.outFacts.add_11rb$(new ExpressionComparison(void 0, void 0, Kotlin.isType(tmp$_4 = first(expressionChain.chain), Expression) ? tmp$_4 : throwCCE(), Kotlin.isType(tmp$_5 = last(expressionChain.chain), Expression) ? tmp$_5 : throwCCE(), expressionChain.comparisonType, this));
        log_1.addMessageWithFactDetail_5zaetr$(MainLineAndNode$check$lambda_20, last(this.outFacts), MessageType$USER_getInstance(), currentLogLevel.v);
        if (checkingResult_1.additionalFactUsed) {
          additionalFactUsed = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainLineAndNode$check$lambda_21);
        }
      }
       else {
        log_1.addMessage_bda5c9$(MainLineAndNode$check$lambda_22, MessageType$USER_getInstance(), currentLogLevel.v);
        log_1.add_f1hiuo$(expressionChain, MainLineAndNode$check$lambda_23, MainLineAndNode$check$lambda_24, currentLogLevel.v);
        return new ComparisonResult(false, coloringTasks, this, this, checkingResult_1.description);
      }
    }
    log_1.addMessage_bda5c9$(MainLineAndNode$check$lambda_25, MessageType$USER_getInstance(), currentLogLevel.v - 1 | 0);
    tmp$_6 = this.factTransformationChains.iterator();
    while (tmp$_6.hasNext()) {
      var factChain_0 = tmp$_6.next();
      var checkingResult_2 = factChain_0.check_l8pk6u$(factComporator, false, plus(factsTransformations, nodeFactsTransformations), plus(expressionTransformations, nodeExpressionTransformations), plus(additionalFacts, this.inFacts));
      coloringTasks.addAll_brywnq$(checkingResult_2.coloringTasks);
      if (checkingResult_2.isCorrect) {
        this.outFacts.add_11rb$(last(factChain_0.chain));
        log_1.addMessageWithFactDetail_5zaetr$(MainLineAndNode$check$lambda_26, last(this.outFacts), MessageType$USER_getInstance(), currentLogLevel.v);
        if (checkingResult_2.additionalFactUsed) {
          additionalFactUsed = log_1.assignAndLog_746w4o$(true, currentLogLevel.v, MainLineAndNode$check$lambda_27);
        }
      }
       else {
        log_1.addMessage_bda5c9$(MainLineAndNode$check$lambda_28, MessageType$USER_getInstance(), currentLogLevel.v);
        log_1.add_f1hiuo$(factChain_0, MainLineAndNode$check$lambda_29, MainLineAndNode$check$lambda_30, currentLogLevel.v);
        return new ComparisonResult(false, coloringTasks, this, this, checkingResult_2.description);
      }
    }
    log_1.addMessageWithFactDetail_5zaetr$(MainLineAndNode$check$lambda_31, this, MessageType$USER_getInstance(), currentLogLevel.v - 1 | 0);
    return new ComparisonResult(true, coloringTasks, this, this, void 0, additionalFactUsed);
  };
  MainLineAndNode.prototype.getActualChain = function () {
    return last(this.factTransformationChains).chain;
  };
  MainLineAndNode.prototype.addStartNewFactChain = function () {
    this.factTransformationChains.add_11rb$(new MainChain());
  };
  MainLineAndNode.prototype.addExpressionComparisonFact_5lkwds$ = function (fact) {
    if (this.factTransformationChains.isEmpty()) {
      this.addStartNewFactChain();
    }
    this.getActualChain().add_11rb$(fact);
  };
  MainLineAndNode.prototype.type = function () {
    return ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance();
  };
  function MainLineAndNode$toString$lambda(it) {
    return it.toString();
  }
  function MainLineAndNode$toString$lambda_0(it) {
    return it.toString();
  }
  function MainLineAndNode$toString$lambda_1(it) {
    return it.toString();
  }
  function MainLineAndNode$toString$lambda_2(it) {
    return it.toString();
  }
  function MainLineAndNode$toString$lambda_3(it) {
    return it.toString();
  }
  MainLineAndNode.prototype.toString = function () {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3;
    if (!this.rules.isEmpty()) {
      tmp$ = 'rules:(' + joinToString(this.rules, ';', void 0, void 0, void 0, void 0, MainLineAndNode$toString$lambda) + ');';
    }
     else {
      tmp$ = '';
    }
    if (!this.expressionTransformationChains.isEmpty()) {
      tmp$_0 = 'transformation chains:(' + joinToString(this.expressionTransformationChains, ';', void 0, void 0, void 0, void 0, MainLineAndNode$toString$lambda_0) + ');';
    }
     else {
      tmp$_0 = '';
    }
    if (!this.factTransformationChains.isEmpty()) {
      tmp$_1 = 'facts chains:(' + joinToString(this.factTransformationChains, ';', void 0, void 0, void 0, void 0, MainLineAndNode$toString$lambda_1) + ')';
    }
     else {
      tmp$_1 = '';
    }
    if (!this.inFacts.isEmpty()) {
      tmp$_2 = 'in:(' + joinToString(this.inFacts, ';', void 0, void 0, void 0, void 0, MainLineAndNode$toString$lambda_2) + ')';
    }
     else {
      tmp$_2 = '';
    }
    if (!this.outFacts.isEmpty()) {
      tmp$_3 = 'out:(' + joinToString(this.outFacts, ';', void 0, void 0, void 0, void 0, MainLineAndNode$toString$lambda_3) + ')';
    }
     else {
      tmp$_3 = '';
    }
    return 'AND_NODE(' + tmp$ + tmp$_0 + tmp$_1 + tmp$_2 + tmp$_3 + ')';
  };
  function MainLineAndNode$computeIdentifier$lambda(closure$recomputeIfComputed) {
    return function (it) {
      return it.computeIdentifier_6taknv$(closure$recomputeIfComputed);
    };
  }
  function MainLineAndNode$computeIdentifier$lambda_0(closure$recomputeIfComputed) {
    return function (it) {
      return it.computeIdentifier_6taknv$(closure$recomputeIfComputed);
    };
  }
  MainLineAndNode.prototype.computeIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.identifier) || recomputeIfComputed) {
      this.identifier = 'AND_NODE(' + joinToString(this.inFacts, ';mn;', void 0, void 0, void 0, void 0, MainLineAndNode$computeIdentifier$lambda(recomputeIfComputed)) + ((!this.outFacts.isEmpty() ? ';-->>;(' + joinToString(this.outFacts, ';mn;', void 0, void 0, void 0, void 0, MainLineAndNode$computeIdentifier$lambda_0(recomputeIfComputed)) : '') + ')');
    }
    return this.identifier;
  };
  function MainLineAndNode$computeInIdentifier$lambda(closure$recomputeIfComputed) {
    return function (it) {
      return it.computeInIdentifier_6taknv$(closure$recomputeIfComputed);
    };
  }
  MainLineAndNode.prototype.computeInIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.inIdentifier) || recomputeIfComputed) {
      this.inIdentifier = 'AND_NODE(' + joinToString(this.inFacts, ';mn;', void 0, void 0, void 0, void 0, MainLineAndNode$computeInIdentifier$lambda(recomputeIfComputed)) + ')';
    }
    return this.inIdentifier;
  };
  function MainLineAndNode$computeOutIdentifier$lambda(closure$recomputeIfComputed) {
    return function (it) {
      return it.computeOutIdentifier_6taknv$(closure$recomputeIfComputed);
    };
  }
  MainLineAndNode.prototype.computeOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.outIdentifier) || recomputeIfComputed) {
      this.outIdentifier = 'AND_NODE(' + joinToString(this.outFacts, ';mn;', void 0, void 0, void 0, void 0, MainLineAndNode$computeOutIdentifier$lambda(recomputeIfComputed)) + ')';
    }
    return this.outIdentifier;
  };
  function MainLineAndNode$computeSortedOutIdentifier$lambda(it) {
    return it;
  }
  MainLineAndNode.prototype.computeSortedOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    var $receiver = this.outFacts;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var item = tmp$.next();
      destination.add_11rb$(item.computeSortedOutIdentifier_6taknv$(recomputeIfComputed));
    }
    var childrenFactsIdentifiers = destination;
    return 'AND_NODE(' + joinToString(sorted(childrenFactsIdentifiers), ';mn;', void 0, void 0, void 0, void 0, MainLineAndNode$computeSortedOutIdentifier$lambda) + ')';
  };
  MainLineAndNode.prototype.isFactorizationForVariables_3b7jn6$ = function (minNumberOfMultipliers, targetVariables, targetExpression, factComporator) {
    if (!this.outFacts.isEmpty()) {
      return last(this.outFacts).isFactorizationForVariables_3b7jn6$(minNumberOfMultipliers, targetVariables, targetExpression, factComporator);
    }
    return new GeneralError('No answer');
  };
  MainLineAndNode.prototype.isSolutionWithoutFunctions_cbql57$ = function (forbidden, targetExpression, factComporator) {
    if (!this.outFacts.isEmpty()) {
      return last(this.outFacts).isSolutionWithoutFunctions_cbql57$(forbidden, targetExpression, factComporator);
    }
    return new GeneralError('No answer');
  };
  MainLineAndNode.prototype.hasNoFractions_5ah4l7$ = function (maxNumberOfDivisions, targetExpression, factComporator) {
    if (!this.outFacts.isEmpty()) {
      return last(this.outFacts).hasNoFractions_5ah4l7$(maxNumberOfDivisions, targetExpression, factComporator);
    }
    return new GeneralError('No answer');
  };
  function MainLineAndNode$Companion() {
    MainLineAndNode$Companion_instance = this;
  }
  MainLineAndNode$Companion.prototype.parseFromFactIdentifier_yhp8gb$ = function (string, parent, functionConfiguration) {
    if (parent === void 0)
      parent = null;
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration();
    var endIndex = string.length - 1 | 0;
    var mainPart = string.substring(9, endIndex);
    var $receiver = splitBySubstringOnTopLevel(listOf(';-->>;'), mainPart);
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var item = tmp$.next();
      var tmp$_0 = destination.add_11rb$;
      var startIndex = item.startPosition;
      var endIndex_0 = item.endPosition;
      tmp$_0.call(destination, mainPart.substring(startIndex, endIndex_0));
    }
    var parts = destination;
    var result = new MainLineAndNode(void 0, void 0, parent);
    result.inFacts.addAll_brywnq$(parsePartsFromIdentifier(parts.get_za3lpa$(0), parent, functionConfiguration));
    result.outFacts.addAll_brywnq$(parsePartsFromIdentifier(parts.size > 1 ? parts.get_za3lpa$(1) : parts.get_za3lpa$(0), parent, functionConfiguration));
    return result;
  };
  MainLineAndNode$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var MainLineAndNode$Companion_instance = null;
  function MainLineAndNode$Companion_getInstance() {
    if (MainLineAndNode$Companion_instance === null) {
      new MainLineAndNode$Companion();
    }
    return MainLineAndNode$Companion_instance;
  }
  MainLineAndNode.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'MainLineAndNode',
    interfaces: [MainLineNode]
  };
  function MainLineOrNode(startPosition, endPosition, parent, factTransformationChains, inFacts, outFacts, expressionTransformationChains, rules, identifier) {
    MainLineOrNode$Companion_getInstance();
    if (startPosition === void 0)
      startPosition = 0;
    if (endPosition === void 0)
      endPosition = 0;
    if (parent === void 0)
      parent = null;
    if (factTransformationChains === void 0) {
      factTransformationChains = ArrayList_init();
    }
    if (inFacts === void 0) {
      inFacts = ArrayList_init();
    }
    if (outFacts === void 0) {
      outFacts = ArrayList_init();
    }
    if (expressionTransformationChains === void 0) {
      expressionTransformationChains = ArrayList_init();
    }
    if (rules === void 0) {
      rules = ArrayList_init();
    }
    if (identifier === void 0)
      identifier = '';
    this.startPosition_t9kio0$_0 = startPosition;
    this.endPosition_pktch3$_0 = endPosition;
    this.parent_kw1601$_0 = parent;
    this.factTransformationChains_9mri8y$_0 = factTransformationChains;
    this.inFacts_uvj815$_0 = inFacts;
    this.outFacts_87aq1c$_0 = outFacts;
    this.expressionTransformationChains_rpyzw6$_0 = expressionTransformationChains;
    this.rules_xsla30$_0 = rules;
    this.identifier_g6vyv4$_0 = identifier;
    this.inIdentifier = '';
    this.outIdentifier = '';
  }
  Object.defineProperty(MainLineOrNode.prototype, 'startPosition', {
    get: function () {
      return this.startPosition_t9kio0$_0;
    }
  });
  Object.defineProperty(MainLineOrNode.prototype, 'endPosition', {
    get: function () {
      return this.endPosition_pktch3$_0;
    }
  });
  Object.defineProperty(MainLineOrNode.prototype, 'parent', {
    get: function () {
      return this.parent_kw1601$_0;
    },
    set: function (parent) {
      this.parent_kw1601$_0 = parent;
    }
  });
  Object.defineProperty(MainLineOrNode.prototype, 'factTransformationChains', {
    get: function () {
      return this.factTransformationChains_9mri8y$_0;
    }
  });
  Object.defineProperty(MainLineOrNode.prototype, 'inFacts', {
    get: function () {
      return this.inFacts_uvj815$_0;
    }
  });
  Object.defineProperty(MainLineOrNode.prototype, 'outFacts', {
    get: function () {
      return this.outFacts_87aq1c$_0;
    }
  });
  Object.defineProperty(MainLineOrNode.prototype, 'expressionTransformationChains', {
    get: function () {
      return this.expressionTransformationChains_rpyzw6$_0;
    }
  });
  Object.defineProperty(MainLineOrNode.prototype, 'rules', {
    get: function () {
      return this.rules_xsla30$_0;
    }
  });
  Object.defineProperty(MainLineOrNode.prototype, 'identifier', {
    get: function () {
      return this.identifier_g6vyv4$_0;
    },
    set: function (identifier) {
      this.identifier_g6vyv4$_0 = identifier;
    }
  });
  MainLineOrNode.prototype.getLastExpression = function () {
    return last(this.outFacts).getLastExpression();
  };
  MainLineOrNode.prototype.isSolutionForVariables_axkv0l$$default = function (targetVariables, left, allowedVariables) {
    var tmp$;
    tmp$ = this.outFacts.iterator();
    while (tmp$.hasNext()) {
      var fact = tmp$.next();
      var error = fact.isSolutionForVariables_axkv0l$(targetVariables, void 0, allowedVariables);
      if (error != null)
        return error;
    }
    return null;
  };
  MainLineOrNode.prototype.computeIfNumeric_7do60d$ = function (substitutionInstance, baseOperationsDefinitions, checkOutMainLineNodePart) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    var actualFacts = checkOutMainLineNodePart ? getOutFactsFromMainLineNode(this) : getInFactsFromMainLineNode(this);
    var isNull = false;
    tmp$ = actualFacts.iterator();
    while (tmp$.hasNext()) {
      var fact = tmp$.next();
      switch (fact.type().name) {
        case 'EXPRESSION_COMPARISON':
          tmp$_2 = (Kotlin.isType(tmp$_0 = fact, ExpressionComparison) ? tmp$_0 : throwCCE()).computeIfNumeric_z3m4ac$(substitutionInstance, baseOperationsDefinitions);
          break;
        case 'MAIN_LINE_AND_NODE':
        case 'MAIN_LINE_OR_NODE':
          tmp$_2 = (Kotlin.isType(tmp$_1 = fact, MainLineNode) ? tmp$_1 : throwCCE()).computeIfNumeric_7do60d$(substitutionInstance, baseOperationsDefinitions, checkOutMainLineNodePart);
          break;
        default:tmp$_2 = null;
          break;
      }
      var isCorrect = tmp$_2;
      if (isCorrect == null) {
        isNull = true;
      }
       else if (isCorrect) {
        return true;
      }
    }
    return isNull ? null : false;
  };
  MainLineOrNode.prototype.copyNode = function () {
    return new MainLineOrNode(this.startPosition, this.endPosition, this.parent);
  };
  MainLineOrNode.prototype.clone = function () {
    var tmp$ = this.startPosition;
    var tmp$_0 = this.endPosition;
    var tmp$_1 = this.parent;
    var tmp$_2 = void 0;
    var $receiver = this.inFacts;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$_3;
    tmp$_3 = $receiver.iterator();
    while (tmp$_3.hasNext()) {
      var item = tmp$_3.next();
      destination.add_11rb$(item.clone());
    }
    var tmp$_4 = toMutableList(destination);
    var $receiver_0 = this.outFacts;
    var destination_0 = ArrayList_init_0(collectionSizeOrDefault($receiver_0, 10));
    var tmp$_5;
    tmp$_5 = $receiver_0.iterator();
    while (tmp$_5.hasNext()) {
      var item_0 = tmp$_5.next();
      destination_0.add_11rb$(item_0.clone());
    }
    return new MainLineOrNode(tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_4, toMutableList(destination_0));
  };
  MainLineOrNode.prototype.cloneWithNormalization_1g1bdl$ = function (nameArgsMap, sorted) {
    var tmp$ = this.startPosition;
    var tmp$_0 = this.endPosition;
    var tmp$_1 = this.parent;
    var tmp$_2 = void 0;
    var $receiver = this.inFacts;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$_3;
    tmp$_3 = $receiver.iterator();
    while (tmp$_3.hasNext()) {
      var item = tmp$_3.next();
      destination.add_11rb$(item.cloneWithNormalization_1g1bdl$(nameArgsMap, sorted));
    }
    var tmp$_4 = toMutableList(destination);
    var $receiver_0 = this.outFacts;
    var destination_0 = ArrayList_init_0(collectionSizeOrDefault($receiver_0, 10));
    var tmp$_5;
    tmp$_5 = $receiver_0.iterator();
    while (tmp$_5.hasNext()) {
      var item_0 = tmp$_5.next();
      destination_0.add_11rb$(item_0.cloneWithNormalization_1g1bdl$(nameArgsMap, sorted));
    }
    return new MainLineOrNode(tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_4, toMutableList(destination_0));
  };
  MainLineOrNode.prototype.normalizeSubTree_f8z7ch$ = function (currentDeep, nameArgsMap, sorted) {
    var tmp$;
    tmp$ = this.inFacts.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.normalizeSubTree_f8z7ch$(currentDeep, nameArgsMap, sorted);
    }
    var tmp$_0;
    tmp$_0 = this.outFacts.iterator();
    while (tmp$_0.hasNext()) {
      var element_0 = tmp$_0.next();
      element_0.normalizeSubTree_f8z7ch$(currentDeep, nameArgsMap, sorted);
    }
  };
  MainLineOrNode.prototype.variableReplacement_y0zsll$ = function (replacements) {
    var tmp$;
    tmp$ = this.inFacts.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.variableReplacement_y0zsll$(replacements);
    }
    var tmp$_0;
    tmp$_0 = this.outFacts.iterator();
    while (tmp$_0.hasNext()) {
      var element_0 = tmp$_0.next();
      element_0.variableReplacement_y0zsll$(replacements);
    }
    var tmp$_1;
    tmp$_1 = this.rules.iterator();
    while (tmp$_1.hasNext()) {
      var element_1 = tmp$_1.next();
      element_1.variableReplacement_y0zsll$(replacements);
    }
    var tmp$_2;
    tmp$_2 = this.expressionTransformationChains.iterator();
    while (tmp$_2.hasNext()) {
      var element_2 = tmp$_2.next();
      element_2.variableReplacement_y0zsll$(replacements);
    }
    var tmp$_3;
    tmp$_3 = this.factTransformationChains.iterator();
    while (tmp$_3.hasNext()) {
      var element_3 = tmp$_3.next();
      element_3.variableReplacement_y0zsll$(replacements);
    }
  };
  MainLineOrNode.prototype.applyAllExpressionSubstitutions_8sufjw$ = function (expressionSubstitutions) {
    var tmp$;
    tmp$ = this.inFacts.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.applyAllExpressionSubstitutions_8sufjw$(expressionSubstitutions);
    }
    var tmp$_0;
    tmp$_0 = this.outFacts.iterator();
    while (tmp$_0.hasNext()) {
      var element_0 = tmp$_0.next();
      element_0.applyAllExpressionSubstitutions_8sufjw$(expressionSubstitutions);
    }
  };
  MainLineOrNode.prototype.computeExpressionTrees_dq72cu$ = function (baseOperationsDefinitions) {
    var tmp$;
    tmp$ = this.inFacts.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.computeExpressionTrees_dq72cu$(baseOperationsDefinitions);
    }
    var tmp$_0;
    tmp$_0 = this.outFacts.iterator();
    while (tmp$_0.hasNext()) {
      var element_0 = tmp$_0.next();
      element_0.computeExpressionTrees_dq72cu$(baseOperationsDefinitions);
    }
  };
  MainLineOrNode.prototype.replaceNotDefinedFunctionsOnVariables_1vzej0$ = function (functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet) {
    var tmp$;
    tmp$ = this.inFacts.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.replaceNotDefinedFunctionsOnVariables_1vzej0$(functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet);
    }
    var tmp$_0;
    tmp$_0 = this.outFacts.iterator();
    while (tmp$_0.hasNext()) {
      var element_0 = tmp$_0.next();
      element_0.replaceNotDefinedFunctionsOnVariables_1vzej0$(functionIdentifierToVariableMap, definedFunctionNameNumberOfArgsSet);
    }
  };
  MainLineOrNode.prototype.check_l8pk6u$ = function (factComporator, onExpressionLevel, factsTransformations, expressionTransformations, additionalFacts) {
    throw new NotImplementedError_init('An operation is not implemented: ' + 'not implemented');
  };
  MainLineOrNode.prototype.getActualChain = function () {
    return last(this.factTransformationChains).chain;
  };
  MainLineOrNode.prototype.addStartNewFactChain = function () {
    this.factTransformationChains.add_11rb$(new MainChain());
  };
  MainLineOrNode.prototype.addExpressionComparisonFact_5lkwds$ = function (fact) {
    if (this.factTransformationChains.isEmpty()) {
      this.addStartNewFactChain();
    }
    this.getActualChain().add_11rb$(fact);
  };
  MainLineOrNode.prototype.type = function () {
    return ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance();
  };
  function MainLineOrNode$toString$lambda(it) {
    return it.toString();
  }
  function MainLineOrNode$toString$lambda_0(it) {
    return it.toString();
  }
  function MainLineOrNode$toString$lambda_1(it) {
    return it.toString();
  }
  function MainLineOrNode$toString$lambda_2(it) {
    return it.toString();
  }
  function MainLineOrNode$toString$lambda_3(it) {
    return it.toString();
  }
  MainLineOrNode.prototype.toString = function () {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3;
    if (!this.rules.isEmpty()) {
      tmp$ = 'rules:(' + joinToString(this.rules, ';', void 0, void 0, void 0, void 0, MainLineOrNode$toString$lambda) + ');';
    }
     else {
      tmp$ = '';
    }
    if (!this.expressionTransformationChains.isEmpty()) {
      tmp$_0 = 'transformation chains:(' + joinToString(this.expressionTransformationChains, ';', void 0, void 0, void 0, void 0, MainLineOrNode$toString$lambda_0) + ');';
    }
     else {
      tmp$_0 = '';
    }
    if (!this.factTransformationChains.isEmpty()) {
      tmp$_1 = 'facts chains:(' + joinToString(this.factTransformationChains, ';', void 0, void 0, void 0, void 0, MainLineOrNode$toString$lambda_1) + ')';
    }
     else {
      tmp$_1 = '';
    }
    if (!this.inFacts.isEmpty()) {
      tmp$_2 = 'in:(' + joinToString(this.inFacts, ';', void 0, void 0, void 0, void 0, MainLineOrNode$toString$lambda_2) + ')';
    }
     else {
      tmp$_2 = '';
    }
    if (!this.outFacts.isEmpty()) {
      tmp$_3 = 'out:(' + joinToString(this.outFacts, ';', void 0, void 0, void 0, void 0, MainLineOrNode$toString$lambda_3) + ')';
    }
     else {
      tmp$_3 = '';
    }
    return 'OR_NODE(' + tmp$ + tmp$_0 + tmp$_1 + tmp$_2 + tmp$_3 + ')';
  };
  function MainLineOrNode$computeIdentifier$lambda(closure$recomputeIfComputed) {
    return function (it) {
      return it.computeIdentifier_6taknv$(closure$recomputeIfComputed);
    };
  }
  function MainLineOrNode$computeIdentifier$lambda_0(closure$recomputeIfComputed) {
    return function (it) {
      return it.computeIdentifier_6taknv$(closure$recomputeIfComputed);
    };
  }
  MainLineOrNode.prototype.computeIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.identifier) || recomputeIfComputed) {
      this.identifier = 'OR_NODE(' + joinToString(this.inFacts, ';mn;', void 0, void 0, void 0, void 0, MainLineOrNode$computeIdentifier$lambda(recomputeIfComputed)) + ((!this.outFacts.isEmpty() ? ';-->>;(' + joinToString(this.outFacts, ';mn;', void 0, void 0, void 0, void 0, MainLineOrNode$computeIdentifier$lambda_0(recomputeIfComputed)) : '') + ')');
    }
    return this.identifier;
  };
  function MainLineOrNode$computeInIdentifier$lambda(closure$recomputeIfComputed) {
    return function (it) {
      return it.computeInIdentifier_6taknv$(closure$recomputeIfComputed);
    };
  }
  MainLineOrNode.prototype.computeInIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.inIdentifier) || recomputeIfComputed) {
      this.inIdentifier = 'OR_NODE(' + joinToString(this.inFacts, ';mn;', void 0, void 0, void 0, void 0, MainLineOrNode$computeInIdentifier$lambda(recomputeIfComputed)) + ')';
    }
    return this.inIdentifier;
  };
  function MainLineOrNode$computeOutIdentifier$lambda(closure$recomputeIfComputed) {
    return function (it) {
      return it.computeOutIdentifier_6taknv$(closure$recomputeIfComputed);
    };
  }
  MainLineOrNode.prototype.computeOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.outIdentifier) || recomputeIfComputed) {
      this.outIdentifier = 'OR_NODE(' + joinToString(this.outFacts, ';mn;', void 0, void 0, void 0, void 0, MainLineOrNode$computeOutIdentifier$lambda(recomputeIfComputed)) + ')';
    }
    return this.outIdentifier;
  };
  function MainLineOrNode$computeSortedOutIdentifier$lambda(it) {
    return it;
  }
  MainLineOrNode.prototype.computeSortedOutIdentifier_6taknv$ = function (recomputeIfComputed) {
    var $receiver = this.outFacts;
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var item = tmp$.next();
      destination.add_11rb$(item.computeSortedOutIdentifier_6taknv$(recomputeIfComputed));
    }
    var childrenFactsIdentifiers = destination;
    return 'OR_NODE(' + joinToString(sorted(childrenFactsIdentifiers), ';mn;', void 0, void 0, void 0, void 0, MainLineOrNode$computeSortedOutIdentifier$lambda) + ')';
  };
  function MainLineOrNode$Companion() {
    MainLineOrNode$Companion_instance = this;
  }
  MainLineOrNode$Companion.prototype.parseFromFactIdentifier_yhp8gb$ = function (string, parent, functionConfiguration) {
    if (parent === void 0)
      parent = null;
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration();
    var endIndex = string.length - 1 | 0;
    var mainPart = string.substring(8, endIndex);
    var $receiver = splitBySubstringOnTopLevel(listOf(';-->>;'), mainPart);
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var item = tmp$.next();
      var tmp$_0 = destination.add_11rb$;
      var startIndex = item.startPosition;
      var endIndex_0 = item.endPosition;
      tmp$_0.call(destination, mainPart.substring(startIndex, endIndex_0));
    }
    var parts = destination;
    var result = new MainLineOrNode(void 0, void 0, parent);
    result.inFacts.addAll_brywnq$(parsePartsFromIdentifier(parts.get_za3lpa$(0), parent, functionConfiguration));
    result.outFacts.addAll_brywnq$(parsePartsFromIdentifier(parts.size > 1 ? parts.get_za3lpa$(1) : parts.get_za3lpa$(0), parent, functionConfiguration));
    return result;
  };
  MainLineOrNode$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var MainLineOrNode$Companion_instance = null;
  function MainLineOrNode$Companion_getInstance() {
    if (MainLineOrNode$Companion_instance === null) {
      new MainLineOrNode$Companion();
    }
    return MainLineOrNode$Companion_instance;
  }
  MainLineOrNode.prototype.isFactorizationForVariables_3b7jn6$ = function (minNumberOfMultipliers, targetVariables, targetExpression, factComporator) {
    if (!this.outFacts.isEmpty()) {
      return last(this.outFacts).isFactorizationForVariables_3b7jn6$(minNumberOfMultipliers, targetVariables, targetExpression, factComporator);
    }
    return new GeneralError('No answer');
  };
  MainLineOrNode.prototype.isSolutionWithoutFunctions_cbql57$ = function (forbidden, targetExpression, factComporator) {
    if (!this.outFacts.isEmpty()) {
      return last(this.outFacts).isSolutionWithoutFunctions_cbql57$(forbidden, targetExpression, factComporator);
    }
    return new GeneralError('No answer');
  };
  MainLineOrNode.prototype.hasNoFractions_5ah4l7$ = function (maxNumberOfDivisions, targetExpression, factComporator) {
    if (!this.outFacts.isEmpty()) {
      return last(this.outFacts).hasNoFractions_5ah4l7$(maxNumberOfDivisions, targetExpression, factComporator);
    }
    return new GeneralError('No answer');
  };
  MainLineOrNode.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'MainLineOrNode',
    interfaces: [MainLineNode]
  };
  function getInFactsFromMainLineNode(factNode) {
    var tmp$, tmp$_0;
    return factNode.type() === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() ? (Kotlin.isType(tmp$ = factNode, MainLineAndNode) ? tmp$ : throwCCE()).inFacts : (Kotlin.isType(tmp$_0 = factNode, MainLineOrNode) ? tmp$_0 : throwCCE()).inFacts;
  }
  function getOutFactsFromMainLineNode(factNode) {
    var tmp$, tmp$_0;
    return factNode.type() === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() ? (Kotlin.isType(tmp$ = factNode, MainLineAndNode) ? tmp$ : throwCCE()).outFacts : (Kotlin.isType(tmp$_0 = factNode, MainLineOrNode) ? tmp$_0 : throwCCE()).outFacts;
  }
  function parsePartsFromIdentifier(string, parent, functionConfiguration) {
    if (parent === void 0)
      parent = null;
    var tmp$, tmp$_0;
    var $receiver = splitBySubstringOnTopLevel(listOf(';mn;'), string);
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$_1;
    tmp$_1 = $receiver.iterator();
    while (tmp$_1.hasNext()) {
      var item = tmp$_1.next();
      var tmp$_2 = destination.add_11rb$;
      var startIndex = item.startPosition;
      var endIndex = item.endPosition;
      tmp$_2.call(destination, string.substring(startIndex, endIndex));
    }
    var parts = destination;
    var result = ArrayList_init();
    tmp$ = parts.iterator();
    while (tmp$.hasNext()) {
      var part = tmp$.next();
      tmp$_0 = parseFromFactIdentifier(part, parent, functionConfiguration);
      if (tmp$_0 == null) {
        continue;
      }
      result.add_11rb$(tmp$_0);
    }
    return result;
  }
  function parseFromFactIdentifier(string, parent, functionConfiguration) {
    if (parent === void 0)
      parent = null;
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration();
    if (startsWith(string, 'AND_NODE(')) {
      return MainLineAndNode$Companion_getInstance().parseFromFactIdentifier_yhp8gb$(string, parent, functionConfiguration);
    }
     else if (startsWith(string, 'OR_NODE(')) {
      return MainLineOrNode$Companion_getInstance().parseFromFactIdentifier_yhp8gb$(string, parent, functionConfiguration);
    }
     else if (contains_0(string, ';ec;')) {
      return ExpressionComparison$Companion_getInstance().parseFromFactIdentifier_yhp8gb$(string, parent, functionConfiguration);
    }
     else {
      return Expression$Companion_getInstance().parseFromFactIdentifier_yhp8gb$(string, parent, functionConfiguration);
    }
  }
  function normalizeFactsForComparison(left, right) {
    var tmp$;
    if (left.type() === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance())
      tmp$ = new Pair(left, right);
    else if (right.type() === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance())
      tmp$ = new Pair(right, left);
    else
      return new Pair(left, right);
    var ordered = tmp$;
    if (ordered.second.type() !== ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance()) {
      var tmp$_0 = ordered.first;
      var $receiver = new MainLineAndNode();
      $receiver.inFacts.add_11rb$(ordered.second);
      $receiver.outFacts.add_11rb$(ordered.second);
      return new Pair(tmp$_0, $receiver);
    }
     else
      return ordered;
  }
  function factWrapperForCheckingTransformations(fact, checkOutMainLineNodePart) {
    var tmp$, tmp$_0;
    if (fact.type() !== ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() && fact.type() !== ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance()) {
      tmp$ = mutableListOf([fact]);
    }
     else if (checkOutMainLineNodePart) {
      tmp$ = getOutFactsFromMainLineNode(fact);
    }
     else {
      tmp$ = getInFactsFromMainLineNode(fact);
    }
    var actualFacts = tmp$;
    if (fact.type() !== ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance()) {
      tmp$_0 = new MainLineAndNode(void 0, void 0, void 0, void 0, actualFacts, actualFacts);
    }
     else {
      tmp$_0 = new MainLineOrNode(void 0, void 0, void 0, void 0, actualFacts, actualFacts);
    }
    var wrapper = tmp$_0;
    return new MainLineAndNode(void 0, void 0, void 0, void 0, mutableListOf([wrapper]), mutableListOf([wrapper]));
  }
  function checkTransformationChain($receiver, factComporator, onExpressionLevel, additionalFacts) {
    var compiledConfiguration = factComporator.compiledConfiguration;
    $receiver.variableReplacement_y0zsll$(compiledConfiguration.compiledImmediateVariableReplacements);
    var tmp$;
    tmp$ = additionalFacts.iterator();
    while (tmp$.hasNext()) {
      var element = tmp$.next();
      element.variableReplacement_y0zsll$(compiledConfiguration.compiledImmediateVariableReplacements);
    }
    return $receiver.check_l8pk6u$(factComporator, onExpressionLevel, compiledConfiguration.compiledFactTreeTransformationRules, compiledConfiguration.compiledExpressionTreeTransformationRules, additionalFacts);
  }
  function FactConstructorViewer(compiledConfiguration, expressionNodeConstructor, openBracket, closeBracket, mainLineNodePartSuffix) {
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration();
    if (expressionNodeConstructor === void 0)
      expressionNodeConstructor = new ExpressionNodeConstructor(compiledConfiguration.functionConfiguration, compiledConfiguration.compiledImmediateVariableReplacements);
    if (openBracket === void 0)
      openBracket = 123;
    if (closeBracket === void 0)
      closeBracket = 125;
    if (mainLineNodePartSuffix === void 0)
      mainLineNodePartSuffix = ', ';
    this.compiledConfiguration = compiledConfiguration;
    this.expressionNodeConstructor = expressionNodeConstructor;
    this.openBracket = toBoxedChar(openBracket);
    this.closeBracket = toBoxedChar(closeBracket);
    this.mainLineNodePartSuffix = mainLineNodePartSuffix;
  }
  function FactConstructorViewer$constructFactUserView$lambda(this$FactConstructorViewer) {
    return function (it) {
      return this$FactConstructorViewer.constructFactUserView_5lkwds$(it);
    };
  }
  function FactConstructorViewer$constructFactUserView$lambda_0(this$FactConstructorViewer) {
    return function (it) {
      return this$FactConstructorViewer.constructFactUserView_5lkwds$(it);
    };
  }
  function FactConstructorViewer$constructFactUserView$lambda_1(this$FactConstructorViewer) {
    return function (it) {
      return this$FactConstructorViewer.constructFactUserView_5lkwds$(it);
    };
  }
  function FactConstructorViewer$constructFactUserView$lambda$lambda(this$FactConstructorViewer) {
    return function (it) {
      return '[' + this$FactConstructorViewer.constructFactUserView_5lkwds$(it) + ']';
    };
  }
  function FactConstructorViewer$constructFactUserView$lambda_2(this$FactConstructorViewer) {
    return function (it) {
      return joinToString(it.chain, '', void 0, void 0, void 0, void 0, FactConstructorViewer$constructFactUserView$lambda$lambda(this$FactConstructorViewer));
    };
  }
  function FactConstructorViewer$constructFactUserView$lambda$lambda_0(this$FactConstructorViewer) {
    return function (it) {
      var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4;
      if (it.type() === ComparableTransformationPartType$EXPRESSION_getInstance()) {
        tmp$_0 = Kotlin.isType(tmp$ = it, Expression) ? tmp$ : throwCCE();
        return this$FactConstructorViewer.constructFactUserView_5lkwds$(tmp$_0);
      }
       else if (it.type() === ComparableTransformationPartType$RULE_getInstance()) {
        tmp$_2 = Kotlin.isType(tmp$_1 = it, Rule) ? tmp$_1 : throwCCE();
        return this$FactConstructorViewer.constructFactUserView_5lkwds$(tmp$_2);
      }
       else {
        tmp$_4 = Kotlin.isType(tmp$_3 = it, RulePointer) ? tmp$_3 : throwCCE();
        return this$FactConstructorViewer.constructFactUserView_5lkwds$(tmp$_4);
      }
    };
  }
  function FactConstructorViewer$constructFactUserView$lambda_3(this$FactConstructorViewer) {
    return function (it) {
      return joinToString(it.chain, it.comparisonType.string, void 0, void 0, void 0, void 0, FactConstructorViewer$constructFactUserView$lambda$lambda_0(this$FactConstructorViewer));
    };
  }
  FactConstructorViewer.prototype.constructFactUserView_5lkwds$ = function (fact) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5;
    var result = StringBuilder_init();
    switch (fact.type().name) {
      case 'MAIN_LINE_AND_NODE':
      case 'MAIN_LINE_OR_NODE':
        result.append_gw00v9$(split(fact.type().toString(), ['_']).get_za3lpa$(2) + '{');
        Kotlin.isType(tmp$ = fact, MainLineNode) ? tmp$ : throwCCE();
        var tmp$_6 = !fact.inFacts.isEmpty();
        if (tmp$_6) {
          tmp$_6 = !fact.outFacts.isEmpty();
        }

        if (tmp$_6) {
          var inFactsIdentifier = joinToString(fact.inFacts, '; ', void 0, void 0, void 0, void 0, FactConstructorViewer$constructFactUserView$lambda(this));
          var outFactsIdentifier = joinToString(fact.outFacts, '; ', void 0, void 0, void 0, void 0, FactConstructorViewer$constructFactUserView$lambda_0(this));
          if (equals(inFactsIdentifier, outFactsIdentifier)) {
            result.append_gw00v9$(inFactsIdentifier);
          }
           else {
            result.append_gw00v9$(inFactsIdentifier);
            result.append_gw00v9$(' --> ');
            result.append_gw00v9$(outFactsIdentifier);
          }
          result.append_gw00v9$(this.mainLineNodePartSuffix);
        }

        if (!fact.rules.isEmpty()) {
          result.append_gw00v9$('RULES: ');
          result.append_gw00v9$(joinToString(fact.rules, '', void 0, void 0, void 0, void 0, FactConstructorViewer$constructFactUserView$lambda_1(this)));
          result.append_gw00v9$(this.mainLineNodePartSuffix);
        }

        if (!fact.factTransformationChains.isEmpty()) {
          result.append_gw00v9$('FACTS_CHAINS: ');
          result.append_gw00v9$(joinToString(fact.factTransformationChains, '; ', void 0, void 0, void 0, void 0, FactConstructorViewer$constructFactUserView$lambda_2(this)));
          result.append_gw00v9$(this.mainLineNodePartSuffix);
        }

        if (!fact.expressionTransformationChains.isEmpty()) {
          result.append_gw00v9$('EXPRESSION_CHAINS: ');
          result.append_gw00v9$(joinToString(fact.expressionTransformationChains, '; ', void 0, void 0, void 0, void 0, FactConstructorViewer$constructFactUserView$lambda_3(this)));
          result.append_gw00v9$(this.mainLineNodePartSuffix);
        }

        if (endsWith(result, 123)) {
          tmp$_0 = result.toString() + '}';
        }
         else {
          tmp$_0 = dropLast(result, this.mainLineNodePartSuffix.length).toString() + '}';
        }

        return tmp$_0;
      case 'EXPRESSION_COMPARISON':
        result.append_gw00v9$(fact.type().toString() + ': ');
        Kotlin.isType(tmp$_1 = fact, ExpressionComparison) ? tmp$_1 : throwCCE();
        result.append_gw00v9$(this.constructFactUserView_5lkwds$(fact.leftExpression));
        result.append_gw00v9$(' ' + fact.comparisonType.string + ' ');
        result.append_gw00v9$(this.constructFactUserView_5lkwds$(fact.rightExpression));
        break;
      case 'EXPRESSION':
        result.append_gw00v9$((Kotlin.isType(tmp$_2 = fact, Expression) ? tmp$_2 : throwCCE()).data.toString());
        break;
      case 'RULE':
        Kotlin.isType(tmp$_3 = fact, Rule) ? tmp$_3 : throwCCE();
        if (fact.factSubstitution != null || fact.expressionSubstitution != null) {
          if (fact.factSubstitution != null) {
            '[' + this.constructFactUserView_5lkwds$(ensureNotNull(fact.factSubstitution).left) + ' ' + toUserString(ensureNotNull(fact.factSubstitution).direction) + ' ' + this.constructFactUserView_5lkwds$(ensureNotNull(fact.factSubstitution).right) + ', actual ' + ((ensureNotNull(fact.factSubstitution).basedOnTaskContext ? 'only in task context' : 'everywhere') + ']');
          }
           else {
            if (fact.expressionSubstitution != null) {
              tmp$_4 = '[' + ensureNotNull(fact.expressionSubstitution).left + ' -> ' + ensureNotNull(fact.expressionSubstitution).right + ', ' + ('actual in ' + ensureNotNull(fact.expressionSubstitution).comparisonType + ' context') + ((ensureNotNull(fact.expressionSubstitution).basedOnTaskContext ? 'only in task' : 'everywhere') + ']');
            }
             else
              tmp$_4 = '';
            '' + tmp$_4;
          }
        }
         else {
          '[' + fact.name + ':' + this.constructFactUserView_5lkwds$(fact.root) + ']';
        }

        break;
      case 'RULE_POINTER':
        Kotlin.isType(tmp$_5 = fact, RulePointer) ? tmp$_5 : throwCCE();
        '[' + fact.nameLink + ':]';
        break;
      default:throw new NotImplementedError_init('An operation is not implemented: ' + 'unexpected behaviour, should be handled better');
    }
    return result.toString();
  };
  FactConstructorViewer.prototype.data_1v8dcc$ = function ($receiver) {
    return $receiver ? '1' : '0';
  };
  FactConstructorViewer.prototype.booleanFromData_pdl1vz$ = function ($receiver) {
    return !equals($receiver, '0');
  };
  function FactConstructorViewer$constructIdentifierByFact$lambda(this$FactConstructorViewer) {
    return function (it) {
      return this$FactConstructorViewer.constructIdentifierByFact_5lkwds$(it);
    };
  }
  function FactConstructorViewer$constructIdentifierByFact$lambda$lambda(this$FactConstructorViewer) {
    return function (it) {
      return '{' + this$FactConstructorViewer.constructIdentifierByFact_5lkwds$(it) + '}';
    };
  }
  function FactConstructorViewer$constructIdentifierByFact$lambda_0(this$FactConstructorViewer) {
    return function (it) {
      return '{' + joinToString(it.chain, '', void 0, void 0, void 0, void 0, FactConstructorViewer$constructIdentifierByFact$lambda$lambda(this$FactConstructorViewer)) + '}';
    };
  }
  function FactConstructorViewer$constructIdentifierByFact$lambda$lambda_0(this$FactConstructorViewer) {
    return function (it) {
      var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4;
      if (it.type() === ComparableTransformationPartType$EXPRESSION_getInstance()) {
        tmp$_0 = Kotlin.isType(tmp$ = it, Expression) ? tmp$ : throwCCE();
        return '{' + this$FactConstructorViewer.constructIdentifierByFact_5lkwds$(tmp$_0) + '}';
      }
       else if (it.type() === ComparableTransformationPartType$RULE_getInstance()) {
        tmp$_2 = Kotlin.isType(tmp$_1 = it, Rule) ? tmp$_1 : throwCCE();
        return '{' + this$FactConstructorViewer.constructIdentifierByFact_5lkwds$(tmp$_2) + '}';
      }
       else {
        tmp$_4 = Kotlin.isType(tmp$_3 = it, RulePointer) ? tmp$_3 : throwCCE();
        return '{' + this$FactConstructorViewer.constructIdentifierByFact_5lkwds$(tmp$_4) + '}';
      }
    };
  }
  function FactConstructorViewer$constructIdentifierByFact$lambda_1(this$FactConstructorViewer) {
    return function (it) {
      return it.comparisonType.string + '{' + joinToString(it.chain, '', void 0, void 0, void 0, void 0, FactConstructorViewer$constructIdentifierByFact$lambda$lambda_0(this$FactConstructorViewer)) + '}';
    };
  }
  function FactConstructorViewer$constructIdentifierByFact$lambda_2(this$FactConstructorViewer) {
    return function (it) {
      return '{' + this$FactConstructorViewer.constructIdentifierByFact_5lkwds$(it) + '}';
    };
  }
  function FactConstructorViewer$constructIdentifierByFact$lambda_3(this$FactConstructorViewer) {
    return function (it) {
      return '{' + this$FactConstructorViewer.constructIdentifierByFact_5lkwds$(it) + '}';
    };
  }
  FactConstructorViewer.prototype.constructIdentifierByFact_5lkwds$ = function (fact) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6;
    var result = StringBuilder_init();
    switch (fact.type().name) {
      case 'MAIN_LINE_AND_NODE':
      case 'MAIN_LINE_OR_NODE':
        result.append_gw00v9$(fact.type().toString() + '{');
        Kotlin.isType(tmp$ = fact, MainLineNode) ? tmp$ : throwCCE();
        result.append_gw00v9$('RULES{');
        result.append_gw00v9$(joinToString(fact.rules, '', void 0, void 0, void 0, void 0, FactConstructorViewer$constructIdentifierByFact$lambda(this)));
        result.append_gw00v9$('}FACT_TRANSFORMATION_CHAINS{');
        result.append_gw00v9$(joinToString(fact.factTransformationChains, '', void 0, void 0, void 0, void 0, FactConstructorViewer$constructIdentifierByFact$lambda_0(this)));
        result.append_gw00v9$('}EXPRESSION_TRANSFORMATION_CHAINS{');
        result.append_gw00v9$(joinToString(fact.expressionTransformationChains, '', void 0, void 0, void 0, void 0, FactConstructorViewer$constructIdentifierByFact$lambda_1(this)));
        result.append_gw00v9$('}IN_FACTS{');
        result.append_gw00v9$(joinToString(fact.inFacts, '', void 0, void 0, void 0, void 0, FactConstructorViewer$constructIdentifierByFact$lambda_2(this)));
        result.append_gw00v9$('}OUT_FACTS{');
        result.append_gw00v9$(joinToString(fact.outFacts, '', void 0, void 0, void 0, void 0, FactConstructorViewer$constructIdentifierByFact$lambda_3(this)));
        result.append_s8itvh$(125);
        result.append_s8itvh$(125);
        break;
      case 'EXPRESSION_COMPARISON':
        result.append_gw00v9$(fact.type().toString());
        Kotlin.isType(tmp$_0 = fact, ExpressionComparison) ? tmp$_0 : throwCCE();
        result.append_gw00v9$(String.fromCharCode(unboxChar(this.openBracket)) + this.constructIdentifierByFact_5lkwds$(fact.leftExpression) + String.fromCharCode(unboxChar(this.closeBracket)));
        result.append_gw00v9$(String.fromCharCode(unboxChar(this.openBracket)) + fact.comparisonType.string + String.fromCharCode(unboxChar(this.closeBracket)));
        result.append_gw00v9$(String.fromCharCode(unboxChar(this.openBracket)) + this.constructIdentifierByFact_5lkwds$(fact.rightExpression) + String.fromCharCode(unboxChar(this.closeBracket)));
        break;
      case 'EXPRESSION':
        result.append_gw00v9$((Kotlin.isType(tmp$_1 = fact, Expression) ? tmp$_1 : throwCCE()).data.toString());
        break;
      case 'RULE':
        Kotlin.isType(tmp$_2 = fact, Rule) ? tmp$_2 : throwCCE();
        tmp$_4 = '{' + fact.name + '{' + this.constructIdentifierByFact_5lkwds$(fact.root) + '}';
        if (fact.expressionSubstitution != null) {
          var subst = ensureNotNull(fact.expressionSubstitution);
          tmp$_3 = '{' + subst.left + '}{' + subst.right + '}{' + subst.comparisonType.string + '}{' + this.data_1v8dcc$(subst.basedOnTaskContext) + '}{' + subst.weight + '}';
        }
         else
          tmp$_3 = '';
        if (fact.factSubstitution != null) {
          var subst_0 = ensureNotNull(fact.factSubstitution);
          tmp$_5 = '{' + this.constructIdentifierByFact_5lkwds$(subst_0.left) + '}{' + this.constructIdentifierByFact_5lkwds$(subst_0.right) + '}{' + subst_0.direction + '}{' + this.data_1v8dcc$(subst_0.basedOnTaskContext) + '}{' + subst_0.weight + '}';
        }
         else
          tmp$_5 = '';
        result.append_gw00v9$(tmp$_4 + ('{EXPRESSION_SUBSTITUTION' + tmp$_3 + '}') + ('{FACT_SUBSTITUTION' + tmp$_5 + '}') + '}');
        break;
      case 'RULE_POINTER':
        Kotlin.isType(tmp$_6 = fact, RulePointer) ? tmp$_6 : throwCCE();
        '{' + fact.nameLink + ':}';
        break;
      default:throw new NotImplementedError_init('An operation is not implemented: ' + 'unexpected behaviour, should be handled better');
    }
    return result.toString();
  };
  FactConstructorViewer.prototype.splitStringByBracketsOnTopLevel_0 = function (identifier, startPosition) {
    if (startPosition === void 0)
      startPosition = 0;
    return splitStringByBracketsOnTopLevel(identifier, unboxChar(this.openBracket), unboxChar(this.closeBracket), startPosition);
  };
  FactConstructorViewer.prototype.constructFactByIdentifier_7q4i4t$ = function (identifier, parent) {
    if (parent === void 0)
      parent = null;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11, tmp$_12, tmp$_13, tmp$_14, tmp$_15, tmp$_16, tmp$_17, tmp$_18, tmp$_19, tmp$_20, tmp$_21;
    if (contains_1(identifier, 123)) {
      var identifierData = this.splitStringByBracketsOnTopLevel_0(identifier);
      var factType = identifierData.name;
      if (equals(factType, ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance().toString()) || equals(factType, ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance().toString())) {
        if (equals(factType, ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance().toString())) {
          tmp$ = new MainLineAndNode(0, 0, parent, void 0, void 0, void 0, void 0, void 0, identifier);
        }
         else {
          tmp$ = new MainLineOrNode(0, 0, parent, void 0, void 0, void 0, void 0, void 0, identifier);
        }
        var newFact = tmp$;
        var i = 0;
        var mainNodeData = first(identifierData.list);
        while (i < mainNodeData.length) {
          var mainNodePartData = this.splitStringByBracketsOnTopLevel_0(mainNodeData, i);
          var mainLineNodePartName = mainNodePartData.name;
          var mainLineNodePartIdentifier = first(mainNodePartData.list);
          i = mainNodePartData.endPosition;
          var tmp$_22;
          switch (trim(Kotlin.isCharSequence(tmp$_22 = mainLineNodePartName) ? tmp$_22 : throwCCE()).toString()) {
            case 'FACT_TRANSFORMATION_CHAINS':
              var chains = this.splitStringByBracketsOnTopLevel_0(mainLineNodePartIdentifier);
              tmp$_0 = chains.list.iterator();
              while (tmp$_0.hasNext()) {
                var chain = tmp$_0.next();
                newFact.factTransformationChains.add_11rb$(new MainChain());
                var factIdentifiers = this.splitStringByBracketsOnTopLevel_0(chain);
                tmp$_1 = factIdentifiers.list.iterator();
                while (tmp$_1.hasNext()) {
                  var factIdentifier = tmp$_1.next();
                  last(newFact.factTransformationChains).chain.add_11rb$(this.constructFactByIdentifier_7q4i4t$(factIdentifier, newFact));
                }
              }

              break;
            case 'EXPRESSION_TRANSFORMATION_CHAINS':
              var chains_0 = this.splitStringByBracketsOnTopLevel_0(mainLineNodePartIdentifier);
              tmp$_2 = chains_0.list.iterator();
              while (tmp$_2.hasNext()) {
                var chain_0 = tmp$_2.next();
                var factIdentifiers_0 = this.splitStringByBracketsOnTopLevel_0(chain_0);
                newFact.expressionTransformationChains.add_11rb$(new ExpressionChain(void 0, void 0, valueOfComparisonType(factIdentifiers_0.name)));
                tmp$_3 = factIdentifiers_0.list.iterator();
                while (tmp$_3.hasNext()) {
                  var factIdentifier_0 = tmp$_3.next();
                  last(newFact.expressionTransformationChains).chain.add_11rb$(this.constructFactByIdentifier_7q4i4t$(factIdentifier_0, newFact));
                }
              }

              break;
            case 'RULES':
              var rules = this.splitStringByBracketsOnTopLevel_0(mainLineNodePartIdentifier);
              tmp$_4 = rules.list.iterator();
              while (tmp$_4.hasNext()) {
                var rule = tmp$_4.next();
                var ruleIdentifier = this.splitStringByBracketsOnTopLevel_0(rule);
                var expressionSubstitutionData = this.splitStringByBracketsOnTopLevel_0(ruleIdentifier.list.get_za3lpa$(1));
                if (expressionSubstitutionData.list.isEmpty())
                  tmp$_9 = null;
                else {
                  tmp$_5 = this.expressionNodeConstructor.construct_61zpoe$(expressionSubstitutionData.list.get_za3lpa$(0));
                  tmp$_6 = this.expressionNodeConstructor.construct_61zpoe$(expressionSubstitutionData.list.get_za3lpa$(1));
                  tmp$_7 = valueOfComparisonType(expressionSubstitutionData.list.get_za3lpa$(2));
                  tmp$_8 = this.booleanFromData_pdl1vz$(expressionSubstitutionData.list.get_za3lpa$(3));
                  tmp$_9 = new ExpressionSubstitution(tmp$_5, tmp$_6, toDouble(expressionSubstitutionData.list.get_za3lpa$(4)), tmp$_8, void 0, void 0, void 0, tmp$_7);
                }
                var expressionSubstitution = tmp$_9;
                var factSubstitutionData = this.splitStringByBracketsOnTopLevel_0(ruleIdentifier.list.get_za3lpa$(2));
                if (factSubstitutionData.list.isEmpty())
                  tmp$_14 = null;
                else {
                  tmp$_10 = this.constructFactByIdentifier_7q4i4t$(factSubstitutionData.list.get_za3lpa$(0));
                  tmp$_11 = this.constructFactByIdentifier_7q4i4t$(factSubstitutionData.list.get_za3lpa$(1));
                  tmp$_12 = SubstitutionDirection$valueOf(factSubstitutionData.list.get_za3lpa$(2));
                  tmp$_13 = this.booleanFromData_pdl1vz$(factSubstitutionData.list.get_za3lpa$(3));
                  tmp$_14 = new FactSubstitution(tmp$_10, tmp$_11, toDouble(factSubstitutionData.list.get_za3lpa$(4)), tmp$_13, tmp$_12, void 0, this.compiledConfiguration.factComporator);
                }
                var factSubstitution = tmp$_14;
                tmp$_17 = newFact.rules;
                tmp$_15 = ruleIdentifier.name;
                tmp$_17.add_11rb$(new Rule(0, 0, newFact, Kotlin.isType(tmp$_16 = this.constructFactByIdentifier_7q4i4t$(ruleIdentifier.list.get_za3lpa$(0), newFact), MainLineAndNode) ? tmp$_16 : throwCCE(), tmp$_15, void 0, factSubstitution, expressionSubstitution));
              }

              break;
            case 'IN_FACTS':
              var factIdentifiers_1 = this.splitStringByBracketsOnTopLevel_0(mainLineNodePartIdentifier);
              tmp$_18 = factIdentifiers_1.list.iterator();
              while (tmp$_18.hasNext()) {
                var factIdentifier_1 = tmp$_18.next();
                newFact.inFacts.add_11rb$(this.constructFactByIdentifier_7q4i4t$(factIdentifier_1, newFact));
              }

              break;
            case 'OUT_FACTS':
              var factIdentifiers_2 = this.splitStringByBracketsOnTopLevel_0(mainLineNodePartIdentifier);
              tmp$_19 = factIdentifiers_2.list.iterator();
              while (tmp$_19.hasNext()) {
                var factIdentifier_2 = tmp$_19.next();
                newFact.outFacts.add_11rb$(this.constructFactByIdentifier_7q4i4t$(factIdentifier_2, newFact));
              }

              break;
          }
        }
        return newFact;
      }
       else if (equals(factType, ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance().toString())) {
        var newFact_0 = new ExpressionComparison(void 0, void 0, emptyExpression(), emptyExpression(), valueOfComparisonType(identifierData.list.get_za3lpa$(1)), parent);
        newFact_0.leftExpression = Kotlin.isType(tmp$_20 = this.constructFactByIdentifier_7q4i4t$(identifierData.list.get_za3lpa$(0), parent), Expression) ? tmp$_20 : throwCCE();
        newFact_0.rightExpression = Kotlin.isType(tmp$_21 = this.constructFactByIdentifier_7q4i4t$(identifierData.list.get_za3lpa$(2), parent), Expression) ? tmp$_21 : throwCCE();
        return newFact_0;
      }
       else {
        throw new NotImplementedError_init('An operation is not implemented: ' + 'unexpected behaviour, should be handled better');
      }
    }
     else {
      return new Expression(0, 0, this.expressionNodeConstructor.construct_61zpoe$(identifier), identifier, parent);
    }
  };
  FactConstructorViewer.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FactConstructorViewer',
    interfaces: []
  };
  function Comparator$ObjectLiteral_4(closure$comparison) {
    this.closure$comparison = closure$comparison;
  }
  Comparator$ObjectLiteral_4.prototype.compare = function (a, b) {
    return this.closure$comparison(a, b);
  };
  Comparator$ObjectLiteral_4.$metadata$ = {kind: Kind_CLASS, interfaces: [Comparator]};
  var compareBy$lambda_2 = wrapFunction(function () {
    var compareValues = Kotlin.kotlin.comparisons.compareValues_s00gnj$;
    return function (closure$selector) {
      return function (a, b) {
        var selector = closure$selector;
        return compareValues(selector(a), selector(b));
      };
    };
  });
  function FactComporator() {
    this.compiledConfiguration_z292fw$_0 = this.compiledConfiguration_z292fw$_0;
    this.expressionComporator_987byt$_0 = this.expressionComporator_987byt$_0;
  }
  Object.defineProperty(FactComporator.prototype, 'compiledConfiguration', {
    get: function () {
      if (this.compiledConfiguration_z292fw$_0 == null)
        return throwUPAE('compiledConfiguration');
      return this.compiledConfiguration_z292fw$_0;
    },
    set: function (compiledConfiguration) {
      this.compiledConfiguration_z292fw$_0 = compiledConfiguration;
    }
  });
  Object.defineProperty(FactComporator.prototype, 'expressionComporator', {
    get: function () {
      if (this.expressionComporator_987byt$_0 == null)
        return throwUPAE('expressionComporator');
      return this.expressionComporator_987byt$_0;
    },
    set: function (expressionComporator) {
      this.expressionComporator_987byt$_0 = expressionComporator;
    }
  });
  FactComporator.prototype.init_dvfgl$ = function (compiledConfiguration, expressionComporator) {
    if (expressionComporator === void 0)
      expressionComporator = new ExpressionComporator();
    this.compiledConfiguration = compiledConfiguration;
    this.expressionComporator = expressionComporator;
    this.expressionComporator.init_lwoezr$(compiledConfiguration);
  };
  function FactComporator$compareAsIs$lambda() {
    return 'compareAsIs started';
  }
  function FactComporator$compareAsIs$lambda_0(closure$currentLogLevel) {
    return function () {
      return 'Current log level: ' + closure$currentLogLevel.v;
    };
  }
  function FactComporator$compareAsIs$lambda_1() {
    return 'Expression pribability comparison';
  }
  function FactComporator$compareAsIs$lambda_2() {
    return "Result of comparison left.left with right.left: '";
  }
  function FactComporator$compareAsIs$lambda_3() {
    return "'";
  }
  function FactComporator$compareAsIs$lambda_4() {
    return "Result of comparison left.right with right.right: '";
  }
  function FactComporator$compareAsIs$lambda_5() {
    return "'";
  }
  function FactComporator$compareAsIs$lambda_6() {
    return 'Expression Comparisons are equal';
  }
  function FactComporator$compareAsIs$lambda_7() {
    return 'Simple check failed. Try to reverse comparison';
  }
  function FactComporator$compareAsIs$lambda_8() {
    return "Result of comparison left.left with right.right: '";
  }
  function FactComporator$compareAsIs$lambda_9() {
    return "'";
  }
  function FactComporator$compareAsIs$lambda_10() {
    return "Result of comparison left.right with right.left: '";
  }
  function FactComporator$compareAsIs$lambda_11() {
    return "'";
  }
  function FactComporator$compareAsIs$lambda_12() {
    return 'left';
  }
  function FactComporator$compareAsIs$lambda_13() {
    return 'right';
  }
  function FactComporator$compareAsIs$lambda_14() {
    return 'Comparison in exist order';
  }
  function FactComporator$compareAsIs$lambda_15() {
    return "facts at position '";
  }
  function FactComporator$compareAsIs$lambda_16() {
    return "' are not equal. Order may be different";
  }
  function FactComporator$compareAsIs$lambda_17() {
    return 'Comparison in sorted order';
  }
  function FactComporator$compareAsIs$lambda_18(it) {
    return it.computeSortedOutIdentifier_6taknv$(true);
  }
  function FactComporator$compareAsIs$lambda_19(it) {
    return it.computeSortedOutIdentifier_6taknv$(true);
  }
  function FactComporator$compareAsIs$lambda_20() {
    return 'sorted left';
  }
  function FactComporator$compareAsIs$lambda_21() {
    return 'sorted right';
  }
  function FactComporator$compareAsIs$lambda_22() {
    return "Additional fact used to match left fact at left: '";
  }
  function FactComporator$compareAsIs$lambda_23() {
    return "' and right '";
  }
  function FactComporator$compareAsIs$lambda_24() {
    return "'";
  }
  function FactComporator$compareAsIs$lambda_25() {
    return "DiscrepancyFound at left: '";
  }
  function FactComporator$compareAsIs$lambda_26() {
    return "' and right '";
  }
  function FactComporator$compareAsIs$lambda_27() {
    return "'";
  }
  function FactComporator$compareAsIs$lambda_28() {
    return "Additional fact used to match right fact at left: '";
  }
  function FactComporator$compareAsIs$lambda_29() {
    return "' and right '";
  }
  function FactComporator$compareAsIs$lambda_30() {
    return "'";
  }
  function FactComporator$compareAsIs$lambda_31() {
    return "DiscrepancyFound at left: '";
  }
  function FactComporator$compareAsIs$lambda_32() {
    return "' and right '";
  }
  function FactComporator$compareAsIs$lambda_33() {
    return "'";
  }
  function FactComporator$compareAsIs$lambda_34() {
    return "DiscrepancyFound at left: '";
  }
  function FactComporator$compareAsIs$lambda_35() {
    return "' and right '";
  }
  function FactComporator$compareAsIs$lambda_36() {
    return "' in not MAIN_LINE_AND_NODE";
  }
  function FactComporator$compareAsIs$lambda_37() {
    return "DiscrepancyFound at left: '";
  }
  function FactComporator$compareAsIs$lambda_38() {
    return "' and right '";
  }
  function FactComporator$compareAsIs$lambda_39() {
    return "'";
  }
  function FactComporator$compareAsIs$lambda_40() {
    return "DiscrepancyFound at left: '";
  }
  function FactComporator$compareAsIs$lambda_41() {
    return "' and right '";
  }
  function FactComporator$compareAsIs$lambda_42() {
    return "' during search in left facts";
  }
  function FactComporator$compareAsIs$lambda_43() {
    return "DiscrepancyFound at left: '";
  }
  function FactComporator$compareAsIs$lambda_44() {
    return "' and right '";
  }
  function FactComporator$compareAsIs$lambda_45() {
    return "' during search in right facts";
  }
  function FactComporator$compareAsIs$lambda_46() {
    return "result: '";
  }
  function FactComporator$compareAsIs$lambda_47() {
    return "'";
  }
  FactComporator.prototype.compareAsIs_hsjydo$ = function (left, right, additionalFactsSortedIdentifiers, compareExpressionsWithProbabilityTest) {
    if (additionalFactsSortedIdentifiers === void 0) {
      additionalFactsSortedIdentifiers = emptyList();
    }
    if (compareExpressionsWithProbabilityTest === void 0)
      compareExpressionsWithProbabilityTest = false;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5;
    log_1.addMessage_bda5c9$(FactComporator$compareAsIs$lambda, void 0, void 0, 1);
    log_1.logFactsCompareAsIsParams_eu4irh$(left, right, additionalFactsSortedIdentifiers, compareExpressionsWithProbabilityTest);
    var currentLogLevel = {v: log_1.currentLevel};
    log_1.addMessage_bda5c9$(FactComporator$compareAsIs$lambda_0(currentLogLevel), void 0, currentLogLevel.v);
    if (left.type() !== right.type()) {
      return false;
    }
    switch (left.type().name) {
      case 'EXPRESSION':
        log_1.addMessage_bda5c9$(FactComporator$compareAsIs$lambda_1, void 0, currentLogLevel.v);
        tmp$_5 = this.expressionComporator.probabilityTestComparison_3fo6fu$((Kotlin.isType(tmp$ = left, Expression) ? tmp$ : throwCCE()).data.clone(), (Kotlin.isType(tmp$_0 = right, Expression) ? tmp$_0 : throwCCE()).data.clone());
        break;
      case 'EXPRESSION_COMPARISON':
        var leftComparison = Kotlin.isType(tmp$_1 = left, ExpressionComparison) ? tmp$_1 : throwCCE();
        var rightComparison = Kotlin.isType(tmp$_2 = right, ExpressionComparison) ? tmp$_2 : throwCCE();
        var leftOriginal = this.compareAsIs_hsjydo$(leftComparison.leftExpression, rightComparison.leftExpression, additionalFactsSortedIdentifiers);
        log_1.add_f1hiuo$(leftOriginal, FactComporator$compareAsIs$lambda_2, FactComporator$compareAsIs$lambda_3, currentLogLevel.v);
        var rightOriginal = this.compareAsIs_hsjydo$(leftComparison.rightExpression, rightComparison.rightExpression, additionalFactsSortedIdentifiers);
        log_1.add_f1hiuo$(rightOriginal, FactComporator$compareAsIs$lambda_4, FactComporator$compareAsIs$lambda_5, currentLogLevel.v);
        if (leftOriginal && rightOriginal && leftComparison.comparisonType === rightComparison.comparisonType) {
          log_1.addMessage_bda5c9$(FactComporator$compareAsIs$lambda_6, void 0, currentLogLevel.v);
          tmp$_5 = true;
        }
         else {
          log_1.addMessage_bda5c9$(FactComporator$compareAsIs$lambda_7, void 0, currentLogLevel.v);
          var leftEqualRight = this.compareAsIs_hsjydo$(leftComparison.leftExpression, rightComparison.rightExpression, additionalFactsSortedIdentifiers);
          log_1.add_f1hiuo$(leftEqualRight, FactComporator$compareAsIs$lambda_8, FactComporator$compareAsIs$lambda_9, currentLogLevel.v);
          var rightEqualLeft = this.compareAsIs_hsjydo$(leftComparison.rightExpression, rightComparison.leftExpression, additionalFactsSortedIdentifiers);
          log_1.add_f1hiuo$(rightEqualLeft, FactComporator$compareAsIs$lambda_10, FactComporator$compareAsIs$lambda_11, currentLogLevel.v);
          if (!leftEqualRight || !rightEqualLeft)
            tmp$_5 = false;
          else {
            switch (leftComparison.comparisonType.name) {
              case 'EQUAL':
                tmp$_5 = rightComparison.comparisonType === ComparisonType$EQUAL_getInstance();
                break;
              case 'LEFT_MORE_OR_EQUAL':
                tmp$_5 = rightComparison.comparisonType === ComparisonType$LEFT_LESS_OR_EQUAL_getInstance();
                break;
              case 'LEFT_LESS_OR_EQUAL':
                tmp$_5 = rightComparison.comparisonType === ComparisonType$LEFT_MORE_OR_EQUAL_getInstance();
                break;
              case 'LEFT_MORE':
                tmp$_5 = rightComparison.comparisonType === ComparisonType$LEFT_LESS_getInstance();
                break;
              case 'LEFT_LESS':
                tmp$_5 = rightComparison.comparisonType === ComparisonType$LEFT_MORE_getInstance();
                break;
              default:tmp$_5 = Kotlin.noWhenBranchMatched();
                break;
            }
          }
        }

        break;
      case 'MAIN_LINE_AND_NODE':
      case 'MAIN_LINE_OR_NODE':
        var leftNodeOutFacts = getOutFactsFromMainLineNode(left);
        var rightNodeInFacts = getInFactsFromMainLineNode(right);
        log_1.logSystemFacts_zi2lc5$(left.type(), leftNodeOutFacts, FactComporator$compareAsIs$lambda_12);
        log_1.logSystemFacts_zi2lc5$(right.type(), rightNodeInFacts, FactComporator$compareAsIs$lambda_13);
        var orderIsDifferent = false;
        if (leftNodeOutFacts.size === rightNodeInFacts.size) {
          log_1.addMessage_bda5c9$(FactComporator$compareAsIs$lambda_14, void 0, currentLogLevel.v);
          tmp$_3 = get_lastIndex(leftNodeOutFacts);
          for (var i = 0; i <= tmp$_3; i++) {
            if (!this.compareAsIs_hsjydo$(leftNodeOutFacts.get_za3lpa$(i), rightNodeInFacts.get_za3lpa$(i), additionalFactsSortedIdentifiers)) {
              orderIsDifferent = true;
              log_1.add_f1hiuo$(i, FactComporator$compareAsIs$lambda_15, FactComporator$compareAsIs$lambda_16, currentLogLevel.v);
              break;
            }
          }
        }

        if (!orderIsDifferent && leftNodeOutFacts.size === rightNodeInFacts.size) {
          tmp$_5 = true;
        }
         else {
          log_1.addMessage_bda5c9$(FactComporator$compareAsIs$lambda_17);
          var leftNodeOutFactsSorted = sortedWith(leftNodeOutFacts, new Comparator$ObjectLiteral_4(compareBy$lambda_2(FactComporator$compareAsIs$lambda_18)));
          var rightNodeOutFactsSorted = sortedWith(rightNodeInFacts, new Comparator$ObjectLiteral_4(compareBy$lambda_2(FactComporator$compareAsIs$lambda_19)));
          log_1.logSystemFacts_zi2lc5$(left.type(), leftNodeOutFactsSorted, FactComporator$compareAsIs$lambda_20);
          log_1.logSystemFacts_zi2lc5$(right.type(), rightNodeOutFactsSorted, FactComporator$compareAsIs$lambda_21);
          var discrepancyFound = false;
          var leftCounter = 0;
          var rightCounter = 0;
          while (leftCounter < leftNodeOutFactsSorted.size && rightCounter < rightNodeOutFactsSorted.size) {
            var leftIdentifier = leftNodeOutFactsSorted.get_za3lpa$(leftCounter).computeSortedOutIdentifier_6taknv$(true);
            var rightIdentifier = rightNodeOutFactsSorted.get_za3lpa$(rightCounter).computeSortedOutIdentifier_6taknv$(true);
            if (equals(leftIdentifier, rightIdentifier)) {
              leftCounter = leftCounter + 1 | 0;
              rightCounter = rightCounter + 1 | 0;
            }
             else if (left.type() === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance()) {
              if (Kotlin.compareTo(leftIdentifier, rightIdentifier) < 0) {
                if (binarySearch(additionalFactsSortedIdentifiers, leftIdentifier) >= 0) {
                  log_1.add_gqvic5$(leftCounter, rightCounter, FactComporator$compareAsIs$lambda_22, FactComporator$compareAsIs$lambda_23, FactComporator$compareAsIs$lambda_24, currentLogLevel.v);
                  leftCounter = leftCounter + 1 | 0;
                }
                 else {
                  discrepancyFound = true;
                  log_1.add_gqvic5$(leftCounter, rightCounter, FactComporator$compareAsIs$lambda_25, FactComporator$compareAsIs$lambda_26, FactComporator$compareAsIs$lambda_27, currentLogLevel.v);
                  break;
                }
              }
               else if (Kotlin.compareTo(leftIdentifier, rightIdentifier) > 0) {
                if (binarySearch(additionalFactsSortedIdentifiers, rightIdentifier) >= 0) {
                  log_1.add_gqvic5$(leftCounter, rightCounter, FactComporator$compareAsIs$lambda_28, FactComporator$compareAsIs$lambda_29, FactComporator$compareAsIs$lambda_30, currentLogLevel.v);
                  tmp$_4 = rightCounter, rightCounter = tmp$_4 + 1 | 0;
                }
                 else {
                  log_1.add_gqvic5$(leftCounter, rightCounter, FactComporator$compareAsIs$lambda_31, FactComporator$compareAsIs$lambda_32, FactComporator$compareAsIs$lambda_33, currentLogLevel.v);
                  discrepancyFound = true;
                  break;
                }
              }
            }
             else {
              log_1.add_gqvic5$(leftCounter, rightCounter, FactComporator$compareAsIs$lambda_34, FactComporator$compareAsIs$lambda_35, FactComporator$compareAsIs$lambda_36, currentLogLevel.v);
              discrepancyFound = true;
              break;
            }
          }
          if (left.type() !== ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() && (leftCounter < leftNodeOutFactsSorted.size || rightCounter < rightNodeOutFactsSorted.size)) {
            log_1.add_gqvic5$(leftCounter, rightCounter, FactComporator$compareAsIs$lambda_37, FactComporator$compareAsIs$lambda_38, FactComporator$compareAsIs$lambda_39, currentLogLevel.v);
            discrepancyFound = true;
          }
          while (!discrepancyFound && leftCounter < leftNodeOutFactsSorted.size) {
            if (binarySearch(additionalFactsSortedIdentifiers, leftNodeOutFactsSorted.get_za3lpa$(leftCounter).computeSortedOutIdentifier_6taknv$(true)) >= 0) {
              leftCounter = leftCounter + 1 | 0;
            }
             else {
              log_1.add_gqvic5$(leftCounter, rightCounter, FactComporator$compareAsIs$lambda_40, FactComporator$compareAsIs$lambda_41, FactComporator$compareAsIs$lambda_42, currentLogLevel.v);
              discrepancyFound = true;
              break;
            }
          }
          while (!discrepancyFound && rightCounter < rightNodeOutFactsSorted.size) {
            if (binarySearch(additionalFactsSortedIdentifiers, rightNodeOutFactsSorted.get_za3lpa$(rightCounter).computeSortedOutIdentifier_6taknv$(true)) >= 0) {
              rightCounter = rightCounter + 1 | 0;
            }
             else {
              log_1.add_gqvic5$(leftCounter, rightCounter, FactComporator$compareAsIs$lambda_43, FactComporator$compareAsIs$lambda_44, FactComporator$compareAsIs$lambda_45, currentLogLevel.v);
              discrepancyFound = true;
              break;
            }
          }
          log_1.add_f1hiuo$(discrepancyFound, FactComporator$compareAsIs$lambda_46, FactComporator$compareAsIs$lambda_47, currentLogLevel.v);
          tmp$_5 = !discrepancyFound;
        }

        break;
      default:tmp$_5 = true;
        break;
    }
    return tmp$_5;
  };
  function FactComporator$compareWithoutSubstitutions$lambda() {
    return 'compareWithoutSubstitutions started';
  }
  function FactComporator$compareWithoutSubstitutions$lambda_0(closure$currentLogLevel) {
    return function () {
      return 'Current log level: ' + closure$currentLogLevel.v;
    };
  }
  function FactComporator$compareWithoutSubstitutions$lambda_1() {
    return 'Left fact after normalization: ';
  }
  function FactComporator$compareWithoutSubstitutions$lambda_2() {
    return 'Right fact after normalization: ';
  }
  function FactComporator$compareWithoutSubstitutions$lambda_3() {
    return 'Left fact after complicated function replacement: ';
  }
  function FactComporator$compareWithoutSubstitutions$lambda_4() {
    return 'Right fact after complicated function replacement: ';
  }
  function FactComporator$compareWithoutSubstitutions$lambda_5() {
    return 'Expression numeric trees computed. ';
  }
  FactComporator.prototype.compareWithoutSubstitutions_y9i8qm$ = function (left, right, additionalFacts, additionalFactsSortedIdentifiers) {
    if (additionalFactsSortedIdentifiers === void 0) {
      var destination = ArrayList_init_0(collectionSizeOrDefault(additionalFacts, 10));
      var tmp$;
      tmp$ = additionalFacts.iterator();
      while (tmp$.hasNext()) {
        var item = tmp$.next();
        destination.add_11rb$(item.computeOutIdentifier_6taknv$(true));
      }
      additionalFactsSortedIdentifiers = sorted(destination);
    }
    log_1.addMessage_bda5c9$(FactComporator$compareWithoutSubstitutions$lambda, void 0, void 0, 1);
    log_1.logFactsCompareAsIsParams_eu4irh$(left, right, additionalFactsSortedIdentifiers);
    var currentLogLevel = {v: log_1.currentLevel};
    log_1.addMessage_bda5c9$(FactComporator$compareWithoutSubstitutions$lambda_0(currentLogLevel), void 0, currentLogLevel.v);
    var l = left.cloneWithNormalization_1g1bdl$(LinkedHashMap_init_0(), true);
    var r = right.cloneWithNormalization_1g1bdl$(LinkedHashMap_init_0(), true);
    log_1.addMessageWithFactShort_5zaetr$(FactComporator$compareWithoutSubstitutions$lambda_1, l, void 0, currentLogLevel.v);
    log_1.addMessageWithFactShort_5zaetr$(FactComporator$compareWithoutSubstitutions$lambda_2, r, void 0, currentLogLevel.v);
    if (this.compiledConfiguration.comparisonSettings.compareExpressionsAndFactsWithProbabilityRules) {
      throw new NotImplementedError_init('An operation is not implemented: ' + 'implement');
    }
     else if (this.compiledConfiguration.comparisonSettings.compareExpressionsWithProbabilityRulesWhenComparingFacts) {
      var functionIdentifierToVariableMap = LinkedHashMap_init_0();
      l.replaceNotDefinedFunctionsOnVariables_1vzej0$(functionIdentifierToVariableMap, this.expressionComporator.definedFunctionNameNumberOfArgsSet);
      r.replaceNotDefinedFunctionsOnVariables_1vzej0$(functionIdentifierToVariableMap, this.expressionComporator.definedFunctionNameNumberOfArgsSet);
      log_1.addMessageWithFactShort_5zaetr$(FactComporator$compareWithoutSubstitutions$lambda_3, l, void 0, currentLogLevel.v);
      log_1.addMessageWithFactShort_5zaetr$(FactComporator$compareWithoutSubstitutions$lambda_4, r, void 0, currentLogLevel.v);
      if (this.compareAsIs_hsjydo$(l, r, additionalFactsSortedIdentifiers, true)) {
        return true;
      }
      l.computeExpressionTrees_dq72cu$(this.expressionComporator.baseOperationsDefinitions);
      r.computeExpressionTrees_dq72cu$(this.expressionComporator.baseOperationsDefinitions);
      log_1.addMessage_bda5c9$(FactComporator$compareWithoutSubstitutions$lambda_5, void 0, currentLogLevel.v);
      var res = this.compareAsIs_hsjydo$(l, r, additionalFactsSortedIdentifiers, true);
      return res;
    }
     else {
      var res_0 = this.compareAsIs_hsjydo$(l, r, additionalFactsSortedIdentifiers);
      return res_0;
    }
  };
  function FactComporator$compareWithTreeTransformationRules$lambda() {
    return 'compareWithTreeTransformationRules called';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_0(closure$currentLogLevel) {
    return function () {
      return 'Current log level: ' + closure$currentLogLevel.v;
    };
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_1() {
    return 'Left fact after first normalization: ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_2() {
    return 'Right fact after first normalization: ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_3() {
    return 'COMPARISON_WITHOUT_SUBSTITUTIONS FAILED; Transformation rules search started.';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_4() {
    return 'Considering rule: ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_5() {
    return 'Left fact after fact wrapping: ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_6() {
    return 'Right fact after fact wrapping: ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_7() {
    return '';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_8() {
    return ' possible applications found';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_9() {
    return '';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_10() {
    return ' possible applications found => ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_11() {
    return ' possible combinations';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_12() {
    return "Possible application places count more than max count for boosting: '";
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_13() {
    return "'. Apply in all of them together";
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_14() {
    return 'Left fact after transformation: ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_15() {
    return 'Right fact after transformation: ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_16() {
    return 'TRANSFORMATION_VERIFIED. ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_17() {
    return 'TASK_CONTEXT_FACT_USED. ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_18() {
    return "bitmask: '";
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_19() {
    return "' of '";
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_20() {
    return "'";
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_21() {
    return 'Left fact after transformation: ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_22() {
    return 'Right fact after transformation: ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_23() {
    return 'TRANSFORMATION_VERIFIED. ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_24() {
    return 'TASK_CONTEXT_FACT_USED. ';
  }
  function FactComporator$compareWithTreeTransformationRules$lambda_25() {
    return 'applicable TRANSFORMATION_NOT_FOUND';
  }
  FactComporator.prototype.compareWithTreeTransformationRules_90aq3c$ = function (leftOriginal, rightOriginal, additionalFacts, transformations, maxTransformationWeight, maxBustCount, minPossibleTransformationWeight, additionalFactsSortedIdentifiers, additionalFactUsed) {
    var tmp$, tmp$_0, tmp$_1;
    if (maxTransformationWeight === void 0)
      maxTransformationWeight = this.compiledConfiguration.comparisonSettings.maxTransformationWeight;
    if (maxBustCount === void 0)
      maxBustCount = this.compiledConfiguration.comparisonSettings.maxBustCount;
    if (minPossibleTransformationWeight === void 0) {
      var minBy$result;
      minBy$break: do {
        var iterator = transformations.iterator();
        if (!iterator.hasNext()) {
          minBy$result = null;
          break minBy$break;
        }
        var minElem = iterator.next();
        var minValue = minElem.weight;
        while (iterator.hasNext()) {
          var e = iterator.next();
          var v = e.weight;
          if (Kotlin.compareTo(minValue, v) > 0) {
            minElem = e;
            minValue = v;
          }
        }
        minBy$result = minElem;
      }
       while (false);
      minPossibleTransformationWeight = (tmp$_0 = (tmp$ = minBy$result) != null ? tmp$.weight : null) != null ? tmp$_0 : 1.0;
    }
    if (additionalFactsSortedIdentifiers === void 0) {
      var destination = ArrayList_init_0(collectionSizeOrDefault(additionalFacts, 10));
      var tmp$_2;
      tmp$_2 = additionalFacts.iterator();
      while (tmp$_2.hasNext()) {
        var item = tmp$_2.next();
        destination.add_11rb$(item.computeOutIdentifier_6taknv$(true));
      }
      additionalFactsSortedIdentifiers = sorted(destination);
    }
    var left = leftOriginal.clone();
    var right = rightOriginal.clone();
    log_1.addMessage_bda5c9$(FactComporator$compareWithTreeTransformationRules$lambda, MessageType$USER_getInstance(), void 0, 1);
    log_1.logFactsCompareAsIsParams_9vkx2o$(left, right, additionalFacts, maxTransformationWeight, maxBustCount, minPossibleTransformationWeight, additionalFactUsed);
    var currentLogLevel = {v: log_1.currentLevel};
    log_1.addMessage_bda5c9$(FactComporator$compareWithTreeTransformationRules$lambda_0(currentLogLevel), void 0, currentLogLevel.v);
    left.applyAllExpressionSubstitutions_8sufjw$(this.compiledConfiguration.compiledImmediateTreeTransformationRules);
    right.applyAllExpressionSubstitutions_8sufjw$(this.compiledConfiguration.compiledImmediateTreeTransformationRules);
    log_1.addMessageWithFactShort_5zaetr$(FactComporator$compareWithTreeTransformationRules$lambda_1, left, void 0, currentLogLevel.v);
    log_1.addMessageWithFactShort_5zaetr$(FactComporator$compareWithTreeTransformationRules$lambda_2, right, void 0, currentLogLevel.v);
    if (this.compareWithoutSubstitutions_y9i8qm$(left, right, additionalFacts, additionalFactsSortedIdentifiers))
      return true;
    log_1.addMessage_bda5c9$(FactComporator$compareWithTreeTransformationRules$lambda_3, MessageType$USER_getInstance(), currentLogLevel.v);
    if (maxTransformationWeight < minPossibleTransformationWeight)
      return false;
    var destination_0 = ArrayList_init();
    var tmp$_3;
    tmp$_3 = transformations.iterator();
    while (tmp$_3.hasNext()) {
      var element = tmp$_3.next();
      if (element.weight <= maxTransformationWeight)
        destination_0.add_11rb$(element);
    }
    tmp$_1 = destination_0.iterator();
    while (tmp$_1.hasNext()) {
      var transformation = tmp$_1.next();
      log_1.addMessageWithFactSubstitutionDetail_v23yj3$(FactComporator$compareWithTreeTransformationRules$lambda_4, transformation, MessageType$USER_getInstance(), currentLogLevel.v);
      var transformationLogLevel = currentLogLevel.v + 1 | 0;
      var l = left.clone();
      var r = right.clone();
      var lParent = factWrapperForCheckingTransformations(l, true);
      var rParent = factWrapperForCheckingTransformations(r, false);
      log_1.addMessageWithFactShort_5zaetr$(FactComporator$compareWithTreeTransformationRules$lambda_5, lParent, void 0, transformationLogLevel);
      log_1.addMessageWithFactShort_5zaetr$(FactComporator$compareWithTreeTransformationRules$lambda_6, rParent, void 0, transformationLogLevel);
      var substitutionPlaces = plus(transformation.findAllPossibleSubstitutionPlaces_hkzcsw$(lParent, true, additionalFacts), transformation.findAllPossibleSubstitutionPlaces_hkzcsw$(rParent, false, additionalFacts));
      log_1.add_f1hiuo$(substitutionPlaces.size, FactComporator$compareWithTreeTransformationRules$lambda_7, FactComporator$compareWithTreeTransformationRules$lambda_8);
      var bitMaskCount = 1 << substitutionPlaces.size;
      log_1.add_gqvic5$(substitutionPlaces.size, bitMaskCount, FactComporator$compareWithTreeTransformationRules$lambda_9, FactComporator$compareWithTreeTransformationRules$lambda_10, FactComporator$compareWithTreeTransformationRules$lambda_11, transformationLogLevel, void 0, MessageType$USER_getInstance());
      if (Kotlin.imul(bitMaskCount, transformations.size) > maxBustCount) {
        log_1.add_f1hiuo$(maxBustCount / transformations.size | 0, FactComporator$compareWithTreeTransformationRules$lambda_12, FactComporator$compareWithTreeTransformationRules$lambda_13, transformationLogLevel, void 0, MessageType$USER_getInstance());
        var additionalFactInCurrentTransformationApplicationUsed = ArrayList_init();
        transformation.applySubstitution_u3h3q6$(substitutionPlaces, additionalFacts, additionalFactInCurrentTransformationApplicationUsed);
        log_1.addMessageWithFactDetail_5zaetr$(FactComporator$compareWithTreeTransformationRules$lambda_14, lParent, MessageType$USER_getInstance(), transformationLogLevel);
        log_1.addMessageWithFactDetail_5zaetr$(FactComporator$compareWithTreeTransformationRules$lambda_15, rParent, MessageType$USER_getInstance(), transformationLogLevel);
        if (this.compareWithTreeTransformationRules_90aq3c$(lParent, rParent, additionalFacts, transformations, maxTransformationWeight - transformation.weight, maxBustCount, minPossibleTransformationWeight, additionalFactsSortedIdentifiers, additionalFactInCurrentTransformationApplicationUsed)) {
          log_1.addMessage_bda5c9$(FactComporator$compareWithTreeTransformationRules$lambda_16, MessageType$USER_getInstance(), transformationLogLevel);
          if (!additionalFactInCurrentTransformationApplicationUsed.isEmpty()) {
            additionalFactUsed.add_11rb$(true);
            log_1.addMessage_bda5c9$(FactComporator$compareWithTreeTransformationRules$lambda_17, MessageType$USER_getInstance(), transformationLogLevel);
          }
          return true;
        }
      }
       else {
        for (var bitMask = 1; bitMask < bitMaskCount; bitMask++) {
          log_1.add_gqvic5$(toString_0(bitMask, 2), toString_0(bitMaskCount, 2), FactComporator$compareWithTreeTransformationRules$lambda_18, FactComporator$compareWithTreeTransformationRules$lambda_19, FactComporator$compareWithTreeTransformationRules$lambda_20, transformationLogLevel, void 0, MessageType$USER_getInstance());
          var additionalFactInCurrentTransformationApplicationUsed_0 = ArrayList_init();
          transformation.applySubstitutionByBitMask_s1ctej$(substitutionPlaces, bitMask, additionalFactInCurrentTransformationApplicationUsed_0);
          log_1.addMessageWithFactDetail_5zaetr$(FactComporator$compareWithTreeTransformationRules$lambda_21, lParent, MessageType$USER_getInstance(), transformationLogLevel);
          log_1.addMessageWithFactDetail_5zaetr$(FactComporator$compareWithTreeTransformationRules$lambda_22, rParent, MessageType$USER_getInstance(), transformationLogLevel);
          if (this.compareWithTreeTransformationRules_90aq3c$(lParent.cloneWithNormalization_1g1bdl$(LinkedHashMap_init_0(), false), rParent.cloneWithNormalization_1g1bdl$(LinkedHashMap_init_0(), false), additionalFacts, transformations, maxTransformationWeight - transformation.weight, maxBustCount, minPossibleTransformationWeight, additionalFactsSortedIdentifiers, additionalFactInCurrentTransformationApplicationUsed_0)) {
            log_1.addMessage_bda5c9$(FactComporator$compareWithTreeTransformationRules$lambda_23, MessageType$USER_getInstance(), transformationLogLevel);
            if (!additionalFactInCurrentTransformationApplicationUsed_0.isEmpty()) {
              additionalFactUsed.add_11rb$(true);
              log_1.addMessage_bda5c9$(FactComporator$compareWithTreeTransformationRules$lambda_24, MessageType$USER_getInstance(), transformationLogLevel);
            }
            return true;
          }
        }
      }
    }
    log_1.addMessage_bda5c9$(FactComporator$compareWithTreeTransformationRules$lambda_25, MessageType$USER_getInstance(), currentLogLevel.v);
    return false;
  };
  FactComporator.prototype.fullFactsCompare_z4bf12$ = function (left, right, additionalFacts, additionalFactUsed) {
    left.applyAllExpressionSubstitutions_8sufjw$(this.compiledConfiguration.compiledImmediateTreeTransformationRules);
    right.applyAllExpressionSubstitutions_8sufjw$(this.compiledConfiguration.compiledImmediateTreeTransformationRules);
    if (this.compiledConfiguration.comparisonSettings.isComparisonWithRules) {
      var additionalFactInCurrentTransformationApplicationUsed = ArrayList_init();
      if (this.compareWithTreeTransformationRules_90aq3c$(left, right, additionalFacts, this.compiledConfiguration.compiledFactTreeTransformationRules, this.compiledConfiguration.comparisonSettings.maxTransformationWeight, this.compiledConfiguration.comparisonSettings.maxBustCount, void 0, void 0, additionalFactInCurrentTransformationApplicationUsed)) {
        if (!additionalFactInCurrentTransformationApplicationUsed.isEmpty()) {
          additionalFactUsed.add_11rb$(true);
        }
        return true;
      }
      additionalFactInCurrentTransformationApplicationUsed.clear();
      left.computeExpressionTrees_dq72cu$(this.expressionComporator.baseOperationsDefinitions);
      right.computeExpressionTrees_dq72cu$(this.expressionComporator.baseOperationsDefinitions);
      if (this.compareWithTreeTransformationRules_90aq3c$(left, right, additionalFacts, this.compiledConfiguration.compiledFactTreeTransformationRules, this.compiledConfiguration.comparisonSettings.maxTransformationWeight, this.compiledConfiguration.comparisonSettings.maxBustCount, void 0, void 0, additionalFactInCurrentTransformationApplicationUsed)) {
        if (!additionalFactInCurrentTransformationApplicationUsed.isEmpty()) {
          additionalFactUsed.add_11rb$(true);
        }
        return true;
      }
    }
     else {
      if (this.compareWithoutSubstitutions_y9i8qm$(left, right, additionalFacts)) {
        return true;
      }
    }
    return false;
  };
  FactComporator.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FactComporator',
    interfaces: []
  };
  function SubstitutionDirection(name, ordinal, beginString, endString) {
    Enum.call(this);
    this.beginString = beginString;
    this.endString = endString;
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function SubstitutionDirection_initFields() {
    SubstitutionDirection_initFields = function () {
    };
    SubstitutionDirection$LEFT_TO_RIGHT_instance = new SubstitutionDirection('LEFT_TO_RIGHT', 0, '-', '->');
    SubstitutionDirection$RIGHT_TO_LEFT_instance = new SubstitutionDirection('RIGHT_TO_LEFT', 1, '<-', '-');
    SubstitutionDirection$ALL_TO_ALL_instance = new SubstitutionDirection('ALL_TO_ALL', 2, '<-', '->');
  }
  var SubstitutionDirection$LEFT_TO_RIGHT_instance;
  function SubstitutionDirection$LEFT_TO_RIGHT_getInstance() {
    SubstitutionDirection_initFields();
    return SubstitutionDirection$LEFT_TO_RIGHT_instance;
  }
  var SubstitutionDirection$RIGHT_TO_LEFT_instance;
  function SubstitutionDirection$RIGHT_TO_LEFT_getInstance() {
    SubstitutionDirection_initFields();
    return SubstitutionDirection$RIGHT_TO_LEFT_instance;
  }
  var SubstitutionDirection$ALL_TO_ALL_instance;
  function SubstitutionDirection$ALL_TO_ALL_getInstance() {
    SubstitutionDirection_initFields();
    return SubstitutionDirection$ALL_TO_ALL_instance;
  }
  SubstitutionDirection.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'SubstitutionDirection',
    interfaces: [Enum]
  };
  function SubstitutionDirection$values() {
    return [SubstitutionDirection$LEFT_TO_RIGHT_getInstance(), SubstitutionDirection$RIGHT_TO_LEFT_getInstance(), SubstitutionDirection$ALL_TO_ALL_getInstance()];
  }
  SubstitutionDirection.values = SubstitutionDirection$values;
  function SubstitutionDirection$valueOf(name) {
    switch (name) {
      case 'LEFT_TO_RIGHT':
        return SubstitutionDirection$LEFT_TO_RIGHT_getInstance();
      case 'RIGHT_TO_LEFT':
        return SubstitutionDirection$RIGHT_TO_LEFT_getInstance();
      case 'ALL_TO_ALL':
        return SubstitutionDirection$ALL_TO_ALL_getInstance();
      default:throwISE('No enum constant factstransformations.SubstitutionDirection.' + name);
    }
  }
  SubstitutionDirection.valueOf_61zpoe$ = SubstitutionDirection$valueOf;
  function toUserString($receiver) {
    return $receiver.beginString + $receiver.endString;
  }
  function FactSubstitutionPlace(parentChain, replaceableNodeIndex, substitutionInstance, checkOutMainLineNodePart, originalValue) {
    this.parentChain = parentChain;
    this.replaceableNodeIndex = replaceableNodeIndex;
    this.substitutionInstance = substitutionInstance;
    this.checkOutMainLineNodePart = checkOutMainLineNodePart;
    this.originalValue = originalValue;
  }
  FactSubstitutionPlace.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FactSubstitutionPlace',
    interfaces: []
  };
  FactSubstitutionPlace.prototype.component1 = function () {
    return this.parentChain;
  };
  FactSubstitutionPlace.prototype.component2 = function () {
    return this.replaceableNodeIndex;
  };
  FactSubstitutionPlace.prototype.component3 = function () {
    return this.substitutionInstance;
  };
  FactSubstitutionPlace.prototype.component4 = function () {
    return this.checkOutMainLineNodePart;
  };
  FactSubstitutionPlace.prototype.component5 = function () {
    return this.originalValue;
  };
  FactSubstitutionPlace.prototype.copy_1jnezz$ = function (parentChain, replaceableNodeIndex, substitutionInstance, checkOutMainLineNodePart, originalValue) {
    return new FactSubstitutionPlace(parentChain === void 0 ? this.parentChain : parentChain, replaceableNodeIndex === void 0 ? this.replaceableNodeIndex : replaceableNodeIndex, substitutionInstance === void 0 ? this.substitutionInstance : substitutionInstance, checkOutMainLineNodePart === void 0 ? this.checkOutMainLineNodePart : checkOutMainLineNodePart, originalValue === void 0 ? this.originalValue : originalValue);
  };
  FactSubstitutionPlace.prototype.toString = function () {
    return 'FactSubstitutionPlace(parentChain=' + Kotlin.toString(this.parentChain) + (', replaceableNodeIndex=' + Kotlin.toString(this.replaceableNodeIndex)) + (', substitutionInstance=' + Kotlin.toString(this.substitutionInstance)) + (', checkOutMainLineNodePart=' + Kotlin.toString(this.checkOutMainLineNodePart)) + (', originalValue=' + Kotlin.toString(this.originalValue)) + ')';
  };
  FactSubstitutionPlace.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.parentChain) | 0;
    result = result * 31 + Kotlin.hashCode(this.replaceableNodeIndex) | 0;
    result = result * 31 + Kotlin.hashCode(this.substitutionInstance) | 0;
    result = result * 31 + Kotlin.hashCode(this.checkOutMainLineNodePart) | 0;
    result = result * 31 + Kotlin.hashCode(this.originalValue) | 0;
    return result;
  };
  FactSubstitutionPlace.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.parentChain, other.parentChain) && Kotlin.equals(this.replaceableNodeIndex, other.replaceableNodeIndex) && Kotlin.equals(this.substitutionInstance, other.substitutionInstance) && Kotlin.equals(this.checkOutMainLineNodePart, other.checkOutMainLineNodePart) && Kotlin.equals(this.originalValue, other.originalValue)))));
  };
  function FactSubstitution(left, right, weight, basedOnTaskContext, direction, name, factComporator) {
    if (weight === void 0)
      weight = 1.0;
    if (basedOnTaskContext === void 0)
      basedOnTaskContext = false;
    if (direction === void 0)
      direction = SubstitutionDirection$ALL_TO_ALL_getInstance();
    if (name === void 0)
      name = '';
    this.left = left;
    this.right = right;
    this.weight = weight;
    this.basedOnTaskContext = basedOnTaskContext;
    this.direction = direction;
    this.name = name;
    this.factComporator = factComporator;
    this.identifier = '';
  }
  FactSubstitution.prototype.computeIdentifier_6taknv$ = function (recomputeIfComputed) {
    if (isBlank(this.identifier)) {
      this.identifier = '[' + this.left.computeIdentifier_6taknv$(recomputeIfComputed) + this.direction.beginString + (this.basedOnTaskContext ? 'InTaskContext' : '') + this.direction.endString + this.right.computeIdentifier_6taknv$(recomputeIfComputed) + ']';
    }
    return this.identifier;
  };
  FactSubstitution.prototype.checkCondition_enijgy$ = function (factNode, inputConditionNode, substitutionInstance, nameArgsMap, checkOutMainLineNodePart, additionalFacts, correspondingIndexes) {
    if (nameArgsMap === void 0) {
      nameArgsMap = LinkedHashMap_init_0();
    }
    if (additionalFacts === void 0) {
      additionalFacts = emptyList();
    }
    if (correspondingIndexes === void 0) {
      correspondingIndexes = ArrayList_init();
    }
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11, tmp$_12, tmp$_13, tmp$_14, tmp$_15, tmp$_16, tmp$_17, tmp$_18, tmp$_19, tmp$_20;
    var conditionNode = inputConditionNode;
    if (inputConditionNode.type() === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() || inputConditionNode.type() === ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance()) {
      if ((Kotlin.isType(tmp$ = inputConditionNode, MainLineNode) ? tmp$ : throwCCE()).outFacts.size === 1 && factNode.type() !== ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() && factNode.type() !== ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance()) {
        conditionNode = first(inputConditionNode.outFacts);
      }
    }
     else if (factNode.type() === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() || factNode.type() === ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance()) {
      var actualFacts = checkOutMainLineNodePart ? getOutFactsFromMainLineNode(factNode) : getInFactsFromMainLineNode(factNode);
      if (actualFacts.size === 1) {
        switch (factNode.type().name) {
          case 'MAIN_LINE_AND_NODE':
            tmp$_2 = new MainLineAndNode(void 0, void 0, void 0, void 0, void 0, mutableListOf([Kotlin.isType(tmp$_0 = inputConditionNode, MainChainPart) ? tmp$_0 : throwCCE()]));
            break;
          case 'MAIN_LINE_OR_NODE':
            tmp$_2 = new MainLineOrNode(void 0, void 0, void 0, void 0, void 0, mutableListOf([Kotlin.isType(tmp$_1 = inputConditionNode, MainChainPart) ? tmp$_1 : throwCCE()]));
            break;
          default:tmp$_2 = new MainLineAndNode();
            break;
        }
        conditionNode = tmp$_2;
      }
    }
    if (conditionNode.type() === ComparableTransformationPartType$EXPRESSION_getInstance()) {
      Kotlin.isType(tmp$_3 = conditionNode, Expression) ? tmp$_3 : throwCCE();
      if (this.basedOnTaskContext) {
        if (!(factNode.type() !== ComparableTransformationPartType$EXPRESSION_getInstance()) ? !conditionNode.data.isNodeSubtreeEquals_7j5kvs$((Kotlin.isType(tmp$_4 = factNode, Expression) ? tmp$_4 : throwCCE()).data) : true) {
          substitutionInstance.isApplicable = false;
          return;
        }
      }
       else {
        var designationName = conditionNode.getDesignation();
        if (designationName.length > 0) {
          var varValue = substitutionInstance.getComparableVar_61zpoe$(designationName);
          if (varValue == null) {
            if (substitutionInstance.getExprVar_61zpoe$(designationName) == null) {
              substitutionInstance.putComparableVar_10y352$(designationName, factNode);
            }
             else {
              substitutionInstance.isApplicable = false;
              return;
            }
          }
           else {
            if (!this.factComporator.compareAsIs_hsjydo$(Kotlin.isType(tmp$_5 = varValue, MainChainPart) ? tmp$_5 : throwCCE(), Kotlin.isType(tmp$_6 = factNode, MainChainPart) ? tmp$_6 : throwCCE(), emptyList())) {
              substitutionInstance.isApplicable = false;
              return;
            }
          }
        }
         else {
          if (conditionNode.type() !== factNode.type()) {
            substitutionInstance.isApplicable = false;
            return;
          }
          ExpressionSubstitution$Companion_getInstance().checkConditionCompanion_5w3lm6$((Kotlin.isType(tmp$_7 = factNode, Expression) ? tmp$_7 : throwCCE()).data, (Kotlin.isType(tmp$_8 = conditionNode, Expression) ? tmp$_8 : throwCCE()).data, substitutionInstance, nameArgsMap, this.basedOnTaskContext);
          if (!substitutionInstance.isApplicable)
            return;
        }
      }
    }
     else {
      if (conditionNode.type() !== factNode.type()) {
        substitutionInstance.isApplicable = false;
        return;
      }
      loop_label: switch (conditionNode.type().name) {
        case 'EXPRESSION_COMPARISON':
          var isApplicable = false;
          var currentTime = substitutionInstance.varNamesTimeStorage.time;
          this.checkCondition_enijgy$((Kotlin.isType(tmp$_9 = factNode, ExpressionComparison) ? tmp$_9 : throwCCE()).leftExpression, (Kotlin.isType(tmp$_10 = conditionNode, ExpressionComparison) ? tmp$_10 : throwCCE()).leftExpression, substitutionInstance, nameArgsMap, checkOutMainLineNodePart);
          if (substitutionInstance.isApplicable && factNode.comparisonType === conditionNode.comparisonType) {
            this.checkCondition_enijgy$(factNode.rightExpression, conditionNode.rightExpression, substitutionInstance, nameArgsMap, checkOutMainLineNodePart);
            if (substitutionInstance.isApplicable) {
              isApplicable = true;
            }
          }

          if (!isApplicable) {
            substitutionInstance.isApplicable = false;
            switch (conditionNode.comparisonType.name) {
              case 'EQUAL':
                if (factNode.comparisonType !== ComparisonType$EQUAL_getInstance())
                  return;
                break;
              case 'LEFT_MORE_OR_EQUAL':
                if (factNode.comparisonType !== ComparisonType$LEFT_LESS_OR_EQUAL_getInstance())
                  return;
                break;
              case 'LEFT_LESS_OR_EQUAL':
                if (factNode.comparisonType !== ComparisonType$LEFT_MORE_OR_EQUAL_getInstance())
                  return;
                break;
              case 'LEFT_MORE':
                if (factNode.comparisonType !== ComparisonType$LEFT_LESS_getInstance())
                  return;
                break;
              case 'LEFT_LESS':
                if (factNode.comparisonType !== ComparisonType$LEFT_MORE_getInstance())
                  return;
                break;
            }
            substitutionInstance.dropExtraVarsAfter_za3lpa$(currentTime);
            substitutionInstance.isApplicable = true;
            this.checkCondition_enijgy$(factNode.leftExpression, conditionNode.rightExpression, substitutionInstance, nameArgsMap, checkOutMainLineNodePart);
            if (substitutionInstance.isApplicable) {
              this.checkCondition_enijgy$(factNode.rightExpression, conditionNode.leftExpression, substitutionInstance, nameArgsMap, checkOutMainLineNodePart);
              if (substitutionInstance.isApplicable) {
                isApplicable = true;
              }
            }
            if (!isApplicable) {
              substitutionInstance.isApplicable = false;
              return;
            }
          }

          break loop_label;
        case 'MAIN_LINE_AND_NODE':
        case 'MAIN_LINE_OR_NODE':
          var actualFacts_0 = checkOutMainLineNodePart ? getOutFactsFromMainLineNode(factNode) : getInFactsFromMainLineNode(factNode);
          var conditionFacts = getOutFactsFromMainLineNode(conditionNode);
          var array = Array_0(conditionFacts.size);
          var tmp$_21;
          tmp$_21 = array.length - 1 | 0;
          for (var i = 0; i <= tmp$_21; i++) {
            array[i] = LinkedHashSet_init();
          }

          var nodesCorrespondingToConditionFacts = array;
          var notMatchedConditionFactsIndexes = LinkedHashSet_init();
          tmp$_11 = get_lastIndex(conditionFacts);
          for (var j = 0; j <= tmp$_11; j++) {
            var conditionFact = conditionFacts.get_za3lpa$(j);
            tmp$_12 = get_lastIndex(actualFacts_0);
            for (var i_0 = 0; i_0 <= tmp$_12; i_0++) {
              var actualFact = actualFacts_0.get_za3lpa$(i_0);
              var startFactCheckingTime = substitutionInstance.varNamesTimeStorage.time;
              substitutionInstance.isApplicable = true;
              this.checkCondition_enijgy$(actualFact, conditionFact, substitutionInstance, nameArgsMap, checkOutMainLineNodePart);
              if (substitutionInstance.isApplicable) {
                nodesCorrespondingToConditionFacts[j].add_11rb$(i_0);
              }
              substitutionInstance.dropExtraVarsAfter_za3lpa$(startFactCheckingTime);
            }
            tmp$_13 = get_lastIndex(additionalFacts);
            for (var i_1 = 0; i_1 <= tmp$_13; i_1++) {
              var actualFact_0 = additionalFacts.get_za3lpa$(i_1);
              var startFactCheckingTime_0 = substitutionInstance.varNamesTimeStorage.time;
              substitutionInstance.isApplicable = true;
              this.checkCondition_enijgy$(actualFact_0, conditionFact, substitutionInstance, nameArgsMap, checkOutMainLineNodePart);
              if (substitutionInstance.isApplicable) {
                nodesCorrespondingToConditionFacts[j].add_11rb$(actualFacts_0.size + i_1 | 0);
              }
              substitutionInstance.dropExtraVarsAfter_za3lpa$(startFactCheckingTime_0);
            }
            if (nodesCorrespondingToConditionFacts[j].isEmpty()) {
              notMatchedConditionFactsIndexes.add_11rb$(j);
            }
          }

          var all$result;
          all$break: do {
            var tmp$_22;
            for (tmp$_22 = 0; tmp$_22 !== nodesCorrespondingToConditionFacts.length; ++tmp$_22) {
              var element = nodesCorrespondingToConditionFacts[tmp$_22];
              if (!(element.size <= 1)) {
                all$result = false;
                break all$break;
              }
            }
            all$result = true;
          }
           while (false);
          if (all$result) {
            var startGeneratingResultTime = substitutionInstance.varNamesTimeStorage.time;
            tmp$_14 = get_lastIndex(conditionFacts);
            for (var j_0 = 0; j_0 <= tmp$_14; j_0++) {
              if (notMatchedConditionFactsIndexes.contains_11rb$(j_0)) {
                continue;
              }
              var conditionFact_0 = conditionFacts.get_za3lpa$(j_0);
              var matchingFactIndex = first_2(nodesCorrespondingToConditionFacts[j_0]);
              if (matchingFactIndex >= actualFacts_0.size) {
                substitutionInstance.varNamesTimeStorage.addVarName_5gyjt1$(additionalFactUsedVarName, SubstitutionInstanceVarType$INFO_getInstance());
                tmp$_15 = additionalFacts.get_za3lpa$(matchingFactIndex - actualFacts_0.size | 0);
              }
               else {
                tmp$_15 = actualFacts_0.get_za3lpa$(matchingFactIndex);
              }
              var actualFact_1 = tmp$_15;
              substitutionInstance.isApplicable = true;
              var currentStartGeneratingResultTime = substitutionInstance.varNamesTimeStorage.time;
              this.checkCondition_enijgy$(actualFact_1, conditionFact_0, substitutionInstance, nameArgsMap, checkOutMainLineNodePart);
              if (!substitutionInstance.isApplicable) {
                substitutionInstance.dropExtraVarsAfter_za3lpa$(currentStartGeneratingResultTime);
                notMatchedConditionFactsIndexes.add_11rb$(j_0);
              }
              correspondingIndexes.add_11rb$(new MatchedNode(matchingFactIndex, actualFact_1.type()));
            }
            tmp$_16 = notMatchedConditionFactsIndexes.iterator();
            while (tmp$_16.hasNext()) {
              var j_1 = tmp$_16.next();
              var conditionFact_1 = conditionFacts.get_za3lpa$(j_1);
              switch (conditionFact_1.type().name) {
                case 'EXPRESSION_COMPARISON':
                  tmp$_19 = (Kotlin.isType(tmp$_17 = conditionFact_1, ExpressionComparison) ? tmp$_17 : throwCCE()).computeIfNumeric_z3m4ac$(substitutionInstance, this.factComporator.expressionComporator.baseOperationsDefinitions);
                  break;
                case 'MAIN_LINE_AND_NODE':
                case 'MAIN_LINE_OR_NODE':
                  tmp$_19 = (Kotlin.isType(tmp$_18 = conditionFact_1, MainLineNode) ? tmp$_18 : throwCCE()).computeIfNumeric_7do60d$(substitutionInstance, this.factComporator.expressionComporator.baseOperationsDefinitions, true);
                  break;
                default:tmp$_19 = false;
                  break;
              }
              var isNumericAndCorrect = tmp$_19;
              if (isNumericAndCorrect !== true) {
                substitutionInstance.isApplicable = false;
                substitutionInstance.dropExtraVarsAfter_za3lpa$(startGeneratingResultTime);
                return;
              }
            }
            substitutionInstance.isApplicable = true;
          }
           else {
            var j_2 = 0;
            var startGeneratingResultTime_0 = substitutionInstance.varNamesTimeStorage.time;
            while (j_2 < conditionFacts.size) {
              var conditionFact_2 = conditionFacts.get_za3lpa$(j_2);
              if (nodesCorrespondingToConditionFacts[j_2].isEmpty()) {
                substitutionInstance.isApplicable = false;
                substitutionInstance.dropExtraVarsAfter_za3lpa$(startGeneratingResultTime_0);
                return;
              }
              var matchingFactIndex_0 = first_2(nodesCorrespondingToConditionFacts[j_2]);
              if (matchingFactIndex_0 >= actualFacts_0.size) {
                substitutionInstance.varNamesTimeStorage.addVarName_5gyjt1$(additionalFactUsedVarName, SubstitutionInstanceVarType$INFO_getInstance());
                tmp$_20 = additionalFacts.get_za3lpa$(matchingFactIndex_0 - actualFacts_0.size | 0);
              }
               else {
                tmp$_20 = actualFacts_0.get_za3lpa$(matchingFactIndex_0);
              }
              var actualFact_2 = tmp$_20;
              substitutionInstance.isApplicable = true;
              var startFactCheckingTime_1 = substitutionInstance.varNamesTimeStorage.time;
              this.checkCondition_enijgy$(actualFact_2, conditionFact_2, substitutionInstance, nameArgsMap, checkOutMainLineNodePart);
              if (!substitutionInstance.isApplicable) {
                substitutionInstance.dropExtraVarsAfter_za3lpa$(startFactCheckingTime_1);
                nodesCorrespondingToConditionFacts[j_2].remove_11rb$(matchingFactIndex_0);
                continue;
              }
              var tmp$_23;
              for (tmp$_23 = 0; tmp$_23 !== nodesCorrespondingToConditionFacts.length; ++tmp$_23) {
                var element_0 = nodesCorrespondingToConditionFacts[tmp$_23];
                element_0.remove_11rb$(matchingFactIndex_0);
              }
              correspondingIndexes.add_11rb$(new MatchedNode(matchingFactIndex_0, actualFact_2.type()));
              j_2 = j_2 + 1 | 0;
            }
          }

          break loop_label;
      }
    }
  };
  FactSubstitution.prototype.checkLeftCondition_j8spiw$ = function (factNode, checkOutMainLineNodePart, additionalFacts) {
    var substitutionInstance = new SubstitutionInstance();
    this.checkCondition_enijgy$(factNode, this.left, substitutionInstance, void 0, checkOutMainLineNodePart, additionalFacts, substitutionInstance.correspondingIndexes.children);
    substitutionInstance.correspondingIndexes.nodeType = factNode.type();
    substitutionInstance.correspondingIndexes.matchedFactIndex = 0;
    return substitutionInstance;
  };
  function FactSubstitution$findAllPossibleSubstitutionPlaces$lambda() {
    return 'findAllPossibleSubstitutionPlaces in fact: ';
  }
  function FactSubstitution$findAllPossibleSubstitutionPlaces$lambda_0(closure$currentLogLevel) {
    return function () {
      return 'Current log level: ' + closure$currentLogLevel.v;
    };
  }
  function FactSubstitution$findAllPossibleSubstitutionPlaces$lambda_1() {
    return 'actualFacts';
  }
  function FactSubstitution$findAllPossibleSubstitutionPlaces$lambda_2() {
    return 'Applicable substitution found ';
  }
  FactSubstitution.prototype.findAllPossibleSubstitutionPlaces_0 = function (root, checkOutMainLineNodePart, additionalFacts, result) {
    var tmp$;
    log_1.addMessageWithFactShort_5zaetr$(FactSubstitution$findAllPossibleSubstitutionPlaces$lambda, root, void 0, void 0, 1);
    var currentLogLevel = {v: log_1.currentLevel};
    log_1.addMessage_bda5c9$(FactSubstitution$findAllPossibleSubstitutionPlaces$lambda_0(currentLogLevel), void 0, currentLogLevel.v);
    if (root.type() === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() || root.type() === ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance()) {
      var actualFacts = checkOutMainLineNodePart ? getOutFactsFromMainLineNode(root) : getInFactsFromMainLineNode(root);
      log_1.logSystemFacts_zi2lc5$(root.type(), actualFacts, FactSubstitution$findAllPossibleSubstitutionPlaces$lambda_1);
      tmp$ = actualFacts.size;
      for (var i = 0; i < tmp$; i++) {
        this.findAllPossibleSubstitutionPlaces_0(actualFacts.get_za3lpa$(i), checkOutMainLineNodePart, additionalFacts, result);
        var substitutionInstance = this.checkLeftCondition_j8spiw$(actualFacts.get_za3lpa$(i), checkOutMainLineNodePart, additionalFacts);
        if (substitutionInstance.isApplicable) {
          substitutionInstance.logValue_d8wcre$(FactSubstitution$findAllPossibleSubstitutionPlaces$lambda_2, void 0, currentLogLevel.v);
          result.add_11rb$(new FactSubstitutionPlace(actualFacts, i, substitutionInstance, checkOutMainLineNodePart, actualFacts.get_za3lpa$(i)));
        }
      }
    }
  };
  function FactSubstitution$findAllPossibleSubstitutionPlaces$lambda_3() {
    return 'search places for transformation';
  }
  FactSubstitution.prototype.findAllPossibleSubstitutionPlaces_hkzcsw$ = function (root, checkOutMainLineNodePart, additionalFacts) {
    var result = ArrayList_init();
    log_1.addMessage_bda5c9$(FactSubstitution$findAllPossibleSubstitutionPlaces$lambda_3);
    this.findAllPossibleSubstitutionPlaces_0(root, checkOutMainLineNodePart, additionalFacts, result);
    return result;
  };
  FactSubstitution.prototype.applySubstitution_u3h3q6$ = function (substitutionPlaces, additionalFacts, additionalFactUsed) {
    var tmp$;
    tmp$ = substitutionPlaces.iterator();
    while (tmp$.hasNext()) {
      var substitutionPlace = tmp$.next();
      var newValue = this.checkAndApply_hkzcsw$(substitutionPlace.parentChain.get_za3lpa$(substitutionPlace.replaceableNodeIndex), substitutionPlace.checkOutMainLineNodePart, additionalFacts);
      if (newValue != null) {
        substitutionPlace.parentChain.set_wxm5ur$(substitutionPlace.replaceableNodeIndex, newValue);
        var $receiver = substitutionPlace.substitutionInstance.varNamesTimeStorage.varsList;
        var destination = ArrayList_init();
        var tmp$_0;
        tmp$_0 = $receiver.iterator();
        while (tmp$_0.hasNext()) {
          var element = tmp$_0.next();
          if (element.type === SubstitutionInstanceVarType$INFO_getInstance() && equals(element.name, additionalFactUsedVarName))
            destination.add_11rb$(element);
        }
        if (!destination.isEmpty() && additionalFactUsed.isEmpty()) {
          additionalFactUsed.add_11rb$(true);
        }
      }
    }
  };
  FactSubstitution.prototype.applySubstitutionByBitMask_s1ctej$ = function (substitutionPlaces, bitMask, additionalFactUsed) {
    var tmp$, tmp$_0;
    tmp$ = substitutionPlaces.size;
    for (var i = 0; i < tmp$; i++) {
      var substitutionPlace = substitutionPlaces.get_za3lpa$(i);
      substitutionPlace.parentChain.set_wxm5ur$(substitutionPlace.replaceableNodeIndex, substitutionPlace.originalValue);
    }
    tmp$_0 = substitutionPlaces.size;
    for (var i_0 = 0; i_0 < tmp$_0; i_0++) {
      if ((bitMask & 1 << i_0) === 0)
        continue;
      var substitutionPlace_0 = substitutionPlaces.get_za3lpa$(i_0);
      var newValue = this.applyRight_8yl8ki$(substitutionPlace_0.substitutionInstance, !substitutionPlace_0.checkOutMainLineNodePart, this.right, substitutionPlace_0.parentChain.get_za3lpa$(substitutionPlace_0.replaceableNodeIndex));
      if (newValue != null) {
        substitutionPlace_0.parentChain.set_wxm5ur$(substitutionPlace_0.replaceableNodeIndex, newValue);
        var $receiver = substitutionPlace_0.substitutionInstance.varNamesTimeStorage.varsList;
        var destination = ArrayList_init();
        var tmp$_1;
        tmp$_1 = $receiver.iterator();
        while (tmp$_1.hasNext()) {
          var element = tmp$_1.next();
          if (element.type === SubstitutionInstanceVarType$INFO_getInstance() && equals(element.name, additionalFactUsedVarName))
            destination.add_11rb$(element);
        }
        if (!destination.isEmpty() && additionalFactUsed.isEmpty()) {
          additionalFactUsed.add_11rb$(true);
        }
      }
    }
  };
  FactSubstitution.prototype.applyRight_8yl8ki$ = function (substitutionInstance, checkOutMainLineNodePart, right, factNode) {
    if (factNode === void 0)
      factNode = null;
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10, tmp$_11, tmp$_12, tmp$_13, tmp$_14, tmp$_15, tmp$_16, tmp$_17, tmp$_18, tmp$_19, tmp$_20, tmp$_21, tmp$_22, tmp$_23, tmp$_24, tmp$_25, tmp$_26;
    if (right.type() === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance() || right.type() === ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance()) {
      var result = right.copyNode();
      var resultFacts = !checkOutMainLineNodePart ? getOutFactsFromMainLineNode(result) : getInFactsFromMainLineNode(result);
      var rightFacts = getInFactsFromMainLineNode(right);
      tmp$ = rightFacts.iterator();
      while (tmp$.hasNext()) {
        var fact = tmp$.next();
        switch (fact.type().name) {
          case 'MAIN_LINE_AND_NODE':
          case 'MAIN_LINE_OR_NODE':
            tmp$_13 = this.applyRight_8yl8ki$(substitutionInstance, checkOutMainLineNodePart, fact);
            break;
          case 'EXPRESSION_COMPARISON':
            var res = Kotlin.isType(tmp$_0 = fact.copyNode(), ExpressionComparison) ? tmp$_0 : throwCCE();
            var leftDesignationName = (Kotlin.isType(tmp$_1 = fact, ExpressionComparison) ? tmp$_1 : throwCCE()).leftExpression.getDesignation();
            var rightDesignationName = fact.rightExpression.getDesignation();
            if (isBlank(leftDesignationName) || substitutionInstance.getComparableVar_61zpoe$(leftDesignationName) == null) {
              tmp$_2 = ExpressionSubstitution$Companion_getInstance().applyRightCompanion_miu9dc$(substitutionInstance, fact.leftExpression.data);
              if (tmp$_2 == null) {
                return null;
              }
              tmp$_5 = new Expression(void 0, void 0, tmp$_2);
            }
             else {
              tmp$_3 = substitutionInstance.getComparableVar_61zpoe$(leftDesignationName);
              if (tmp$_3 == null) {
                return null;
              }
              tmp$_5 = Kotlin.isType(tmp$_4 = tmp$_3.cloneWithNormalization_1g1bdl$(LinkedHashMap_init_0(), false), Expression) ? tmp$_4 : throwCCE();
            }

            res.leftExpression = tmp$_5;
            if (isBlank(rightDesignationName) || substitutionInstance.getComparableVar_61zpoe$(rightDesignationName) == null) {
              tmp$_6 = ExpressionSubstitution$Companion_getInstance().applyRightCompanion_miu9dc$(substitutionInstance, fact.rightExpression.data);
              if (tmp$_6 == null) {
                return null;
              }
              tmp$_9 = new Expression(void 0, void 0, tmp$_6);
            }
             else {
              tmp$_7 = substitutionInstance.getComparableVar_61zpoe$(rightDesignationName);
              if (tmp$_7 == null) {
                return null;
              }
              tmp$_9 = Kotlin.isType(tmp$_8 = tmp$_7.cloneWithNormalization_1g1bdl$(LinkedHashMap_init_0(), false), Expression) ? tmp$_8 : throwCCE();
            }

            res.rightExpression = tmp$_9;
            res.identifier = res.computeIdentifier_6taknv$(false);
            tmp$_13 = res;
            break;
          case 'EXPRESSION':
            var designationName = (Kotlin.isType(tmp$_10 = fact, Expression) ? tmp$_10 : throwCCE()).getDesignation();
            if (isBlank(designationName))
              return null;
            tmp$_11 = substitutionInstance.getComparableVar_61zpoe$(designationName);
            if (tmp$_11 == null) {
              return null;
            }

            tmp$_13 = Kotlin.isType(tmp$_12 = tmp$_11.cloneWithNormalization_1g1bdl$(LinkedHashMap_init_0(), false), MainChainPart) ? tmp$_12 : throwCCE();
            break;
          default:tmp$_13 = null;
            break;
        }
        var child = tmp$_13;
        if (child == null) {
          return null;
        }
        resultFacts.add_11rb$(child);
      }
      if (factNode != null && right.type() === substitutionInstance.correspondingIndexes.nodeType) {
        var actualFacts = checkOutMainLineNodePart ? getOutFactsFromMainLineNode(factNode) : getInFactsFromMainLineNode(factNode);
        var $receiver = substitutionInstance.correspondingIndexes.children;
        var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
        var tmp$_27;
        tmp$_27 = $receiver.iterator();
        while (tmp$_27.hasNext()) {
          var item = tmp$_27.next();
          destination.add_11rb$(item.matchedFactIndex);
        }
        var correspondingIndexesSet = toSet(destination);
        tmp$_14 = actualFacts.size;
        for (var i = 0; i < tmp$_14; i++) {
          if (!correspondingIndexesSet.contains_11rb$(i)) {
            resultFacts.add_11rb$(actualFacts.get_za3lpa$(i));
          }
        }
      }
      return Kotlin.isType(tmp$_15 = result, MainChainPart) ? tmp$_15 : throwCCE();
    }
     else if (right.type() === ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance()) {
      var res_0 = Kotlin.isType(tmp$_16 = right.copyNode(), ExpressionComparison) ? tmp$_16 : throwCCE();
      var leftDesignationName_0 = (Kotlin.isType(tmp$_17 = right, ExpressionComparison) ? tmp$_17 : throwCCE()).leftExpression.getDesignation();
      var rightDesignationName_0 = (Kotlin.isType(tmp$_18 = right, ExpressionComparison) ? tmp$_18 : throwCCE()).rightExpression.getDesignation();
      if (isBlank(leftDesignationName_0) || substitutionInstance.getComparableVar_61zpoe$(leftDesignationName_0) == null) {
        tmp$_19 = ExpressionSubstitution$Companion_getInstance().applyRightCompanion_miu9dc$(substitutionInstance, right.leftExpression.data);
        if (tmp$_19 == null) {
          return null;
        }
        tmp$_22 = new Expression(void 0, void 0, tmp$_19);
      }
       else {
        tmp$_20 = substitutionInstance.getComparableVar_61zpoe$(leftDesignationName_0);
        if (tmp$_20 == null) {
          return null;
        }
        tmp$_22 = Kotlin.isType(tmp$_21 = tmp$_20.cloneWithNormalization_1g1bdl$(LinkedHashMap_init_0(), false), Expression) ? tmp$_21 : throwCCE();
      }
      res_0.leftExpression = tmp$_22;
      if (isBlank(rightDesignationName_0) || substitutionInstance.getComparableVar_61zpoe$(rightDesignationName_0) == null) {
        tmp$_23 = ExpressionSubstitution$Companion_getInstance().applyRightCompanion_miu9dc$(substitutionInstance, right.rightExpression.data);
        if (tmp$_23 == null) {
          return null;
        }
        tmp$_26 = new Expression(void 0, void 0, tmp$_23);
      }
       else {
        tmp$_24 = substitutionInstance.getComparableVar_61zpoe$(rightDesignationName_0);
        if (tmp$_24 == null) {
          return null;
        }
        tmp$_26 = Kotlin.isType(tmp$_25 = tmp$_24.cloneWithNormalization_1g1bdl$(LinkedHashMap_init_0(), false), Expression) ? tmp$_25 : throwCCE();
      }
      res_0.rightExpression = tmp$_26;
      res_0.identifier = res_0.computeIdentifier_6taknv$(false);
      return res_0;
    }
    return null;
  };
  FactSubstitution.prototype.checkAndApply_hkzcsw$ = function (factNode, checkOutMainLineNodePart, additionalFacts) {
    if (checkOutMainLineNodePart === void 0)
      checkOutMainLineNodePart = true;
    if (additionalFacts === void 0) {
      additionalFacts = emptyList();
    }
    var substitutionInstance = this.checkLeftCondition_j8spiw$(factNode, checkOutMainLineNodePart, additionalFacts);
    if (substitutionInstance.isApplicable)
      return this.applyRight_8yl8ki$(substitutionInstance, checkOutMainLineNodePart, this.right, factNode);
    else
      return null;
  };
  FactSubstitution.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'FactSubstitution',
    interfaces: []
  };
  function emptyFactSubstitution() {
    return new FactSubstitution(emptyExpression(), emptyExpression(), void 0, void 0, void 0, '', new FactComporator());
  }
  function TransformationChainParser(originalTransformationChain, nameForRuleDesignationsPossible, functionConfiguration, factsLogicConfiguration, compiledImmediateVariableReplacements, transformationChain) {
    if (nameForRuleDesignationsPossible === void 0)
      nameForRuleDesignationsPossible = false;
    if (functionConfiguration === void 0)
      functionConfiguration = new FunctionConfiguration();
    if (factsLogicConfiguration === void 0)
      factsLogicConfiguration = new FactsLogicConfiguration();
    if (compiledImmediateVariableReplacements === void 0) {
      compiledImmediateVariableReplacements = emptyMap();
    }
    if (transformationChain === void 0)
      transformationChain = originalTransformationChain;
    this.originalTransformationChain = originalTransformationChain;
    this.nameForRuleDesignationsPossible = nameForRuleDesignationsPossible;
    this.functionConfiguration = functionConfiguration;
    this.factsLogicConfiguration = factsLogicConfiguration;
    this.compiledImmediateVariableReplacements = compiledImmediateVariableReplacements;
    this.transformationChain = transformationChain;
    this.root = new MainLineAndNode(0, this.transformationChain.length, null);
    this.parserError = null;
    this.somethingUnexpectedCode_0 = 'Something unexpected';
  }
  function TransformationChainParser$ParserState(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function TransformationChainParser$ParserState_initFields() {
    TransformationChainParser$ParserState_initFields = function () {
    };
    TransformationChainParser$ParserState$EXPRESSION_START_instance = new TransformationChainParser$ParserState('EXPRESSION_START', 0);
    TransformationChainParser$ParserState$IN_EXPRESSION_instance = new TransformationChainParser$ParserState('IN_EXPRESSION', 1);
    TransformationChainParser$ParserState$NOT_IN_EXPRESSION_END_instance = new TransformationChainParser$ParserState('NOT_IN_EXPRESSION_END', 2);
    TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_instance = new TransformationChainParser$ParserState('IN_END_OF_FOLLOWING_STATEMENT', 3);
    TransformationChainParser$ParserState$AFTER_ROW_END_instance = new TransformationChainParser$ParserState('AFTER_ROW_END', 4);
  }
  var TransformationChainParser$ParserState$EXPRESSION_START_instance;
  function TransformationChainParser$ParserState$EXPRESSION_START_getInstance() {
    TransformationChainParser$ParserState_initFields();
    return TransformationChainParser$ParserState$EXPRESSION_START_instance;
  }
  var TransformationChainParser$ParserState$IN_EXPRESSION_instance;
  function TransformationChainParser$ParserState$IN_EXPRESSION_getInstance() {
    TransformationChainParser$ParserState_initFields();
    return TransformationChainParser$ParserState$IN_EXPRESSION_instance;
  }
  var TransformationChainParser$ParserState$NOT_IN_EXPRESSION_END_instance;
  function TransformationChainParser$ParserState$NOT_IN_EXPRESSION_END_getInstance() {
    TransformationChainParser$ParserState_initFields();
    return TransformationChainParser$ParserState$NOT_IN_EXPRESSION_END_instance;
  }
  var TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_instance;
  function TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_getInstance() {
    TransformationChainParser$ParserState_initFields();
    return TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_instance;
  }
  var TransformationChainParser$ParserState$AFTER_ROW_END_instance;
  function TransformationChainParser$ParserState$AFTER_ROW_END_getInstance() {
    TransformationChainParser$ParserState_initFields();
    return TransformationChainParser$ParserState$AFTER_ROW_END_instance;
  }
  TransformationChainParser$ParserState.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ParserState',
    interfaces: [Enum]
  };
  function TransformationChainParser$ParserState$values() {
    return [TransformationChainParser$ParserState$EXPRESSION_START_getInstance(), TransformationChainParser$ParserState$IN_EXPRESSION_getInstance(), TransformationChainParser$ParserState$NOT_IN_EXPRESSION_END_getInstance(), TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_getInstance(), TransformationChainParser$ParserState$AFTER_ROW_END_getInstance()];
  }
  TransformationChainParser$ParserState.values = TransformationChainParser$ParserState$values;
  function TransformationChainParser$ParserState$valueOf(name) {
    switch (name) {
      case 'EXPRESSION_START':
        return TransformationChainParser$ParserState$EXPRESSION_START_getInstance();
      case 'IN_EXPRESSION':
        return TransformationChainParser$ParserState$IN_EXPRESSION_getInstance();
      case 'NOT_IN_EXPRESSION_END':
        return TransformationChainParser$ParserState$NOT_IN_EXPRESSION_END_getInstance();
      case 'IN_END_OF_FOLLOWING_STATEMENT':
        return TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_getInstance();
      case 'AFTER_ROW_END':
        return TransformationChainParser$ParserState$AFTER_ROW_END_getInstance();
      default:throwISE('No enum constant factstransformations.TransformationChainParser.ParserState.' + name);
    }
  }
  TransformationChainParser$ParserState.valueOf_61zpoe$ = TransformationChainParser$ParserState$valueOf;
  TransformationChainParser.prototype.normalisePositionInParseError_0 = function (parserError) {
    return parserError;
  };
  TransformationChainParser.prototype.parse = function () {
    var error = this.splitOnMainLevelParts_0(this.root);
    if (error != null)
      return this.normalisePositionInParseError_0(error);
    return null;
  };
  function TransformationChainParser$logParserStateChange$lambda(closure$parserState, closure$oldValue) {
    return function () {
      return "parserState changed to '" + closure$parserState.toString() + "' from '" + closure$oldValue.toString() + "'";
    };
  }
  TransformationChainParser.prototype.logParserStateChange_0 = function (parserState, logLevel, oldValue) {
    log_1.addMessage_bda5c9$(TransformationChainParser$logParserStateChange$lambda(parserState, oldValue), void 0, logLevel);
  };
  TransformationChainParser.prototype.assignAndLogParserState_0 = function (parserState, logLevel, currentValue) {
    if (parserState !== currentValue) {
      this.logParserStateChange_0(parserState, logLevel, currentValue);
    }
    return parserState;
  };
  function TransformationChainParser$SemanticRangeShift(rangeStart, rangeEnd, start, end) {
    if (rangeStart === void 0)
      rangeStart = 0;
    if (rangeEnd === void 0)
      rangeEnd = 0;
    if (start === void 0)
      start = 0;
    if (end === void 0)
      end = 0;
    this.rangeStart = rangeStart;
    this.rangeEnd = rangeEnd;
    this.start = start;
    this.end = end;
  }
  TransformationChainParser$SemanticRangeShift.prototype.addTagShift_vux9f0$ = function (openTagLen, closeTagLen) {
    this.start = this.start + openTagLen | 0;
    this.end = this.end + closeTagLen | 0;
  };
  TransformationChainParser$SemanticRangeShift.prototype.currentShiftKeepsSemantic_vux9f0$ = function (start, end) {
    return start <= (this.rangeStart + this.start | 0) && end >= (this.rangeEnd + this.end | 0);
  };
  TransformationChainParser$SemanticRangeShift.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'SemanticRangeShift',
    interfaces: []
  };
  TransformationChainParser$SemanticRangeShift.prototype.component1 = function () {
    return this.rangeStart;
  };
  TransformationChainParser$SemanticRangeShift.prototype.component2 = function () {
    return this.rangeEnd;
  };
  TransformationChainParser$SemanticRangeShift.prototype.component3 = function () {
    return this.start;
  };
  TransformationChainParser$SemanticRangeShift.prototype.component4 = function () {
    return this.end;
  };
  TransformationChainParser$SemanticRangeShift.prototype.copy_tjonv8$ = function (rangeStart, rangeEnd, start, end) {
    return new TransformationChainParser$SemanticRangeShift(rangeStart === void 0 ? this.rangeStart : rangeStart, rangeEnd === void 0 ? this.rangeEnd : rangeEnd, start === void 0 ? this.start : start, end === void 0 ? this.end : end);
  };
  TransformationChainParser$SemanticRangeShift.prototype.toString = function () {
    return 'SemanticRangeShift(rangeStart=' + Kotlin.toString(this.rangeStart) + (', rangeEnd=' + Kotlin.toString(this.rangeEnd)) + (', start=' + Kotlin.toString(this.start)) + (', end=' + Kotlin.toString(this.end)) + ')';
  };
  TransformationChainParser$SemanticRangeShift.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.rangeStart) | 0;
    result = result * 31 + Kotlin.hashCode(this.rangeEnd) | 0;
    result = result * 31 + Kotlin.hashCode(this.start) | 0;
    result = result * 31 + Kotlin.hashCode(this.end) | 0;
    return result;
  };
  TransformationChainParser$SemanticRangeShift.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.rangeStart, other.rangeStart) && Kotlin.equals(this.rangeEnd, other.rangeEnd) && Kotlin.equals(this.start, other.start) && Kotlin.equals(this.end, other.end)))));
  };
  function TransformationChainParser$splitOnMainLevelParts$lambda() {
    return 'parsing part ';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_0() {
    return ' : ';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_1() {
    return '';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_2(closure$currentLogLevel) {
    return function () {
      return 'Current log level: ' + closure$currentLogLevel;
    };
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_3() {
    return 'currentPartStartPosition';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_4() {
    return "comment found and parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_5() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_6() {
    return "whitespace found and parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_7() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_8() {
    return "math_tag found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_9() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_10(it) {
    return unboxChar(it) !== 62;
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_11() {
    return "math_tag parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_12() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_13() {
    return 'currentPartStartPosition';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_14() {
    return "math_closing_tag found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_15() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_16() {
    return 'currentPartStartPosition < currentPosition; parseExpressionComparisonOrExpressionChainFromTransformationChain';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_17(it) {
    return unboxChar(it) !== 62;
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_18() {
    return "math_closing_tag parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_19() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_20() {
    return "mtable_closing_tag found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_21() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_22(it) {
    return unboxChar(it) !== 62;
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_23() {
    return "mtable_closing_tag parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_24() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_25() {
    return "mo_open_tag found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_26() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_27() {
    return "fact_divider following_statement found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_28() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_29() {
    return 'currentPartStartPosition < currentPosition; parseExpressionComparisonOrExpressionChainFromTransformationChain';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_30() {
    return "fact_divider following_statement parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_31() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_32() {
    return 'waitingForFollowingSignDoubling';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_33() {
    return "fact_divider_details_mo found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_34() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_35() {
    return "fact_divider_details_mo parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_36() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_37() {
    return 'waitingForFollowingSignDoubling';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_38() {
    return "fact_divider_details_mfenced found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_39() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_40() {
    return "fact_divider_details_mfenced parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_41() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_42() {
    return 'waitingForFollowingSignDoubling';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_43() {
    return "fact_divider_details rule_pointer found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_44() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_45() {
    return "RulePointer '''";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_46() {
    return "''' parsed";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_47() {
    return "fact_divider_details rule_pointer parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_48() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_49() {
    return 'waitingForFollowingSignDoubling';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_50() {
    return "second following_statement part parsing started; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_51() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_52() {
    return "second following_statement part parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_53() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_54() {
    return 'currentPartStartPosition';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_55() {
    return "mo[ found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_56() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_57() {
    return "mo[ parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_58() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_59() {
    return "rule_identified; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_60() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_61() {
    return "rule parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_62() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_63() {
    return 'currentPartStartPosition';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_64() {
    return "signsPointersOnNotEndedExpression '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_65() {
    return "' found and parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_66() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_67() {
    return "parserState != ParserState.NOT_IN_EXPRESSION_END; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_68() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_69() {
    return "mspace_tag_linebreak_newline found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_70() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_71() {
    return 'currentPartStartPosition < currentPosition; parseExpressionComparisonOrExpressionChainFromTransformationChain';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_72() {
    return 'currentPartStartPosition';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_73() {
    return 'currentMainLineNode.parent != null; currentMainLineNode.addStartNewFactChain() called';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_74() {
    return "mspace_tag_linebreak_newline parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_75() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_76() {
    return "mtd_mtr_closing_tag found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_77() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_78() {
    return 'parserState != ParserState.IN_END_OF_FOLLOWING_STATEMENT && currentPartStartPosition < currentPosition; parseExpressionComparisonOrExpressionChainFromTransformationChain';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_79() {
    return "mtd_mtr_closing_tag parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_80() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_81() {
    return 'currentPartStartPosition';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_82() {
    return "mfenced_closing_tag found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_83() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_84() {
    return 'parserState != ParserState.IN_END_OF_FOLLOWING_STATEMENT && currentPartStartPosition < currentPosition; parseExpressionComparisonOrExpressionChainFromTransformationChain';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_85() {
    return "currentPosition == currentMainLineNode.endPosition; currentMainLineNode.parent is '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_86() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_87() {
    return 'currentPartStartPosition';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_88() {
    return "mfenced_closing_tag parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_89() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_90() {
    return "actual_tag '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_91() {
    return "' found; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_92() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_93(it) {
    return it.key + "='" + it.value + "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_94() {
    return "extracted tag_data: '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_95() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_96() {
    return "tagData[name] == mfenced && tagData[close] == ''";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_97() {
    return 'currentPartStartPosition < currentPosition; parseExpressionComparisonOrExpressionChainFromTransformationChain';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_98() {
    return "actual_tag parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_99() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_100() {
    return "internalEnd (closing_mfenced_tag) = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_101() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_102() {
    return "MainLineAndNode AND child_created 'from ";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_103() {
    return ' to ';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_104() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_105() {
    return "MainLineOrNode OR child_created 'from ";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_106() {
    return ' to ';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_107() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_108() {
    return 'currentMainLineNode.addExpressionComparisonFact() called; switch_to_child_node';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_109() {
    return "tagData[name] == mfenced && tagData[close] == '' && tagData[open] == ''";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_110() {
    return 'currentPartStartPosition < currentPosition; parseExpressionComparisonOrExpressionChainFromTransformationChain';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_111() {
    return "actual_tag parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_112() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_113() {
    return 'parserState == ParserState.EXPRESSION_START && currentPartStartPosition < currentPosition';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_114() {
    return "internalEnd (closing_mfenced_tag) = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_115() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_116() {
    return "rule parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_117() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_118() {
    return 'currentPartStartPosition';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_119() {
    return "actual_tag parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_120() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_121() {
    return 'currentPartStartPosition';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_122() {
    return "actual_tag parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_123() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_124() {
    return 'parserState == ParserState.AFTER_ROW_END';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_125() {
    return "mtd_mtr_tag found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_126() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_127() {
    return 'currentPartStartPosition';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_128() {
    return 'currentMainLineNode.parent != null; currentMainLineNode.addStartNewFactChain() called';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_129() {
    return "mtd_mtr_tag parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_130() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_131() {
    return "mfenced_closing_tag found at position = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_132() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_133() {
    return "currentPosition == currentMainLineNode.endPosition; currentMainLineNode.parent is '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_134() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_135() {
    return 'currentPartStartPosition';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_136() {
    return "mfenced_closing_tag parsed; currentPosition = '";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_137() {
    return "'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_138() {
    return "exit from 'while (currentPosition < mainLineNode.endPosition)'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_139() {
    return 'parserState != ParserState.IN_END_OF_FOLLOWING_STATEMENT';
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_140() {
    return "currentPartStartPosition:'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_141() {
    return "' < currentPosition:'";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_142() {
    return "'; parseExpressionComparisonOrExpressionChainFromTransformationChain";
  }
  function TransformationChainParser$splitOnMainLevelParts$lambda_143() {
    return 'parsed fact: ';
  }
  TransformationChainParser.prototype.splitOnMainLevelParts_0 = function (mainLineNode) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7;
    log_1.add_gqvic5$(mainLineNode.startPosition, mainLineNode.endPosition, TransformationChainParser$splitOnMainLevelParts$lambda, TransformationChainParser$splitOnMainLevelParts$lambda_0, TransformationChainParser$splitOnMainLevelParts$lambda_1, void 0, 1);
    var currentLogLevel = log_1.currentLevel;
    log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_2(currentLogLevel), void 0, currentLogLevel);
    var parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$EXPRESSION_START_getInstance(), currentLogLevel, TransformationChainParser$ParserState$EXPRESSION_START_getInstance());
    var currentMainLineNode = mainLineNode;
    var currentPosition = mainLineNode.startPosition;
    var currentPartStartPosition = log_1.assignAndLog_746w4o$(mainLineNode.startPosition, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_3);
    var semanticRangeShift = new TransformationChainParser$SemanticRangeShift(mainLineNode.startPosition, mainLineNode.endPosition);
    while (currentPosition < mainLineNode.endPosition) {
      if (remainingExpressionStartsWith(openCommentShort, this.transformationChain, currentPosition) || remainingExpressionStartsWith(openCommentMathML, this.transformationChain, currentPosition)) {
        var commentStartPosition = currentPosition;
        currentPosition = currentPosition + 2 | 0;
        while (currentPosition < mainLineNode.endPosition && !(remainingExpressionStartsWith(closeCommentShort, this.transformationChain, currentPosition) || remainingExpressionStartsWith(closeCommentMathML, this.transformationChain, currentPosition))) {
          currentPosition = currentPosition + 1 | 0;
        }
        var tmp$_8;
        tmp$_8 = currentPosition;
        var tmp$_9;
        if (currentPosition < mainLineNode.endPosition && remainingExpressionStartsWith(closeCommentShort, this.transformationChain, currentPosition)) {
          tmp$_9 = closeCommentShort.length;
        }
         else if (currentPosition < mainLineNode.endPosition && remainingExpressionStartsWith(closeCommentMathML, this.transformationChain, currentPosition)) {
          tmp$_9 = closeCommentMathML.length;
        }
         else
          tmp$_9 = 0;
        currentPosition = tmp$_8 + tmp$_9 | 0;
        log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_4, TransformationChainParser$splitOnMainLevelParts$lambda_5, currentLogLevel);
        semanticRangeShift.addTagShift_vux9f0$(currentPosition - commentStartPosition | 0, 0);
        var tmp$_10 = this.transformationChain.substring(0, commentStartPosition) + repeat(' ', currentPosition - commentStartPosition | 0);
        var $receiver = this.transformationChain;
        var startIndex = currentPosition;
        var endIndex = this.transformationChain.length;
        this.transformationChain = tmp$_10 + $receiver.substring(startIndex, endIndex);
        continue;
      }
      if (remainingExpressionStartsWith(newWhiteSpace, this.transformationChain, currentPosition)) {
        currentPosition = currentPosition + newWhiteSpace.length | 0;
        log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_6, TransformationChainParser$splitOnMainLevelParts$lambda_7, currentLogLevel);
        semanticRangeShift.addTagShift_vux9f0$(newWhiteSpace.length, 0);
        continue;
      }
      if (isWhitespace(this.transformationChain.charCodeAt(currentPosition))) {
        currentPosition = currentPosition + 1 | 0;
        semanticRangeShift.addTagShift_vux9f0$(1, 0);
        continue;
      }
      if (remainingExpressionStartsWith('<math', this.transformationChain, currentPosition)) {
        log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_8, TransformationChainParser$splitOnMainLevelParts$lambda_9, currentLogLevel);
        var currentPositionStamp = currentPosition;
        currentPosition = skipFromRemainingExpressionWhile(TransformationChainParser$splitOnMainLevelParts$lambda_10, this.transformationChain, currentPosition);
        currentPosition = currentPosition + 1 | 0;
        log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_11, TransformationChainParser$splitOnMainLevelParts$lambda_12, currentLogLevel);
        currentPartStartPosition = log_1.assignAndLog_746w4o$(currentPosition, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_13);
        semanticRangeShift.addTagShift_vux9f0$(currentPosition - currentPositionStamp | 0, 7);
        continue;
      }
       else if (remainingExpressionStartsWith('<\/math', this.transformationChain, currentPosition)) {
        log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_14, TransformationChainParser$splitOnMainLevelParts$lambda_15, currentLogLevel);
        if (parserState !== TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_getInstance()) {
          if (currentPartStartPosition < currentPosition) {
            log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_16, void 0, currentLogLevel);
            if (this.parseExpressionComparisonOrExpressionChainFromTransformationChain_0(currentPartStartPosition, currentPosition, currentMainLineNode, semanticRangeShift.currentShiftKeepsSemantic_vux9f0$(currentPartStartPosition, currentPosition)) == null)
              if (!equals(ensureNotNull(this.parserError).description, this.somethingUnexpectedCode_0))
                return this.parserError;
          }
          parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_getInstance(), currentLogLevel, parserState);
        }
        currentPosition = skipFromRemainingExpressionWhile(TransformationChainParser$splitOnMainLevelParts$lambda_17, this.transformationChain, currentPosition);
        currentPosition = currentPosition + 1 | 0;
        log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_18, TransformationChainParser$splitOnMainLevelParts$lambda_19, currentLogLevel);
        continue;
      }
       else if (remainingExpressionStartsWith('<\/mtable', this.transformationChain, currentPosition)) {
        log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_20, TransformationChainParser$splitOnMainLevelParts$lambda_21, currentLogLevel);
        currentPosition = skipFromRemainingExpressionWhile(TransformationChainParser$splitOnMainLevelParts$lambda_22, this.transformationChain, currentPosition);
        currentPosition = currentPosition + 1 | 0;
        log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_23, TransformationChainParser$splitOnMainLevelParts$lambda_24, currentLogLevel);
        continue;
      }
      if (parserState === TransformationChainParser$ParserState$IN_EXPRESSION_getInstance() || parserState === TransformationChainParser$ParserState$EXPRESSION_START_getInstance() || parserState === TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_getInstance() || parserState === TransformationChainParser$ParserState$NOT_IN_EXPRESSION_END_getInstance()) {
        if (remainingExpressionStartsWith('<mo>', this.transformationChain, currentPosition)) {
          log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_25, TransformationChainParser$splitOnMainLevelParts$lambda_26, currentLogLevel);
          var newCurrentPosition = currentPosition + 4 | 0;
          if (remainingExpressionStartsWith('<mo>=<\/mo><mo>&gt;<\/mo><mspace linebreak="newline"/>', this.transformationChain, currentPosition) || remainingExpressionStartsWith('<mo>=<\/mo><mo>&gt;<\/mo>', this.transformationChain, currentPosition) || remainingExpressionStartsWith('<mo>&#x21D2;<\/mo>', this.transformationChain, currentPosition)) {
            log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_27, TransformationChainParser$splitOnMainLevelParts$lambda_28, currentLogLevel);
            if (currentPartStartPosition < currentPosition) {
              log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_29, void 0, currentLogLevel);
              if (this.parseExpressionComparisonOrExpressionChainFromTransformationChain_0(currentPartStartPosition, currentPosition, currentMainLineNode, semanticRangeShift.currentShiftKeepsSemantic_vux9f0$(currentPartStartPosition, currentPosition)) == null)
                return this.parserError;
            }
            var tmp$_11;
            tmp$_11 = currentPosition;
            var tmp$_12;
            if (remainingExpressionStartsWith('<mo>&#x21D2;<\/mo>', this.transformationChain, currentPosition)) {
              tmp$_12 = 17;
            }
             else if (remainingExpressionStartsWith('<mo>=<\/mo><mo>&gt;<\/mo>', this.transformationChain, currentPosition)) {
              tmp$_12 = 23;
            }
             else {
              tmp$_12 = 52;
            }
            currentPosition = tmp$_11 + tmp$_12 | 0;
            log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_30, TransformationChainParser$splitOnMainLevelParts$lambda_31, currentLogLevel);
            var waitingForFollowingSignDoubling = log_1.assignAndLog_746w4o$(false, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_32);
            if (remainingExpressionStartsWith('<mo>[<\/mo>', this.transformationChain, currentPosition)) {
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_33, TransformationChainParser$splitOnMainLevelParts$lambda_34, currentLogLevel);
              currentPosition = currentPosition + 10 | 0;
              var internalEnd = skipFromRemainingExpressionWhileClosingBracketNotFound('<mo>]<\/mo>', '<mo>[<\/mo>', this.transformationChain, currentPosition);
              this.parseRule_0(currentPosition, internalEnd, Kotlin.isType(tmp$ = currentMainLineNode.getActualChain(), MutableList) ? tmp$ : throwCCE(), currentMainLineNode);
              currentPosition = internalEnd + 10 | 0;
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_35, TransformationChainParser$splitOnMainLevelParts$lambda_36, currentLogLevel);
              waitingForFollowingSignDoubling = log_1.assignAndLog_746w4o$(true, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_37);
            }
             else if (remainingExpressionStartsWith('<mfenced open="[" close="]">', this.transformationChain, currentPosition)) {
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_38, TransformationChainParser$splitOnMainLevelParts$lambda_39, currentLogLevel);
              currentPosition = currentPosition + 28 | 0;
              var internalEnd_0 = skipFromRemainingExpressionWhileClosingTagNotFound('mfenced', this.transformationChain, currentPosition);
              this.parseRule_0(currentPosition, internalEnd_0, Kotlin.isType(tmp$_0 = currentMainLineNode.getActualChain(), MutableList) ? tmp$_0 : throwCCE(), currentMainLineNode);
              currentPosition = internalEnd_0 + 10 | 0;
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_40, TransformationChainParser$splitOnMainLevelParts$lambda_41, currentLogLevel);
              waitingForFollowingSignDoubling = log_1.assignAndLog_746w4o$(true, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_42);
            }
             else if (remainingExpressionStartsWith('<mtext>', this.transformationChain, currentPosition)) {
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_43, TransformationChainParser$splitOnMainLevelParts$lambda_44, currentLogLevel);
              var ruleLinkNameStartPosition = currentPosition;
              currentPosition = currentPosition + 7 | 0;
              var internalEnd_1 = skipFromRemainingExpressionWhileClosingTagNotFound('mtext', this.transformationChain, currentPosition);
              var $receiver_0 = this.transformationChain;
              var startIndex_0 = currentPosition;
              var endIndex_0 = internalEnd_1 - 1 | 0;
              var ruleNameLink = $receiver_0.substring(startIndex_0, endIndex_0);
              currentPosition = internalEnd_1 + 8 | 0;
              currentMainLineNode.getActualChain().add_11rb$(new RulePointer(ruleLinkNameStartPosition, currentPosition, currentMainLineNode, ruleNameLink));
              log_1.add_f1hiuo$(last(currentMainLineNode.getActualChain()), TransformationChainParser$splitOnMainLevelParts$lambda_45, TransformationChainParser$splitOnMainLevelParts$lambda_46, currentLogLevel);
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_47, TransformationChainParser$splitOnMainLevelParts$lambda_48, currentLogLevel);
              waitingForFollowingSignDoubling = log_1.assignAndLog_746w4o$(true, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_49);
            }
            if (waitingForFollowingSignDoubling) {
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_50, TransformationChainParser$splitOnMainLevelParts$lambda_51, currentLogLevel);
              if (remainingExpressionStartsWith('<mo>&#x21D2;<\/mo>', this.transformationChain, currentPosition)) {
                tmp$_1 = '<mo>&#x21D2;<\/mo>';
              }
               else if (remainingExpressionStartsWith('<mo>=<\/mo><mo>&gt;<\/mo>', this.transformationChain, currentPosition)) {
                tmp$_1 = '<mo>=<\/mo><mo>&gt;<\/mo>';
              }
               else if (remainingExpressionStartsWith('<mo>=<\/mo><mo>&gt;<\/mo><mspace linebreak="newline"/>', this.transformationChain, currentPosition)) {
                tmp$_1 = '<mo>=<\/mo><mo>&gt;<\/mo><mspace linebreak="newline"/>';
              }
               else
                return new ParserError(currentPosition, 'Following statement duplication expected', currentPosition);
              var currentSplittingSign = tmp$_1;
              currentPosition = currentPosition + currentSplittingSign.length | 0;
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_52, TransformationChainParser$splitOnMainLevelParts$lambda_53, currentLogLevel);
            }
            currentPartStartPosition = log_1.assignAndLog_746w4o$(currentPosition, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_54);
            parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_getInstance(), currentLogLevel, parserState);
            continue;
          }
           else if (remainingExpressionStartsWith('<mo>[<\/mo>', this.transformationChain, currentPosition)) {
            log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_55, TransformationChainParser$splitOnMainLevelParts$lambda_56, currentLogLevel);
            currentPosition = currentPosition + 10 | 0;
            log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_57, TransformationChainParser$splitOnMainLevelParts$lambda_58, currentLogLevel);
            if (parserState === TransformationChainParser$ParserState$EXPRESSION_START_getInstance()) {
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_59, TransformationChainParser$splitOnMainLevelParts$lambda_60, currentLogLevel);
              var internalEnd_2 = skipFromRemainingExpressionWhileClosingBracketNotFound('<mo>]<\/mo>', '<mo>[<\/mo>', this.transformationChain, currentPosition);
              this.parseRule_0(currentPosition, internalEnd_2, Kotlin.isType(tmp$_2 = currentMainLineNode.rules, MutableList) ? tmp$_2 : throwCCE(), currentMainLineNode);
              currentPosition = internalEnd_2 + 10 | 0;
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_61, TransformationChainParser$splitOnMainLevelParts$lambda_62, currentLogLevel);
              currentPartStartPosition = log_1.assignAndLog_746w4o$(currentPosition, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_63);
              parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$EXPRESSION_START_getInstance(), currentLogLevel, parserState);
            }
            continue;
          }
           else {
            parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$IN_EXPRESSION_getInstance(), currentLogLevel, parserState);
            tmp$_3 = this.factsLogicConfiguration.signsPointersOnNotEndedExpression.iterator();
            while (tmp$_3.hasNext()) {
              var sign = tmp$_3.next();
              if (remainingExpressionStartsWith(sign, this.transformationChain, newCurrentPosition)) {
                if (remainingExpressionStartsWith('<mo>' + sign + '<\/mo>', this.transformationChain, currentPosition)) {
                  currentPosition = currentPosition + ('<mo>' + sign + '<\/mo>').length | 0;
                  log_1.add_gqvic5$(sign, currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_64, TransformationChainParser$splitOnMainLevelParts$lambda_65, TransformationChainParser$splitOnMainLevelParts$lambda_66, currentLogLevel);
                  parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$NOT_IN_EXPRESSION_END_getInstance(), currentLogLevel, parserState);
                  break;
                }
              }
            }
            if (parserState !== TransformationChainParser$ParserState$NOT_IN_EXPRESSION_END_getInstance()) {
              currentPosition = newCurrentPosition;
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_67, TransformationChainParser$splitOnMainLevelParts$lambda_68, currentLogLevel);
            }
            continue;
          }
        }
         else if (remainingExpressionStartsWith('<mspace linebreak="newline"/>', this.transformationChain, currentPosition)) {
          log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_69, TransformationChainParser$splitOnMainLevelParts$lambda_70, currentLogLevel);
          if (parserState !== TransformationChainParser$ParserState$NOT_IN_EXPRESSION_END_getInstance()) {
            var tmp$_13 = currentPartStartPosition < currentPosition;
            if (tmp$_13) {
              var $receiver_1 = this.transformationChain;
              var startIndex_1 = currentPartStartPosition;
              var endIndex_1 = currentPosition;
              tmp$_13 = !isBlank($receiver_1.substring(startIndex_1, endIndex_1));
            }
            if (tmp$_13) {
              log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_71, void 0, currentLogLevel);
              if (this.parseExpressionComparisonOrExpressionChainFromTransformationChain_0(currentPartStartPosition, currentPosition, currentMainLineNode, semanticRangeShift.currentShiftKeepsSemantic_vux9f0$(currentPartStartPosition, currentPosition)) == null)
                return this.parserError;
            }
            currentPosition = currentPosition + 29 | 0;
            currentPartStartPosition = log_1.assignAndLog_746w4o$(currentPosition, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_72);
            if (currentMainLineNode.parent != null) {
              currentMainLineNode.addStartNewFactChain();
              log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_73, void 0, currentLogLevel);
            }
            parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$EXPRESSION_START_getInstance(), currentLogLevel, parserState);
          }
           else {
            currentPosition = currentPosition + 29 | 0;
          }
          log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_74, TransformationChainParser$splitOnMainLevelParts$lambda_75, currentLogLevel);
          continue;
        }
         else if (remainingExpressionStartsWith('<\/mtd><\/mtr>', this.transformationChain, currentPosition)) {
          log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_76, TransformationChainParser$splitOnMainLevelParts$lambda_77, currentLogLevel);
          if (parserState !== TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_getInstance() && currentPartStartPosition < currentPosition) {
            log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_78, void 0, currentLogLevel);
            if (this.parseExpressionComparisonOrExpressionChainFromTransformationChain_0(currentPartStartPosition, currentPosition, currentMainLineNode, semanticRangeShift.currentShiftKeepsSemantic_vux9f0$(currentPartStartPosition, currentPosition)) == null)
              return this.parserError;
          }
          currentPosition = currentPosition + 12 | 0;
          log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_79, TransformationChainParser$splitOnMainLevelParts$lambda_80, currentLogLevel);
          currentPartStartPosition = log_1.assignAndLog_746w4o$(currentPosition, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_81);
          parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$AFTER_ROW_END_getInstance(), currentLogLevel, parserState);
          continue;
        }
         else if (remainingExpressionStartsWith('<\/mfenced>', this.transformationChain, currentPosition)) {
          log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_82, TransformationChainParser$splitOnMainLevelParts$lambda_83, currentLogLevel);
          if (currentPosition === currentMainLineNode.endPosition) {
            currentPosition = currentPosition + 10 | 0;
            if (currentMainLineNode.isEmpty()) {
              if (parserState !== TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_getInstance() && currentPartStartPosition < currentPosition) {
                log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_84, void 0, currentLogLevel);
                if (this.parseExpressionComparisonOrExpressionChainFromTransformationChain_0(currentPartStartPosition, currentPosition, currentMainLineNode, semanticRangeShift.currentShiftKeepsSemantic_vux9f0$(currentPartStartPosition, currentPosition)) == null)
                  return this.parserError;
              }
            }
            log_1.add_f1hiuo$(currentMainLineNode.parent == null ? 'null' : 'not null', TransformationChainParser$splitOnMainLevelParts$lambda_85, TransformationChainParser$splitOnMainLevelParts$lambda_86, currentLogLevel);
            tmp$_4 = currentMainLineNode.parent;
            if (tmp$_4 == null) {
              return new ParserError(currentPosition, 'Unexpected system closing');
            }
            currentMainLineNode = tmp$_4;
            currentPartStartPosition = log_1.assignAndLog_746w4o$(currentPosition, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_87);
            parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$EXPRESSION_START_getInstance(), currentLogLevel, parserState);
          }
           else {
            currentPosition = currentPosition + 10 | 0;
          }
          log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_88, TransformationChainParser$splitOnMainLevelParts$lambda_89, currentLogLevel);
          continue;
        }
         else {
          var actualTag = readOpenTagStringIfItPresent(this.transformationChain, currentPosition);
          if (actualTag != null && parserState !== TransformationChainParser$ParserState$IN_EXPRESSION_getInstance()) {
            log_1.add_gqvic5$(actualTag, currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_90, TransformationChainParser$splitOnMainLevelParts$lambda_91, TransformationChainParser$splitOnMainLevelParts$lambda_92, currentLogLevel);
            var tagData = getTagAttributes(actualTag);
            log_1.add_f1hiuo$(joinToString(tagData.entries, void 0, void 0, void 0, void 0, void 0, TransformationChainParser$splitOnMainLevelParts$lambda_93), TransformationChainParser$splitOnMainLevelParts$lambda_94, TransformationChainParser$splitOnMainLevelParts$lambda_95, currentLogLevel);
            if (equals(tagData.get_11rb$('name'), 'mfenced')) {
              if (equals(tagData.get_11rb$('close'), '""')) {
                log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_96, void 0, currentLogLevel);
                if (parserState !== TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_getInstance() && parserState !== TransformationChainParser$ParserState$EXPRESSION_START_getInstance() && currentPartStartPosition < currentPosition) {
                  log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_97, void 0, currentLogLevel);
                  if (this.parseExpressionComparisonOrExpressionChainFromTransformationChain_0(currentPartStartPosition, currentPosition, currentMainLineNode, semanticRangeShift.currentShiftKeepsSemantic_vux9f0$(currentPartStartPosition, currentPosition)) == null)
                    return this.parserError;
                }
                currentPosition = currentPosition + actualTag.length | 0;
                log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_98, TransformationChainParser$splitOnMainLevelParts$lambda_99, currentLogLevel);
                var internalEnd_3 = skipFromRemainingExpressionWhileClosingTagNotFound('mfenced', this.transformationChain, currentPosition);
                log_1.add_f1hiuo$(internalEnd_3, TransformationChainParser$splitOnMainLevelParts$lambda_100, TransformationChainParser$splitOnMainLevelParts$lambda_101, currentLogLevel);
                if (equals(tagData.get_11rb$('open'), '"{"')) {
                  log_1.add_gqvic5$(currentPosition, internalEnd_3, TransformationChainParser$splitOnMainLevelParts$lambda_102, TransformationChainParser$splitOnMainLevelParts$lambda_103, TransformationChainParser$splitOnMainLevelParts$lambda_104, currentLogLevel);
                  tmp$_5 = new MainLineAndNode(currentPosition, internalEnd_3, currentMainLineNode);
                }
                 else if (equals(tagData.get_11rb$('open'), '"["')) {
                  log_1.add_gqvic5$(currentPosition, internalEnd_3, TransformationChainParser$splitOnMainLevelParts$lambda_105, TransformationChainParser$splitOnMainLevelParts$lambda_106, TransformationChainParser$splitOnMainLevelParts$lambda_107, currentLogLevel);
                  tmp$_5 = new MainLineOrNode(currentPosition, internalEnd_3, currentMainLineNode);
                }
                 else
                  return new ParserError(currentPosition, 'Undefined system');
                var childMainLineNode = tmp$_5;
                currentMainLineNode.addExpressionComparisonFact_5lkwds$(childMainLineNode);
                log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_108, void 0, currentLogLevel);
                currentMainLineNode = childMainLineNode;
                parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$EXPRESSION_START_getInstance(), currentLogLevel, parserState);
              }
               else if (equals(tagData.get_11rb$('name'), 'mfenced') && equals(tagData.get_11rb$('close'), '"]"') && equals(tagData.get_11rb$('open'), '"["')) {
                log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_109, void 0, currentLogLevel);
                if (parserState === TransformationChainParser$ParserState$EXPRESSION_START_getInstance() && currentPartStartPosition < currentPosition) {
                  log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_110, void 0, currentLogLevel);
                  if (this.parseExpressionComparisonOrExpressionChainFromTransformationChain_0(currentPartStartPosition, currentPosition, currentMainLineNode, semanticRangeShift.currentShiftKeepsSemantic_vux9f0$(currentPartStartPosition, currentPosition)) == null)
                    return this.parserError;
                }
                currentPosition = currentPosition + actualTag.length | 0;
                log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_111, TransformationChainParser$splitOnMainLevelParts$lambda_112, currentLogLevel);
                if (parserState === TransformationChainParser$ParserState$EXPRESSION_START_getInstance() && currentPartStartPosition < currentPosition) {
                  log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_113, void 0, currentLogLevel);
                  var internalEnd_4 = skipFromRemainingExpressionWhileClosingTagNotFound('mfenced', this.transformationChain, currentPosition);
                  log_1.add_f1hiuo$(internalEnd_4, TransformationChainParser$splitOnMainLevelParts$lambda_114, TransformationChainParser$splitOnMainLevelParts$lambda_115, currentLogLevel);
                  this.parseRule_0(currentPosition, internalEnd_4, Kotlin.isType(tmp$_6 = currentMainLineNode.rules, MutableList) ? tmp$_6 : throwCCE(), currentMainLineNode);
                  currentPosition = internalEnd_4 + 10 | 0;
                  log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_116, TransformationChainParser$splitOnMainLevelParts$lambda_117, currentLogLevel);
                  currentPartStartPosition = log_1.assignAndLog_746w4o$(currentPosition, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_118);
                  parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$EXPRESSION_START_getInstance(), currentLogLevel, parserState);
                }
              }
               else {
                currentPosition = currentPosition + actualTag.length | 0;
              }
            }
             else if (equals(tagData.get_11rb$('name'), 'mtable') || equals(tagData.get_11rb$('name'), 'mtr') || equals(tagData.get_11rb$('name'), 'mtd')) {
              currentPosition = currentPosition + actualTag.length | 0;
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_119, TransformationChainParser$splitOnMainLevelParts$lambda_120, currentLogLevel);
              if (parserState === TransformationChainParser$ParserState$EXPRESSION_START_getInstance()) {
                currentPartStartPosition = log_1.assignAndLog_746w4o$(currentPosition, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_121);
              }
            }
             else {
              currentPosition = currentPosition + actualTag.length | 0;
              log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_122, TransformationChainParser$splitOnMainLevelParts$lambda_123, currentLogLevel);
            }
            continue;
          }
           else {
            currentPosition = currentPosition + 1 | 0;
            parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$IN_EXPRESSION_getInstance(), currentLogLevel, parserState);
            continue;
          }
        }
      }
       else if (parserState === TransformationChainParser$ParserState$AFTER_ROW_END_getInstance()) {
        log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_124, void 0, currentLogLevel);
        if (remainingExpressionStartsWith('<mtr><mtd>', this.transformationChain, currentPosition)) {
          log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_125, TransformationChainParser$splitOnMainLevelParts$lambda_126, currentLogLevel);
          currentPosition = currentPosition + 10 | 0;
          currentPartStartPosition = log_1.assignAndLog_746w4o$(currentPosition, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_127);
          semanticRangeShift.addTagShift_vux9f0$(10, 12);
          if (currentMainLineNode.parent != null) {
            currentMainLineNode.addStartNewFactChain();
            log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_128, void 0, currentLogLevel);
          }
          parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$EXPRESSION_START_getInstance(), currentLogLevel, parserState);
          log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_129, TransformationChainParser$splitOnMainLevelParts$lambda_130, currentLogLevel);
          continue;
        }
         else if (remainingExpressionStartsWith('<\/mfenced>', this.transformationChain, currentPosition)) {
          log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_131, TransformationChainParser$splitOnMainLevelParts$lambda_132, currentLogLevel);
          if (currentPosition === currentMainLineNode.endPosition) {
            log_1.add_f1hiuo$(currentMainLineNode.parent == null ? 'null' : 'not null', TransformationChainParser$splitOnMainLevelParts$lambda_133, TransformationChainParser$splitOnMainLevelParts$lambda_134, currentLogLevel);
            tmp$_7 = currentMainLineNode.parent;
            if (tmp$_7 == null) {
              return new ParserError(currentPosition, 'Unexpected system closing');
            }
            currentMainLineNode = tmp$_7;
            currentPosition = currentPosition + 10 | 0;
            currentPartStartPosition = log_1.assignAndLog_746w4o$(currentPosition, currentLogLevel, TransformationChainParser$splitOnMainLevelParts$lambda_135);
            parserState = this.assignAndLogParserState_0(TransformationChainParser$ParserState$EXPRESSION_START_getInstance(), currentLogLevel, parserState);
          }
           else {
            currentPosition = currentPosition + 10 | 0;
          }
          log_1.add_f1hiuo$(currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_136, TransformationChainParser$splitOnMainLevelParts$lambda_137, currentLogLevel);
          continue;
        }
      }
      return new ParserError(currentPosition, 'Unexpected action');
    }
    log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_138, void 0, currentLogLevel);
    if (parserState !== TransformationChainParser$ParserState$IN_END_OF_FOLLOWING_STATEMENT_getInstance()) {
      log_1.addMessage_bda5c9$(TransformationChainParser$splitOnMainLevelParts$lambda_139, void 0, currentLogLevel);
      if (currentPartStartPosition < currentPosition) {
        log_1.add_gqvic5$(currentPartStartPosition, currentPosition, TransformationChainParser$splitOnMainLevelParts$lambda_140, TransformationChainParser$splitOnMainLevelParts$lambda_141, TransformationChainParser$splitOnMainLevelParts$lambda_142, currentLogLevel);
        if (this.parseExpressionComparisonOrExpressionChainFromTransformationChain_0(currentPartStartPosition, currentPosition, currentMainLineNode, semanticRangeShift.currentShiftKeepsSemantic_vux9f0$(currentPartStartPosition, currentPosition)) == null)
          if (!equals(ensureNotNull(this.parserError).description, this.somethingUnexpectedCode_0))
            return this.parserError;
      }
    }
    log_1.addMessageWithFactDetail_5zaetr$(TransformationChainParser$splitOnMainLevelParts$lambda_143, mainLineNode, void 0, currentLogLevel);
    return null;
  };
  function TransformationChainParser$parseRule$lambda() {
    return "parseRule '''";
  }
  function TransformationChainParser$parseRule$lambda_0() {
    return "'''";
  }
  function TransformationChainParser$parseRule$lambda_1(closure$currentLogLevel) {
    return function () {
      return 'Current log level: ' + closure$currentLogLevel;
    };
  }
  function TransformationChainParser$parseRule$lambda_2() {
    return "mrow cropped; currentPosition = '";
  }
  function TransformationChainParser$parseRule$lambda_3() {
    return "', currentEndPosition = '";
  }
  function TransformationChainParser$parseRule$lambda_4() {
    return "'";
  }
  function TransformationChainParser$parseRule$lambda_5() {
    return "ruleName = '";
  }
  function TransformationChainParser$parseRule$lambda_6() {
    return "' parsed; currentPosition = '";
  }
  function TransformationChainParser$parseRule$lambda_7() {
    return "'";
  }
  function TransformationChainParser$parseRule$lambda_8() {
    return 'currentPosition < currentEndPosition; parse rule fact';
  }
  function TransformationChainParser$parseRule$lambda_9() {
    return 'FACT_PARSER_ERROR: ';
  }
  function TransformationChainParser$parseRule$lambda_10() {
    return '';
  }
  function TransformationChainParser$parseRule$lambda_11() {
    return "Rule: '";
  }
  function TransformationChainParser$parseRule$lambda_12() {
    return "' added";
  }
  function TransformationChainParser$parseRule$lambda_13() {
    return "RulePointer: '";
  }
  function TransformationChainParser$parseRule$lambda_14() {
    return "' added";
  }
  function TransformationChainParser$parseRule$lambda_15() {
    return 'BLANK_RULE_POINTER_NAME_ERROR: ';
  }
  function TransformationChainParser$parseRule$lambda_16() {
    return '';
  }
  function TransformationChainParser$parseRule$lambda_17(it) {
    return it.toString();
  }
  function TransformationChainParser$parseRule$lambda_18() {
    return "current ruleChain: '''";
  }
  function TransformationChainParser$parseRule$lambda_19() {
    return "'''";
  }
  TransformationChainParser.prototype.parseRule_0 = function (startPosition, endPosition, ruleChain, parent) {
    var tmp$;
    log_1.add_f1hiuo$(this.transformationChain.substring(startPosition, endPosition), TransformationChainParser$parseRule$lambda, TransformationChainParser$parseRule$lambda_0, void 0, 1);
    var currentLogLevel = log_1.currentLevel;
    log_1.addMessage_bda5c9$(TransformationChainParser$parseRule$lambda_1(currentLogLevel), void 0, currentLogLevel);
    var currentPosition = startPosition;
    var currentEndPosition = endPosition;
    if (remainingExpressionStartsWith('<mrow>', this.transformationChain, currentPosition)) {
      currentPosition = currentPosition + 6 | 0;
      currentEndPosition = currentEndPosition - 7 | 0;
      log_1.add_gqvic5$(currentPosition, currentEndPosition, TransformationChainParser$parseRule$lambda_2, TransformationChainParser$parseRule$lambda_3, TransformationChainParser$parseRule$lambda_4, currentLogLevel);
    }
    if (remainingExpressionStartsWith('<mtext>', this.transformationChain, currentPosition)) {
      var nameStartPosition = currentPosition;
      currentPosition = currentPosition + 7 | 0;
      currentPosition = skipFromRemainingExpressionWhileClosingTagNotFound('mtext', this.transformationChain, currentPosition);
      if (elementAt(this.transformationChain, currentPosition - 1 | 0) === 58) {
        var $receiver = this.transformationChain;
        var startIndex = nameStartPosition + 7 | 0;
        var endIndex = currentPosition - 1 | 0;
        var name = $receiver.substring(startIndex, endIndex);
        currentPosition = currentPosition + 8 | 0;
        tmp$ = name;
      }
       else
        tmp$ = '';
    }
     else
      tmp$ = '';
    var ruleName = tmp$;
    log_1.add_gqvic5$(ruleName, currentPosition, TransformationChainParser$parseRule$lambda_5, TransformationChainParser$parseRule$lambda_6, TransformationChainParser$parseRule$lambda_7, currentLogLevel);
    if (currentPosition < currentEndPosition) {
      log_1.addMessage_bda5c9$(TransformationChainParser$parseRule$lambda_8, void 0, currentLogLevel);
      var ruleRoot = new MainLineAndNode(currentPosition, currentEndPosition, parent);
      var error = this.splitOnMainLevelParts_0(ruleRoot);
      if (error != null) {
        this.parserError = error;
        log_1.add_f1hiuo$(toString(this.parserError), TransformationChainParser$parseRule$lambda_9, TransformationChainParser$parseRule$lambda_10, currentLogLevel);
        return null;
      }
      ruleChain.add_11rb$(new Rule(startPosition, currentEndPosition, parent, ruleRoot, ruleName));
      log_1.add_f1hiuo$(last(ruleChain).toString(), TransformationChainParser$parseRule$lambda_11, TransformationChainParser$parseRule$lambda_12, currentLogLevel);
    }
     else {
      if (!isBlank(ruleName)) {
        ruleChain.add_11rb$(new RulePointer(startPosition, currentEndPosition, parent, ruleName));
        log_1.add_f1hiuo$(last(ruleChain).toString(), TransformationChainParser$parseRule$lambda_13, TransformationChainParser$parseRule$lambda_14, currentLogLevel);
      }
       else {
        this.parserError = new ParserError(startPosition, 'Unexpected rule end', endPosition);
        log_1.add_f1hiuo$(toString(this.parserError), TransformationChainParser$parseRule$lambda_15, TransformationChainParser$parseRule$lambda_16, currentLogLevel);
        return null;
      }
    }
    log_1.add_f1hiuo$(joinToString(ruleChain, void 0, void 0, void 0, void 0, void 0, TransformationChainParser$parseRule$lambda_17), TransformationChainParser$parseRule$lambda_18, TransformationChainParser$parseRule$lambda_19, currentLogLevel);
    return ruleChain;
  };
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda() {
    return "parseExpressionComparisonOrExpressionChain: '''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_0() {
    return "'''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_1() {
    return 'expressionChainExpected: ';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_2() {
    return '';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_3(closure$currentLogLevel) {
    return function () {
      return 'Current log level: ' + closure$currentLogLevel;
    };
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_4() {
    return 'Splitting_on_parts_started';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda$lambda() {
    return "part positions: from '";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda$lambda_0() {
    return "' to '";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda$lambda_1() {
    return "'; split by '";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda$lambda_2() {
    return "'";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda$lambda_3() {
    return "part string: '''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda$lambda_4() {
    return "'''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_5() {
    return 'Splitting_on_parts_ended';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_6() {
    return 'ExpressionComparison parsing start';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_7() {
    return "left expression = '''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_8() {
    return "''' parsing started";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_9() {
    return 'EXPRESSION_PARSER_ERROR: ';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_10() {
    return '';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_11() {
    return "left expression = '''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_12() {
    return "''' parsed";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_13() {
    return "right expression = '''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_14() {
    return "''' parsing started";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_15() {
    return 'EXPRESSION_PARSER_ERROR: ';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_16() {
    return '';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_17() {
    return "right expression = '''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_18() {
    return "''' parsed";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_19() {
    return "sign = '";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_20() {
    return "' parsed";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_21() {
    return 'parsed fact:';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_22() {
    return 'currentMainLineNode.addExpressionComparisonFact() called';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_23() {
    return 'unreachable place 2019_01_27_17_33';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_24() {
    return 'currentMainLineNode.addExpressionComparisonFact() called';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_25() {
    return 'ExpressionChain parsing start';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_26() {
    return "part string: '''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_27() {
    return "'''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_28() {
    return "rule link: '";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_29() {
    return "' found and parsed";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_30() {
    return 'fact_divider_details_mo found; parseRule';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_31() {
    return 'fact_divider_details_mfenced found; parseRule';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_32() {
    return 'EXPRESSION_PARSER_ERROR: ';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_33() {
    return '';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_34() {
    return "parsed part expression: '''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_35() {
    return "'''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_36() {
    return "part.splittingSign: '";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_37() {
    return "'";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_38() {
    return 'hasEquality';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_39() {
    return 'hasEquality';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_40() {
    return 'hasLeftMore';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_41() {
    return 'hasEquality';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_42() {
    return 'hasLeftLess';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_43() {
    return 'hasLeftMore';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_44() {
    return 'hasLeftLess';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_45() {
    return 'CHAIN_SIGN_ERROR: ';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_46() {
    return '';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_47() {
    return "result chain: '''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_48() {
    return "'''";
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_49() {
    return 'LESS_THEN_2_PARTS_ERROR: ';
  }
  function TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_50() {
    return '';
  }
  TransformationChainParser.prototype.parseExpressionComparisonOrExpressionChainFromTransformationChain_0 = function (startPosition, endPosition, currentMainLineNode, expressionChainExpected) {
    if (expressionChainExpected === void 0)
      expressionChainExpected = false;
    var tmp$, tmp$_0;
    var significantPart = this.transformationChain.substring(startPosition, endPosition);
    log_1.add_f1hiuo$(significantPart, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_0, void 0, 1);
    var currentLogLevel = log_1.currentLevel;
    log_1.add_f1hiuo$(expressionChainExpected, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_1, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_2, currentLogLevel);
    log_1.addMessage_bda5c9$(TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_3(currentLogLevel), void 0, currentLogLevel);
    log_1.addMessage_bda5c9$(TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_4, void 0, currentLogLevel);
    var allParts = splitBySubstringOnTopLevel(getAllComparisonTypeMathML(), this.transformationChain, startPosition, endPosition);
    var destination = ArrayList_init();
    var tmp$_1;
    tmp$_1 = allParts.iterator();
    while (tmp$_1.hasNext()) {
      var element = tmp$_1.next();
      var tmp$_0_0;
      log_1.add_sf5b3k$(element.startPosition, element.endPosition, toString(element.splittingSubstring), TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda$lambda, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda$lambda_0, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda$lambda_1, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda$lambda_2, currentLogLevel);
      var $receiver = this.transformationChain;
      var startIndex = element.startPosition;
      var endIndex = element.endPosition;
      var partString = trimmedMathML($receiver.substring(startIndex, endIndex));
      log_1.add_f1hiuo$(partString, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda$lambda_3, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda$lambda_4, currentLogLevel);
      if ((tmp$_0_0 = partString.length === 0 ? null : element) != null) {
        destination.add_11rb$(tmp$_0_0);
      }
    }
    var parts = destination;
    log_1.addMessage_bda5c9$(TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_5, void 0, currentLogLevel);
    if (parts.size === 2 && !expressionChainExpected) {
      log_1.addMessage_bda5c9$(TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_6, void 0, currentLogLevel);
      var $receiver_0 = this.transformationChain;
      var startIndex_0 = parts.get_za3lpa$(0).startPosition;
      var endIndex_0 = parts.get_za3lpa$(0).endPosition;
      var leftPartParser = new ExpressionTreeParser($receiver_0.substring(startIndex_0, endIndex_0), void 0, this.functionConfiguration, this.compiledImmediateVariableReplacements);
      var tmp$_2 = log_1;
      var $receiver_1 = this.transformationChain;
      var startIndex_1 = parts.get_za3lpa$(0).startPosition;
      var endIndex_1 = parts.get_za3lpa$(0).endPosition;
      tmp$_2.add_f1hiuo$($receiver_1.substring(startIndex_1, endIndex_1), TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_7, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_8, currentLogLevel);
      var error = leftPartParser.parse();
      if (error != null) {
        this.parserError = new ParserError(error.position + parts.get_za3lpa$(0).startPosition | 0, error.description, parts.get_za3lpa$(0).endPosition);
        log_1.add_f1hiuo$(toString(this.parserError), TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_9, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_10, currentLogLevel);
        return null;
      }
      log_1.add_f1hiuo$(leftPartParser.root, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_11, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_12, currentLogLevel);
      var $receiver_2 = this.transformationChain;
      var startIndex_2 = parts.get_za3lpa$(1).startPosition;
      var endIndex_2 = parts.get_za3lpa$(1).endPosition;
      var rightPartParser = new ExpressionTreeParser($receiver_2.substring(startIndex_2, endIndex_2), void 0, this.functionConfiguration, this.compiledImmediateVariableReplacements);
      var tmp$_3 = log_1;
      var $receiver_3 = this.transformationChain;
      var startIndex_3 = parts.get_za3lpa$(1).startPosition;
      var endIndex_3 = parts.get_za3lpa$(1).endPosition;
      tmp$_3.add_f1hiuo$($receiver_3.substring(startIndex_3, endIndex_3), TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_13, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_14, currentLogLevel);
      error = rightPartParser.parse();
      if (error != null) {
        this.parserError = new ParserError(error.position + parts.get_za3lpa$(1).startPosition | 0, error.description, parts.get_za3lpa$(1).endPosition);
        log_1.add_f1hiuo$(toString(this.parserError), TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_15, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_16, currentLogLevel);
        return null;
      }
      log_1.add_f1hiuo$(rightPartParser.root, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_17, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_18, currentLogLevel);
      var sign = valueFromMathMLString(ensureNotNull(parts.get_za3lpa$(0).splittingSubstring));
      log_1.add_f1hiuo$(sign, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_19, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_20, currentLogLevel);
      if (this.factsLogicConfiguration.alwaysLetTwoPartsComparisonsAsExpressionComparisons) {
        var result = new ExpressionComparison(startPosition, endPosition, new Expression(parts.get_za3lpa$(0).startPosition, parts.get_za3lpa$(0).endPosition, leftPartParser.root), new Expression(parts.get_za3lpa$(1).startPosition, parts.get_za3lpa$(1).endPosition, rightPartParser.root), sign);
        log_1.addMessageWithFactDetail_5zaetr$(TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_21, result, void 0, currentLogLevel);
        currentMainLineNode.addExpressionComparisonFact_5lkwds$(result);
        log_1.addMessage_bda5c9$(TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_22, void 0, currentLogLevel);
        return result;
      }
       else {
        log_1.addMessage_bda5c9$(TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_23, void 0, currentLogLevel);
        if (!true) {
          var result_0 = new ExpressionComparison(startPosition, endPosition, new Expression(parts.get_za3lpa$(0).startPosition, parts.get_za3lpa$(0).endPosition, leftPartParser.root), new Expression(parts.get_za3lpa$(1).startPosition, parts.get_za3lpa$(1).endPosition, rightPartParser.root), sign);
          currentMainLineNode.addExpressionComparisonFact_5lkwds$(result_0);
          log_1.addMessage_bda5c9$(TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_24, void 0, currentLogLevel);
          return result_0;
        }
      }
    }
     else if (parts.size >= 2) {
      log_1.addMessage_bda5c9$(TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_25, void 0, currentLogLevel);
      var expressions = ArrayList_init();
      var hasEquality = false;
      var hasLeftMore = false;
      var hasLeftLess = false;
      tmp$ = parts.iterator();
      while (tmp$.hasNext()) {
        var part = tmp$.next();
        var $receiver_4 = this.transformationChain;
        var startIndex_4 = part.startPosition;
        var endIndex_4 = part.endPosition;
        var partString_0 = $receiver_4.substring(startIndex_4, endIndex_4);
        log_1.add_f1hiuo$(partString_0, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_26, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_27, currentLogLevel);
        if (startsWith(partString_0, '<mtext>') && endsWith_0(partString_0, '<\/mtext>')) {
          var endIndex_5 = partString_0.length - 9 | 0;
          var ruleNameLink = partString_0.substring(7, endIndex_5);
          log_1.add_f1hiuo$(ruleNameLink, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_28, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_29, currentLogLevel);
          expressions.add_11rb$(new RulePointer(part.startPosition, part.endPosition, null, ruleNameLink));
        }
         else if (startsWith(partString_0, '<mo>[<\/mo>') && endsWith_0(partString_0, '<mo>]<\/mo>')) {
          log_1.addMessage_bda5c9$(TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_30, void 0, currentLogLevel);
          this.parseRule_0(part.startPosition + 10 | 0, part.endPosition - 10 | 0, expressions, null);
        }
         else if (startsWith(partString_0, '<mfenced open="[" close="]">') && endsWith_0(partString_0, '<\/mfenced>')) {
          log_1.addMessage_bda5c9$(TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_31, void 0, currentLogLevel);
          this.parseRule_0(part.startPosition + 28 | 0, part.endPosition - 10 | 0, expressions, null);
        }
         else {
          var partParser = new ExpressionTreeParser(partString_0, void 0, this.functionConfiguration, this.compiledImmediateVariableReplacements);
          var error_0 = partParser.parse();
          if (error_0 != null) {
            this.parserError = new ParserError(error_0.position + part.startPosition | 0, error_0.description, part.endPosition);
            log_1.add_f1hiuo$(toString(this.parserError), TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_32, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_33, currentLogLevel);
            return null;
          }
          log_1.add_f1hiuo$(partParser.root, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_34, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_35, currentLogLevel);
          log_1.add_f1hiuo$(toString(part.splittingSubstring), TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_36, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_37, currentLogLevel);
          if (part.splittingSubstring != null) {
            var sign_0 = valueFromMathMLString(ensureNotNull(part.splittingSubstring));
            switch (sign_0.name) {
              case 'EQUAL':
                hasEquality = log_1.assignAndLog_746w4o$(true, currentLogLevel, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_38);
                break;
              case 'LEFT_MORE_OR_EQUAL':
                hasEquality = log_1.assignAndLog_746w4o$(true, currentLogLevel, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_39);
                hasLeftMore = log_1.assignAndLog_746w4o$(true, currentLogLevel, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_40);
                break;
              case 'LEFT_LESS_OR_EQUAL':
                hasEquality = log_1.assignAndLog_746w4o$(true, currentLogLevel, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_41);
                hasLeftLess = log_1.assignAndLog_746w4o$(true, currentLogLevel, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_42);
                break;
              case 'LEFT_MORE':
                hasLeftMore = log_1.assignAndLog_746w4o$(true, currentLogLevel, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_43);
                break;
              case 'LEFT_LESS':
                hasLeftLess = log_1.assignAndLog_746w4o$(true, currentLogLevel, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_44);
                break;
            }
          }
          if (hasLeftMore && hasLeftLess) {
            this.parserError = new ParserError(startPosition, "Expression transformation chain cannot contains both signs '<' and '>'", endPosition);
            log_1.add_f1hiuo$(toString(this.parserError), TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_45, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_46, currentLogLevel);
            return null;
          }
          expressions.add_11rb$(new Expression(part.startPosition, part.endPosition, partParser.root));
        }
      }
      if (hasEquality) {
        tmp$_0 = hasLeftMore ? ComparisonType$LEFT_MORE_OR_EQUAL_getInstance() : hasLeftLess ? ComparisonType$LEFT_LESS_OR_EQUAL_getInstance() : ComparisonType$EQUAL_getInstance();
      }
       else
        tmp$_0 = hasLeftMore ? ComparisonType$LEFT_MORE_getInstance() : ComparisonType$LEFT_LESS_getInstance();
      var sign_1 = tmp$_0;
      var result_1 = new ExpressionChain(startPosition, endPosition, sign_1, expressions);
      currentMainLineNode.expressionTransformationChains.add_11rb$(result_1);
      log_1.add_f1hiuo$(result_1.toString(), TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_47, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_48, currentLogLevel);
      return result_1;
    }
    var actualTag = readOpenTagStringIfItPresent(this.transformationChain, startPosition);
    if (actualTag != null) {
      var tagData = getTagAttributes(actualTag);
      if (endsWith_0(significantPart, '<\/' + toString(tagData.get_11rb$('name')) + '>') && (equals(tagData.get_11rb$('name'), 'mfenced') || equals(tagData.get_11rb$('name'), 'mrow'))) {
        return this.parseExpressionComparisonOrExpressionChainFromTransformationChain_0(startPosition + actualTag.length | 0, endPosition - ('<\/' + toString(tagData.get_11rb$('name')) + '>').length | 0, currentMainLineNode, expressionChainExpected);
      }
    }
    this.parserError = new ParserError(startPosition, this.somethingUnexpectedCode_0, endPosition);
    log_1.add_f1hiuo$(toString(this.parserError), TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_49, TransformationChainParser$parseExpressionComparisonOrExpressionChainFromTransformationChain$lambda_50, currentLogLevel);
    return null;
  };
  TransformationChainParser.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'TransformationChainParser',
    interfaces: []
  };
  function MessageType(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function MessageType_initFields() {
    MessageType_initFields = function () {
    };
    MessageType$USER_instance = new MessageType('USER', 0);
    MessageType$TECHNICAL_instance = new MessageType('TECHNICAL', 1);
    MessageType$ALL_instance = new MessageType('ALL', 2);
  }
  var MessageType$USER_instance;
  function MessageType$USER_getInstance() {
    MessageType_initFields();
    return MessageType$USER_instance;
  }
  var MessageType$TECHNICAL_instance;
  function MessageType$TECHNICAL_getInstance() {
    MessageType_initFields();
    return MessageType$TECHNICAL_instance;
  }
  var MessageType$ALL_instance;
  function MessageType$ALL_getInstance() {
    MessageType_initFields();
    return MessageType$ALL_instance;
  }
  MessageType.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'MessageType',
    interfaces: [Enum]
  };
  function MessageType$values() {
    return [MessageType$USER_getInstance(), MessageType$TECHNICAL_getInstance(), MessageType$ALL_getInstance()];
  }
  MessageType.values = MessageType$values;
  function MessageType$valueOf(name) {
    switch (name) {
      case 'USER':
        return MessageType$USER_getInstance();
      case 'TECHNICAL':
        return MessageType$TECHNICAL_getInstance();
      case 'ALL':
        return MessageType$ALL_getInstance();
      default:throwISE('No enum constant logs.MessageType.' + name);
    }
  }
  MessageType.valueOf_61zpoe$ = MessageType$valueOf;
  function LazyMessage(message, messageType, level) {
    this.messageType = messageType;
    this.level = level;
    this.message_jzidzn$_0 = lazy(LazyMessage$message$lambda(message));
  }
  Object.defineProperty(LazyMessage.prototype, 'message', {
    get: function () {
      return this.message_jzidzn$_0.value;
    }
  });
  function LazyMessage$message$lambda(closure$message) {
    return function () {
      return closure$message();
    };
  }
  LazyMessage.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'LazyMessage',
    interfaces: []
  };
  function LazyLog() {
    this.factConstructorViewer = new FactConstructorViewer();
    this.log = ArrayList_init();
    this.currentLevel = 0;
  }
  LazyLog.prototype.addMessage_bda5c9$ = function (message, messageType, level, levelChange) {
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    if (level === void 0)
      level = null;
    if (levelChange === void 0)
      levelChange = 0;
    this.changeLevel_2c627j$(level, levelChange);
    this.log.add_11rb$(new LazyMessage(message, messageType, this.currentLevel));
  };
  function LazyLog$addMessageWithFactDetail$lambda(closure$fact, this$LazyLog) {
    return function () {
      return this$LazyLog.factToUserString_0(closure$fact);
    };
  }
  function LazyLog$addMessageWithFactDetail$lambda_0(closure$fact, this$LazyLog) {
    return function () {
      return this$LazyLog.factToTechnicalString_0(closure$fact);
    };
  }
  LazyLog.prototype.addMessageWithFactDetail_5zaetr$ = function (message, fact, messageType, level, levelChange) {
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    if (level === void 0)
      level = null;
    if (levelChange === void 0)
      levelChange = 0;
    this.changeLevel_2c627j$(level, levelChange);
    this.log.add_11rb$(new LazyMessage(message, messageType, this.currentLevel));
    this.log.add_11rb$(new LazyMessage(LazyLog$addMessageWithFactDetail$lambda(fact, this), messageType, this.currentLevel + 1 | 0));
    this.log.add_11rb$(new LazyMessage(LazyLog$addMessageWithFactDetail$lambda_0(fact, this), MessageType$TECHNICAL_getInstance(), this.currentLevel + 1 | 0));
  };
  function LazyLog$addMessageWithFactShort$lambda(closure$message, closure$fact, this$LazyLog) {
    return function () {
      return closure$message() + ("'" + this$LazyLog.factToUserString_0(closure$fact) + "'");
    };
  }
  LazyLog.prototype.addMessageWithFactShort_5zaetr$ = function (message, fact, messageType, level, levelChange) {
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    if (level === void 0)
      level = null;
    if (levelChange === void 0)
      levelChange = 0;
    this.changeLevel_2c627j$(level, levelChange);
    this.log.add_11rb$(new LazyMessage(LazyLog$addMessageWithFactShort$lambda(message, fact, this), messageType, this.currentLevel));
  };
  function LazyLog$addMessageWithFactSubstitutionDetail$lambda() {
    return 'Left: ';
  }
  function LazyLog$addMessageWithFactSubstitutionDetail$lambda_0() {
    return 'Right: ';
  }
  LazyLog.prototype.addMessageWithFactSubstitutionDetail_v23yj3$ = function (message, substitution, messageType, level, levelChange) {
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    if (level === void 0)
      level = null;
    if (levelChange === void 0)
      levelChange = 0;
    this.changeLevel_2c627j$(level, levelChange);
    this.log.add_11rb$(new LazyMessage(message, messageType, this.currentLevel));
    this.addMessageWithFactDetail_5zaetr$(LazyLog$addMessageWithFactSubstitutionDetail$lambda, substitution.left, messageType);
    this.addMessageWithFactDetail_5zaetr$(LazyLog$addMessageWithFactSubstitutionDetail$lambda_0, substitution.right, messageType);
  };
  function LazyLog$addMessageWithFactSubstitutionShort$lambda(closure$message, closure$substitution, this$LazyLog) {
    return function () {
      return closure$message() + ("'" + this$LazyLog.factToUserString_0(closure$substitution.left) + "' -> '" + this$LazyLog.factToUserString_0(closure$substitution.right) + "'");
    };
  }
  LazyLog.prototype.addMessageWithFactSubstitutionShort_v23yj3$ = function (message, substitution, messageType, level, levelChange) {
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    if (level === void 0)
      level = null;
    if (levelChange === void 0)
      levelChange = 0;
    this.changeLevel_2c627j$(level, levelChange);
    this.log.add_11rb$(new LazyMessage(LazyLog$addMessageWithFactSubstitutionShort$lambda(message, substitution, this), messageType, this.currentLevel));
  };
  function LazyLog$addMessageWithExpression$lambda(closure$message, closure$expressionNode, this$LazyLog) {
    return function () {
      return closure$message() + ("'" + this$LazyLog.expressionToString_0(closure$expressionNode) + "'");
    };
  }
  LazyLog.prototype.addMessageWithExpression_kf0d7z$ = function (message, expressionNode, messageType, level, levelChange) {
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    if (level === void 0)
      level = null;
    if (levelChange === void 0)
      levelChange = 0;
    this.changeLevel_2c627j$(level, levelChange);
    this.log.add_11rb$(new LazyMessage(LazyLog$addMessageWithExpression$lambda(message, expressionNode, this), messageType, this.currentLevel));
  };
  function LazyLog$addMessageWithExpressionSubstitutionShort$lambda(closure$message, closure$substitution, this$LazyLog) {
    return function () {
      return closure$message() + ("'" + this$LazyLog.expressionToString_0(closure$substitution.left) + "' -> '" + this$LazyLog.expressionToString_0(closure$substitution.right) + "'");
    };
  }
  LazyLog.prototype.addMessageWithExpressionSubstitutionShort_ht2yvq$ = function (message, substitution, messageType, level, levelChange) {
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    if (level === void 0)
      level = null;
    if (levelChange === void 0)
      levelChange = 0;
    this.changeLevel_2c627j$(level, levelChange);
    this.log.add_11rb$(new LazyMessage(LazyLog$addMessageWithExpressionSubstitutionShort$lambda(message, substitution, this), messageType, this.currentLevel));
  };
  LazyLog.prototype.changeLevel_2c627j$ = function (newLevel, levelChange) {
    if (newLevel === void 0)
      newLevel = null;
    if (levelChange === void 0)
      levelChange = 0;
    this.currentLevel = newLevel != null ? newLevel : this.currentLevel + levelChange | 0;
  };
  LazyLog.prototype.getLogInPlainText_ouivre$ = function (messageType, maxLevel, returnLogWithLogLevel, logLevelPrefixInPlainText, levelChangeShift, suffixChar) {
    if (messageType === void 0)
      messageType = MessageType$ALL_getInstance();
    if (maxLevel === void 0)
      maxLevel = 2147483647;
    if (returnLogWithLogLevel === void 0)
      returnLogWithLogLevel = true;
    if (logLevelPrefixInPlainText === void 0)
      logLevelPrefixInPlainText = 'LL_';
    if (levelChangeShift === void 0)
      levelChangeShift = '|   ';
    if (suffixChar === void 0)
      suffixChar = 32;
    var tmp$;
    var result = new StringBuilder("Log type = '" + messageType.toString() + "', max message level = '" + maxLevel + "'" + '\n');
    var messages = this.filterMessages_gbs7d8$(messageType, maxLevel);
    var maxLevelNumberLength = maxLevel.toString().length;
    tmp$ = messages.iterator();
    while (tmp$.hasNext()) {
      var message = tmp$.next();
      if (returnLogWithLogLevel) {
        result.append_gw00v9$(logLevelPrefixInPlainText);
        result.append_gw00v9$(toStringWithMinLength(message.level, maxLevelNumberLength, 32));
      }
      result.append_gw00v9$(repeat(levelChangeShift, message.level));
      result.append_gw00v9$(message.message);
      result.append_s8itvh$(10);
    }
    return result.toString();
  };
  LazyLog.prototype.getLogInJson_gbs7d8$ = function (messageType, maxLevel) {
    if (messageType === void 0)
      messageType = MessageType$ALL_getInstance();
    if (maxLevel === void 0)
      maxLevel = 2147483647;
    var tmp$;
    var result = new StringBuilder('{' + '"' + 'logType_' + messageType + '__MaxMessageLevel_' + maxLevel + '"' + ':[');
    var messages = this.filterMessages_gbs7d8$(messageType, maxLevel);
    var currentLevel = 0;
    tmp$ = messages.iterator();
    while (tmp$.hasNext()) {
      var message = tmp$.next();
      while (message.level > currentLevel) {
        result.append_gw00v9$('{"message":"root", "details":[');
        currentLevel = currentLevel + 1 | 0;
      }
      while (message.level < currentLevel) {
        result.append_gw00v9$(']}');
        currentLevel = currentLevel - 1 | 0;
      }
      if (message.level === currentLevel) {
        if (last_0(result) === 125) {
          result.append_s8itvh$(44);
        }
        result.append_gw00v9$('{' + '"' + 'message' + '"' + ':' + '"' + replace_0(message.message, 34, 39) + '"' + ', ' + '"' + 'details' + '"' + ':[');
        currentLevel = currentLevel + 1 | 0;
      }
    }
    while (0 < currentLevel) {
      result.append_gw00v9$(']}');
      currentLevel = currentLevel - 1 | 0;
    }
    result.append_gw00v9$(']}');
    return result.toString();
  };
  LazyLog.prototype.filterMessages_gbs7d8$ = function (messageType, maxLevel) {
    var tmp$;
    if (equals(messageType, MessageType$ALL_getInstance()))
      tmp$ = this.log;
    else {
      var $receiver = this.log;
      var destination = ArrayList_init();
      var tmp$_0;
      tmp$_0 = $receiver.iterator();
      while (tmp$_0.hasNext()) {
        var element = tmp$_0.next();
        if (element.messageType === messageType)
          destination.add_11rb$(element);
      }
      tmp$ = destination;
    }
    var $receiver_0 = tmp$;
    var destination_0 = ArrayList_init();
    var tmp$_1;
    tmp$_1 = $receiver_0.iterator();
    while (tmp$_1.hasNext()) {
      var element_0 = tmp$_1.next();
      if (element_0.level <= maxLevel)
        destination_0.add_11rb$(element_0);
    }
    return destination_0;
  };
  LazyLog.prototype.clear = function () {
    this.currentLevel = 0;
    this.log.clear();
  };
  LazyLog.prototype.factToUserString_0 = function (fact) {
    return this.factConstructorViewer.constructFactUserView_5lkwds$(fact);
  };
  LazyLog.prototype.factToTechnicalString_0 = function (fact) {
    return this.factConstructorViewer.constructIdentifierByFact_5lkwds$(fact);
  };
  LazyLog.prototype.expressionToString_0 = function (expressionNode) {
    return expressionNode.toString();
  };
  function LazyLog$add$lambda(closure$prefix, closure$value, closure$suffix) {
    return function () {
      return closure$prefix() + closure$value.toString() + closure$suffix();
    };
  }
  LazyLog.prototype.add_f1hiuo$ = function (value, prefix, suffix, level, levelChange, messageType) {
    if (level === void 0)
      level = null;
    if (levelChange === void 0)
      levelChange = 0;
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    this.addMessage_bda5c9$(LazyLog$add$lambda(prefix, value, suffix), messageType, level, levelChange);
  };
  function LazyLog$add$lambda_0(closure$prefix, closure$value1, closure$middle, closure$value2, closure$suffix) {
    return function () {
      return closure$prefix() + closure$value1.toString() + closure$middle() + closure$value2.toString() + closure$suffix();
    };
  }
  LazyLog.prototype.add_gqvic5$ = function (value1, value2, prefix, middle, suffix, level, levelChange, messageType) {
    if (level === void 0)
      level = null;
    if (levelChange === void 0)
      levelChange = 0;
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    this.addMessage_bda5c9$(LazyLog$add$lambda_0(prefix, value1, middle, value2, suffix), messageType, level, levelChange);
  };
  function LazyLog$add$lambda_1(closure$prefix, closure$value1, closure$middle1, closure$value2, closure$middle2, closure$value3, closure$suffix) {
    return function () {
      return closure$prefix() + closure$value1.toString() + closure$middle1() + closure$value2.toString() + closure$middle2() + closure$value3.toString() + closure$suffix();
    };
  }
  LazyLog.prototype.add_sf5b3k$ = function (value1, value2, value3, prefix, middle1, middle2, suffix, level, levelChange, messageType) {
    if (level === void 0)
      level = null;
    if (levelChange === void 0)
      levelChange = 0;
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    this.addMessage_bda5c9$(LazyLog$add$lambda_1(prefix, value1, middle1, value2, middle2, value3, suffix), messageType, level, levelChange);
  };
  function LazyLog$assignAndLog$lambda(closure$variableName, closure$data) {
    return function () {
      return closure$variableName() + " = '" + toString(closure$data) + "'";
    };
  }
  LazyLog.prototype.assignAndLog_746w4o$ = function (data, logLevel, variableName) {
    this.addMessage_bda5c9$(LazyLog$assignAndLog$lambda(variableName, data), void 0, logLevel);
    return data;
  };
  function LazyLog$logCheckParams$lambda() {
    return 'function parameters:';
  }
  function LazyLog$logCheckParams$lambda_0(closure$onExpressionLevel) {
    return function () {
      return "onExpressionLevel: '" + toString(closure$onExpressionLevel) + "'";
    };
  }
  function LazyLog$logCheckParams$lambda_1() {
    return 'factsTransformations';
  }
  function LazyLog$logCheckParams$lambda_2(closure$j, closure$factsTransformation) {
    return function () {
      return closure$j.toString() + '. ' + closure$factsTransformation.name + ':';
    };
  }
  function LazyLog$logCheckParams$lambda_3() {
    return 'expressionTransformations';
  }
  function LazyLog$logCheckParams$lambda_4(closure$j, closure$expressionTransformation) {
    return function () {
      return closure$j.toString() + '. ' + closure$expressionTransformation.code + ':';
    };
  }
  function LazyLog$logCheckParams$lambda_5() {
    return 'additionalFacts';
  }
  function LazyLog$logCheckParams$lambda_6(closure$j) {
    return function () {
      return closure$j.toString() + '. ';
    };
  }
  LazyLog.prototype.logCheckParams_f38nyx$ = function (onExpressionLevel, factsTransformations, expressionTransformations, additionalFacts, messageType) {
    if (onExpressionLevel === void 0)
      onExpressionLevel = null;
    if (factsTransformations === void 0)
      factsTransformations = null;
    if (expressionTransformations === void 0)
      expressionTransformations = null;
    if (additionalFacts === void 0)
      additionalFacts = null;
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    var tmp$, tmp$_0, tmp$_1;
    var originalLogLevel = this.currentLevel;
    this.addMessage_bda5c9$(LazyLog$logCheckParams$lambda, messageType);
    this.currentLevel = this.currentLevel + 1 | 0;
    this.addMessage_bda5c9$(LazyLog$logCheckParams$lambda_0(onExpressionLevel), messageType);
    this.addMessage_bda5c9$(LazyLog$logCheckParams$lambda_1, messageType, originalLogLevel + 1 | 0);
    var i = 0;
    if (factsTransformations != null) {
      tmp$ = factsTransformations.iterator();
      while (tmp$.hasNext()) {
        var factsTransformation = tmp$.next();
        var j = i;
        this.addMessageWithFactSubstitutionDetail_v23yj3$(LazyLog$logCheckParams$lambda_2(j, factsTransformation), factsTransformation, messageType, originalLogLevel + 2 | 0);
        i = i + 1 | 0;
      }
    }
    this.addMessage_bda5c9$(LazyLog$logCheckParams$lambda_3, void 0, originalLogLevel + 1 | 0);
    if (expressionTransformations != null) {
      i = 0;
      tmp$_0 = expressionTransformations.iterator();
      while (tmp$_0.hasNext()) {
        var expressionTransformation = tmp$_0.next();
        var j_0 = i;
        this.addMessageWithExpressionSubstitutionShort_ht2yvq$(LazyLog$logCheckParams$lambda_4(j_0, expressionTransformation), expressionTransformation, messageType, originalLogLevel + 2 | 0);
        i = i + 1 | 0;
      }
    }
    this.addMessage_bda5c9$(LazyLog$logCheckParams$lambda_5, void 0, originalLogLevel + 1 | 0);
    if (additionalFacts != null) {
      i = 0;
      tmp$_1 = additionalFacts.iterator();
      while (tmp$_1.hasNext()) {
        var additionalFact = tmp$_1.next();
        var j_1 = i;
        this.addMessageWithFactDetail_5zaetr$(LazyLog$logCheckParams$lambda_6(j_1), additionalFact, messageType, originalLogLevel + 2 | 0);
        i = i + 1 | 0;
      }
    }
    this.currentLevel = originalLogLevel;
  };
  function LazyLog$logSystemFacts$lambda(closure$message) {
    return function () {
      return closure$message() + ' AND system facts:';
    };
  }
  function LazyLog$logSystemFacts$lambda_0(closure$message) {
    return function () {
      return closure$message() + ' OR system facts:';
    };
  }
  function LazyLog$logSystemFacts$lambda_1(closure$j) {
    return function () {
      return closure$j.toString() + '. ';
    };
  }
  LazyLog.prototype.logSystemFacts_zi2lc5$ = function (type, facts, message, messageType) {
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    var tmp$;
    var originalLogLevel = this.currentLevel;
    if (type === ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance()) {
      this.addMessage_bda5c9$(LazyLog$logSystemFacts$lambda(message), messageType);
    }
     else {
      this.addMessage_bda5c9$(LazyLog$logSystemFacts$lambda_0(message), messageType);
    }
    if (facts != null) {
      var i = 0;
      tmp$ = facts.iterator();
      while (tmp$.hasNext()) {
        var additionalFact = tmp$.next();
        var j = i;
        this.addMessageWithFactDetail_5zaetr$(LazyLog$logSystemFacts$lambda_1(j), additionalFact, messageType, originalLogLevel + 1 | 0);
        i = i + 1 | 0;
      }
    }
    this.currentLevel = originalLogLevel;
  };
  function LazyLog$logFactsCompareAsIsParams$lambda() {
    return 'Left fact: ';
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_0() {
    return 'Right fact: ';
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_1(closure$j) {
    return function () {
      return closure$j.toString() + '. ';
    };
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_2(closure$maxTransformationWeight) {
    return function () {
      return "maxTransformationWeight: '" + closure$maxTransformationWeight + "'";
    };
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_3(closure$maxBustCount) {
    return function () {
      return "maxBustCount: '" + closure$maxBustCount + "'";
    };
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_4(closure$minPossibleTransformationWeight) {
    return function () {
      return "compareExpressionsWithProbabilityTest: '" + closure$minPossibleTransformationWeight + "'";
    };
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_5() {
    return 'additionalFactsSortedIdentifiers:';
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_6(it) {
    return it ? '1' : '0';
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_7() {
    return "additionalFactUsed: '";
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_8() {
    return "'";
  }
  LazyLog.prototype.logFactsCompareAsIsParams_9vkx2o$ = function (left, right, additionalFacts, maxTransformationWeight, maxBustCount, minPossibleTransformationWeight, additionalFactUsed, messageType) {
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    var tmp$;
    var originalLogLevel = this.currentLevel;
    this.addMessageWithFactDetail_5zaetr$(LazyLog$logFactsCompareAsIsParams$lambda, left, messageType, originalLogLevel + 1 | 0);
    this.addMessageWithFactDetail_5zaetr$(LazyLog$logFactsCompareAsIsParams$lambda_0, right, messageType, originalLogLevel + 1 | 0);
    var i = 0;
    tmp$ = additionalFacts.iterator();
    while (tmp$.hasNext()) {
      var additionalFact = tmp$.next();
      var j = i;
      this.addMessageWithFactDetail_5zaetr$(LazyLog$logFactsCompareAsIsParams$lambda_1(j), additionalFact, messageType, originalLogLevel + 1 | 0);
      i = i + 1 | 0;
    }
    this.addMessage_bda5c9$(LazyLog$logFactsCompareAsIsParams$lambda_2(maxTransformationWeight), messageType, originalLogLevel + 1 | 0);
    this.addMessage_bda5c9$(LazyLog$logFactsCompareAsIsParams$lambda_3(maxBustCount), messageType, originalLogLevel + 1 | 0);
    this.addMessage_bda5c9$(LazyLog$logFactsCompareAsIsParams$lambda_4(minPossibleTransformationWeight), messageType, originalLogLevel + 1 | 0);
    this.addMessage_bda5c9$(LazyLog$logFactsCompareAsIsParams$lambda_5, messageType, originalLogLevel + 1 | 0);
    this.add_f1hiuo$(joinToString(additionalFactUsed, void 0, void 0, void 0, void 0, void 0, LazyLog$logFactsCompareAsIsParams$lambda_6), LazyLog$logFactsCompareAsIsParams$lambda_7, LazyLog$logFactsCompareAsIsParams$lambda_8, originalLogLevel + 1 | 0, void 0, messageType);
    this.currentLevel = originalLogLevel;
  };
  function LazyLog$logFactsCompareAsIsParams$lambda_9() {
    return 'Left fact: ';
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_10() {
    return 'Right fact: ';
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_11(closure$compareExpressionsWithProbabilityTest) {
    return function () {
      return "compareExpressionsWithProbabilityTest: '" + toString(closure$compareExpressionsWithProbabilityTest) + "'";
    };
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_12() {
    return 'additionalFactsSortedIdentifiers:';
  }
  function LazyLog$logFactsCompareAsIsParams$lambda_13(closure$j, closure$additionalFactsSortedIdentifiers) {
    return function () {
      return closure$j.toString() + ". '''" + closure$additionalFactsSortedIdentifiers + "'''";
    };
  }
  LazyLog.prototype.logFactsCompareAsIsParams_eu4irh$ = function (left, right, additionalFactsSortedIdentifiers, compareExpressionsWithProbabilityTest, messageType) {
    if (compareExpressionsWithProbabilityTest === void 0)
      compareExpressionsWithProbabilityTest = null;
    if (messageType === void 0)
      messageType = MessageType$TECHNICAL_getInstance();
    var tmp$;
    var originalLogLevel = this.currentLevel;
    this.addMessageWithFactDetail_5zaetr$(LazyLog$logFactsCompareAsIsParams$lambda_9, left, messageType, originalLogLevel + 1 | 0);
    this.addMessageWithFactDetail_5zaetr$(LazyLog$logFactsCompareAsIsParams$lambda_10, right, messageType, originalLogLevel + 1 | 0);
    if (compareExpressionsWithProbabilityTest != null) {
      this.addMessage_bda5c9$(LazyLog$logFactsCompareAsIsParams$lambda_11(compareExpressionsWithProbabilityTest), messageType, originalLogLevel + 1 | 0);
    }
    this.addMessage_bda5c9$(LazyLog$logFactsCompareAsIsParams$lambda_12, messageType, originalLogLevel + 1 | 0);
    var i = 0;
    tmp$ = additionalFactsSortedIdentifiers.iterator();
    while (tmp$.hasNext()) {
      var additionalFactsSortedIdentifier = tmp$.next();
      var j = i;
      this.addMessage_bda5c9$(LazyLog$logFactsCompareAsIsParams$lambda_13(j, additionalFactsSortedIdentifiers), messageType, originalLogLevel + 2 | 0);
      i = i + 1 | 0;
    }
    this.currentLevel = originalLogLevel;
  };
  LazyLog.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'LazyLog',
    interfaces: []
  };
  var log_1;
  function checkFactsInMathML$lambda(closure$brushedMathML) {
    return function () {
      return "input transformations in mathML: '''" + closure$brushedMathML + "'''";
    };
  }
  function checkFactsInMathML$lambda_0(closure$mathML) {
    return function () {
      return "input transformations in mathML without brushing: '''" + closure$mathML + "'''";
    };
  }
  function checkFactsInMathML$lambda_1() {
    return 'input transformations parsing started';
  }
  function checkFactsInMathML$lambda_2() {
    return 'input transformations are parsed successfully';
  }
  function checkFactsInMathML$lambda_3() {
    return 'parsed input transformations: ';
  }
  function checkFactsInMathML$lambda_4() {
    return 'input transformations checking started';
  }
  function checkFactsInMathML$lambda_5(closure$checkingResult) {
    return function () {
      return "input transformations checking result: '" + (closure$checkingResult.isCorrect ? 'correct' : 'incorrect - ' + closure$checkingResult.description) + "'";
    };
  }
  function checkFactsInMathML$lambda_6(closure$result) {
    return function () {
      return "transformations in mathML after brushing: '''" + closure$result + "'''";
    };
  }
  function checkFactsInMathML$lambda_7(closure$error) {
    return function () {
      return closure$error.description;
    };
  }
  function checkFactsInMathML$lambda_8(closure$error) {
    return function () {
      return closure$error.description;
    };
  }
  function checkFactsInMathML$lambda_9(closure$variable) {
    return function () {
      return "variable '" + closure$variable + "' is not expressed";
    };
  }
  function checkFactsInMathML$lambda_10(closure$error) {
    return function () {
      return closure$error.description;
    };
  }
  function checkFactsInMathML$lambda_11(closure$error) {
    return function () {
      return closure$error.description;
    };
  }
  function checkFactsInMathML$lambda_12() {
    return 'Answer checked successfully';
  }
  function checkFactsInMathML_0(brushedMathML, wellKnownFunctions, expressionTransformationRules, targetFactIdentifier, targetVariablesNames, minNumberOfMultipliersInAnswer, maxNumberOfDivisionsInAnswer, additionalFactsIdentifiers, maxExpressionTransformationWeight, unlimitedWellKnownFunctions, shortErrorDescription, taskContextExpressionTransformationRules, allowedVariablesNames, maxDistBetweenDiffSteps, forbiddenFunctions, scopeFilter) {
    if (wellKnownFunctions === void 0)
      wellKnownFunctions = '+;;;-1;;;-;;;-1;;;*;;;-1;;;/;;;-1';
    if (expressionTransformationRules === void 0)
      expressionTransformationRules = 'S(i, a, a, f(i));;;f(a);;;S(i, a, b, f(i));;;S(i, a, b-1, f(i)) + f(b)';
    if (targetFactIdentifier === void 0)
      targetFactIdentifier = '';
    if (targetVariablesNames === void 0)
      targetVariablesNames = '';
    if (minNumberOfMultipliersInAnswer === void 0)
      minNumberOfMultipliersInAnswer = '';
    if (maxNumberOfDivisionsInAnswer === void 0)
      maxNumberOfDivisionsInAnswer = '';
    if (additionalFactsIdentifiers === void 0)
      additionalFactsIdentifiers = '';
    if (maxExpressionTransformationWeight === void 0)
      maxExpressionTransformationWeight = '1.0';
    if (unlimitedWellKnownFunctions === void 0)
      unlimitedWellKnownFunctions = wellKnownFunctions;
    if (shortErrorDescription === void 0)
      shortErrorDescription = '0';
    if (taskContextExpressionTransformationRules === void 0)
      taskContextExpressionTransformationRules = '';
    if (allowedVariablesNames === void 0)
      allowedVariablesNames = '';
    if (maxDistBetweenDiffSteps === void 0)
      maxDistBetweenDiffSteps = '';
    if (forbiddenFunctions === void 0)
      forbiddenFunctions = '';
    if (scopeFilter === void 0)
      scopeFilter = '';
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4;
    log_1.clear();
    var compiledConfiguration = compiledConfigurationBySettings(wellKnownFunctions, expressionTransformationRules, maxExpressionTransformationWeight, unlimitedWellKnownFunctions, taskContextExpressionTransformationRules, maxDistBetweenDiffSteps, scopeFilter);
    log_1.factConstructorViewer = new FactConstructorViewer(compiledConfiguration);
    log_1.addMessage_bda5c9$(checkFactsInMathML$lambda(brushedMathML), void 0, 0);
    var mathMLWithoutUnexpectedCodes = replaceSpaceMathMLAliases(brushedMathML);
    var mathMLWithoutSuffix = deleteErrorStringFromMathMLSolution(mathMLWithoutUnexpectedCodes, listOf_0([errorPrefix, syntaxErrorPrefix]));
    var mathMLWithoutBrushing = dropPerformedMathMLBrushing(mathMLWithoutSuffix);
    var mathMLWithoutSupportingTags = deleteUnsupportedMathMLTags(mathMLWithoutBrushing);
    var mathMLAfterSpecificSystemReplacements = specificMathMlSystemReplacements(mathMLWithoutSupportingTags);
    var mathML = correctMathMlTagsAccordingToBracketsFromEnd(mathMLAfterSpecificSystemReplacements);
    if (contains_0(mathML, 'error', true) && contains_0(mathML, '#FF')) {
      return mathML;
    }
    log_1.addMessage_bda5c9$(checkFactsInMathML$lambda_0(mathML), void 0, 0);
    var transformationChainParser = new TransformationChainParser(mathML, false, compiledConfiguration.functionConfiguration, compiledConfiguration.factsLogicConfiguration, compiledConfiguration.compiledImmediateVariableReplacements);
    log_1.addMessage_bda5c9$(checkFactsInMathML$lambda_1, MessageType$USER_getInstance(), 0);
    var error = transformationChainParser.parse();
    if (error != null) {
      return returnParsingError(error, mathML);
    }
     else {
      log_1.addMessage_bda5c9$(checkFactsInMathML$lambda_2, MessageType$USER_getInstance(), 0);
      log_1.addMessageWithFactDetail_5zaetr$(checkFactsInMathML$lambda_3, transformationChainParser.root, MessageType$USER_getInstance());
      var factComporator = compiledConfiguration.factComporator;
      var solutionRoot = combineSolutionRoot(targetFactIdentifier, transformationChainParser, compiledConfiguration);
      log_1.addMessage_bda5c9$(checkFactsInMathML$lambda_4, MessageType$USER_getInstance(), 0);
      var checkingResult = solutionRoot.check_l8pk6u$(factComporator, false, emptyList(), emptyList(), additionalFactsFromItsIdentifiers(log_1.factConstructorViewer, additionalFactsIdentifiers));
      log_1.addMessage_bda5c9$(checkFactsInMathML$lambda_5(checkingResult), MessageType$USER_getInstance(), 0);
      var resultWithColoredTasks = brushMathMl(transformationChainParser.originalTransformationChain, checkingResult.coloringTasks);
      var result = setBackgroundColorMathMl(resultWithColoredTasks, compiledConfiguration.checkedFactAccentuation.checkedFactColor.checkedFactBackgroundColor);
      log_1.addMessage_bda5c9$(checkFactsInMathML$lambda_6(result), void 0, 0);
      if (!checkingResult.isCorrect) {
        if (!startsWith(brushedMathML, '<')) {
          return errorPrefix + ': ' + checkingResult.description;
        }
        if (equals(shortErrorDescription, '1')) {
          tmp$ = addErrorStringToMathMLSolution(result, 'Unclear transformation or incomplete solution. Try to fix errors or to write more details.', errorPrefix);
        }
         else
          tmp$ = addErrorStringToMathMLSolution(result, checkingResult.description, errorPrefix);
        return tmp$;
      }
      if (!isBlank(minNumberOfMultipliersInAnswer)) {
        var minNumberOfMultipliers = toInt(minNumberOfMultipliersInAnswer);
        var $receiver = split(targetVariablesNames, [configSeparator]);
        var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
        var tmp$_5;
        tmp$_5 = $receiver.iterator();
        while (tmp$_5.hasNext()) {
          var item = tmp$_5.next();
          var tmp$_6;
          destination.add_11rb$(trim(Kotlin.isCharSequence(tmp$_6 = item) ? tmp$_6 : throwCCE()).toString());
        }
        var targetVariables = toSet(destination);
        var targetExpression = (Kotlin.isType(tmp$_0 = log_1.factConstructorViewer.constructFactByIdentifier_7q4i4t$(targetFactIdentifier), Expression) ? tmp$_0 : throwCCE()).data;
        var error_0 = solutionRoot.isFactorizationForVariables_3b7jn6$(minNumberOfMultipliers, targetVariables, targetExpression, factComporator);
        if (error_0 != null) {
          log_1.addMessage_bda5c9$(checkFactsInMathML$lambda_7(error_0), MessageType$USER_getInstance(), 0);
          return addErrorStringToMathMLSolution(result, error_0.description, errorPrefix);
        }
      }
       else {
        if (!isBlank(maxNumberOfDivisionsInAnswer)) {
          var maxNumberOfDivisions = toInt(maxNumberOfDivisionsInAnswer);
          var targetExpression_0 = (Kotlin.isType(tmp$_1 = log_1.factConstructorViewer.constructFactByIdentifier_7q4i4t$(targetFactIdentifier), Expression) ? tmp$_1 : throwCCE()).data;
          var error_1 = solutionRoot.hasNoFractions_5ah4l7$(maxNumberOfDivisions, targetExpression_0, factComporator);
          if (error_1 != null) {
            log_1.addMessage_bda5c9$(checkFactsInMathML$lambda_8(error_1), MessageType$USER_getInstance(), 0);
            return addErrorStringToMathMLSolution(result, error_1.description, errorPrefix);
          }
        }
         else {
          if (!isBlank(targetVariablesNames)) {
            var $receiver_0 = split(targetVariablesNames, [configSeparator]);
            var destination_0 = ArrayList_init_0(collectionSizeOrDefault($receiver_0, 10));
            var tmp$_7;
            tmp$_7 = $receiver_0.iterator();
            while (tmp$_7.hasNext()) {
              var item_0 = tmp$_7.next();
              var tmp$_8;
              destination_0.add_11rb$(new Pair(trim(Kotlin.isCharSequence(tmp$_8 = item_0) ? tmp$_8 : throwCCE()).toString(), false));
            }
            var targetVariables_0 = toMutableMap(toMap(destination_0));
            if (!equals(allowedVariablesNames, '')) {
              var $receiver_1 = split(allowedVariablesNames, [configSeparator]);
              var destination_1 = ArrayList_init_0(collectionSizeOrDefault($receiver_1, 10));
              var tmp$_9;
              tmp$_9 = $receiver_1.iterator();
              while (tmp$_9.hasNext()) {
                var item_1 = tmp$_9.next();
                var tmp$_10;
                destination_1.add_11rb$(trim(Kotlin.isCharSequence(tmp$_10 = item_1) ? tmp$_10 : throwCCE()).toString());
              }
              tmp$_2 = toSet(destination_1);
            }
             else {
              tmp$_2 = emptySet();
            }
            var allowedVariables = tmp$_2;
            var error_2 = solutionRoot.isSolutionForVariables_axkv0l$(targetVariables_0, void 0, allowedVariables);
            tmp$_3 = targetVariables_0.entries.iterator();
            while (tmp$_3.hasNext()) {
              var tmp$_11 = tmp$_3.next();
              var variable = tmp$_11.key;
              var expressed = tmp$_11.value;
              if (!expressed) {
                log_1.addMessage_bda5c9$(checkFactsInMathML$lambda_9(variable), MessageType$USER_getInstance(), 0);
                return addErrorStringToMathMLSolution(result, "variable '" + variable + "' is not expressed", errorPrefix);
              }
            }
            if (error_2 != null) {
              log_1.addMessage_bda5c9$(checkFactsInMathML$lambda_10(error_2), MessageType$USER_getInstance(), 0);
              return addErrorStringToMathMLSolution(result, error_2.description, errorPrefix);
            }
          }
          if (!isBlank(forbiddenFunctions)) {
            var forbidden = pairsStringIntFromString(forbiddenFunctions);
            var targetExpression_1 = (Kotlin.isType(tmp$_4 = log_1.factConstructorViewer.constructFactByIdentifier_7q4i4t$(targetFactIdentifier), Expression) ? tmp$_4 : throwCCE()).data;
            var error_3 = solutionRoot.isSolutionWithoutFunctions_cbql57$(forbidden, targetExpression_1, factComporator);
            if (error_3 != null) {
              log_1.addMessage_bda5c9$(checkFactsInMathML$lambda_11(error_3), MessageType$USER_getInstance(), 0);
              return addErrorStringToMathMLSolution(result, error_3.description, errorPrefix);
            }
          }
          log_1.addMessage_bda5c9$(checkFactsInMathML$lambda_12, MessageType$USER_getInstance(), 0);
        }
      }
      return result;
    }
  }
  function returnParsingError(error, mathML) {
    return returnParsingError_0(error.description, error.position, error.endPosition, mathML);
  }
  function returnParsingError$lambda(closure$description) {
    return function () {
      return "transformations parsing error: '" + closure$description + "'";
    };
  }
  function returnParsingError_0(description, start, end, mathML) {
    log_1.addMessage_bda5c9$(returnParsingError$lambda(description), MessageType$USER_getInstance(), 0);
    var positions = selectPlacesForColoringByFragment(mathML, start, end);
    var endIndex = positions.first;
    var tmp$ = mathML.substring(0, endIndex) + underliningStartMathML;
    var startIndex = positions.first;
    var endIndex_0 = positions.second;
    var tmp$_0 = tmp$ + mathML.substring(startIndex, endIndex_0) + underliningEndMathML;
    var startIndex_0 = positions.second;
    var endIndex_1 = mathML.length;
    var result = tmp$_0 + mathML.substring(startIndex_0, endIndex_1);
    return addErrorStringToMathMLSolution(result, description, 'Syntax&#xA0;error&#xA0;(underlined)');
  }
  function replaceSpaceMathMLAliases(string) {
    var result = spaceRegex.replace_x2uqeu$(string, '&#xA0;');
    return result;
  }
  var spaceRegex;
  function deleteUnsupportedMathMLTags(string) {
    var tmp$;
    var result = StringBuilder_init();
    var pos = 0;
    while (pos < string.length) {
      var toWhile = false;
      tmp$ = unsupportedTagListMathML.iterator();
      while (tmp$.hasNext()) {
        var tag = tmp$.next();
        if (remainingExpressionStartsWith('<\/' + tag + '>', string, pos)) {
          pos = pos + ('<\/' + tag + '>').length | 0;
          toWhile = true;
          result.append_gw00v9$('<\/mrow>');
        }
         else if (remainingExpressionStartsWith('<' + tag, string, pos)) {
          var actualTag = readOpenTagStringIfItPresent(string, pos);
          pos = pos + ensureNotNull(actualTag).length | 0;
          toWhile = true;
          result.append_gw00v9$('<mrow>');
        }
        if (toWhile) {
          break;
        }
      }
      if (toWhile) {
        continue;
      }
      result.append_s8itvh$(string.charCodeAt(pos));
      pos = pos + 1 | 0;
    }
    return result.toString();
  }
  function correctMathMlTagsAccordingToBracketsFromEnd(mathML) {
    var result = StringBuilder_init();
    var tag = 'msup';
    var tagBracketsStack = ArrayList_init();
    var valuesToAddMap = LinkedHashMap_init_0();
    var currentPos = get_lastIndex_0(mathML);
    while (currentPos >= 0) {
      result.append_s8itvh$(mathML.charCodeAt(currentPos));
      if (mathML.charCodeAt(currentPos) === 41) {
        tagBracketsStack.add_11rb$(')');
      }
       else if (mathML.charCodeAt(currentPos) === 60) {
        if (remainingExpressionStartsWith('<\/msup', mathML, currentPos)) {
          tagBracketsStack.add_11rb$(tag);
        }
         else if (remainingExpressionStartsWith('<msup', mathML, currentPos)) {
          if (tagBracketsStack.isEmpty()) {
            return returnParsingError_0("Not closed tag: '<msup>'", currentPos - 4 | 0, currentPos + 6 | 0, mathML);
          }
          if (equals(last(tagBracketsStack), tag)) {
            tagBracketsStack = toMutableList(dropLast_0(tagBracketsStack, 1));
          }
           else {
            tagBracketsStack = toMutableList(dropLast_0(tagBracketsStack, 1));
            var tagToMove = remainingExpressionStartsWith('<msup><mrow>', mathML, currentPos) ? '<msup><mrow>' : '';
            result = StringBuilder_init_0(dropLast(result, tagToMove.length));
            var tmp$;
            valuesToAddMap.put_xwzc9p$(tag, reversed(Kotlin.isCharSequence(tmp$ = tagToMove) ? tmp$ : throwCCE()).toString());
          }
        }
      }
       else if (mathML.charCodeAt(currentPos) === 40) {
        if (tagBracketsStack.isEmpty()) {
          return returnParsingError_0("Not closed bracket: '('", currentPos - 4 | 0, currentPos + 6 | 0, mathML);
        }
        if (equals(last(tagBracketsStack), '(')) {
          tagBracketsStack = toMutableList(dropLast_0(tagBracketsStack, 1));
        }
         else {
          var currentTag = last(tagBracketsStack);
          tagBracketsStack = toMutableList(dropLast_0(tagBracketsStack, 1));
          if (valuesToAddMap.containsKey_11rb$(currentTag)) {
            var tmp$_0;
            result.append_gw00v9$(reversed(Kotlin.isCharSequence(tmp$_0 = '<mo>') ? tmp$_0 : throwCCE()).toString());
            currentPos = currentPos - 4 | 0;
            result.append_gw00v9$(valuesToAddMap.get_11rb$(currentTag));
          }
        }
      }
      currentPos = currentPos - 1 | 0;
    }
    return result.reverse().toString();
  }
  function specificMathMlSystemReplacements(mathML) {
    return replace(replace(replace(mathML, '<\/mtd><\/mtr><\/mtable><mo>=<\/mo><mo>&gt;<\/mo><\/mrow><\/mfenced>', '<\/mtd><\/mtr><\/mtable><\/mfenced><mo>=<\/mo><mo>&gt;<\/mo>'), '<\/mtd><\/mtr><\/mtable><mo>&#x21D2;<\/mo><\/mrow><\/mfenced>', '<\/mtd><\/mtr><\/mtable><\/mfenced><mo>&#x21D2;<\/mo>'), '<mrow><mtable columnalign="left"><mtr><mtd>', '<mtable columnalign="left"><mtr><mtd>');
  }
  function addErrorStringToMathMLSolution(mathML, error, errorPrefix) {
    var endIndex = mathML.length - 7 | 0;
    var withoutEnd = mathML.substring(0, endIndex);
    var escapedError = replace(replace(error, '<', '&lt'), '>', '&gt');
    return withoutEnd + '<mspace linebreak="newline"/>' + ('<mtext mathvariant=' + '"' + 'bold' + '"' + ' mathcolor=' + '"' + '#FF0000' + '"' + '>' + errorPrefix + ': ') + escapedError + '<\/mtext><\/math>';
  }
  function deleteErrorStringFromMathMLSolution(mathML, errorPrefix) {
    var tmp$;
    if (endsWith_0(mathML, '<\/mtext><\/math>')) {
      var errorMessage = substringAfterLast(mathML, '<mspace linebreak="newline"/><mtext mathvariant="bold" mathcolor="#FF0000">');
      tmp$ = errorPrefix.iterator();
      while (tmp$.hasNext()) {
        var prefix = tmp$.next();
        if (startsWith(errorMessage, prefix)) {
          var withoutEnd = substringBeforeLast(mathML, '<mspace linebreak="newline"/><mtext mathvariant="bold" mathcolor="#FF0000">');
          return withoutEnd + '<\/math>';
        }
      }
    }
    return mathML;
  }
  var unsupportedTagListMathML;
  var underliningStartMathML;
  var underliningEndMathML;
  function TexVerificationResult(validatedSolution, errorMessage) {
    this.validatedSolution = validatedSolution;
    this.errorMessage = errorMessage;
  }
  TexVerificationResult.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'TexVerificationResult',
    interfaces: []
  };
  TexVerificationResult.prototype.component1 = function () {
    return this.validatedSolution;
  };
  TexVerificationResult.prototype.component2 = function () {
    return this.errorMessage;
  };
  TexVerificationResult.prototype.copy_puj7f4$ = function (validatedSolution, errorMessage) {
    return new TexVerificationResult(validatedSolution === void 0 ? this.validatedSolution : validatedSolution, errorMessage === void 0 ? this.errorMessage : errorMessage);
  };
  TexVerificationResult.prototype.toString = function () {
    return 'TexVerificationResult(validatedSolution=' + Kotlin.toString(this.validatedSolution) + (', errorMessage=' + Kotlin.toString(this.errorMessage)) + ')';
  };
  TexVerificationResult.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.validatedSolution) | 0;
    result = result * 31 + Kotlin.hashCode(this.errorMessage) | 0;
    return result;
  };
  TexVerificationResult.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.validatedSolution, other.validatedSolution) && Kotlin.equals(this.errorMessage, other.errorMessage)))));
  };
  function checkFactsInTex$lambda(closure$originalTexSolution) {
    return function () {
      return "input transformations in TEX: '''" + closure$originalTexSolution + "'''";
    };
  }
  function checkFactsInTex$lambda_0(closure$texSolution) {
    return function () {
      return "input transformations in TEX without brushing: '''" + closure$texSolution + "'''";
    };
  }
  function checkFactsInTex$lambda_1() {
    return 'input transformations parsing started';
  }
  function checkFactsInTex$lambda_2() {
    return 'input transformations are parsed successfully';
  }
  function checkFactsInTex$lambda_3() {
    return 'parsed input transformations: ';
  }
  function checkFactsInTex$lambda_4() {
    return 'input transformations checking started';
  }
  function checkFactsInTex$lambda_5(closure$checkingResult) {
    return function () {
      return "input transformations checking result: '" + (closure$checkingResult.isCorrect ? 'correct' : 'incorrect - ' + closure$checkingResult.description) + "'";
    };
  }
  function checkFactsInTex$lambda_6(closure$result) {
    return function () {
      return "transformations in tex after brushing: '''" + closure$result + "'''";
    };
  }
  function checkFactsInTex$lambda_7() {
    return 'input transformations checked successfully; answer checking started';
  }
  function checkFactsInTex$lambda_8(closure$patternNode) {
    return function () {
      return "parsed answer pattern: '''" + closure$patternNode + "'''";
    };
  }
  function checkFactsInTex$lambda_9() {
    return 'Full solution checked successfully';
  }
  function checkFactsInTex(originalTexSolution, startExpressionIdentifier, endExpressionIdentifier, targetFactIdentifier, targetFactPattern, additionalFactsIdentifiers, shortErrorDescription, compiledConfiguration) {
    if (startExpressionIdentifier === void 0)
      startExpressionIdentifier = '';
    if (endExpressionIdentifier === void 0)
      endExpressionIdentifier = '';
    if (targetFactIdentifier === void 0)
      targetFactIdentifier = '';
    if (targetFactPattern === void 0)
      targetFactPattern = '';
    if (additionalFactsIdentifiers === void 0)
      additionalFactsIdentifiers = '';
    if (shortErrorDescription === void 0)
      shortErrorDescription = '0';
    var tmp$;
    log_1.clear();
    log_1.factConstructorViewer = new FactConstructorViewer(compiledConfiguration);
    log_1.addMessage_bda5c9$(checkFactsInTex$lambda(originalTexSolution), void 0, 0);
    var texSolution = dropPerformedTexBrushing(originalTexSolution);
    log_1.addMessage_bda5c9$(checkFactsInTex$lambda_0(texSolution), void 0, 0);
    var transformationChainParser = new TransformationChainParser(texSolution, false, compiledConfiguration.functionConfiguration, compiledConfiguration.factsLogicConfiguration, compiledConfiguration.compiledImmediateVariableReplacements);
    log_1.addMessage_bda5c9$(checkFactsInTex$lambda_1, MessageType$USER_getInstance(), 0);
    var error = transformationChainParser.parse();
    if (error != null) {
      return new TexVerificationResult(returnParsingError_1(error, texSolution), 'Syntax error (underlined): ' + error.description);
    }
     else if (transformationChainParser.root.factTransformationChains.isEmpty() && transformationChainParser.root.expressionTransformationChains.isEmpty()) {
      return new TexVerificationResult(texSolution, 'Error: No transformations found');
    }
     else {
      log_1.addMessage_bda5c9$(checkFactsInTex$lambda_2, MessageType$USER_getInstance(), 0);
      log_1.addMessageWithFactDetail_5zaetr$(checkFactsInTex$lambda_3, transformationChainParser.root, MessageType$USER_getInstance());
      var factComporator = compiledConfiguration.factComporator;
      var solutionRoot = combineSolutionRoot(targetFactIdentifier, transformationChainParser, compiledConfiguration, startExpressionIdentifier, endExpressionIdentifier);
      log_1.addMessage_bda5c9$(checkFactsInTex$lambda_4, MessageType$USER_getInstance(), 0);
      var checkingResult = solutionRoot.check_l8pk6u$(factComporator, false, emptyList(), emptyList(), additionalFactsFromItsIdentifiers(log_1.factConstructorViewer, additionalFactsIdentifiers));
      log_1.addMessage_bda5c9$(checkFactsInTex$lambda_5(checkingResult), MessageType$USER_getInstance(), 0);
      var tmp$_0 = transformationChainParser.originalTransformationChain;
      var $receiver = checkingResult.coloringTasks;
      var destination = ArrayList_init();
      var tmp$_1;
      tmp$_1 = $receiver.iterator();
      while (tmp$_1.hasNext()) {
        var element = tmp$_1.next();
        if (element.startPosition > 0 || element.endPosition > 0)
          destination.add_11rb$(element);
      }
      var resultWithColoredTasks = brushTex(tmp$_0, destination);
      var result = setBackgroundColorTex(resultWithColoredTasks, 'purple');
      log_1.addMessage_bda5c9$(checkFactsInTex$lambda_6(result), void 0, 0);
      if (!checkingResult.isCorrect) {
        if (equals(shortErrorDescription, '1')) {
          tmp$ = new TexVerificationResult(result, 'Error: Unclear transformation or incomplete solution. Try to fix errors or to write more details');
        }
         else
          tmp$ = new TexVerificationResult(result, errorPrefix + ': ' + checkingResult.description);
        return tmp$;
      }
      if (!isBlank(targetFactPattern)) {
        log_1.addMessage_bda5c9$(checkFactsInTex$lambda_7, MessageType$USER_getInstance(), 0);
        var resultExpression = solutionRoot.getLastExpression();
        if (resultExpression == null || resultExpression.data.children.isEmpty()) {
          return new TexVerificationResult(result, 'Error: answer is empty');
        }
        var expressionStructureConditionConstructor = new ExpressionStructureConditionConstructor(compiledConfiguration);
        var patternNode = expressionStructureConditionConstructor.parse_61zpoe$(targetFactPattern);
        log_1.addMessage_bda5c9$(checkFactsInTex$lambda_8(patternNode), void 0, 0);
        if (!checkExpressionStructure(resultExpression.data, patternNode)) {
          return new TexVerificationResult(result, 'Error: answer does not match given condition');
        }
      }
      log_1.addMessage_bda5c9$(checkFactsInTex$lambda_9, MessageType$USER_getInstance(), 0);
      return new TexVerificationResult(result, '');
    }
  }
  function returnParsingError_1(error, mathML) {
    return returnParsingError_2(error.description, error.position, error.endPosition, mathML);
  }
  function returnParsingError$lambda_0(closure$description) {
    return function () {
      return "transformations parsing error: '" + closure$description + "'";
    };
  }
  function returnParsingError_2(description, start, end, tex) {
    log_1.addMessage_bda5c9$(returnParsingError$lambda_0(description), MessageType$USER_getInstance(), 0);
    var endPosition = findClosestPlaceToTargetOnTheSameLevel(tex, start, end);
    var tmp$ = tex.substring(0, start) + '\\underline{' + tex.substring(start, endPosition) + '}';
    var endIndex = tex.length;
    var result = tmp$ + tex.substring(endPosition, endIndex);
    return result;
  }
  function deleteUnsupportedTags(string) {
    var tmp$;
    var result = StringBuilder_init();
    var pos = 0;
    while (pos < string.length) {
      var toWhile = false;
      tmp$ = unsupportedTagListMathML.iterator();
      while (tmp$.hasNext()) {
        var tag = tmp$.next();
        if (remainingExpressionStartsWith('<\/' + tag + '>', string, pos)) {
          pos = pos + ('<\/' + tag + '>').length | 0;
          toWhile = true;
          result.append_gw00v9$('<\/mrow>');
        }
         else if (remainingExpressionStartsWith('<' + tag, string, pos)) {
          var actualTag = readOpenTagStringIfItPresent(string, pos);
          pos = pos + ensureNotNull(actualTag).length | 0;
          toWhile = true;
          result.append_gw00v9$('<mrow>');
        }
        if (toWhile) {
          break;
        }
      }
      if (toWhile) {
        continue;
      }
      result.append_s8itvh$(string.charCodeAt(pos));
      pos = pos + 1 | 0;
    }
    return result.toString();
  }
  function compiledConfigurationBySettings(wellKnownFunctionsString, expressionTransformationRulesString, maxExpressionTransformationWeightString, unlimitedWellKnownFunctionsString, taskContextExpressionTransformationRulesString, maxDistBetweenDiffStepsString, scopeFilterString, wellKnownFunctions, unlimitedWellKnownFunctions, expressionTransformationRules) {
    if (wellKnownFunctionsString === void 0)
      wellKnownFunctionsString = '';
    if (expressionTransformationRulesString === void 0)
      expressionTransformationRulesString = '';
    if (maxExpressionTransformationWeightString === void 0)
      maxExpressionTransformationWeightString = '';
    if (unlimitedWellKnownFunctionsString === void 0)
      unlimitedWellKnownFunctionsString = '';
    if (taskContextExpressionTransformationRulesString === void 0)
      taskContextExpressionTransformationRulesString = '';
    if (maxDistBetweenDiffStepsString === void 0)
      maxDistBetweenDiffStepsString = '';
    if (scopeFilterString === void 0)
      scopeFilterString = '';
    if (wellKnownFunctions === void 0) {
      wellKnownFunctions = emptyList();
    }
    if (unlimitedWellKnownFunctions === void 0) {
      unlimitedWellKnownFunctions = emptyList();
    }
    if (expressionTransformationRules === void 0) {
      expressionTransformationRules = emptyList();
    }
    var $receiver = split(scopeFilterString, [configSeparator]);
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$;
    tmp$ = $receiver.iterator();
    while (tmp$.hasNext()) {
      var item = tmp$.next();
      var tmp$_0;
      destination.add_11rb$(trim(Kotlin.isCharSequence(tmp$_0 = item) ? tmp$_0 : throwCCE()).toString());
    }
    var functionConfiguration = new FunctionConfiguration(toSet(destination));
    if (!wellKnownFunctions.isEmpty()) {
      functionConfiguration.notChangesOnVariablesInComparisonFunction = wellKnownFunctions;
    }
     else {
      if (!isBlank(wellKnownFunctionsString)) {
        var pairs = pairsFromString(wellKnownFunctionsString);
        var destination_0 = ArrayList_init_0(collectionSizeOrDefault(pairs, 10));
        var tmp$_1;
        tmp$_1 = pairs.iterator();
        while (tmp$_1.hasNext()) {
          var item_0 = tmp$_1.next();
          destination_0.add_11rb$(new FunctionIdentifier(item_0.first, toInt(item_0.second)));
        }
        functionConfiguration.notChangesOnVariablesInComparisonFunction = toMutableList(destination_0);
      }
    }
    if (!unlimitedWellKnownFunctions.isEmpty()) {
      functionConfiguration.notChangesOnVariablesInComparisonFunctionWithoutTransformations = unlimitedWellKnownFunctions;
    }
     else {
      if (!isBlank(unlimitedWellKnownFunctionsString)) {
        var pairs_0 = pairsFromString(unlimitedWellKnownFunctionsString);
        var destination_1 = ArrayList_init_0(collectionSizeOrDefault(pairs_0, 10));
        var tmp$_2;
        tmp$_2 = pairs_0.iterator();
        while (tmp$_2.hasNext()) {
          var item_1 = tmp$_2.next();
          destination_1.add_11rb$(new FunctionIdentifier(item_1.first, toInt(item_1.second)));
        }
        functionConfiguration.notChangesOnVariablesInComparisonFunctionWithoutTransformations = toMutableList(destination_1);
      }
    }
    if (expressionTransformationRulesString.length > 0) {
      var $receiver_0 = functionConfiguration.treeTransformationRules;
      var destination_2 = ArrayList_init();
      var tmp$_3;
      tmp$_3 = $receiver_0.iterator();
      while (tmp$_3.hasNext()) {
        var element = tmp$_3.next();
        if (element.isImmediate === true)
          destination_2.add_11rb$(element);
      }
      functionConfiguration.treeTransformationRules = toMutableList(destination_2);
      var pairs_1 = pairsFromString(expressionTransformationRulesString);
      var tmp$_4 = functionConfiguration.treeTransformationRules;
      var destination_3 = ArrayList_init_0(collectionSizeOrDefault(pairs_1, 10));
      var tmp$_5;
      tmp$_5 = pairs_1.iterator();
      while (tmp$_5.hasNext()) {
        var item_2 = tmp$_5.next();
        destination_3.add_11rb$(new TreeTransformationRule(item_2.first, item_2.second));
      }
      tmp$_4.addAll_brywnq$(destination_3);
    }
    if (taskContextExpressionTransformationRulesString.length > 0) {
      var $receiver_1 = functionConfiguration.taskContextTreeTransformationRules;
      var destination_4 = ArrayList_init();
      var tmp$_6;
      tmp$_6 = $receiver_1.iterator();
      while (tmp$_6.hasNext()) {
        var element_0 = tmp$_6.next();
        if (element_0.isImmediate === true)
          destination_4.add_11rb$(element_0);
      }
      functionConfiguration.taskContextTreeTransformationRules = toMutableList(destination_4);
      var pairs_2 = pairsFromString(taskContextExpressionTransformationRulesString);
      var tmp$_7 = functionConfiguration.taskContextTreeTransformationRules;
      var destination_5 = ArrayList_init_0(collectionSizeOrDefault(pairs_2, 10));
      var tmp$_8;
      tmp$_8 = pairs_2.iterator();
      while (tmp$_8.hasNext()) {
        var item_3 = tmp$_8.next();
        destination_5.add_11rb$(new TreeTransformationRule(item_3.first, item_3.second));
      }
      tmp$_7.addAll_brywnq$(destination_5);
    }
    var compiledConfiguration = new CompiledConfiguration(void 0, functionConfiguration);
    if (!expressionTransformationRules.isEmpty()) {
      compiledConfiguration.compiledExpressionTreeTransformationRules.clear();
      compiledConfiguration.compiledExpressionTreeTransformationRules.addAll_brywnq$(expressionTransformationRules);
    }
    if (!isBlank(maxExpressionTransformationWeightString)) {
      compiledConfiguration.comparisonSettings.maxExpressionTransformationWeight = toDouble(maxExpressionTransformationWeightString);
    }
    if (!isBlank(maxDistBetweenDiffStepsString)) {
      compiledConfiguration.comparisonSettings.maxDistBetweenDiffSteps = toDouble(maxDistBetweenDiffStepsString);
    }
    return compiledConfiguration;
  }
  function combineSolutionRoot$lambda() {
    return 'solution with task target joined: ';
  }
  function combineSolutionRoot(targetFactIdentifier, transformationChainParser, compiledConfiguration, startExpressionIdentifier, endExpressionIdentifier) {
    if (startExpressionIdentifier === void 0)
      startExpressionIdentifier = '';
    if (endExpressionIdentifier === void 0)
      endExpressionIdentifier = '';
    var tmp$;
    if (!isBlank(startExpressionIdentifier) && transformationChainParser.root.factTransformationChains.isEmpty() && transformationChainParser.root.expressionTransformationChains.size === 1) {
      var expressionNodeConstructor = new ExpressionNodeConstructor(compiledConfiguration.functionConfiguration);
      var startExpression = expressionNodeConstructor.construct_61zpoe$(startExpressionIdentifier);
      first(transformationChainParser.root.expressionTransformationChains).chain.add_wxm5ur$(0, new Expression(void 0, void 0, startExpression, void 0, transformationChainParser.root));
      if (!isBlank(endExpressionIdentifier)) {
        var endExpression = expressionNodeConstructor.construct_61zpoe$(endExpressionIdentifier);
        first(transformationChainParser.root.expressionTransformationChains).chain.add_11rb$(new Expression(void 0, void 0, endExpression, void 0, transformationChainParser.root));
      }
    }
    if (contains_0(targetFactIdentifier, '}{=}{')) {
      var taskTargetFact = log_1.factConstructorViewer.constructFactByIdentifier_7q4i4t$(targetFactIdentifier);
      var taskTargetRoot = taskTargetFact.type() === transformationChainParser.root.type() ? taskTargetFact : new MainLineAndNode(void 0, void 0, void 0, void 0, mutableListOf([taskTargetFact]));
      var newRoot = new MainLineAndNode(void 0, void 0, void 0, mutableListOf([new MainChain(mutableListOf([transformationChainParser.root, taskTargetRoot]))]));
      log_1.addMessageWithFactDetail_5zaetr$(combineSolutionRoot$lambda, newRoot, MessageType$USER_getInstance());
      tmp$ = newRoot;
    }
     else {
      tmp$ = transformationChainParser.root;
    }
    return tmp$;
  }
  function pairsFromString(data) {
    var result = ArrayList_init();
    var tmp$;
    var $receiver = split(trim(Kotlin.isCharSequence(tmp$ = data) ? tmp$ : throwCCE()).toString(), [configSeparator]);
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$_0;
    tmp$_0 = $receiver.iterator();
    while (tmp$_0.hasNext()) {
      var item = tmp$_0.next();
      var tmp$_1;
      destination.add_11rb$(trim(Kotlin.isCharSequence(tmp$_1 = item) ? tmp$_1 : throwCCE()).toString());
    }
    var parts = destination;
    var i = 1;
    while (i < parts.size) {
      result.add_11rb$(new Pair(parts.get_za3lpa$(i - 1 | 0), parts.get_za3lpa$(i)));
      i = i + 2 | 0;
    }
    return result;
  }
  function pairsStringIntFromString(data) {
    var result = ArrayList_init();
    var tmp$;
    var $receiver = split(trim(Kotlin.isCharSequence(tmp$ = data) ? tmp$ : throwCCE()).toString(), [configSeparator]);
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver, 10));
    var tmp$_0;
    tmp$_0 = $receiver.iterator();
    while (tmp$_0.hasNext()) {
      var item = tmp$_0.next();
      var tmp$_1;
      destination.add_11rb$(trim(Kotlin.isCharSequence(tmp$_1 = item) ? tmp$_1 : throwCCE()).toString());
    }
    var parts = destination;
    var i = 1;
    while (i < parts.size) {
      result.add_11rb$(new Pair(parts.get_za3lpa$(i - 1 | 0), toInt(parts.get_za3lpa$(i))));
      i = i + 2 | 0;
    }
    return result;
  }
  function additionalFactsFromItsIdentifiers($receiver, additionalFactsIdentifiers) {
    var $receiver_0 = split(additionalFactsIdentifiers, [configSeparator]);
    var destination = ArrayList_init_0(collectionSizeOrDefault($receiver_0, 10));
    var tmp$;
    tmp$ = $receiver_0.iterator();
    while (tmp$.hasNext()) {
      var item = tmp$.next();
      var tmp$_0;
      destination.add_11rb$(trim(Kotlin.isCharSequence(tmp$_0 = item) ? tmp$_0 : throwCCE()).toString());
    }
    var destination_0 = ArrayList_init();
    var tmp$_1;
    tmp$_1 = destination.iterator();
    while (tmp$_1.hasNext()) {
      var element = tmp$_1.next();
      if (element.length > 0)
        destination_0.add_11rb$(element);
    }
    var identifiers = destination_0;
    var destination_1 = ArrayList_init_0(collectionSizeOrDefault(identifiers, 10));
    var tmp$_2;
    tmp$_2 = identifiers.iterator();
    while (tmp$_2.hasNext()) {
      var item_0 = tmp$_2.next();
      destination_1.add_11rb$($receiver.constructFactByIdentifier_7q4i4t$(item_0));
    }
    return destination_1;
  }
  var configSeparator;
  var errorPrefix;
  var syntaxErrorPrefix;
  function CageHolder(minPoint, maxPoint) {
    CageHolder$Companion_getInstance();
    this.minPoint_0 = minPoint;
    this.maxPoint_0 = maxPoint;
    var tmp$;
    if (this.minPoint_0.size !== this.maxPoint_0.size) {
      throw IllegalArgumentException_init('Points have different dimensions');
    }
    tmp$ = this.minPoint_0.size;
    for (var i = 0; i <= tmp$; i++) {
      if (this.minPoint_0.get_za3lpa$(i) > this.maxPoint_0.get_za3lpa$(i)) {
        throw IllegalArgumentException_init('Min point greater than max point in position ' + i);
      }
    }
  }
  function CageHolder$Companion() {
    CageHolder$Companion_instance = this;
  }
  CageHolder$Companion.prototype.fullSpaceCageHolder_za3lpa$ = function (dimension) {
    var minPoint = ArrayList_init();
    var maxPoint = ArrayList_init();
    for (var i = 0; i <= dimension; i++) {
      minPoint.add_11rb$(kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY);
      maxPoint.add_11rb$(kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY);
    }
    return new CageHolder(minPoint, maxPoint);
  };
  CageHolder$Companion.prototype.emptyCageHolder_za3lpa$ = function (dimension) {
    var minPoint = ArrayList_init();
    var maxPoint = ArrayList_init();
    for (var i = 0; i <= dimension; i++) {
      minPoint.add_11rb$(kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY);
      maxPoint.add_11rb$(kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY);
    }
    return new CageHolder(minPoint, maxPoint);
  };
  CageHolder$Companion.prototype.domainIntersection_p7f0kx$ = function (domains, dimension) {
    var tmp$, tmp$_0, tmp$_1;
    var intersectionMinPoint = ArrayList_init();
    var intersectionMaxPoint = ArrayList_init();
    if (domains.isEmpty()) {
      return this.fullSpaceCageHolder_za3lpa$(dimension);
    }
    tmp$ = domains.iterator();
    while (tmp$.hasNext()) {
      var domain = tmp$.next();
      if (domain.getDimension() !== dimension) {
        throw IllegalArgumentException_init("Different point's dimensions");
      }
    }
    loop_label: for (var i = 0; i <= dimension; i++) {
      var maxBy$result;
      maxBy$break: do {
        var iterator = domains.iterator();
        if (!iterator.hasNext()) {
          maxBy$result = null;
          break maxBy$break;
        }
        var maxElem = iterator.next();
        var maxValue = maxElem.minPoint_0.get_za3lpa$(i);
        while (iterator.hasNext()) {
          var e = iterator.next();
          var v = e.minPoint_0.get_za3lpa$(i);
          if (Kotlin.compareTo(maxValue, v) < 0) {
            maxElem = e;
            maxValue = v;
          }
        }
        maxBy$result = maxElem;
      }
       while (false);
      intersectionMinPoint.add_11rb$(ensureNotNull((tmp$_0 = maxBy$result) != null ? tmp$_0.minPoint_0 : null).get_za3lpa$(i));
      var minBy$result;
      minBy$break: do {
        var iterator_0 = domains.iterator();
        if (!iterator_0.hasNext()) {
          minBy$result = null;
          break minBy$break;
        }
        var minElem = iterator_0.next();
        var minValue = minElem.maxPoint_0.get_za3lpa$(i);
        while (iterator_0.hasNext()) {
          var e_0 = iterator_0.next();
          var v_0 = e_0.maxPoint_0.get_za3lpa$(i);
          if (Kotlin.compareTo(minValue, v_0) > 0) {
            minElem = e_0;
            minValue = v_0;
          }
        }
        minBy$result = minElem;
      }
       while (false);
      intersectionMaxPoint.add_11rb$(ensureNotNull((tmp$_1 = minBy$result) != null ? tmp$_1.maxPoint_0 : null).get_za3lpa$(i));
    }
    for (var i_0 = 0; i_0 <= dimension; i_0++) {
      if (intersectionMaxPoint.get_za3lpa$(i_0) < intersectionMinPoint.get_za3lpa$(i_0)) {
        return this.emptyCageHolder_za3lpa$(dimension);
      }
    }
    return new CageHolder(intersectionMinPoint, intersectionMaxPoint);
  };
  CageHolder$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var CageHolder$Companion_instance = null;
  function CageHolder$Companion_getInstance() {
    if (CageHolder$Companion_instance === null) {
      new CageHolder$Companion();
    }
    return CageHolder$Companion_instance;
  }
  CageHolder.prototype.pointInDomain_l8u4bv$ = function (point) {
    var tmp$;
    if (point.size !== this.minPoint_0.size) {
      throw IllegalArgumentException_init("Point's dimension " + point.size + ' != cage dimension ' + this.minPoint_0.size + '$');
    }
    tmp$ = this.getDimension();
    for (var i = 0; i <= tmp$; i++) {
      if (point.get_za3lpa$(i) < this.minPoint_0.get_za3lpa$(i) || point.get_za3lpa$(i) > this.maxPoint_0.get_za3lpa$(i)) {
        return false;
      }
    }
    return true;
  };
  CageHolder.prototype.getDimension = function () {
    return this.minPoint_0.size;
  };
  CageHolder.prototype.isEmpty = function () {
    var tmp$;
    tmp$ = this.getDimension();
    for (var i = 0; i <= tmp$; i++) {
      if (this.minPoint_0.get_za3lpa$(i) !== kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY) {
        return false;
      }
    }
    return true;
  };
  CageHolder.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'CageHolder',
    interfaces: []
  };
  function Form(name, ordinal) {
    Enum.call(this);
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function Form_initFields() {
    Form_initFields = function () {
    };
    Form$ALGEBRAIC_instance = new Form('ALGEBRAIC', 0);
    Form$TRIGONOMETRIC_instance = new Form('TRIGONOMETRIC', 1);
  }
  var Form$ALGEBRAIC_instance;
  function Form$ALGEBRAIC_getInstance() {
    Form_initFields();
    return Form$ALGEBRAIC_instance;
  }
  var Form$TRIGONOMETRIC_instance;
  function Form$TRIGONOMETRIC_getInstance() {
    Form_initFields();
    return Form$TRIGONOMETRIC_instance;
  }
  Form.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'Form',
    interfaces: [Enum]
  };
  function Form$values() {
    return [Form$ALGEBRAIC_getInstance(), Form$TRIGONOMETRIC_getInstance()];
  }
  Form.values = Form$values;
  function Form$valueOf(name) {
    switch (name) {
      case 'ALGEBRAIC':
        return Form$ALGEBRAIC_getInstance();
      case 'TRIGONOMETRIC':
        return Form$TRIGONOMETRIC_getInstance();
      default:throwISE('No enum constant numbers.Form.' + name);
    }
  }
  Form.valueOf_61zpoe$ = Form$valueOf;
  function toComplex($receiver) {
    return Complex_init(toReal($receiver), toReal(0), Form$ALGEBRAIC_getInstance());
  }
  function toComplex_0($receiver) {
    return Complex_init(toReal_0($receiver), toReal(0), Form$ALGEBRAIC_getInstance());
  }
  function toComplexOrNull($receiver) {
    var realValue = toRealOrNull($receiver);
    if (realValue != null) {
      return Complex_init(realValue, Real_init(0), Form$ALGEBRAIC_getInstance());
    }
    if ($receiver.length > 0 && $receiver.charCodeAt(0) === 105) {
      var imaginaryValue = toRealOrNull($receiver.substring(1));
      if (imaginaryValue != null) {
        return Complex_init(Real_init(0), imaginaryValue, Form$ALGEBRAIC_getInstance());
      }
    }
    var partsOfNumber = split($receiver, ['+i']);
    if (partsOfNumber.size !== 2) {
      return null;
    }
    var realPart = toRealOrNull(partsOfNumber.get_za3lpa$(0));
    var imaginaryPart = toRealOrNull(partsOfNumber.get_za3lpa$(1));
    if (realPart == null || imaginaryPart == null) {
      return null;
    }
    return Complex_init(realPart, imaginaryPart, Form$ALGEBRAIC_getInstance());
  }
  function toComplex_1($receiver) {
    var result = toComplexOrNull($receiver);
    if (result == null) {
      throw IllegalStateException_init_0($receiver + ' cannot be converted to complex');
    }
     else {
      return result;
    }
  }
  function Complex() {
    Complex$Companion_getInstance();
    this.real_0 = Real_init(0);
    this.imaginary_0 = Real_init(0);
  }
  function Complex$Companion() {
    Complex$Companion_instance = this;
    this.i = Complex_init(Real_init(0), Real_init(1), Form$ALGEBRAIC_getInstance());
  }
  Complex$Companion.prototype.exp_i6s3kk$ = function (z) {
    return Complex_init(Real$Companion_getInstance().exp_vit0pu$(z.real_0), z.imaginary_0, Form$TRIGONOMETRIC_getInstance());
  };
  Complex$Companion.prototype.ln_i6s3kk$ = function (z) {
    return Complex_init(Real$Companion_getInstance().ln_vit0pu$(z.getRadius()), z.getAngle(), Form$ALGEBRAIC_getInstance());
  };
  Complex$Companion.prototype.sin_i6s3kk$ = function (z) {
    return this.exp_i6s3kk$(this.i.times_i6s3kk$(z)).minus_i6s3kk$(this.exp_i6s3kk$(this.i.unaryMinus().times_i6s3kk$(z))).div_i6s3kk$(this.i.times_vit0pu$(toReal(2)));
  };
  Complex$Companion.prototype.cos_i6s3kk$ = function (z) {
    return this.exp_i6s3kk$(this.i.times_i6s3kk$(z)).plus_i6s3kk$(this.exp_i6s3kk$(this.i.unaryMinus().times_i6s3kk$(z))).div_vit0pu$(toReal(2));
  };
  Complex$Companion.prototype.tan_i6s3kk$ = function (z) {
    return this.sin_i6s3kk$(z).div_i6s3kk$(this.cos_i6s3kk$(z));
  };
  Complex$Companion.prototype.sinh_i6s3kk$ = function (z) {
    return this.i.unaryMinus().times_i6s3kk$(this.sin_i6s3kk$(this.i.times_i6s3kk$(z)));
  };
  Complex$Companion.prototype.cosh_i6s3kk$ = function (z) {
    return this.cos_i6s3kk$(this.i.times_i6s3kk$(z));
  };
  Complex$Companion.prototype.tanh_i6s3kk$ = function (z) {
    return this.i.unaryMinus().times_i6s3kk$(this.tan_i6s3kk$(this.i.times_i6s3kk$(z)));
  };
  Complex$Companion.prototype.abs_i6s3kk$ = function (z) {
    return z.getRadius();
  };
  Complex$Companion.prototype.sqrt_i6s3kk$ = function (z) {
    if (z.imaginary_0.additivelyEqualToZero()) {
      if (z.real_0.additivelyEqualToZero())
        return toComplex(0);
      if (z.real_0.compareTo_11rb$(toReal(0)) > 0)
        return Complex_init(Real$Companion_getInstance().sqrt_vit0pu$(z.real_0), toReal(0));
      if (z.imaginary_0.value < -Real$Companion_getInstance().EPSILON)
        return Complex_init(toReal(0), Real$Companion_getInstance().sqrt_vit0pu$(z.real_0.unaryMinus()).unaryMinus());
      return Complex_init(toReal(0), Real$Companion_getInstance().sqrt_vit0pu$(z.real_0.unaryMinus()));
    }
     else {
      var r = z.getRadius();
      var zz = z.plus_i6s3kk$(toComplex(1).minus_i6s3kk$(z).times_vit0pu$(r).div_vit0pu$(r.plus_vit0pu$(toReal(1))));
      var rz = zz.getRadius();
      zz.timesAssign_vit0pu$(Real$Companion_getInstance().sqrt_vit0pu$(r).div_vit0pu$(rz));
      return zz;
    }
  };
  Complex$Companion.prototype.pow2_i6s3kk$ = function (z) {
    return z.pow_vit0pu$(Real_init(2));
  };
  Complex$Companion.prototype.asin_i6s3kk$ = function (z) {
    return this.i.unaryMinus().times_i6s3kk$(this.ln_i6s3kk$(this.i.times_i6s3kk$(z).plus_i6s3kk$(this.sqrt_i6s3kk$(this.pow2_i6s3kk$(z).unaryMinus().plus_i6s3kk$(toComplex(1))))));
  };
  Complex$Companion.prototype.acos_i6s3kk$ = function (z) {
    return this.i.unaryMinus().times_i6s3kk$(this.ln_i6s3kk$(z.plus_i6s3kk$(this.sqrt_i6s3kk$(this.pow2_i6s3kk$(z).minus_i6s3kk$(toComplex(1))))));
  };
  Complex$Companion.prototype.atan_i6s3kk$ = function (z) {
    return this.i.div_vit0pu$(toReal(2)).unaryMinus().times_i6s3kk$(this.ln_i6s3kk$(toComplex(1).plus_i6s3kk$(this.i.times_i6s3kk$(z)).div_i6s3kk$(toComplex(1).minus_i6s3kk$(this.i.times_i6s3kk$(z)))));
  };
  Complex$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var Complex$Companion_instance = null;
  function Complex$Companion_getInstance() {
    if (Complex$Companion_instance === null) {
      new Complex$Companion();
    }
    return Complex$Companion_instance;
  }
  Complex.prototype.plus_i6s3kk$ = function (other) {
    return Complex_init(this.real_0.plus_vit0pu$(other.real_0), this.imaginary_0.plus_vit0pu$(other.imaginary_0));
  };
  Complex.prototype.minus_i6s3kk$ = function (other) {
    return Complex_init(this.real_0.minus_vit0pu$(other.real_0), this.imaginary_0.minus_vit0pu$(other.imaginary_0));
  };
  Complex.prototype.times_i6s3kk$ = function (other) {
    var r = this.real_0.times_vit0pu$(other.real_0).minus_vit0pu$(this.imaginary_0.times_vit0pu$(other.imaginary_0));
    var i = this.real_0.times_vit0pu$(other.imaginary_0).plus_vit0pu$(other.real_0.times_vit0pu$(this.imaginary_0));
    return Complex_init(r, i);
  };
  Complex.prototype.div_i6s3kk$ = function (other) {
    var res = this.times_i6s3kk$(Complex_init(other.real_0, other.imaginary_0.unaryMinus()));
    var radius2 = Real$Companion_getInstance().pow2_vit0pu$(other.real_0).plus_vit0pu$(Real$Companion_getInstance().pow2_vit0pu$(other.imaginary_0));
    res.real_0 = res.real_0.div_vit0pu$(radius2);
    res.imaginary_0 = res.imaginary_0.div_vit0pu$(radius2);
    return res;
  };
  Complex.prototype.times_vit0pu$ = function (other) {
    return Complex_init(this.real_0.times_vit0pu$(other), this.imaginary_0.times_vit0pu$(other));
  };
  Complex.prototype.div_vit0pu$ = function (other) {
    return Complex_init(this.real_0.div_vit0pu$(other), this.imaginary_0.div_vit0pu$(other));
  };
  Complex.prototype.unaryMinus = function () {
    return Complex_init(this.real_0.unaryMinus(), this.imaginary_0.unaryMinus());
  };
  Complex.prototype.plusAssign_i6s3kk$ = function (other) {
    this.real_0 = this.real_0.plus_vit0pu$(other.real_0);
    this.imaginary_0 = this.imaginary_0.plus_vit0pu$(other.imaginary_0);
  };
  Complex.prototype.minusAssign_i6s3kk$ = function (other) {
    this.real_0 = this.real_0.minus_vit0pu$(other.real_0);
    this.imaginary_0 = this.imaginary_0.minus_vit0pu$(other.imaginary_0);
  };
  Complex.prototype.timesAssign_i6s3kk$ = function (other) {
    var r = this.real_0.times_vit0pu$(other.real_0).minus_vit0pu$(this.imaginary_0.times_vit0pu$(other.imaginary_0));
    var i = this.real_0.times_vit0pu$(other.imaginary_0).plus_vit0pu$(other.real_0.times_vit0pu$(this.imaginary_0));
    this.real_0 = r;
    this.imaginary_0 = i;
  };
  Complex.prototype.divAssign_i6s3kk$ = function (other) {
    this.timesAssign_i6s3kk$(Complex_init(other.real_0, other.imaginary_0.unaryMinus()));
    var radius2 = Real$Companion_getInstance().pow2_vit0pu$(other.real_0).plus_vit0pu$(Real$Companion_getInstance().pow2_vit0pu$(other.imaginary_0));
    this.real_0 = this.real_0.div_vit0pu$(radius2);
    this.imaginary_0 = this.imaginary_0.div_vit0pu$(radius2);
  };
  Complex.prototype.timesAssign_vit0pu$ = function (other) {
    this.real_0 = this.real_0.times_vit0pu$(other);
    this.imaginary_0 = this.imaginary_0.times_vit0pu$(other);
  };
  Complex.prototype.divAssign_vit0pu$ = function (other) {
    this.real_0 = this.real_0.div_vit0pu$(other);
    this.imaginary_0 = this.imaginary_0.div_vit0pu$(other);
  };
  Complex.prototype.equals_i6s3kk$ = function (other) {
    return this.real_0.additivelyEqualTo_vit0pu$(other.real_0) && this.imaginary_0.additivelyEqualTo_vit0pu$(other.imaginary_0);
  };
  Complex.prototype.pow_i6s3kk$ = function (arg) {
    var tmp$;
    if (this.additivelyEqualToZero_0()) {
      tmp$ = toComplex(0);
    }
     else {
      tmp$ = Complex$Companion_getInstance().exp_i6s3kk$(arg.times_i6s3kk$(Complex$Companion_getInstance().ln_i6s3kk$(this)));
    }
    return tmp$;
  };
  Complex.prototype.additivelyEqualToZero_0 = function () {
    return this.getRadius().additivelyEqualToZero();
  };
  Complex.prototype.getAngle_0 = function (r) {
    if (r.additivelyEqualToZero())
      return toReal(0);
    return this.imaginary_0.compareTo_11rb$(toReal(0)) >= 0 ? Real$Companion_getInstance().acos_vit0pu$(this.real_0.div_vit0pu$(r)) : Real$Companion_getInstance().acos_vit0pu$(this.real_0.div_vit0pu$(r)).unaryMinus();
  };
  Complex.prototype.pow_vit0pu$ = function (arg) {
    return this.pow_i6s3kk$(Complex_init(arg, Real_init(0)));
  };
  Complex.prototype.toString = function () {
    return this.real_0.toString() + '+i' + this.imaginary_0;
  };
  Complex.prototype.toDouble = function () {
    return this.real_0.toDouble();
  };
  Complex.prototype.getRadius = function () {
    return Real$Companion_getInstance().sqrt_vit0pu$(Real$Companion_getInstance().pow2_vit0pu$(this.real_0).plus_vit0pu$(Real$Companion_getInstance().pow2_vit0pu$(this.imaginary_0)));
  };
  Complex.prototype.getAngle = function () {
    var r = this.getRadius();
    return this.getAngle_0(r);
  };
  Complex.prototype.getReal = function () {
    return this.real_0;
  };
  Complex.prototype.getImaginary = function () {
    return this.imaginary_0;
  };
  Complex.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'Complex',
    interfaces: []
  };
  function Complex_init(realOrRadius, imaginaryOrAngle, form, $this) {
    if (form === void 0)
      form = Form$ALGEBRAIC_getInstance();
    $this = $this || Object.create(Complex.prototype);
    Complex.call($this);
    switch (form.name) {
      case 'ALGEBRAIC':
        $this.real_0 = realOrRadius;
        $this.imaginary_0 = imaginaryOrAngle;
        break;
      case 'TRIGONOMETRIC':
        if (realOrRadius.compareTo_11rb$(toReal(0)) < 0) {
          throw IllegalArgumentException_init('error: radius < 0');
        }

        $this.real_0 = realOrRadius.times_vit0pu$(Real$Companion_getInstance().cos_vit0pu$(imaginaryOrAngle));
        $this.imaginary_0 = realOrRadius.times_vit0pu$(Real$Companion_getInstance().sin_vit0pu$(imaginaryOrAngle));
        break;
    }
    return $this;
  }
  function LineSegmentHolder(from, to) {
    LineSegmentHolder$Companion_getInstance();
    this.from_0 = from;
    this.to_0 = to;
    if (this.from_0 > this.to_0) {
      var temporary = this.from_0;
      this.from_0 = this.to_0;
      this.to_0 = temporary;
    }
  }
  function LineSegmentHolder$Companion() {
    LineSegmentHolder$Companion_instance = this;
    this.fullSegment = new LineSegmentHolder(kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY, kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY);
    this.emptySegment = new LineSegmentHolder(kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY, kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY);
    this.positiveSegment = new LineSegmentHolder(0.0, kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY);
  }
  LineSegmentHolder$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var LineSegmentHolder$Companion_instance = null;
  function LineSegmentHolder$Companion_getInstance() {
    if (LineSegmentHolder$Companion_instance === null) {
      new LineSegmentHolder$Companion();
    }
    return LineSegmentHolder$Companion_instance;
  }
  LineSegmentHolder.prototype.pointInSegment_14dthe$ = function (point) {
    return rangeTo(this.from_0, this.to_0).contains_mef7kx$(point);
  };
  LineSegmentHolder.prototype.isSubzero = function () {
    return this.to_0 < 0;
  };
  LineSegmentHolder.prototype.isSubSegment_271ndl$ = function (segment) {
    return segment.from_0 <= this.from_0 && segment.to_0 >= this.to_0;
  };
  LineSegmentHolder.prototype.hasIntersection_271ndl$ = function (segment) {
    return !(segment.from_0 > this.to_0 || this.from_0 > segment.to_0);
  };
  LineSegmentHolder.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'LineSegmentHolder',
    interfaces: []
  };
  function toReal($receiver) {
    return Real_init($receiver);
  }
  function toReal_0($receiver) {
    return new Real($receiver);
  }
  function toRealOrNull($receiver) {
    var tmp$;
    var resultDouble = toDoubleOrNull($receiver);
    if (resultDouble === null) {
      tmp$ = null;
    }
     else {
      tmp$ = new Real(resultDouble);
    }
    return tmp$;
  }
  function Real(value) {
    Real$Companion_getInstance();
    this.value = value;
  }
  function Real$Companion() {
    Real$Companion_instance = this;
    this.PI = new Real(math.PI);
    this.EPSILON = 1.19E-6;
    this.POSITIVE_INFINITY_0 = new Real(kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY);
    this.NEGATIVE_INFINITY_0 = new Real(kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY);
  }
  Real$Companion.prototype.sin_vit0pu$ = function (arg) {
    var x = arg.value;
    return new Real(Math_0.sin(x));
  };
  Real$Companion.prototype.cos_vit0pu$ = function (arg) {
    var x = arg.value;
    return new Real(Math_0.cos(x));
  };
  Real$Companion.prototype.tan_vit0pu$ = function (arg) {
    var x = arg.value;
    return new Real(Math_0.tan(x));
  };
  Real$Companion.prototype.exp_vit0pu$ = function (arg) {
    var tmp$;
    if (arg === this.POSITIVE_INFINITY_0)
      tmp$ = this.POSITIVE_INFINITY_0;
    else if (arg === this.NEGATIVE_INFINITY_0)
      tmp$ = Real_init(0);
    else {
      var x = arg.value;
      tmp$ = new Real(Math_0.exp(x));
    }
    return tmp$;
  };
  Real$Companion.prototype.asin_vit0pu$ = function (arg) {
    var x = arg.value;
    return new Real(Math_0.asin(x));
  };
  Real$Companion.prototype.acos_vit0pu$ = function (arg) {
    var x = arg.value;
    return new Real(Math_0.acos(x));
  };
  Real$Companion.prototype.atan_vit0pu$ = function (arg) {
    var tmp$;
    if (arg === this.POSITIVE_INFINITY_0)
      tmp$ = new Real(math.PI / 2);
    else if (arg === this.NEGATIVE_INFINITY_0)
      tmp$ = new Real(-math.PI / 2);
    else {
      var x = arg.value;
      tmp$ = new Real(Math_0.atan(x));
    }
    return tmp$;
  };
  Real$Companion.prototype.sinh_vit0pu$ = function (arg) {
    var x = arg.value;
    return new Real(Math_0.sinh(x));
  };
  Real$Companion.prototype.cosh_vit0pu$ = function (arg) {
    var x = arg.value;
    return new Real(Math_0.cosh(x));
  };
  Real$Companion.prototype.tanh_vit0pu$ = function (arg) {
    var x = arg.value;
    return new Real(Math_0.tanh(x));
  };
  Real$Companion.prototype.ln_vit0pu$ = function (arg) {
    var tmp$;
    if (arg === this.POSITIVE_INFINITY_0)
      tmp$ = this.POSITIVE_INFINITY_0;
    else {
      var x = arg.value;
      if (Math_0.log(x) === kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY)
        tmp$ = this.NEGATIVE_INFINITY_0;
      else {
        var x_0 = arg.value;
        tmp$ = new Real(Math_0.log(x_0));
      }
    }
    return tmp$;
  };
  Real$Companion.prototype.abs_vit0pu$ = function (arg) {
    var tmp$;
    if (arg === this.POSITIVE_INFINITY_0 || arg === this.NEGATIVE_INFINITY_0) {
      tmp$ = this.POSITIVE_INFINITY_0;
    }
     else {
      var x = arg.value;
      tmp$ = new Real(Math_0.abs(x));
    }
    return tmp$;
  };
  Real$Companion.prototype.pow2_vit0pu$ = function (arg) {
    var tmp$;
    if (arg === this.POSITIVE_INFINITY_0 || arg === this.NEGATIVE_INFINITY_0) {
      tmp$ = this.POSITIVE_INFINITY_0;
    }
     else {
      tmp$ = new Real(arg.value * arg.value);
    }
    return tmp$;
  };
  Real$Companion.prototype.sqrt_vit0pu$ = function (arg) {
    var tmp$;
    if (arg === this.POSITIVE_INFINITY_0) {
      tmp$ = this.POSITIVE_INFINITY_0;
    }
     else {
      var x = arg.value;
      tmp$ = new Real(Math_0.sqrt(x));
    }
    return tmp$;
  };
  Real$Companion.$metadata$ = {
    kind: Kind_OBJECT,
    simpleName: 'Companion',
    interfaces: []
  };
  var Real$Companion_instance = null;
  function Real$Companion_getInstance() {
    if (Real$Companion_instance === null) {
      new Real$Companion();
    }
    return Real$Companion_instance;
  }
  Real.prototype.compareTo_11rb$ = function (other) {
    return Kotlin.compareTo(this.value, other.value);
  };
  Real.prototype.plus_vit0pu$ = function (other) {
    return new Real(this.value + other.value);
  };
  Real.prototype.minus_vit0pu$ = function (other) {
    return new Real(this.value - other.value);
  };
  Real.prototype.times_vit0pu$ = function (other) {
    return new Real(this.value * other.value);
  };
  Real.prototype.div_vit0pu$ = function (other) {
    return new Real(this.value / other.value);
  };
  Real.prototype.unaryMinus = function () {
    return new Real(-this.value);
  };
  Real.prototype.additivelyEqualTo_vit0pu$ = function (number) {
    return rangeTo(-Real$Companion_getInstance().EPSILON, Real$Companion_getInstance().EPSILON).contains_mef7kx$(this.value - number.value);
  };
  Real.prototype.additivelyEqualToZero = function () {
    return rangeTo(-Real$Companion_getInstance().EPSILON, Real$Companion_getInstance().EPSILON).contains_mef7kx$(this.value);
  };
  Real.prototype.pow_vit0pu$ = function (arg) {
    var tmp$;
    if (this.additivelyEqualToZero()) {
      tmp$ = Real_init(0);
    }
     else {
      var $receiver = this.value;
      var x = arg.value;
      tmp$ = new Real(Math_0.pow($receiver, x));
    }
    return tmp$;
  };
  Real.prototype.toDouble = function () {
    return this.value;
  };
  Real.prototype.toString = function () {
    return this.value.toString();
  };
  Real.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'Real',
    interfaces: [Comparable]
  };
  function Real_init(value, $this) {
    $this = $this || Object.create(Real.prototype);
    Real.call($this, value);
    return $this;
  }
  function InequalityApproximateSolver(baseOperationsDefinitions) {
    if (baseOperationsDefinitions === void 0)
      baseOperationsDefinitions = new BaseOperationsDefinitions();
    this.baseOperationsDefinitions_0 = baseOperationsDefinitions;
  }
  InequalityApproximateSolver.prototype.isLinear_6718cy$ = function (expressionNode) {
    return true;
  };
  InequalityApproximateSolver.prototype.isQuadratic_6718cy$ = function (expressionNode) {
    return true;
  };
  InequalityApproximateSolver.prototype.isConstant_5lmvi0$ = function ($receiver, variables) {
    var tmp$;
    if (variables.contains_11rb$($receiver.value))
      return false;
    tmp$ = $receiver.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      if (!this.isConstant_5lmvi0$(child, variables))
        return false;
    }
    return true;
  };
  InequalityApproximateSolver.prototype.isPolynom_5lmvi0$ = function ($receiver, variables) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2;
    if ($receiver.children.isEmpty())
      return true;
    tmp$ = $receiver.value;
    if (contains_0('', tmp$) || equals(tmp$, '+') || equals(tmp$, '-') || equals(tmp$, '*')) {
      tmp$_0 = $receiver.children.iterator();
      while (tmp$_0.hasNext()) {
        var child = tmp$_0.next();
        if (!this.isPolynom_5lmvi0$(child, variables))
          return false;
      }
    }
     else if (contains_0('/', tmp$) || equals(tmp$, '^')) {
      if (!this.isPolynom_5lmvi0$(first($receiver.children), variables))
        return false;
      tmp$_1 = $receiver.children.size;
      for (var i = 1; i < tmp$_1; i++) {
        if (!this.isConstant_5lmvi0$($receiver.children.get_za3lpa$(i), variables))
          return false;
      }
    }
     else {
      tmp$_2 = $receiver.children.iterator();
      while (tmp$_2.hasNext()) {
        var child_0 = tmp$_2.next();
        if (!this.isConstant_5lmvi0$(child_0, variables))
          return false;
      }
    }
    return true;
  };
  InequalityApproximateSolver.prototype.isPolynomThatCanHaveDivsOnlyOnTopLevel_5lmvi0$ = function ($receiver, variables) {
    var tmp$, tmp$_0, tmp$_1;
    tmp$ = $receiver.value;
    if (contains_0('*', tmp$) || equals(tmp$, '')) {
      tmp$_0 = $receiver.children.iterator();
      while (tmp$_0.hasNext()) {
        var child = tmp$_0.next();
        if (!this.isPolynomThatCanHaveDivsOnlyOnTopLevel_5lmvi0$(child, variables))
          return false;
      }
    }
     else if (contains_0('/', tmp$)) {
      tmp$_1 = $receiver.children.iterator();
      while (tmp$_1.hasNext()) {
        var child_0 = tmp$_1.next();
        if (!this.isPolynom_5lmvi0$(child_0, variables))
          return false;
      }
    }
     else
      return this.isPolynom_5lmvi0$($receiver, variables);
    return true;
  };
  InequalityApproximateSolver.prototype.findTopMultipliers_csr4zj$ = function ($receiver, variable) {
  };
  InequalityApproximateSolver.prototype.findVariableNode_csr4zj$ = function ($receiver, variable) {
    var tmp$;
    var variableChildNumber = -1;
    tmp$ = get_lastIndex($receiver.children);
    for (var i = 0; i <= tmp$; i++) {
      if (!this.isConstant_5lmvi0$($receiver.children.get_za3lpa$(i), setOf(variable))) {
        if (variableChildNumber < 0)
          variableChildNumber = i;
        else
          return $receiver.children.size;
      }
    }
    return variableChildNumber;
  };
  InequalityApproximateSolver.prototype.fastTopResolver_csr4zj$ = function ($receiver, variable) {
    var tmp$, tmp$_0, tmp$_1, tmp$_2, tmp$_3, tmp$_4, tmp$_5, tmp$_6, tmp$_7, tmp$_8, tmp$_9, tmp$_10;
    var result = new VariableProperties(variable, mutableListOf([new SegmentsUnion()]));
    var variableChildNumber = this.findVariableNode_csr4zj$($receiver, variable);
    tmp$ = get_lastIndex($receiver.children);
    if (!(0 <= variableChildNumber && variableChildNumber <= tmp$))
      return null;
    var varChild = $receiver.children.get_za3lpa$(variableChildNumber);
    var root = new ExpressionNode(NodeType$FUNCTION_getInstance(), '');
    if (equals(varChild.value, variable)) {
      switch ($receiver.value) {
        case '+':
          root.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '+'));
          tmp$_0 = get_lastIndex($receiver.children);
          for (var i = 0; i <= tmp$_0; i++) {
            if (i !== variableChildNumber) {
              if (equals($receiver.children.get_za3lpa$(i).value, '-')) {
                first(root.children).addChild_6718cy$(first($receiver.children.get_za3lpa$(i).children).clone());
              }
               else {
                var additive = new ExpressionNode(NodeType$FUNCTION_getInstance(), '-');
                additive.addChild_6718cy$($receiver.children.get_za3lpa$(i).clone());
                first(root.children).addChild_6718cy$(additive);
              }
            }
          }

          first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(root));
          break;
        case '-':
          if ($receiver.children.size === 1) {
            root.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '0'));
            first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(void 0, root));
          }
           else {
            if (variableChildNumber === 0) {
              root.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '+'));
              tmp$_1 = get_lastIndex($receiver.children);
              for (var i_0 = 1; i_0 <= tmp$_1; i_0++) {
                first(root.children).addChild_6718cy$($receiver.children.get_za3lpa$(i_0).clone());
              }
              first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(root));
            }
             else {
              if ($receiver.children.size === 2)
                root.addChild_6718cy$($receiver.children.get_za3lpa$(0).clone());
              else {
                root.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '-'));
                tmp$_2 = get_lastIndex($receiver.children);
                for (var i_1 = 0; i_1 <= tmp$_2; i_1++) {
                  if (i_1 !== variableChildNumber) {
                    first(root.children).addChild_6718cy$($receiver.children.get_za3lpa$(i_1).clone());
                  }
                }
              }
              first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(void 0, root));
            }
          }

          break;
        case '*':
          if ($receiver.children.size === 2) {
            tmp$_3 = toDoubleOrNull($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).value);
            if (tmp$_3 == null) {
              return null;
            }
            var mult = tmp$_3;
            if (mult > 0) {
              root.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '0'));
              first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(root));
            }
             else if (mult < 0) {
              root.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '0'));
              first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(void 0, root));
            }
             else
              first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment());
          }
           else
            return null;
          break;
        case '/':
          if ($receiver.children.size === 2) {
            tmp$_4 = toDoubleOrNull($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).value);
            if (tmp$_4 == null) {
              return null;
            }
            var mult_0 = tmp$_4;
            if (mult_0 > 0) {
              root.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '0'));
              first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(root));
            }
             else if (mult_0 < 0) {
              root.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '0'));
              first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(void 0, root));
            }
          }
           else
            return null;
          break;
        case '^':
          if (variableChildNumber === 0) {
            root.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '0'));
            first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(root));
          }
           else if ($receiver.children.size === 2) {
            first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment());
          }
           else
            return null;
          break;
        case 'exp':
          first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment());
          break;
        case 'ln':
          root.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '1'));
          first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(root, void 0, void 0, false));
          break;
        case 'S':
          if ($receiver.children.size !== 4)
            return null;
          switch (variableChildNumber) {
            case 1:
            case 2:
              if (equals($receiver.children.get_za3lpa$(3).value, $receiver.children.get_za3lpa$(0).value)) {
                root.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '+'));
                first(root.children).addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '-'));
                first(first(root.children).children).addChild_6718cy$($receiver.children.get_za3lpa$(variableChildNumber - 1 | 0).clone());
                first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(root));
              }
               else
                return null;
              break;
            case 3:
              var multNode = new ExpressionNode(NodeType$FUNCTION_getInstance(), '-');
              multNode.addChild_6718cy$($receiver.children.get_za3lpa$(2).clone());
              multNode.addChild_6718cy$($receiver.children.get_za3lpa$(1).clone());
              this.baseOperationsDefinitions_0.computeExpressionTree_6718cy$(multNode);
              tmp$_5 = toDoubleOrNull(multNode.value);
              if (tmp$_5 == null) {
                return null;
              }

              var mult_1 = tmp$_5;
              if (mult_1 > 0) {
                root.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '0'));
                first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(root));
              }
               else if (mult_1 < 0) {
                root.addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), '0'));
                first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(void 0, root));
              }
               else
                first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment());
              break;
            default:first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment());
              break;
          }

          break;
        default:return null;
      }
      return result;
    }
     else if ($receiver.children.size > 2)
      return null;
    else if (equals($receiver.value, '+')) {
      var variableGrandSonNumber = this.findVariableNode_csr4zj$(varChild, variable);
      var varGrandSon = varChild.children.get_za3lpa$(variableGrandSonNumber);
      if (equals(varGrandSon.value, variable)) {
        switch (varChild.value) {
          case '-':
            if (varChild.children.size === 1) {
              root.addChild_6718cy$($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).clone());
              first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(void 0, root));
            }
             else {
              root.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '+'));
              if (variableGrandSonNumber === 0) {
                tmp$_6 = get_lastIndex(varChild.children);
                for (var i_2 = 1; i_2 <= tmp$_6; i_2++) {
                  first(root.children).addChild_6718cy$(varChild.children.get_za3lpa$(i_2).clone());
                }
                if (equals($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).value, '-')) {
                  first(root.children).addChild_6718cy$($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).clone());
                }
                 else {
                  first(root.children).addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '-'));
                  first(first(root.children).children).addChild_6718cy$($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).clone());
                }
                first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(root));
              }
               else {
                first(root.children).addChild_6718cy$($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).clone());
                if (varChild.children.size === 2)
                  first(root.children).addChild_6718cy$(varChild.children.get_za3lpa$(0).clone());
                else {
                  first(root.children).addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '-'));
                  tmp$_7 = get_lastIndex(varChild.children);
                  for (var i_3 = 0; i_3 <= tmp$_7; i_3++) {
                    if (i_3 !== variableGrandSonNumber) {
                      first(first(root.children).children).addChild_6718cy$(varChild.children.get_za3lpa$(i_3).clone());
                    }
                  }
                }
                first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(void 0, root));
              }
            }

            break;
          case '*':
            if (varChild.children.size === 2) {
              tmp$_8 = toDoubleOrNull(varChild.children.get_za3lpa$(1 - variableGrandSonNumber | 0).value);
              if (tmp$_8 == null) {
                return null;
              }
              var mult_2 = tmp$_8;
              root.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '/'));
              if (equals($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).value, '-')) {
                first(root.children).addChild_6718cy$($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).clone());
              }
               else {
                first(root.children).addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '+'));
                first(first(root.children).children).addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '-'));
                first(first(first(root.children).children).children).addChild_6718cy$($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).clone());
              }
              if (mult_2 > 0) {
                first(root.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), mult_2.toString()));
                first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(root));
              }
               else if (mult_2 < 0) {
                first(root.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), (-mult_2).toString()));
                first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(void 0, root));
              }
               else {
                tmp$_9 = toDoubleOrNull($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).value);
                if (tmp$_9 == null) {
                  return null;
                }
                var const_0 = tmp$_9;
                if (const_0 > 0)
                  first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment());
              }
            }
             else
              return null;
            break;
          case '/':
            if ($receiver.children.size === 2) {
              tmp$_10 = toDoubleOrNull(varChild.children.get_za3lpa$(1 - variableGrandSonNumber | 0).value);
              if (tmp$_10 == null) {
                return null;
              }
              var mult_3 = tmp$_10;
              if (variableGrandSonNumber === 0) {
                root.addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '*'));
                if (equals($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).value, '-')) {
                  first(root.children).addChild_6718cy$($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).clone());
                }
                 else {
                  first(root.children).addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '+'));
                  first(first(root.children).children).addChild_6718cy$(new ExpressionNode(NodeType$FUNCTION_getInstance(), '-'));
                  first(first(first(root.children).children).children).addChild_6718cy$($receiver.children.get_za3lpa$(1 - variableChildNumber | 0).clone());
                }
                if (mult_3 > 0) {
                  first(root.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), mult_3.toString()));
                  first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(root));
                }
                 else if (mult_3 < 0) {
                  first(root.children).addChild_6718cy$(new ExpressionNode(NodeType$VARIABLE_getInstance(), (-mult_3).toString()));
                  first(result.segmentsUnionsIntersection).segmentsUnion.add_11rb$(new Segment(void 0, root));
                }
              }
               else
                return null;
            }
             else
              return null;
            break;
          default:return null;
        }
        return result;
      }
       else if (equals(varChild.value, '-')) {
        var variableGreatGrandSonNumber = this.findVariableNode_csr4zj$(varGrandSon, variable);
        var varGreatGrandSon = varChild.children.get_za3lpa$(variableGreatGrandSonNumber);
        if (!equals(varGreatGrandSon.value, variable))
          return null;
      }
       else
        return null;
    }
     else if (!equals($receiver.value, '-'))
      return null;
    return result;
  };
  InequalityApproximateSolver.prototype.solveExpressionMoreThanNull_6718cy$ = function (expressionNode) {
    var tmp$;
    var expression = expressionNode.cloneWithNormalization_1g1bdl$(void 0, false);
    this.baseOperationsDefinitions_0.computeExpressionTree_6718cy$(expression.children.get_za3lpa$(0));
    var variables = expression.getVariableNames();
    var result = LinkedHashMap_init_0();
    tmp$ = variables.iterator();
    while (tmp$.hasNext()) {
      var variable = tmp$.next();
      var fastResolverResult = this.fastTopResolver_csr4zj$(expression, variable);
      if (fastResolverResult == null) {
        if (!this.isPolynomThatCanHaveDivsOnlyOnTopLevel_5lmvi0$(expression, setOf(variable)))
          result.put_xwzc9p$(variable, new VariableProperties(variable, void 0, true));
      }
       else {
        result.put_xwzc9p$(variable, fastResolverResult);
      }
    }
    return result;
  };
  InequalityApproximateSolver.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'InequalityApproximateSolver',
    interfaces: []
  };
  function Case(name, ordinal, string) {
    Enum.call(this);
    this.string = string;
    this.name$ = name;
    this.ordinal$ = ordinal;
  }
  function Case_initFields() {
    Case_initFields = function () {
    };
    Case$ONE_DIMENSIONAL_POLYNOMIAL_instance = new Case('ONE_DIMENSIONAL_POLYNOMIAL', 0, 'one dimensional polynomial');
    Case$NONE_instance = new Case('NONE', 1, 'none');
  }
  var Case$ONE_DIMENSIONAL_POLYNOMIAL_instance;
  function Case$ONE_DIMENSIONAL_POLYNOMIAL_getInstance() {
    Case_initFields();
    return Case$ONE_DIMENSIONAL_POLYNOMIAL_instance;
  }
  var Case$NONE_instance;
  function Case$NONE_getInstance() {
    Case_initFields();
    return Case$NONE_instance;
  }
  Case.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'Case',
    interfaces: [Enum]
  };
  function Case$values() {
    return [Case$ONE_DIMENSIONAL_POLYNOMIAL_getInstance(), Case$NONE_getInstance()];
  }
  Case.values = Case$values;
  function Case$valueOf(name) {
    switch (name) {
      case 'ONE_DIMENSIONAL_POLYNOMIAL':
        return Case$ONE_DIMENSIONAL_POLYNOMIAL_getInstance();
      case 'NONE':
        return Case$NONE_getInstance();
      default:throwISE('No enum constant optimizerutils.Case.' + name);
    }
  }
  Case.valueOf_61zpoe$ = Case$valueOf;
  function SpecialCaseSolver(left, right) {
    this.left = left;
    this.right = right;
    this.case = Case$NONE_getInstance();
    this.eps_0 = 1.0E-7;
    if (this.isPolynomial_0(this.left) && this.isPolynomial_0(this.right)) {
      var leftVariables = this.left.getContainedVariables();
      var rightVariables = this.right.getContainedVariables();
      if (leftVariables.size <= 1 && rightVariables.size <= 1 && union(leftVariables, rightVariables).size <= 1) {
        this.case = Case$ONE_DIMENSIONAL_POLYNOMIAL_getInstance();
      }
    }
    this.preciseSolutionDegree_0 = 10;
    this.approximatePolynomialSolutionDegree_0 = 100;
  }
  SpecialCaseSolver.prototype.currentCase = function () {
    return this.case;
  };
  SpecialCaseSolver.prototype.solve_d62imr$ = function (comparisonType, leftBorder, rightBorder) {
    if (leftBorder === void 0)
      leftBorder = kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY;
    if (rightBorder === void 0)
      rightBorder = kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY;
    if (equals(this.case, Case$ONE_DIMENSIONAL_POLYNOMIAL_getInstance()))
      return this.solveForPolynomials_0(comparisonType, leftBorder, rightBorder);
    else
      throw Exception_init("I can't solve this type of tasks");
  };
  SpecialCaseSolver.prototype.polynomialCanBeNegative_0 = function (coefs, leftBorder, rightBorder) {
    var tmp$;
    var deg = this.getPolynomialDegree_0(coefs);
    if (deg < 0)
      return false;
    if (deg === 0)
      return coefs.get_za3lpa$(0) < -this.eps_0;
    if (this.valueAt_0(coefs, leftBorder) < -this.eps_0 || this.valueAt_0(coefs, rightBorder) < -this.eps_0)
      return true;
    if (deg < this.preciseSolutionDegree_0) {
      switch (deg) {
        case 1:
          tmp$ = this.solutionForPolynomialWithDeg1_0(coefs, leftBorder, rightBorder);
          break;
        case 2:
          tmp$ = this.solutionForPolynomialWithDeg2_0(coefs, leftBorder, rightBorder);
          break;
        case 3:
          tmp$ = this.solutionForPolynomialWithDeg3_0(coefs, leftBorder, rightBorder);
          break;
        case 4:
          tmp$ = this.solutionForPolynomialWithDeg4_0(coefs, leftBorder, rightBorder);
          break;
        default:tmp$ = this.solutionForPolynomialWithMediumDeg_0(coefs, leftBorder, rightBorder);
          break;
      }
      return tmp$;
    }
     else if (deg < this.approximatePolynomialSolutionDegree_0)
      return this.solutionForPolynomialWithLargeDeg_0(coefs, leftBorder, rightBorder);
    else
      throw Exception_init("I can't solve this type of tasks");
  };
  SpecialCaseSolver.prototype.getPolynomialRoots_0 = function (coefs, leftBorder, rightBorder, iterCount, newtonIterationCount) {
    if (iterCount === void 0)
      iterCount = 20;
    if (newtonIterationCount === void 0)
      newtonIterationCount = 5;
    var tmp$, tmp$_0;
    var deg = this.getPolynomialDegree_0(coefs);
    if (deg <= 0) {
      return ArrayList_init();
    }
    if (deg === 1) {
      var root = -coefs.get_za3lpa$(0) / coefs.get_za3lpa$(1);
      if (root < leftBorder - this.eps_0 || root > rightBorder + this.eps_0) {
        return ArrayList_init();
      }
      return arrayListOf([root]);
    }
    var derivative = this.derivativeForPolynomial_l8u4bv$(coefs);
    var derivativeRoots = this.getPolynomialRoots_0(derivative, leftBorder, rightBorder, iterCount, newtonIterationCount);
    var values = ArrayList_init();
    if (derivativeRoots.isEmpty() || derivativeRoots.get_za3lpa$(0) - leftBorder > this.eps_0) {
      derivativeRoots.add_wxm5ur$(0, leftBorder);
      values.add_11rb$(this.valueAt_0(coefs, leftBorder));
    }
    tmp$ = derivativeRoots.size;
    for (var i = 1; i < tmp$; i++)
      values.add_11rb$(this.valueAt_0(coefs, derivativeRoots.get_za3lpa$(i)));
    if (derivativeRoots.isEmpty() || rightBorder - derivativeRoots.get_za3lpa$(derivativeRoots.size - 1 | 0) > this.eps_0) {
      derivativeRoots.add_11rb$(rightBorder);
      values.add_11rb$(this.valueAt_0(coefs, rightBorder));
    }
    var roots = ArrayList_init();
    tmp$_0 = values.size;
    for (var i_0 = 1; i_0 < tmp$_0; i_0++) {
      if (Kotlin.imul(this.sign_0(values.get_za3lpa$(i_0 - 1 | 0)), this.sign_0(values.get_za3lpa$(i_0))) === 1)
        continue;
      if (this.sign_0(values.get_za3lpa$(i_0 - 1 | 0)) === 0)
        roots.add_11rb$(derivativeRoots.get_za3lpa$(i_0 - 1 | 0));
      else {
        if (this.sign_0(values.get_za3lpa$(i_0)) === 0 && (i_0 + 1 | 0) < values.size)
          continue;
        var l = derivativeRoots.get_za3lpa$(i_0 - 1 | 0);
        var r = derivativeRoots.get_za3lpa$(i_0);
        for (var iter = 0; iter < iterCount; iter++) {
          var m = (l + r) / 2;
          if (l > 0 || r < 0) {
            var x = l * r;
            m = Math_0.sqrt(x) * this.sign_0(l);
          }
           else {
            if (l * l < r && r > 1) {
              var x_0 = r;
              var a = Math_0.sqrt(x_0);
              var b = m;
              m = Math_0.min(a, b);
            }
            if (r * r < -l && l < -1) {
              var x_1 = -l;
              var a_0 = -Math_0.sqrt(x_1);
              var b_0 = m;
              m = Math_0.max(a_0, b_0);
            }
          }
          if (this.sign_0(this.valueAt_0(coefs, m)) !== this.sign_0(values.get_za3lpa$(i_0)))
            l = m;
          else
            r = m;
        }
        for (var iter_0 = 0; iter_0 < newtonIterationCount; iter_0++)
          l += -this.valueAt_0(coefs, l) / this.valueAt_0(derivative, l);
        if (this.sign_0(this.valueAt_0(coefs, l)) === 0)
          roots.add_11rb$(l);
      }
    }
    return roots;
  };
  SpecialCaseSolver.prototype.isPolynomial_0 = function (node) {
    var tmp$;
    tmp$ = node.children.iterator();
    while (tmp$.hasNext()) {
      var child = tmp$.next();
      if (!this.isPolynomial_0(child))
        return false;
    }
    if (node.nodeType === NodeType$FUNCTION_getInstance()) {
      if (equals(node.value, '+') || equals(node.value, '*') || equals(node.value, '-') || equals(node.value, ''))
        return true;
      if (equals(node.value, '^')) {
        if (node.children.size !== 2)
          return false;
        var n = toIntOrNull(node.children.get_za3lpa$(1).value);
        return n != null && n >= 0;
      }
      return false;
    }
    return true;
  };
  SpecialCaseSolver.prototype.solveForPolynomials_0 = function (comparisonType, leftBorder, rightBorder) {
    var tmp$;
    var leftPoly = this.toPolynomial_6718cy$(this.left);
    var rightPoly = this.toPolynomial_6718cy$(this.right);
    var a = leftPoly.size;
    var b = rightPoly.size;
    tmp$ = Math_0.max(a, b);
    for (var i = 0; i < tmp$; i++) {
      if (i >= leftPoly.size)
        leftPoly.add_11rb$(0.0);
      if (i < rightPoly.size)
        leftPoly.set_wxm5ur$(i, leftPoly.get_za3lpa$(i) - rightPoly.get_za3lpa$(i));
    }
    if (comparisonType === ComparisonType$LEFT_MORE_OR_EQUAL_getInstance())
      return !this.polynomialCanBeNegative_0(leftPoly, leftBorder, rightBorder);
    if (comparisonType === ComparisonType$LEFT_MORE_getInstance()) {
      leftPoly.set_wxm5ur$(0, leftPoly.get_za3lpa$(0) - 5 * this.eps_0);
      return !this.polynomialCanBeNegative_0(leftPoly, leftBorder, rightBorder);
    }
    for (var i_0 = 0; i_0 !== leftPoly.size; ++i_0) {
      leftPoly.set_wxm5ur$(i_0, -leftPoly.get_za3lpa$(i_0));
    }
    if (comparisonType === ComparisonType$LEFT_LESS_OR_EQUAL_getInstance())
      return !this.polynomialCanBeNegative_0(leftPoly, leftBorder, rightBorder);
    if (comparisonType === ComparisonType$LEFT_LESS_getInstance()) {
      leftPoly.set_wxm5ur$(0, leftPoly.get_za3lpa$(0) - 5 * this.eps_0);
      return !this.polynomialCanBeNegative_0(leftPoly, leftBorder, rightBorder);
    }
    if (comparisonType === ComparisonType$EQUAL_getInstance()) {
      if (leftBorder !== kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY && rightBorder !== kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY && leftBorder === rightBorder)
        return this.sign_0(this.valueAt_0(leftPoly, leftBorder)) === 0;
      return this.getPolynomialDegree_0(leftPoly) === -1;
    }
    return false;
  };
  SpecialCaseSolver.prototype.toPolynomial_6718cy$ = function (node) {
    var tmp$, tmp$_0, tmp$_1;
    if (node.nodeType === NodeType$VARIABLE_getInstance()) {
      if (node.isNumberValue())
        return arrayListOf([toDouble(node.value)]);
      return arrayListOf([0.0, 1.0]);
    }
    if (node.nodeType === NodeType$FUNCTION_getInstance()) {
      if (equals(node.value, '+')) {
        var res = ArrayList_init();
        tmp$ = node.children.iterator();
        while (tmp$.hasNext()) {
          var child = tmp$.next();
          var childPoly = this.toPolynomial_6718cy$(child);
          tmp$_0 = childPoly.size;
          for (var i = 0; i < tmp$_0; i++) {
            if (i >= res.size)
              res.add_11rb$(0.0);
            res.set_wxm5ur$(i, res.get_za3lpa$(i) + childPoly.get_za3lpa$(i));
          }
        }
        return res;
      }
      if (equals(node.value, '-')) {
        var res_0 = this.toPolynomial_6718cy$(node.children.get_za3lpa$(0));
        for (var i_0 = 0; i_0 !== res_0.size; ++i_0) {
          res_0.set_wxm5ur$(i_0, -res_0.get_za3lpa$(i_0));
        }
        return res_0;
      }
      if (equals(node.value, '*')) {
        var res_1 = arrayListOf([1.0]);
        tmp$_1 = node.children.iterator();
        while (tmp$_1.hasNext()) {
          var child_0 = tmp$_1.next();
          res_1 = this.multiplyPolynomials_0(res_1, this.toPolynomial_6718cy$(child_0));
        }
        return res_1;
      }
      if (equals(node.value, '^')) {
        var res_2 = this.toPolynomial_6718cy$(node.children.get_za3lpa$(0));
        res_2 = this.power_0(res_2, toInt(node.children.get_za3lpa$(1).value));
        return res_2;
      }
      if (equals(node.value, ''))
        return this.toPolynomial_6718cy$(node.children.get_za3lpa$(0));
    }
    return ArrayList_init();
  };
  SpecialCaseSolver.prototype.multiplyPolynomials_0 = function (a, b) {
    var tmp$;
    var res = ArrayList_init();
    tmp$ = a.size + b.size - 1 | 0;
    for (var i = 0; i < tmp$; i++)
      res.add_11rb$(0.0);
    for (var i_0 = 0; i_0 !== a.size; ++i_0) {
      for (var j = 0; j !== b.size; ++j) {
        res.set_wxm5ur$(i_0 + j | 0, res.get_za3lpa$(i_0 + j | 0) + a.get_za3lpa$(i_0) * b.get_za3lpa$(j));
      }
    }
    return res;
  };
  SpecialCaseSolver.prototype.power_0 = function (poly, n) {
    var t = n;
    var cur = poly;
    var res = arrayListOf([1.0]);
    while (t > 0) {
      if (t % 2 === 1)
        res = this.multiplyPolynomials_0(res, cur);
      cur = this.multiplyPolynomials_0(cur, cur);
      t = t / 2 | 0;
    }
    return res;
  };
  SpecialCaseSolver.prototype.sign_0 = function (x) {
    if (x < -this.eps_0)
      return -1;
    if (x > this.eps_0)
      return 1;
    return 0;
  };
  SpecialCaseSolver.prototype.valueAt_0 = function (coef, point) {
    var tmp$;
    if (point > kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY && point < kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY) {
      var cur = 1.0;
      var res = 0.0;
      tmp$ = coef.iterator();
      while (tmp$.hasNext()) {
        var c = tmp$.next();
        res += c * cur;
        cur *= point;
      }
      return res;
    }
    var deg = this.getPolynomialDegree_0(coef);
    if (deg % 2 === 0 || point === kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY)
      return coef.get_za3lpa$(deg) > this.eps_0 ? kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY : kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY;
    return coef.get_za3lpa$(deg) > this.eps_0 ? kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY : kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY;
  };
  SpecialCaseSolver.prototype.derivativeForPolynomial_l8u4bv$ = function (coefs) {
    var deg = this.getPolynomialDegree_0(coefs);
    if (deg <= 0)
      return arrayListOf([0.0]);
    var derivative = ArrayList_init();
    for (var i = 0; i < deg; i++)
      derivative.add_11rb$(coefs.get_za3lpa$(i + 1 | 0) * (i + 1 | 0));
    return derivative;
  };
  SpecialCaseSolver.prototype.getPolynomialDegree_0 = function (coefs) {
    var deg = coefs.size - 1 | 0;
    while (deg >= 0 && abs_0(coefs.get_za3lpa$(deg)) < this.eps_0) {
      deg = deg - 1 | 0;
    }
    return deg;
  };
  SpecialCaseSolver.prototype.solutionForPolynomialWithDeg1_0 = function (coefs, leftBorder, rightBorder) {
    var root = -coefs.get_za3lpa$(0) / coefs.get_za3lpa$(1);
    var pointsToCheck = arrayListOf([leftBorder, rightBorder]);
    if (leftBorder - this.eps_0 < root && root < rightBorder + this.eps_0)
      pointsToCheck.add_11rb$(root);
    return this.checkCertainPoints_0(coefs, pointsToCheck);
  };
  SpecialCaseSolver.prototype.solutionForPolynomialWithDeg2_0 = function (coefs, leftBorder, rightBorder) {
    var pointsToCheck = arrayListOf([leftBorder, rightBorder]);
    var vert = -coefs.get_za3lpa$(1) / 2 / coefs.get_za3lpa$(2);
    if (leftBorder - this.eps_0 < vert && vert < rightBorder + this.eps_0)
      pointsToCheck.add_11rb$(vert);
    return this.checkCertainPoints_0(coefs, pointsToCheck);
  };
  SpecialCaseSolver.prototype.solutionForPolynomialWithDeg3_0 = function (coefs, leftBorder, rightBorder) {
    var pointsToCheck = arrayListOf([leftBorder, rightBorder]);
    var semiDiscriminant = coefs.get_za3lpa$(2) * coefs.get_za3lpa$(2) - 3 * coefs.get_za3lpa$(3) - coefs.get_za3lpa$(1);
    if (semiDiscriminant > this.eps_0) {
      var r1 = (-coefs.get_za3lpa$(2) + Math_0.sqrt(semiDiscriminant)) / 3 / coefs.get_za3lpa$(3);
      if (r1 > leftBorder - this.eps_0 && r1 < rightBorder + this.eps_0)
        pointsToCheck.add_11rb$(r1);
      var r2 = (-coefs.get_za3lpa$(2) - Math_0.sqrt(semiDiscriminant)) / 3 / coefs.get_za3lpa$(3);
      if (r2 > leftBorder - this.eps_0 && r2 < rightBorder + this.eps_0)
        pointsToCheck.add_11rb$(r2);
    }
    return this.checkCertainPoints_0(coefs, pointsToCheck);
  };
  SpecialCaseSolver.prototype.solutionForPolynomialWithDeg4_0 = function (coefs, leftBorder, rightBorder) {
    var tmp$;
    var derivative = this.derivativeForPolynomial_l8u4bv$(coefs);
    var pointsToCheck = arrayListOf([leftBorder, rightBorder]);
    var roots = this.rootsOfCubicPolynomial_l8u4bv$(derivative);
    tmp$ = roots.iterator();
    while (tmp$.hasNext()) {
      var root = tmp$.next();
      if (root > leftBorder - this.eps_0 && root < rightBorder + this.eps_0)
        pointsToCheck.add_11rb$(root);
    }
    return this.checkCertainPoints_0(coefs, pointsToCheck);
  };
  SpecialCaseSolver.prototype.solutionForPolynomialWithMediumDeg_0 = function (coefs, leftBorder, rightBorder) {
    var tmp$;
    var derivative = this.derivativeForPolynomial_l8u4bv$(coefs);
    var b = -1.0E9;
    var left = Math_0.max(leftBorder, b);
    var right = Math_0.min(rightBorder, 1.0E9);
    var derivativeRoots = this.getPolynomialRoots_0(derivative, left, right);
    derivativeRoots.add_11rb$(left);
    derivativeRoots.add_11rb$(right);
    tmp$ = derivativeRoots.iterator();
    while (tmp$.hasNext()) {
      var root = tmp$.next();
      if (this.valueAt_0(coefs, root) < -this.eps_0)
        return true;
    }
    return false;
  };
  SpecialCaseSolver.prototype.solutionForPolynomialWithLargeDeg_0 = function (coefs, leftBorder, rightBorder, iterCount) {
    if (iterCount === void 0)
      iterCount = 10;
    var tmp$;
    if (this.solutionForPolynomialWithMediumDeg_0(coefs, leftBorder, rightBorder))
      return true;
    var pointsToCheck = arrayListOf([leftBorder, rightBorder]);
    var derivative = this.derivativeForPolynomial_l8u4bv$(coefs);
    var deg = this.getPolynomialDegree_0(derivative);
    var q = ArrayList_init();
    tmp$ = derivative.iterator();
    while (tmp$.hasNext()) {
      var v = tmp$.next();
      q.add_11rb$(v / last(derivative));
    }
    var m = deg % 2 === 1 ? -1 : 1;
    for (var iterNumber = 1; iterNumber <= iterCount; iterNumber++) {
      for (var i = 0; i <= deg; i++) {
        var res = 0.0;
        for (var j = 0; j <= i; j++) {
          var c = j % 2 === 1 ? -1 : 1;
          res += q.get_za3lpa$(j) * q.get_za3lpa$(i - j | 0) * c;
        }
        q.set_wxm5ur$(i, res * m);
      }
      var tmp$_0 = q.get_za3lpa$(0);
      var x = 1 / Math_0.pow(2.0, iterNumber);
      var root1 = Math_0.pow(tmp$_0, x);
      if (leftBorder - this.eps_0 < root1 && root1 < rightBorder + this.eps_0)
        pointsToCheck.add_11rb$(root1);
      var tmp$_1 = q.get_za3lpa$(0);
      var x_0 = 1 / Math_0.pow(2.0, iterNumber);
      var root2 = Math_0.pow(tmp$_1, x_0);
      if (leftBorder - this.eps_0 < root2 && root2 < rightBorder + this.eps_0)
        pointsToCheck.add_11rb$(root2);
    }
    return this.checkCertainPoints_0(coefs, pointsToCheck);
  };
  SpecialCaseSolver.prototype.checkCertainPoints_0 = function (coefs, points) {
    var tmp$;
    tmp$ = points.iterator();
    while (tmp$.hasNext()) {
      var point = tmp$.next();
      if (this.valueAt_0(coefs, point) < -this.eps_0)
        return true;
    }
    return false;
  };
  SpecialCaseSolver.prototype.rootsOfCubicPolynomial_l8u4bv$ = function (poly) {
    var tmp$ = poly.get_za3lpa$(1) / poly.get_za3lpa$(3);
    var $receiver = poly.get_za3lpa$(2);
    var tmp$_0 = Math_0.pow($receiver, 2) / 3;
    var $receiver_0 = poly.get_za3lpa$(3);
    var p = tmp$ - tmp$_0 / Math_0.pow($receiver_0, 2);
    var tmp$_1 = poly.get_za3lpa$(0) / poly.get_za3lpa$(3);
    var $receiver_1 = poly.get_za3lpa$(2);
    var tmp$_2 = 2 * Math_0.pow($receiver_1, 3) / 27;
    var $receiver_2 = poly.get_za3lpa$(3);
    var tmp$_3 = tmp$_1 + tmp$_2 / Math_0.pow($receiver_2, 3);
    var tmp$_4 = poly.get_za3lpa$(2) * poly.get_za3lpa$(1) / 3;
    var $receiver_3 = poly.get_za3lpa$(3);
    var q = tmp$_3 - tmp$_4 / Math_0.pow($receiver_3, 2);
    var $receiver_4 = p / 3;
    var tmp$_5 = Math_0.pow($receiver_4, 3);
    var $receiver_5 = q / 2;
    var Q = tmp$_5 + Math_0.pow($receiver_5, 2);
    var r1;
    var r2 = null;
    var r3 = null;
    if (Q > this.eps_0) {
      var $receiver_6 = -q / 2 + Math_0.sqrt(Q);
      var x = 1.0 / 3;
      var alpha = Math_0.pow($receiver_6, x);
      var $receiver_7 = -q / 2 - Math_0.sqrt(Q);
      var x_0 = 1.0 / 3;
      var beta = Math_0.pow($receiver_7, x_0);
      r1 = alpha + beta;
    }
     else if (Q > -this.eps_0) {
      var $receiver_8 = -q / 2;
      var x_1 = 1.0 / 3;
      var alpha_0 = Math_0.pow($receiver_8, x_1);
      r1 = 2 * alpha_0;
      r2 = -alpha_0;
    }
     else {
      var $receiver_9 = q / 2;
      var $receiver_10 = Math_0.pow($receiver_9, 2) + -Q;
      var x_2 = 1.0 / 6;
      var r = Math_0.pow($receiver_10, x_2);
      var x_3 = -Q;
      var y = Math_0.sqrt(x_3);
      var x_4 = -q / 2;
      var phi = Math_0.atan2(y, x_4) / 3;
      var re = r * Math_0.cos(phi);
      var im = r * Math_0.sin(phi);
      r1 = 2 * re;
      r2 = -re + Math_0.sqrt(3.0) * im;
      r3 = -re - Math_0.sqrt(3.0) * im;
    }
    var roots = arrayListOf([r1 - poly.get_za3lpa$(2) / 3 / poly.get_za3lpa$(3)]);
    if (r2 != null)
      roots.add_11rb$(r2 - poly.get_za3lpa$(2) / 3 / poly.get_za3lpa$(3));
    if (r3 != null)
      roots.add_11rb$(r3 - poly.get_za3lpa$(2) / 3 / poly.get_za3lpa$(3));
    return roots;
  };
  SpecialCaseSolver.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'SpecialCaseSolver',
    interfaces: []
  };
  function CompressedNodeDouble(func, value) {
    if (func === void 0)
      func = '';
    if (value === void 0)
      value = 0.0;
    this.func = func;
    this.value = value;
    this.children = ArrayList_init();
    this.functor = null;
    if (this.func.length > 0) {
      var baseFunctions = (new BaseOperationsComputation(ComputationType$DOUBLE_getInstance())).baseComputationDouble;
      var key = this.func;
      var tmp$;
      if ((Kotlin.isType(tmp$ = baseFunctions, Map) ? tmp$ : throwCCE()).containsKey_11rb$(key))
        this.functor = baseFunctions.get_11rb$(this.func);
      else
        throw Kotlin.newThrowable('invalid function ' + this.func);
    }
  }
  CompressedNodeDouble.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'CompressedNodeDouble',
    interfaces: []
  };
  CompressedNodeDouble.prototype.component1 = function () {
    return this.func;
  };
  CompressedNodeDouble.prototype.component2 = function () {
    return this.value;
  };
  CompressedNodeDouble.prototype.copy_io5o9c$ = function (func, value) {
    return new CompressedNodeDouble(func === void 0 ? this.func : func, value === void 0 ? this.value : value);
  };
  CompressedNodeDouble.prototype.toString = function () {
    return 'CompressedNodeDouble(func=' + Kotlin.toString(this.func) + (', value=' + Kotlin.toString(this.value)) + ')';
  };
  CompressedNodeDouble.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.func) | 0;
    result = result * 31 + Kotlin.hashCode(this.value) | 0;
    return result;
  };
  CompressedNodeDouble.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.func, other.func) && Kotlin.equals(this.value, other.value)))));
  };
  function OptimizerUtils(expression, baseOperationsDefinitions, compiledConfiguration, domain) {
    if (baseOperationsDefinitions === void 0)
      baseOperationsDefinitions = new BaseOperationsDefinitions();
    if (compiledConfiguration === void 0)
      compiledConfiguration = new CompiledConfiguration();
    if (domain === void 0)
      domain = null;
    this.expression = expression;
    this.compiledConfiguration = compiledConfiguration;
    this.baseOperationsComputationDouble_0 = new BaseOperationsComputation(ComputationType$DOUBLE_getInstance());
    this.domainPointGenerator_0 = domain != null ? domain : new DomainPointGenerator(arrayListOf([this.expression]), baseOperationsDefinitions);
    this.variablesList_0 = ArrayList_init();
    this.treeNodes_0 = ArrayList_init();
    this.nodesWithVariables_0 = ArrayList_init();
    this.partialDerivativesTreeNodes_0 = ArrayList_init();
    this.partialDerivativesNodesWithVariables_0 = ArrayList_init();
    var tmp$;
    var variablesNamesList = ArrayList_init();
    variablesNamesList.addAll_brywnq$(this.expression.getVariableNames());
    var tmp$_0;
    tmp$_0 = variablesNamesList.iterator();
    while (tmp$_0.hasNext()) {
      var element = tmp$_0.next();
      this.variablesList_0.add_11rb$(new VariableInfo(element));
    }
    tmp$ = this.variablesList_0.iterator();
    while (tmp$.hasNext()) {
      var tmp$_1 = tmp$.next();
      var name = tmp$_1.component1();
      var partialDerivative = diff(buildDiffNode(this.expression, name, this.compiledConfiguration), void 0, this.compiledConfiguration);
      this.partialDerivativesTreeNodes_0.add_11rb$(ArrayList_init());
      this.partialDerivativesNodesWithVariables_0.add_11rb$(ArrayList_init());
      this.findAllVariables_0(partialDerivative, last(this.partialDerivativesTreeNodes_0), last(this.partialDerivativesNodesWithVariables_0));
      reverse(last(this.partialDerivativesTreeNodes_0));
    }
    this.findAllVariables_0(this.expression, this.treeNodes_0, this.nodesWithVariables_0);
    reverse(this.treeNodes_0);
  }
  OptimizerUtils.prototype.run_224j3y$ = function (descentStartPointsCount, iterationCount, threshold) {
    if (descentStartPointsCount === void 0)
      descentStartPointsCount = this.compiledConfiguration.gradientDescentComparisonConfiguration.startPointsCount;
    if (iterationCount === void 0)
      iterationCount = this.compiledConfiguration.gradientDescentComparisonConfiguration.iterationCount;
    if (threshold === void 0)
      threshold = 0.0;
    var tmp$, tmp$_0;
    var tmp$_1 = this.domainPointGenerator_0;
    var b = descentStartPointsCount - this.domainPointGenerator_0.foundPointsCount() | 0;
    tmp$_1.findPoints_za3lpa$(Math_0.max(0, b));
    if (!this.canStart())
      return false;
    var b_0 = this.domainPointGenerator_0.foundPointsCount();
    tmp$ = Math_0.min(descentStartPointsCount, b_0);
    for (var run = 0; run < tmp$; run++) {
      var point = this.domainPointGenerator_0.generateNewPoint_mqu1mq$(void 0, void 0, run % this.domainPointGenerator_0.foundPointsCount());
      tmp$_0 = this.variablesList_0.iterator();
      while (tmp$_0.hasNext()) {
        var variable = tmp$_0.next();
        variable.value = toDouble(ensureNotNull(point.get_11rb$(variable.name)));
      }
      if (this.runGradientDescent_0(iterationCount, threshold))
        return true;
    }
    return false;
  };
  OptimizerUtils.prototype.runGradientDescent_0 = function (iterationCount, threshold) {
    var tmp$;
    for (var iter = 0; iter < iterationCount; iter++) {
      var direction = this.calculateDirection_0(this.variablesList_0);
      var lambda = this.runTernarySearch_0(this.variablesList_0, direction, this.compiledConfiguration.gradientDescentComparisonConfiguration.ternarySearchLeftBorder, this.compiledConfiguration.gradientDescentComparisonConfiguration.ternarySearchRightBorder, this.compiledConfiguration.gradientDescentComparisonConfiguration.ternarySearchIterationCount, threshold);
      if (lambda === 0.0)
        break;
      tmp$ = this.variablesList_0;
      for (var i = 0; i !== tmp$.size; ++i) {
        this.variablesList_0.get_za3lpa$(i).value = this.variablesList_0.get_za3lpa$(i).value + lambda * direction.get_za3lpa$(i);
      }
      var result = this.calculateValue_0(this.variablesList_0, this.treeNodes_0, this.nodesWithVariables_0);
      if (result < threshold)
        return true;
    }
    return false;
  };
  OptimizerUtils.prototype.canStart = function () {
    return this.domainPointGenerator_0.hasPointsInDomain();
  };
  OptimizerUtils.prototype.calculateDirection_0 = function (variableList) {
    var direction = ArrayList_init();
    for (var i = 0; i !== variableList.size; ++i) {
      var result = this.calculateValue_0(variableList, this.partialDerivativesTreeNodes_0.get_za3lpa$(i), this.partialDerivativesNodesWithVariables_0.get_za3lpa$(i));
      direction.add_11rb$(!isNaN_0(result) && isFinite(result) ? -result : 0.0);
    }
    return direction;
  };
  OptimizerUtils.prototype.runTernarySearch_0 = function (variableList, direction, leftBorder, rightBorder, iterationsCount, threshold) {
    var left = leftBorder;
    var right = rightBorder;
    var leftOk = this.valueAt_0(left, variableList, direction) != null;
    if (!leftOk && this.valueAt_0(right, variableList, direction) == null) {
      return 0.0;
    }
    var alpha = this.compiledConfiguration.gradientDescentComparisonConfiguration.ternarySearchAlpha;
    var beta = this.compiledConfiguration.gradientDescentComparisonConfiguration.ternarySearchBeta;
    for (var iter = 0; iter < iterationsCount; iter++) {
      var m1 = (alpha * left + beta * right) / (alpha + beta);
      var m2 = (beta * left + alpha * right) / (alpha + beta);
      var value1 = this.valueAt_0(m1, variableList, direction);
      var value2 = this.valueAt_0(m2, variableList, direction);
      if (value1 != null && value1 < threshold)
        return m1;
      if (value2 != null && value2 < threshold)
        return m2;
      if (value1 == null && value2 == null) {
        right = m1;
        continue;
      }
      if (value1 == null || (value2 != null && value1 > value2)) {
        left = m1;
        leftOk = true;
      }
       else {
        right = m2;
      }
    }
    return leftOk ? left : right;
  };
  OptimizerUtils.prototype.valueAt_0 = function (lambda, variableList, direction) {
    var variableListCloned = this.cloneVariableList_0(variableList);
    for (var i = 0; i !== variableList.size; ++i) {
      variableListCloned.get_za3lpa$(i).value = variableListCloned.get_za3lpa$(i).value + direction.get_za3lpa$(i) * lambda;
    }
    var result = this.calculateValue_0(variableListCloned, this.treeNodes_0, this.nodesWithVariables_0);
    return isNaN_0(result) || isInfinite(result) ? null : result;
  };
  OptimizerUtils.prototype.cloneVariableList_0 = function (variablesList) {
    var tmp$;
    var values = ArrayList_init();
    tmp$ = variablesList.iterator();
    while (tmp$.hasNext()) {
      var variable = tmp$.next();
      values.add_11rb$(variable.clone());
    }
    return values;
  };
  OptimizerUtils.prototype.calculateValue_0 = function (variableList, treeNodes, nodesWithVariables) {
    var tmp$, tmp$_0;
    tmp$ = nodesWithVariables.iterator();
    while (tmp$.hasNext()) {
      var tmp$_1 = tmp$.next();
      var nodeInd = tmp$_1.component1()
      , valInd = tmp$_1.component2();
      treeNodes.get_za3lpa$(treeNodes.size - 1 - nodeInd | 0).value = variableList.get_za3lpa$(valInd).value;
    }
    this.baseOperationsComputationDouble_0.computeValue_6l7j1$(Kotlin.isType(tmp$_0 = treeNodes, ArrayList) ? tmp$_0 : throwCCE());
    return last(treeNodes).value;
  };
  OptimizerUtils.prototype.findAllVariables_0 = function (node, nodesList, nodesWithVariables) {
    var tmp$, tmp$_0;
    var ind = nodesList.size;
    if (node.nodeType === NodeType$FUNCTION_getInstance()) {
      nodesList.add_11rb$(new CompressedNodeDouble(node.value));
      tmp$ = node.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        var childIndex = this.findAllVariables_0(child, nodesList, nodesWithVariables);
        nodesList.get_za3lpa$(ind).children.add_11rb$(nodesList.get_za3lpa$(childIndex));
      }
    }
     else {
      var isVariable = false;
      tmp$_0 = this.variablesList_0;
      for (var i = 0; i !== tmp$_0.size; ++i) {
        if (equals(this.variablesList_0.get_za3lpa$(i).name, node.value)) {
          nodesWithVariables.add_11rb$(new Pair(ind, i));
          isVariable = true;
        }
      }
      if (isVariable)
        nodesList.add_11rb$(new CompressedNodeDouble());
      else
        nodesList.add_11rb$(new CompressedNodeDouble(void 0, toDouble(node.value)));
    }
    return ind;
  };
  OptimizerUtils.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'OptimizerUtils',
    interfaces: []
  };
  function VariableInfo(name, value) {
    if (value === void 0)
      value = 0.0;
    this.name = name;
    this.value = value;
  }
  VariableInfo.prototype.clone = function () {
    return new VariableInfo(this.name, this.value);
  };
  VariableInfo.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'VariableInfo',
    interfaces: []
  };
  VariableInfo.prototype.component1 = function () {
    return this.name;
  };
  VariableInfo.prototype.component2 = function () {
    return this.value;
  };
  VariableInfo.prototype.copy_io5o9c$ = function (name, value) {
    return new VariableInfo(name === void 0 ? this.name : name, value === void 0 ? this.value : value);
  };
  VariableInfo.prototype.toString = function () {
    return 'VariableInfo(name=' + Kotlin.toString(this.name) + (', value=' + Kotlin.toString(this.value)) + ')';
  };
  VariableInfo.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.name) | 0;
    result = result * 31 + Kotlin.hashCode(this.value) | 0;
    return result;
  };
  VariableInfo.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.name, other.name) && Kotlin.equals(this.value, other.value)))));
  };
  function CompressedNode(func, value) {
    if (func === void 0)
      func = '';
    if (value === void 0)
      value = toComplex_1('0');
    this.func = func;
    this.value = value;
    this.subtreeValue = this.value;
    this.children = ArrayList_init();
    this.functor = null;
    if (this.func.length > 0) {
      var baseFunctions = (new BaseOperationsComputation(ComputationType$COMPLEX_getInstance())).baseComputationComplex;
      var key = this.func;
      var tmp$;
      if ((Kotlin.isType(tmp$ = baseFunctions, Map) ? tmp$ : throwCCE()).containsKey_11rb$(key))
        this.functor = baseFunctions.get_11rb$(this.func);
      else
        throw Kotlin.newThrowable('invalid function ' + this.func);
    }
  }
  CompressedNode.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'CompressedNode',
    interfaces: []
  };
  CompressedNode.prototype.component1 = function () {
    return this.func;
  };
  CompressedNode.prototype.component2 = function () {
    return this.value;
  };
  CompressedNode.prototype.copy_xkm6ma$ = function (func, value) {
    return new CompressedNode(func === void 0 ? this.func : func, value === void 0 ? this.value : value);
  };
  CompressedNode.prototype.toString = function () {
    return 'CompressedNode(func=' + Kotlin.toString(this.func) + (', value=' + Kotlin.toString(this.value)) + ')';
  };
  CompressedNode.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.func) | 0;
    result = result * 31 + Kotlin.hashCode(this.value) | 0;
    return result;
  };
  CompressedNode.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.func, other.func) && Kotlin.equals(this.value, other.value)))));
  };
  function DomainPointGenerator(_expressions, baseOperationsDefinitions, randomPointCount, goodEnought, annealingRuns, annealingAttemptsCount, annealingIterationCount, annealingTemperatureMultiplier, annealingPenaltyRestrictionMultiplier, gradientDescentRuns, gradientDescentIterationCount, gradientDescentTernarySearchIterationCount, gradientDescentTernarySearchOrderStep, gradientDescentTernarySearchOrderIterCount, gradientDescentDelta) {
    if (_expressions === void 0) {
      _expressions = ArrayList_init();
    }
    if (baseOperationsDefinitions === void 0)
      baseOperationsDefinitions = new BaseOperationsDefinitions();
    if (randomPointCount === void 0)
      randomPointCount = 10;
    if (goodEnought === void 0)
      goodEnought = 5;
    if (annealingRuns === void 0)
      annealingRuns = 2;
    if (annealingAttemptsCount === void 0)
      annealingAttemptsCount = 2;
    if (annealingIterationCount === void 0)
      annealingIterationCount = 1000;
    if (annealingTemperatureMultiplier === void 0)
      annealingTemperatureMultiplier = 0.99;
    if (annealingPenaltyRestrictionMultiplier === void 0)
      annealingPenaltyRestrictionMultiplier = 1000.0;
    if (gradientDescentRuns === void 0)
      gradientDescentRuns = 1;
    if (gradientDescentIterationCount === void 0)
      gradientDescentIterationCount = 50;
    if (gradientDescentTernarySearchIterationCount === void 0)
      gradientDescentTernarySearchIterationCount = 13;
    if (gradientDescentTernarySearchOrderStep === void 0)
      gradientDescentTernarySearchOrderStep = 1000.0;
    if (gradientDescentTernarySearchOrderIterCount === void 0)
      gradientDescentTernarySearchOrderIterCount = 3;
    if (gradientDescentDelta === void 0)
      gradientDescentDelta = 0.001;
    this.baseOperationsDefinitions = baseOperationsDefinitions;
    this.annealingAttemptsCount_0 = annealingAttemptsCount;
    this.annealingIterationCount_0 = annealingIterationCount;
    this.annealingTemperatureMultiplier_0 = annealingTemperatureMultiplier;
    this.annealingPenaltyRestrictionMultiplier_0 = annealingPenaltyRestrictionMultiplier;
    this.gradientDescentRuns_0 = gradientDescentRuns;
    this.gradientDescentIterationCount_0 = gradientDescentIterationCount;
    this.gradientDescentTernarySearchIterationCount_0 = gradientDescentTernarySearchIterationCount;
    this.gradientDescentTernarySearchOrderStep_0 = gradientDescentTernarySearchOrderStep;
    this.gradientDescentTernarySearchOrderIterCount_0 = gradientDescentTernarySearchOrderIterCount;
    this.gradientDescentDelta_0 = gradientDescentDelta;
    this.variablesList_0 = ArrayList_init();
    this.pointsInDomain_0 = ArrayList_init();
    this.maxConstant_0 = 1.0;
    this.pointsFoundUsingAnnealing_0 = 0;
    this.pointsFoundUsingGradientDescent_0 = 0;
    this.epsilon = 1.0E-6;
    this.baseOperationsComputationComplex = new BaseOperationsComputation(ComputationType$COMPLEX_getInstance());
    this.treeNodes_0 = ArrayList_init();
    this.nodesWithVariables_0 = ArrayList_init();
    var tmp$, tmp$_0, tmp$_1;
    var variablesNamesList = ArrayList_init();
    tmp$ = _expressions.iterator();
    while (tmp$.hasNext()) {
      var expression = tmp$.next();
      variablesNamesList.addAll_brywnq$(expression.getVariableNames());
      var a = expression.getMaxConstant();
      var b = this.maxConstant_0;
      this.maxConstant_0 = Math_0.max(a, b);
    }
    var tmp$_2;
    tmp$_2 = variablesNamesList.iterator();
    while (tmp$_2.hasNext()) {
      var element = tmp$_2.next();
      this.variablesList_0.add_11rb$(new VariableInfo(element));
    }
    tmp$_0 = _expressions.iterator();
    while (tmp$_0.hasNext()) {
      var expression_0 = tmp$_0.next();
      this.findAllVariables_0(expression_0);
    }
    reverse(this.treeNodes_0);
    tmp$_1 = randomPointCount;
    for (var attempt = 0; attempt < tmp$_1; attempt++) {
      var tmp$_3;
      tmp$_3 = this.variablesList_0.iterator();
      while (tmp$_3.hasNext()) {
        var element_0 = tmp$_3.next();
        element_0.value = random_0(-this.maxConstant_0, this.maxConstant_0);
      }
      if (this.calculatePenalty_0(this.variablesList_0) < this.epsilon)
        this.pointsInDomain_0.add_11rb$(this.clone_0(this.variablesList_0));
    }
    if (this.pointsInDomain_0.size < goodEnought) {
      this.findPoints_za3lpa$(annealingRuns);
    }
  }
  DomainPointGenerator.prototype.findPoints_za3lpa$ = function (annealingRuns) {
    var tmp$, tmp$_0;
    for (var attempt = 0; attempt < annealingRuns; attempt++) {
      var tmp$_1;
      tmp$_1 = this.variablesList_0.iterator();
      while (tmp$_1.hasNext()) {
        var element = tmp$_1.next();
        element.value = random_0(-this.maxConstant_0, this.maxConstant_0);
      }
      var foundSomething = false;
      tmp$ = this.annealingAttemptsCount_0;
      for (var i = 0; i < tmp$; i++) {
        if (this.runAnnealing_0(this.variablesList_0, this.annealingTemperatureMultiplier_0, this.annealingIterationCount_0)) {
          this.pointsFoundUsingAnnealing_0 = this.pointsFoundUsingAnnealing_0 + 1 | 0;
          this.pointsInDomain_0.add_11rb$(this.clone_0(this.variablesList_0));
          foundSomething = true;
          break;
        }
      }
      if (!foundSomething) {
        tmp$_0 = this.gradientDescentRuns_0;
        for (var run = 0; run < tmp$_0; run++) {
          if (this.runGradientDescent_0(this.variablesList_0, this.gradientDescentIterationCount_0, this.gradientDescentTernarySearchIterationCount_0, this.gradientDescentTernarySearchOrderStep_0, this.gradientDescentTernarySearchOrderIterCount_0, this.gradientDescentDelta_0)) {
            this.pointsFoundUsingGradientDescent_0 = this.pointsFoundUsingGradientDescent_0 + 1 | 0;
            this.pointsInDomain_0.add_11rb$(this.clone_0(this.variablesList_0));
            break;
          }
        }
      }
    }
  };
  DomainPointGenerator.prototype.hasPointsInDomain = function () {
    return !this.pointsInDomain_0.isEmpty();
  };
  DomainPointGenerator.prototype.foundPointsCount = function () {
    return this.pointsInDomain_0.size;
  };
  DomainPointGenerator.prototype.getResult = function () {
    var tmp$;
    println('points found using:' + '\n' + 'Annealing ' + this.pointsFoundUsingAnnealing_0 + '\n' + 'Gradient descent ' + this.pointsFoundUsingGradientDescent_0);
    var result = 'points found: ' + this.pointsInDomain_0.size + '\n';
    if (!this.pointsInDomain_0.isEmpty()) {
      tmp$ = this.pointsInDomain_0.get_za3lpa$(0).iterator();
      while (tmp$.hasNext()) {
        var vari = tmp$.next();
        result += vari.name + ' = ' + vari.value + '\n';
      }
    }
    return result;
  };
  DomainPointGenerator.prototype.generateNewPoint_mqu1mq$ = function (domainArea, randomPointTries, centreID) {
    if (domainArea === void 0)
      domainArea = 1.0E-5;
    if (randomPointTries === void 0)
      randomPointTries = 10;
    if (centreID === void 0)
      centreID = -1;
    var tmp$, tmp$_0;
    for (var iterNumber = 0; iterNumber < randomPointTries; iterNumber++) {
      tmp$ = this.variablesList_0.iterator();
      while (tmp$.hasNext()) {
        var variable = tmp$.next();
        variable.value = random_0(-2 * this.maxConstant_0, 2 * this.maxConstant_0);
      }
      if (this.calculatePenalty_0(this.variablesList_0) < this.epsilon)
        return this.variablesListToMap_jgf0mt$(this.variablesList_0);
    }
    if (!this.pointsInDomain_0.isEmpty()) {
      var pointIndex = centreID === -1 ? random.nextInt_vux9f0$(0, this.pointsInDomain_0.size) : centreID;
      return this.variablesListToMap_jgf0mt$(this.pointsInDomain_0.get_za3lpa$(pointIndex));
    }
     else {
      var result = LinkedHashMap_init_0();
      tmp$_0 = this.variablesList_0.iterator();
      while (tmp$_0.hasNext()) {
        var variable_0 = tmp$_0.next();
        var key = variable_0.name;
        var value = random_0(-this.maxConstant_0, this.maxConstant_0).toString();
        result.put_xwzc9p$(key, value);
      }
      return result;
    }
  };
  DomainPointGenerator.prototype.variablesListToMap_jgf0mt$ = function (variableList) {
    var tmp$;
    var result = LinkedHashMap_init_0();
    tmp$ = variableList.iterator();
    while (tmp$.hasNext()) {
      var variable = tmp$.next();
      var key = variable.name;
      var value = variable.value.toString();
      result.put_xwzc9p$(key, value);
    }
    return result;
  };
  DomainPointGenerator.prototype.clone_0 = function (variableList) {
    var tmp$;
    var values = ArrayList_init();
    tmp$ = variableList.iterator();
    while (tmp$.hasNext()) {
      var variable = tmp$.next();
      values.add_11rb$(variable.clone());
    }
    return values;
  };
  DomainPointGenerator.prototype.runGradientDescent_0 = function (variableList, iterationCount, ternarySearchIterationCount, ternarySearchOrderStep, ternarySearchOrderIterationCount, delta) {
    var tmp$;
    var currentPenalty = this.calculatePenalty_0(variableList);
    if (currentPenalty < this.epsilon)
      return true;
    for (var iterNumber = 0; iterNumber < iterationCount; iterNumber++) {
      var direction = this.calculateDirection_0(variableList, delta, currentPenalty);
      if (ternarySearchIterationCount > 0) {
        currentPenalty = this.runTernarySearch_0(variableList, direction, ternarySearchIterationCount, ternarySearchOrderStep, ternarySearchOrderIterationCount);
      }
       else {
        tmp$ = variableList.size;
        for (var i = 0; i < tmp$; i++)
          variableList.get_za3lpa$(i).value = variableList.get_za3lpa$(i).value + direction.get_za3lpa$(i);
        currentPenalty = this.calculatePenalty_0(variableList);
      }
      if (currentPenalty < this.epsilon)
        return true;
    }
    return false;
  };
  DomainPointGenerator.prototype.runTernarySearch_0 = function (variableList, direction, iterationCount, orderStep, orderIterationCount) {
    var curOrder = 1.0;
    var optimalMultiplier = 1.0;
    var minPenalty = this.substituteDirectionMultiplier_0(1.0, variableList, direction);
    for (var iter = 0; iter < orderIterationCount; iter++) {
      curOrder *= orderStep;
      var penalty = this.substituteDirectionMultiplier_0(curOrder, variableList, direction);
      if (penalty < minPenalty) {
        minPenalty = penalty;
        optimalMultiplier = curOrder;
      }
    }
    curOrder = 1.0;
    for (var iter_0 = 0; iter_0 < orderIterationCount; iter_0++) {
      curOrder /= orderStep;
      var penalty_0 = this.substituteDirectionMultiplier_0(curOrder, variableList, direction);
      if (penalty_0 < minPenalty) {
        minPenalty = penalty_0;
        optimalMultiplier = curOrder;
      }
    }
    var leftBorder = optimalMultiplier / Math_0.sqrt(orderStep);
    var rightBorder = Math_0.sqrt(orderStep) * optimalMultiplier;
    var penaltyLeft = null;
    var penaltyRight = null;
    for (var iterNumber = 0; iterNumber < iterationCount; iterNumber++) {
      if (minPenalty < this.epsilon)
        break;
      var tmp$ = this.generateMedians_0(leftBorder, rightBorder);
      var med1 = tmp$.component1()
      , med2 = tmp$.component2();
      if (penaltyLeft == null) {
        penaltyLeft = this.substituteDirectionMultiplier_0(med1, variableList, direction);
        if (penaltyLeft < minPenalty) {
          minPenalty = penaltyLeft;
          optimalMultiplier = med1;
        }
      }
      if (penaltyRight == null) {
        penaltyRight = this.substituteDirectionMultiplier_0(med2, variableList, direction);
        if (penaltyRight < minPenalty) {
          minPenalty = penaltyRight;
          optimalMultiplier = med2;
        }
      }
      if (penaltyLeft < penaltyRight) {
        rightBorder = med2;
        penaltyRight = penaltyLeft;
        penaltyLeft = null;
      }
       else {
        leftBorder = med1;
        penaltyLeft = penaltyRight;
        penaltyRight = null;
      }
    }
    for (var i = 0; i !== variableList.size; ++i) {
      variableList.get_za3lpa$(i).value = variableList.get_za3lpa$(i).value + optimalMultiplier * direction.get_za3lpa$(i);
    }
    return minPenalty;
  };
  DomainPointGenerator.prototype.substituteDirectionMultiplier_0 = function (coef, variableList, direction) {
    for (var i = 0; i !== variableList.size; ++i) {
      variableList.get_za3lpa$(i).value = variableList.get_za3lpa$(i).value + coef * direction.get_za3lpa$(i);
    }
    var penalty = this.calculatePenalty_0(variableList);
    for (var i_0 = 0; i_0 !== variableList.size; ++i_0) {
      variableList.get_za3lpa$(i_0).value = variableList.get_za3lpa$(i_0).value - coef * direction.get_za3lpa$(i_0);
    }
    return penalty;
  };
  DomainPointGenerator.prototype.generateMedians_0 = function (left, right) {
    var phi = (3 - Math_0.sqrt(5.0)) / 2;
    return new Pair(left + (right - left) * phi, right - (right - left) * phi);
  };
  DomainPointGenerator.prototype.calculateDirection_0 = function (variableList, delta, currentPenalty) {
    var tmp$;
    var direction = ArrayList_init();
    tmp$ = variableList.iterator();
    while (tmp$.hasNext()) {
      var variable = tmp$.next();
      var x = variable.value;
      var a = Math_0.abs(x);
      var dx = Math_0.max(a, 1.0) * delta;
      variable.value = variable.value + dx;
      direction.add_11rb$(-(this.calculatePenalty_0(variableList) - currentPenalty) / dx);
      variable.value = variable.value - dx;
    }
    return direction;
  };
  DomainPointGenerator.prototype.runAnnealing_0 = function (variableList, temperatureMultiplier, iterationCount) {
    var tmp$;
    var currentTemperature = 1.0;
    var currentPenalty = this.calculatePenalty_0(this.variablesList_0);
    if (variableList.isEmpty())
      return currentPenalty < this.epsilon;
    if (currentPenalty < this.epsilon)
      return true;
    for (var iterNumber = 0; iterNumber < iterationCount; iterNumber++) {
      var newPoint = ArrayList_init();
      tmp$ = variableList.iterator();
      while (tmp$.hasNext()) {
        var variable = tmp$.next();
        newPoint.add_11rb$(variable.clone());
      }
      var varIndex = random.nextInt_vux9f0$(0, newPoint.size);
      newPoint.set_wxm5ur$(varIndex, this.generateNextValue_0(newPoint.get_za3lpa$(varIndex), currentPenalty));
      var newPenalty = this.calculatePenalty_0(newPoint);
      if (this.newPointGoodEnough_0(currentPenalty, newPenalty, currentTemperature)) {
        currentPenalty = newPenalty;
        for (var i = 0; i !== newPoint.size; ++i) {
          variableList.get_za3lpa$(i).value = newPoint.get_za3lpa$(i).value;
        }
        if (currentPenalty < this.epsilon)
          return true;
      }
      currentTemperature *= temperatureMultiplier;
    }
    return false;
  };
  DomainPointGenerator.prototype.newPointGoodEnough_0 = function (currentPenalty, newPenalty, temperature) {
    var tmp$ = currentPenalty > newPenalty;
    if (!tmp$) {
      var tmp$_0 = random_0(0.0, 1.0);
      var x = (currentPenalty - newPenalty) / temperature;
      tmp$ = tmp$_0 < Math_0.exp(x) * 0.5;
    }
    return tmp$;
  };
  DomainPointGenerator.prototype.calculatePenalty_0 = function (variableList) {
    var tmp$, tmp$_0;
    tmp$ = this.nodesWithVariables_0.iterator();
    while (tmp$.hasNext()) {
      var tmp$_1 = tmp$.next();
      var nodeInd = tmp$_1.component1()
      , valInd = tmp$_1.component2();
      this.treeNodes_0.get_za3lpa$(this.treeNodes_0.size - 1 - nodeInd | 0).value = toComplex_0(variableList.get_za3lpa$(valInd).value);
    }
    return this.baseOperationsComputationComplex.computePenalty_jutbsk$(Kotlin.isType(tmp$_0 = this.treeNodes_0, ArrayList) ? tmp$_0 : throwCCE());
  };
  DomainPointGenerator.prototype.generateNextValue_0 = function (variable, currentPenalty) {
    var b = abs_0(variable.value) / 10;
    var c = currentPenalty / this.annealingPenaltyRestrictionMultiplier_0;
    var step = Math_0.max(1.0, b, c);
    var a = step;
    var b_0 = currentPenalty * this.annealingPenaltyRestrictionMultiplier_0;
    step = Math_0.min(a, b_0);
    variable.value = random_0(variable.value - step, variable.value + step);
    return variable;
  };
  DomainPointGenerator.prototype.findAllVariables_0 = function (node) {
    var tmp$, tmp$_0;
    var ind = this.treeNodes_0.size;
    if (node.nodeType === NodeType$FUNCTION_getInstance()) {
      this.treeNodes_0.add_11rb$(new CompressedNode(node.value));
      tmp$ = node.children.iterator();
      while (tmp$.hasNext()) {
        var child = tmp$.next();
        var childIndex = this.findAllVariables_0(child);
        this.treeNodes_0.get_za3lpa$(ind).children.add_11rb$(this.treeNodes_0.get_za3lpa$(childIndex));
      }
    }
     else {
      var isVariable = false;
      tmp$_0 = this.variablesList_0;
      for (var i = 0; i !== tmp$_0.size; ++i) {
        if (equals(this.variablesList_0.get_za3lpa$(i).name, node.value)) {
          this.nodesWithVariables_0.add_11rb$(new Pair(ind, i));
          isVariable = true;
        }
      }
      if (isVariable)
        this.treeNodes_0.add_11rb$(new CompressedNode());
      else
        this.treeNodes_0.add_11rb$(new CompressedNode(void 0, toComplex_1(node.value)));
    }
    return ind;
  };
  DomainPointGenerator.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'DomainPointGenerator',
    interfaces: []
  };
  var random;
  function defaultRandom() {
    return random.nextDouble();
  }
  function random_0(from, to) {
    return random.nextDouble() * (to - from) + from;
  }
  function randomInt(from, to) {
    return random.nextInt_vux9f0$(from, to);
  }
  function abs(x) {
    return x > 0 ? x : -x | 0;
  }
  function toStringWithMinLength($receiver, minLength, suffixChar) {
    var tmp$;
    var res = $receiver.toString();
    var suffixLen = minLength - res.length | 0;
    if (suffixLen > 0) {
      tmp$ = res + repeat(String.fromCharCode(suffixChar), suffixLen);
    }
     else {
      tmp$ = res;
    }
    return tmp$;
  }
  function escapeCharacters(string, characterEscapingDepth) {
    if (characterEscapingDepth === void 0)
      characterEscapingDepth = 1;
    return escapeBackSlash(string, characterEscapingDepth);
  }
  function escapeBackSlash(string, characterEscapingDepth) {
    if (characterEscapingDepth === void 0)
      characterEscapingDepth = 1;
    var replacement = repeat('\\', characterEscapingDepth);
    return replace(string, '\\', replacement);
  }
  function toShortString($receiver) {
    var stringValue = $receiver.toString();
    if (contains_1(stringValue, 46)) {
      if (contains_0(stringValue, '999')) {
        var fractionPart = substringBefore_0(substringAfter(stringValue, '.'), '999');
        stringValue = substringBefore_0(stringValue, '.');
        if (fractionPart.length > 0 && !equals(fractionPart, '9'))
          stringValue = stringValue + '.' + substringBefore_0(fractionPart, '999');
        if (last_0(stringValue) !== 57) {
          var newLast = toChar(last_0(stringValue) + 1);
          stringValue = removeSuffix(stringValue, String.fromCharCode(last_0(stringValue))) + String.fromCharCode(toBoxedChar(newLast));
        }
         else {
          stringValue = (toInt(stringValue) + 1 | 0).toString();
        }
      }
       else {
        var fractionPart_0 = substringBefore_0(substringAfter(stringValue, '.'), '000');
        stringValue = substringBefore_0(stringValue, '.');
        if (fractionPart_0.length > 0 && !equals(fractionPart_0, '0'))
          stringValue = stringValue + '.' + substringBefore_0(fractionPart_0, '000');
      }
    }
    return stringValue;
  }
  function abs_0($receiver) {
    return $receiver < 0 ? -$receiver : $receiver;
  }
  function isNumberValuesEqual(l, r) {
    var tmp$, tmp$_0;
    if (equals(r, l)) {
      return true;
    }
    tmp$ = toDoubleOrNull(l);
    if (tmp$ == null) {
      return false;
    }
    var lValue = tmp$;
    tmp$_0 = toDoubleOrNull(r);
    if (tmp$_0 == null) {
      return false;
    }
    var rValue = tmp$_0;
    return abs_0(lValue - rValue) < 1.19E-6;
  }
  function isLowerCaseLetter($receiver) {
    return (new CharRange(97, 122)).contains_mef7kx$($receiver) || (new CharRange(945, 969)).contains_mef7kx$($receiver);
  }
  function isUpperCaseLetter($receiver) {
    return (new CharRange(65, 90)).contains_mef7kx$($receiver) || (new CharRange(913, 937)).contains_mef7kx$($receiver);
  }
  function isLetter($receiver) {
    return isLowerCaseLetter($receiver) || isUpperCaseLetter($receiver);
  }
  function isLatinLetter($receiver) {
    return (new CharRange(97, 122)).contains_mef7kx$($receiver) || (new CharRange(65, 90)).contains_mef7kx$($receiver);
  }
  function isLetterOrUnderscore($receiver) {
    return isLetter($receiver) || $receiver === 95;
  }
  function isDigit($receiver) {
    return (new CharRange(48, 57)).contains_mef7kx$($receiver);
  }
  function isLetterOrDigit($receiver) {
    return isLetter($receiver) || isDigit($receiver);
  }
  function isLetterOrDigitOrUnderscore($receiver) {
    return isLetterOrDigit($receiver) || $receiver === 95;
  }
  function isNamePart($receiver) {
    return isLetterOrDigitOrUnderscore($receiver) || $receiver > 126;
  }
  function isNameOrNumberPart($receiver) {
    return isNamePart($receiver) || $receiver === 46;
  }
  function isNumberPart($receiver) {
    return isDigit($receiver) || $receiver === 46;
  }
  function isOpenBracket($receiver) {
    return $receiver === 40 || $receiver === 123 || $receiver === 91;
  }
  function isCloseBracket($receiver) {
    return $receiver === 41 || $receiver === 125 || $receiver === 93;
  }
  function isTexArgumentsSeparator($receiver) {
    return $receiver === 94 || $receiver === 95 || $receiver === 32;
  }
  function isBracket($receiver) {
    return isOpenBracket($receiver) || isCloseBracket($receiver);
  }
  function isUnarySignPart(c) {
    return c === 33 || c === 35 || c === 39;
  }
  function isBinarySignPart(c, isMathML) {
    if (isMathML === void 0)
      isMathML = false;
    return c === 43 || c === 45 || c === 42 || c === 47 || c === 94 || c === 37 || c === 124 || c === 92 || (c === 38 && !isMathML);
  }
  function isSign($receiver, isMathML) {
    if (isMathML === void 0)
      isMathML = false;
    return isUnarySignPart($receiver) || isBinarySignPart($receiver, isMathML);
  }
  function texStringPrefiltering(string) {
    var i = 0;
    var result = StringBuilder_init();
    while (i < string.length) {
      if (remainingExpressionStartsWith('\\operatorname{', string, i)) {
        i = i + 14 | 0;
        while (i < string.length && string.charCodeAt(i) !== 125) {
          result.append_s8itvh$(string.charCodeAt(i));
          i = i + 1 | 0;
        }
      }
       else {
        result.append_s8itvh$(string.charCodeAt(i));
      }
      i = i + 1 | 0;
    }
    return result.toString();
  }
  function remainingExpressionStartsWith(string, expression, currentPosition) {
    var tmp$;
    if (currentPosition < 0) {
      return false;
    }
    tmp$ = string.length;
    for (var i = 0; i < tmp$; i++)
      if ((currentPosition + i | 0) >= expression.length || expression.charCodeAt(currentPosition + i | 0) !== string.charCodeAt(i))
        return false;
    return true;
  }
  function readFromRemainingExpressionWhile(symbolCondition, expression, currentPosition) {
    var value = '';
    var pos = currentPosition;
    while (pos < expression.length && symbolCondition(toBoxedChar(expression.charCodeAt(pos)))) {
      value += String.fromCharCode(expression.charCodeAt(pos));
      pos = pos + 1 | 0;
    }
    return value;
  }
  function skipFromRemainingExpressionWhile(symbolCondition, expression, currentPosition) {
    var pos = currentPosition;
    while (pos < expression.length && symbolCondition(toBoxedChar(expression.charCodeAt(pos)))) {
      pos = pos + 1 | 0;
    }
    return pos;
  }
  function skipFromRemainingExpressionWhileClosingTagNotFound(closingTag, expression, currentPosition) {
    var tmp$;
    var pos = currentPosition;
    var openTagsCount = 1;
    while (pos < expression.length) {
      if (remainingExpressionStartsWith('<' + closingTag, expression, pos)) {
        openTagsCount = openTagsCount + 1 | 0;
      }
       else if (remainingExpressionStartsWith('<\/' + closingTag, expression, pos))
        tmp$ = openTagsCount, openTagsCount = tmp$ - 1 | 0;
      if (openTagsCount === 0)
        break;
      pos = pos + 1 | 0;
    }
    return pos;
  }
  function getBracketLevelChangeBeforeClosingTag(closingTag, expression, currentPosition) {
    var tmp$, tmp$_0;
    var pos = currentPosition;
    var openTagsCount = 0;
    var openBracketsCount = 0;
    while (pos < expression.length) {
      if (remainingExpressionStartsWith('<' + closingTag, expression, pos)) {
        openTagsCount = openTagsCount + 1 | 0;
      }
       else if (remainingExpressionStartsWith('<\/' + closingTag, expression, pos))
        tmp$ = openTagsCount, openTagsCount = tmp$ - 1 | 0;
      if (openTagsCount === 0)
        break;
      if (isOpenBracket(expression.charCodeAt(pos))) {
        openBracketsCount = openBracketsCount + 1 | 0;
      }
       else if (isCloseBracket(expression.charCodeAt(pos))) {
        tmp$_0 = openBracketsCount, openBracketsCount = tmp$_0 - 1 | 0;
      }
      pos = pos + 1 | 0;
    }
    return openBracketsCount;
  }
  function findFirstNotInTagNotInMtext(string, startPosition) {
    var tmp$;
    tmp$ = get_lastIndex_0(string);
    for (var i = startPosition; i <= tmp$; i++) {
      if (string.charCodeAt(i) === 60) {
        if (remainingExpressionStartsWith('<\/mtext>', string, i)) {
          for (var j = startPosition; j >= 0; j--) {
            if (string.charCodeAt(j) === 62) {
              return j - 6 | 0;
            }
          }
        }
        return startPosition;
      }
       else if (string.charCodeAt(i) === 62) {
        if (remainingExpressionStartsWith('<mtext>', string, i - 6 | 0)) {
          return i - 6 | 0;
        }
        return i + 1 | 0;
      }
    }
    return string.length;
  }
  function skipClosingTags(string, startPosition) {
    var currentStartPosition = startPosition;
    while (remainingExpressionStartsWith('<\/', string, currentStartPosition)) {
      while (string.charCodeAt(currentStartPosition) !== 62) {
        currentStartPosition = currentStartPosition + 1 | 0;
      }
      currentStartPosition = currentStartPosition + 1 | 0;
    }
    return currentStartPosition;
  }
  function selectPlacesForColoringByFragment(mathML, approxStartPosition, approxEndPosition) {
    var startPosition = approxStartPosition;
    var endPosition = approxEndPosition;
    while (startPosition >= 0 && mathML.charCodeAt(startPosition) !== 60 && mathML.charCodeAt(startPosition) !== 62) {
      startPosition = startPosition - 1 | 0;
    }
    if (mathML.charCodeAt(startPosition) === 62) {
      startPosition = startPosition + 1 | 0;
    }
    while (endPosition < mathML.length && mathML.charCodeAt(endPosition) !== 60 && mathML.charCodeAt(endPosition) !== 62) {
      endPosition = endPosition + 1 | 0;
    }
    if (mathML.charCodeAt(endPosition) === 62) {
      endPosition = endPosition + 1 | 0;
    }
    var numberOfNotClosedTags = 0;
    var currentStartPosition = startPosition;
    while (currentStartPosition < endPosition) {
      if (mathML.charCodeAt(currentStartPosition) === 60) {
        if ((currentStartPosition + 1 | 0) < mathML.length && mathML.charCodeAt(currentStartPosition + 1 | 0) === 47) {
          numberOfNotClosedTags = numberOfNotClosedTags - 1 | 0;
        }
         else {
          numberOfNotClosedTags = numberOfNotClosedTags + 1 | 0;
        }
      }
      currentStartPosition = currentStartPosition + 1 | 0;
    }
    while (numberOfNotClosedTags > 0) {
      while (endPosition < mathML.length && mathML.charCodeAt(endPosition) !== 60) {
        endPosition = endPosition + 1 | 0;
      }
      if ((endPosition + 1 | 0) < mathML.length && mathML.charCodeAt(endPosition + 1 | 0) === 47) {
        numberOfNotClosedTags = numberOfNotClosedTags - 1 | 0;
      }
       else {
        numberOfNotClosedTags = numberOfNotClosedTags + 1 | 0;
      }
      while (endPosition < mathML.length && mathML.charCodeAt(endPosition) !== 62) {
        endPosition = endPosition + 1 | 0;
      }
      endPosition = endPosition + 1 | 0;
    }
    while (numberOfNotClosedTags < 0) {
      startPosition = startPosition - 1 | 0;
      while (startPosition >= 0 && mathML.charCodeAt(startPosition) !== 60) {
        startPosition = startPosition - 1 | 0;
      }
      if ((startPosition + 1 | 0) < mathML.length && mathML.charCodeAt(startPosition + 1 | 0) === 47) {
        numberOfNotClosedTags = numberOfNotClosedTags - 1 | 0;
      }
       else {
        numberOfNotClosedTags = numberOfNotClosedTags + 1 | 0;
      }
    }
    return new Pair(startPosition, endPosition);
  }
  function findClosestPlaceToTargetOnTheSameLevel(string, startPosition, targetEndPosition, isMathML) {
    if (isMathML === void 0)
      isMathML = true;
    var tmp$;
    var pos = startPosition;
    var openTagsCount = 0;
    var minDist = targetEndPosition - pos | 0;
    var currentResultPos = pos;
    while (pos < string.length) {
      if (isMathML && remainingExpressionStartsWith('<\/', string, pos)) {
        openTagsCount = openTagsCount - 1 | 0;
      }
       else if (isMathML && string.charCodeAt(pos) === 60) {
        openTagsCount = openTagsCount + 1 | 0;
      }
       else if (isOpenBracket(string.charCodeAt(pos))) {
        openTagsCount = openTagsCount + 1 | 0;
      }
       else if (isCloseBracket(string.charCodeAt(pos)))
        tmp$ = openTagsCount, openTagsCount = tmp$ - 1 | 0;
      pos = pos + 1 | 0;
      if (openTagsCount === 0) {
        var currentDist = abs(targetEndPosition - pos | 0);
        if (currentDist < minDist) {
          minDist = currentDist;
          currentResultPos = pos;
        }
         else if (pos > targetEndPosition) {
          break;
        }
      }
    }
    return currentResultPos;
  }
  function skipFromRemainingExpressionWhileClosingBracketNotFound(closingBracket, openingBracket, expression, currentPosition) {
    var tmp$;
    var pos = currentPosition;
    var openTagsCount = 1;
    while (pos < expression.length) {
      if (remainingExpressionStartsWith(openingBracket, expression, pos)) {
        openTagsCount = openTagsCount + 1 | 0;
      }
       else if (remainingExpressionStartsWith(closingBracket, expression, pos))
        tmp$ = openTagsCount, openTagsCount = tmp$ - 1 | 0;
      if (openTagsCount === 0)
        break;
      pos = pos + 1 | 0;
    }
    return pos;
  }
  function getIndexOfFirstBracketsValueEnd(string, startPosition, openBracket, closingBracket) {
    var i = startPosition;
    var numberOfOpenBrackets = 1;
    while (i < string.length) {
      if (string.charCodeAt(i) === openBracket) {
        numberOfOpenBrackets = numberOfOpenBrackets + 1 | 0;
      }
       else if (string.charCodeAt(i) === closingBracket) {
        numberOfOpenBrackets = numberOfOpenBrackets - 1 | 0;
        if (numberOfOpenBrackets === 0) {
          return i;
        }
      }
      i = i + 1 | 0;
    }
    return string.length;
  }
  function NamedList(name, list, endPosition) {
    this.name = name;
    this.list = list;
    this.endPosition = endPosition;
  }
  NamedList.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'NamedList',
    interfaces: []
  };
  NamedList.prototype.component1 = function () {
    return this.name;
  };
  NamedList.prototype.component2 = function () {
    return this.list;
  };
  NamedList.prototype.component3 = function () {
    return this.endPosition;
  };
  NamedList.prototype.copy_hjdhk9$ = function (name, list, endPosition) {
    return new NamedList(name === void 0 ? this.name : name, list === void 0 ? this.list : list, endPosition === void 0 ? this.endPosition : endPosition);
  };
  NamedList.prototype.toString = function () {
    return 'NamedList(name=' + Kotlin.toString(this.name) + (', list=' + Kotlin.toString(this.list)) + (', endPosition=' + Kotlin.toString(this.endPosition)) + ')';
  };
  NamedList.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.name) | 0;
    result = result * 31 + Kotlin.hashCode(this.list) | 0;
    result = result * 31 + Kotlin.hashCode(this.endPosition) | 0;
    return result;
  };
  NamedList.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.name, other.name) && Kotlin.equals(this.list, other.list) && Kotlin.equals(this.endPosition, other.endPosition)))));
  };
  function splitStringByBracketsOnTopLevel(originalString, openBracket, closingBracket, startPosition) {
    if (startPosition === void 0)
      startPosition = 0;
    var string = originalString.substring(startPosition);
    var result = ArrayList_init();
    var indexOfFirst$result;
    indexOfFirst$break: do {
      var tmp$, tmp$_0, tmp$_1, tmp$_2;
      tmp$ = get_indices(string);
      tmp$_0 = tmp$.first;
      tmp$_1 = tmp$.last;
      tmp$_2 = tmp$.step;
      for (var index = tmp$_0; index <= tmp$_1; index += tmp$_2) {
        if (unboxChar(toBoxedChar(string.charCodeAt(index))) === openBracket) {
          indexOfFirst$result = index;
          break indexOfFirst$break;
        }
      }
      indexOfFirst$result = -1;
    }
     while (false);
    var firstOpenBracketIndex = indexOfFirst$result;
    if (firstOpenBracketIndex < 0) {
      return new NamedList(originalString, emptyList(), originalString.length);
    }
    var $receiver = string.substring(0, firstOpenBracketIndex);
    var tmp$_3;
    var name = trim(Kotlin.isCharSequence(tmp$_3 = $receiver) ? tmp$_3 : throwCCE()).toString();
    var j = firstOpenBracketIndex;
    var endPosition = originalString.length;
    while (j < string.length && string.charCodeAt(j) === openBracket) {
      var partStart = j + 1 | 0;
      var partEnd = getIndexOfFirstBracketsValueEnd(string, partStart, 123, 125);
      if (partEnd >= string.length) {
        break;
      }
      result.add_11rb$(string.substring(partStart, partEnd));
      j = partEnd + 1 | 0;
    }
    if (j < string.length) {
      endPosition = j + startPosition | 0;
    }
    return new NamedList(name, result, endPosition);
  }
  function splitBySubstringOnTopLevel(substrings, expression, startPosition, endPosition) {
    if (startPosition === void 0)
      startPosition = 0;
    if (endPosition === void 0)
      endPosition = expression.length;
    var tmp$, tmp$_0;
    var result = ArrayList_init();
    var pos = startPosition;
    var lastStartPos = startPosition;
    var expressionNotCompleted = false;
    while (pos < endPosition) {
      var splittingSubstring = null;
      tmp$ = substrings.iterator();
      while (tmp$.hasNext()) {
        var substring = tmp$.next();
        if (remainingExpressionStartsWith(substring, expression, pos)) {
          splittingSubstring = substring;
          break;
        }
      }
      if (splittingSubstring != null && !expressionNotCompleted) {
        result.add_11rb$(new StringPart(lastStartPos, pos, splittingSubstring));
        pos = pos + splittingSubstring.length | 0;
        lastStartPos = pos;
      }
       else if (remainingExpressionStartsWith('<mo>', expression, pos)) {
        pos = pos + 4 | 0;
      }
       else if (remainingExpressionStartsWith('<\/mo>', expression, pos)) {
        pos = pos + 5 | 0;
      }
       else if (remainingExpressionStartsWith('<mrow>', expression, pos)) {
        pos = pos + 6 | 0;
      }
       else if (remainingExpressionStartsWith('<\/mrow>', expression, pos)) {
        pos = pos + 7 | 0;
      }
       else if (isOpenBracket(expression.charCodeAt(pos))) {
        var numberOfOpenBrackets = 1;
        expressionNotCompleted = true;
        pos = pos + 1 | 0;
        while (pos < endPosition) {
          if (isOpenBracket(expression.charCodeAt(pos))) {
            numberOfOpenBrackets = numberOfOpenBrackets + 1 | 0;
          }
           else if (isCloseBracket(expression.charCodeAt(pos)))
            tmp$_0 = numberOfOpenBrackets, numberOfOpenBrackets = tmp$_0 - 1 | 0;
          pos = pos + 1 | 0;
          if (numberOfOpenBrackets === 0) {
            expressionNotCompleted = false;
            break;
          }
        }
      }
       else {
        var actualTag = readOpenTagStringIfItPresent(expression, pos);
        if (actualTag != null) {
          pos = pos + actualTag.length | 0;
          if (!endsWith_0(actualTag, '/>')) {
            var tagName = ensureNotNull(getTagAttributes(actualTag).get_11rb$('name'));
            pos = skipFromRemainingExpressionWhileClosingTagNotFound(tagName, expression, pos) + tagName.length + closing.length | 0;
          }
        }
         else {
          pos = pos + 1 | 0;
        }
      }
    }
    if (!expressionNotCompleted) {
      result.add_11rb$(new StringPart(lastStartPos, pos));
    }
    return result;
  }
  function readOpenTagStringIfItPresent$lambda(it) {
    return unboxChar(it) !== 62;
  }
  function readOpenTagStringIfItPresent(expression, currentPosition) {
    if (expression.charCodeAt(currentPosition) === 60 && expression.length > (currentPosition + 1 | 0) && isNamePart(expression.charCodeAt(currentPosition + 1 | 0))) {
      var end = skipFromRemainingExpressionWhile(readOpenTagStringIfItPresent$lambda, expression, currentPosition);
      if (end >= expression.length || expression.charCodeAt(end) !== 62)
        return null;
      var endIndex = end + 1 | 0;
      return expression.substring(currentPosition, endIndex);
    }
     else
      return null;
  }
  function trimmedMathML($receiver) {
    var startPosition = 0;
    while (startPosition < $receiver.length) {
      if (remainingExpressionStartsWith(newWhiteSpace, $receiver, startPosition)) {
        startPosition = startPosition + newWhiteSpace.length | 0;
      }
       else if (remainingExpressionStartsWith(newLineMspace, $receiver, startPosition)) {
        startPosition = startPosition + newLineMspace.length | 0;
      }
       else if (isWhitespace($receiver.charCodeAt(startPosition))) {
        startPosition = startPosition + 1 | 0;
      }
       else {
        break;
      }
    }
    var endPosition = $receiver.length;
    while (endPosition > 0) {
      if (remainingExpressionStartsWith(newWhiteSpace, $receiver, endPosition - newWhiteSpace.length | 0)) {
        endPosition = endPosition - newWhiteSpace.length | 0;
      }
       else if (remainingExpressionStartsWith(newLineMspace, $receiver, endPosition - newLineMspace.length | 0)) {
        endPosition = endPosition - newLineMspace.length | 0;
      }
       else if (isWhitespace($receiver.charCodeAt(endPosition - 1 | 0))) {
        endPosition = endPosition - 1 | 0;
      }
       else {
        break;
      }
    }
    var tmp$;
    if (endPosition < startPosition)
      tmp$ = '';
    else {
      var startIndex = startPosition;
      var endIndex = endPosition;
      tmp$ = $receiver.substring(startIndex, endIndex);
    }
    return tmp$;
  }
  function getTagAttributes(tagString) {
    var tmp$;
    var data = substringBefore(substringAfter_0(tagString, 60), 62);
    var attrValues = split_0(data, Kotlin.charArrayOf(32));
    var result = mutableMapOf([new Pair('name', attrValues.get_za3lpa$(0))]);
    tmp$ = get_lastIndex(attrValues);
    for (var i = 1; i <= tmp$; i++) {
      var attrValue = split_0(attrValues.get_za3lpa$(i), Kotlin.charArrayOf(61));
      result.put_xwzc9p$(attrValue.get_za3lpa$(0), attrValue.get_za3lpa$(1));
    }
    return result;
  }
  function removeNewLinesFromExpression(expression) {
    return replace(expression, '<mspace linebreak="newline"/>', '');
  }
  function findNewLinePlaces(expression) {
    var result = ArrayList_init();
    var startPosition = 0;
    while (startPosition < expression.length) {
      var pos = indexOf_0(expression, newLineMspace, startPosition);
      if (pos < 0) {
        break;
      }
      result.add_11rb$(pos);
      startPosition = pos + 1 | 0;
    }
    return result;
  }
  var mtable;
  var mfenced;
  var closing;
  var newLineMspace;
  var newWhiteSpace;
  var openCommentMathML;
  var openCommentShort;
  var closeCommentMathML;
  var closeCommentShort;
  function TransformationsPart() {
  }
  TransformationsPart.$metadata$ = {
    kind: Kind_INTERFACE,
    simpleName: 'TransformationsPart',
    interfaces: []
  };
  function StringPart(startPosition, endPosition, splittingSubstring) {
    if (splittingSubstring === void 0)
      splittingSubstring = null;
    this.startPosition_a3yidz$_0 = startPosition;
    this.endPosition_23ake$_0 = endPosition;
    this.splittingSubstring = splittingSubstring;
  }
  Object.defineProperty(StringPart.prototype, 'startPosition', {
    get: function () {
      return this.startPosition_a3yidz$_0;
    }
  });
  Object.defineProperty(StringPart.prototype, 'endPosition', {
    get: function () {
      return this.endPosition_23ake$_0;
    }
  });
  StringPart.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'StringPart',
    interfaces: [TransformationsPart]
  };
  function containsAny($receiver, o) {
    var tmp$;
    tmp$ = o.iterator();
    while (tmp$.hasNext()) {
      var e = tmp$.next();
      if ($receiver.contains_11rb$(e)) {
        return true;
      }
    }
    return false;
  }
  function containsAny_0($receiver, o) {
    var tmp$;
    for (tmp$ = 0; tmp$ !== o.length; ++tmp$) {
      var e = o[tmp$];
      if ($receiver.contains_11rb$(e)) {
        return true;
      }
    }
    return false;
  }
  function Letter(unicode, unicodeCode, tex, mathMl) {
    this.unicode = toBoxedChar(unicode);
    this.unicodeCode = unicodeCode;
    this.tex = tex;
    this.mathMl = mathMl;
  }
  Letter.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'Letter',
    interfaces: []
  };
  Letter.prototype.component1 = function () {
    return this.unicode;
  };
  Letter.prototype.component2 = function () {
    return this.unicodeCode;
  };
  Letter.prototype.component3 = function () {
    return this.tex;
  };
  Letter.prototype.component4 = function () {
    return this.mathMl;
  };
  Letter.prototype.copy_n6w77z$ = function (unicode, unicodeCode, tex, mathMl) {
    return new Letter(unicode === void 0 ? this.unicode : unicode, unicodeCode === void 0 ? this.unicodeCode : unicodeCode, tex === void 0 ? this.tex : tex, mathMl === void 0 ? this.mathMl : mathMl);
  };
  Letter.prototype.toString = function () {
    return 'Letter(unicode=' + Kotlin.toString(this.unicode) + (', unicodeCode=' + Kotlin.toString(this.unicodeCode)) + (', tex=' + Kotlin.toString(this.tex)) + (', mathMl=' + Kotlin.toString(this.mathMl)) + ')';
  };
  Letter.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.unicode) | 0;
    result = result * 31 + Kotlin.hashCode(this.unicodeCode) | 0;
    result = result * 31 + Kotlin.hashCode(this.tex) | 0;
    result = result * 31 + Kotlin.hashCode(this.mathMl) | 0;
    return result;
  };
  Letter.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.unicode, other.unicode) && Kotlin.equals(this.unicodeCode, other.unicodeCode) && Kotlin.equals(this.tex, other.tex) && Kotlin.equals(this.mathMl, other.mathMl)))));
  };
  var lettersData;
  var texToUnicode;
  var unicodeToTex;
  var texOpenBracket;
  var texCloseBracket;
  function Comparator$ObjectLiteral_5(closure$comparison) {
    this.closure$comparison = closure$comparison;
  }
  Comparator$ObjectLiteral_5.prototype.compare = function (a, b) {
    return this.closure$comparison(a, b);
  };
  Comparator$ObjectLiteral_5.$metadata$ = {kind: Kind_CLASS, interfaces: [Comparator]};
  var compareBy$lambda_3 = wrapFunction(function () {
    var compareValues = Kotlin.kotlin.comparisons.compareValues_s00gnj$;
    return function (closure$selector) {
      return function (a, b) {
        var selector = closure$selector;
        return compareValues(selector(a), selector(b));
      };
    };
  });
  function ColoringTask(startPosition, endPosition, color) {
    this.startPosition = startPosition;
    this.endPosition = endPosition;
    this.color = color;
  }
  ColoringTask.prototype.texColor = function () {
    switch (this.color) {
      case '7F00FF':
        return 'purple';
      case '007F00':
        return 'green';
      case 'FF00FF':
        return 'yellow';
      case 'FF0000':
        return 'red';
      default:return 'black';
    }
  };
  ColoringTask.$metadata$ = {
    kind: Kind_CLASS,
    simpleName: 'ColoringTask',
    interfaces: []
  };
  ColoringTask.prototype.component1 = function () {
    return this.startPosition;
  };
  ColoringTask.prototype.component2 = function () {
    return this.endPosition;
  };
  ColoringTask.prototype.component3 = function () {
    return this.color;
  };
  ColoringTask.prototype.copy_98i29q$ = function (startPosition, endPosition, color) {
    return new ColoringTask(startPosition === void 0 ? this.startPosition : startPosition, endPosition === void 0 ? this.endPosition : endPosition, color === void 0 ? this.color : color);
  };
  ColoringTask.prototype.toString = function () {
    return 'ColoringTask(startPosition=' + Kotlin.toString(this.startPosition) + (', endPosition=' + Kotlin.toString(this.endPosition)) + (', color=' + Kotlin.toString(this.color)) + ')';
  };
  ColoringTask.prototype.hashCode = function () {
    var result = 0;
    result = result * 31 + Kotlin.hashCode(this.startPosition) | 0;
    result = result * 31 + Kotlin.hashCode(this.endPosition) | 0;
    result = result * 31 + Kotlin.hashCode(this.color) | 0;
    return result;
  };
  ColoringTask.prototype.equals = function (other) {
    return this === other || (other !== null && (typeof other === 'object' && (Object.getPrototypeOf(this) === Object.getPrototypeOf(other) && (Kotlin.equals(this.startPosition, other.startPosition) && Kotlin.equals(this.endPosition, other.endPosition) && Kotlin.equals(this.color, other.color)))));
  };
  function setBackgroundColorMathMl(string, color) {
    return replaceFirst(string, 'MathML">', 'MathML' + '"' + ' mathcolor=' + '"' + '#' + color + '"' + '>');
  }
  function brushMathMl$lambda(it) {
    return it.startPosition;
  }
  function brushMathMl(string, coloringTasks) {
    var tmp$;
    var result = StringBuilder_init();
    var lastHandledPosition = 0;
    var destination = ArrayList_init();
    var tmp$_0;
    tmp$_0 = coloringTasks.iterator();
    while (tmp$_0.hasNext()) {
      var element = tmp$_0.next();
      if (element.startPosition <= element.endPosition)
        destination.add_11rb$(element);
    }
    var sortedColoringTasks = sortedWith(destination, new Comparator$ObjectLiteral_5(compareBy$lambda_3(brushMathMl$lambda)));
    tmp$ = sortedColoringTasks.iterator();
    while (tmp$.hasNext()) {
      var task = tmp$.next();
      var startIndexPair = findAnyOf(string, listOf_0(['<mo>', '<mn>', '<mi>']), task.startPosition - 4 | 0);
      var approxStartPosition = startIndexPair != null && startIndexPair.first <= task.startPosition ? startIndexPair.first : task.startPosition;
      var startPosition = skipClosingTags(string, findFirstNotInTagNotInMtext(string, approxStartPosition));
      if (task.startPosition === task.endPosition || startPosition >= get_lastIndex_0(string)) {
        var startIndex = lastHandledPosition;
        result.append_gw00v9$(colorOnlyNewLineSplittingSign(string.substring(startIndex, startPosition)));
        result.append_gw00v9$(coloringStart(task.color) + underlining + coloringEnd);
        lastHandledPosition = startPosition;
      }
       else {
        var endPosition = findClosestPlaceToTargetOnTheSameLevel(string, startPosition, task.endPosition);
        var startIndex_0 = lastHandledPosition;
        result.append_gw00v9$(string.substring(startIndex_0, startPosition));
        result.append_gw00v9$(coloringStart(task.color));
        result.append_gw00v9$(colorOnlyNewLineSplittingSign(string.substring(startPosition, endPosition)));
        result.append_gw00v9$(coloringEnd);
        lastHandledPosition = endPosition;
      }
    }
    var startIndex_1 = lastHandledPosition;
    result.append_gw00v9$(string.substring(startIndex_1));
    return result.toString();
  }
  function dropPerformedMathMLBrushing(string) {
    var result = dropPerformedMathMLBrushingInternal(string);
    var resultLast = string;
    while (!equals(result, resultLast)) {
      var newResult = dropPerformedMathMLBrushingInternal(result);
      resultLast = result;
      result = newResult;
    }
    return result;
  }
  function dropPerformedMathMLBrushingInternal(string) {
    var result = StringBuilder_init();
    var currentPosition = 0;
    while (currentPosition < string.length) {
      var indexPair = findAnyOf(string, listOf_0([coloringBoldHeaderStart, coloringBoldHeaderStartGeneral, coloringHeaderStart, coloringHeaderStartGeneral, boldHeaderStart, boldHeaderStartGeneral]), currentPosition);
      if (indexPair != null) {
        if (equals(indexPair.second, coloringBoldHeaderStart)) {
          var startIndex = currentPosition;
          var endIndex = indexPair.first;
          result.append_gw00v9$(string.substring(startIndex, endIndex));
          currentPosition = indexPair.first + coloringBoldStartLength | 0;
          var newCurrentPosition = skipFromRemainingExpressionWhileClosingTagNotFound('mrow', string, currentPosition);
          var startIndex_0 = currentPosition;
          result.append_gw00v9$(string.substring(startIndex_0, newCurrentPosition));
          currentPosition = newCurrentPosition + coloringEndLength | 0;
        }
         else if (equals(indexPair.second, coloringHeaderStart)) {
          var startIndex_1 = currentPosition;
          var endIndex_0 = indexPair.first;
          result.append_gw00v9$(string.substring(startIndex_1, endIndex_0));
          currentPosition = indexPair.first + coloringStartLength | 0;
          var newCurrentPosition_0 = skipFromRemainingExpressionWhileClosingTagNotFound('mrow', string, currentPosition);
          var startIndex_2 = currentPosition;
          result.append_gw00v9$(string.substring(startIndex_2, newCurrentPosition_0));
          currentPosition = newCurrentPosition_0 + coloringEndLength | 0;
        }
         else if (equals(indexPair.second, boldHeaderStart)) {
          var startIndex_3 = currentPosition;
          var endIndex_1 = indexPair.first;
          result.append_gw00v9$(string.substring(startIndex_3, endIndex_1));
          currentPosition = indexPair.first + boldStartLength | 0;
          var newCurrentPosition_1 = skipFromRemainingExpressionWhileClosingTagNotFound('mrow', string, currentPosition);
          var startIndex_4 = currentPosition;
          result.append_gw00v9$(string.substring(startIndex_4, newCurrentPosition_1));
          currentPosition = newCurrentPosition_1 + coloringEndLength | 0;
        }
         else if (equals(indexPair.second, coloringBoldHeaderStartGeneral)) {
          var startIndex_5 = currentPosition;
          var endIndex_2 = indexPair.first;
          result.append_gw00v9$(string.substring(startIndex_5, endIndex_2));
          currentPosition = indexPair.first + 39 | 0;
        }
         else if (equals(indexPair.second, coloringHeaderStartGeneral)) {
          var startIndex_6 = currentPosition;
          var endIndex_3 = indexPair.first;
          result.append_gw00v9$(string.substring(startIndex_6, endIndex_3));
          currentPosition = indexPair.first + 20 | 0;
        }
         else if (equals(indexPair.second, boldHeaderStartGeneral)) {
          var startIndex_7 = currentPosition;
          var endIndex_4 = indexPair.first;
          result.append_gw00v9$(string.substring(startIndex_7, endIndex_4));
          currentPosition = indexPair.first + 19 | 0;
        }
         else
          break;
      }
       else {
        var startIndex_8 = currentPosition;
        result.append_gw00v9$(string.substring(startIndex_8));
        break;
      }
    }
    return result.toString();
  }
  function coloringStart(color) {
    return coloringBoldHeaderStart + color + '"' + '>';
  }
  var coloringEnd;
  var coloringBoldHeaderStartGeneral;
  var coloringBoldHeaderStart;
  var coloringBoldStartLength;
  var coloringHeaderStartGeneral;
  var coloringHeaderStart;
  var coloringStartLength;
  var boldHeaderStartGeneral;
  var boldHeaderStart;
  var boldStartLength;
  var coloringEndLength;
  var coloringOffset;
  var underlining;
  function colorOnlyNewLineSplittingSign(splittingSign) {
    var newSplittingSign = splittingSign;
    if (splittingSign.length === 0 || startsWith(splittingSign, '<mspace linebreak="newline"/>')) {
      newSplittingSign = '<mo>=<\/mo><mo>&gt;<\/mo>' + splittingSign;
    }
    return newSplittingSign;
  }
  function transformationPartsToLog(transformationsPart) {
    return transformationsPart.computeIdentifier_6taknv$(false);
  }
  function transformationPartsToLog_0(transformation) {
    return transformation.computeIdentifier_6taknv$(false);
  }
  function transformationPartsToLog_1(transformation) {
    return transformation.computeIdentifier_6taknv$(false);
  }
  function transformationPartsToLog_2(transformation) {
    return transformation.computeIdentifier_6taknv$(false);
  }
  function Comparator$ObjectLiteral_6(closure$comparison) {
    this.closure$comparison = closure$comparison;
  }
  Comparator$ObjectLiteral_6.prototype.compare = function (a, b) {
    return this.closure$comparison(a, b);
  };
  Comparator$ObjectLiteral_6.$metadata$ = {kind: Kind_CLASS, interfaces: [Comparator]};
  var compareBy$lambda_4 = wrapFunction(function () {
    var compareValues = Kotlin.kotlin.comparisons.compareValues_s00gnj$;
    return function (closure$selector) {
      return function (a, b) {
        var selector = closure$selector;
        return compareValues(selector(a), selector(b));
      };
    };
  });
  function setBackgroundColorTex(string, color) {
    return '\\' + 'textcolor{' + color + '}{' + string + '}';
  }
  function brushTex$lambda(it) {
    return it.startPosition;
  }
  function brushTex(string, coloringTasks) {
    var tmp$;
    var result = StringBuilder_init();
    var lastHandledPosition = 0;
    var destination = ArrayList_init();
    var tmp$_0;
    tmp$_0 = coloringTasks.iterator();
    while (tmp$_0.hasNext()) {
      var element = tmp$_0.next();
      if (element.startPosition <= element.endPosition)
        destination.add_11rb$(element);
    }
    var sortedColoringTasks = sortedWith(destination, new Comparator$ObjectLiteral_6(compareBy$lambda_4(brushTex$lambda)));
    tmp$ = sortedColoringTasks.iterator();
    while (tmp$.hasNext()) {
      var task = tmp$.next();
      if (task.startPosition >= get_lastIndex_0(string)) {
        var startIndex = lastHandledPosition;
        var endIndex = get_lastIndex_0(string);
        result.append_gw00v9$(string.substring(startIndex, endIndex));
        result.append_gw00v9$('\\' + 'textcolor{' + task.texColor() + '}{.}');
      }
       else {
        var startIndex_0 = lastHandledPosition;
        var endIndex_0 = task.startPosition;
        result.append_gw00v9$(string.substring(startIndex_0, endIndex_0));
        if (task.startPosition === task.endPosition || task.startPosition >= get_lastIndex_0(string)) {
          result.append_gw00v9$('\\' + 'textcolor{' + task.texColor() + '}{.}');
          lastHandledPosition = task.startPosition;
        }
         else {
          var endPosition = findClosestPlaceToTargetOnTheSameLevel(string, task.startPosition, task.endPosition);
          result.append_gw00v9$('\\' + 'textcolor{' + task.texColor() + '}{');
          var startIndex_1 = task.startPosition;
          result.append_gw00v9$(string.substring(startIndex_1, endPosition));
          result.append_gw00v9$('}');
          lastHandledPosition = endPosition;
        }
      }
    }
    var startIndex_2 = lastHandledPosition;
    result.append_gw00v9$(string.substring(startIndex_2));
    return result.toString();
  }
  function dropPerformedTexBrushing(string) {
    var result = dropPerformedTexBrushingInternal(string);
    var resultLast = string;
    while (!equals(result, resultLast)) {
      var newResult = dropPerformedTexBrushingInternal(result);
      resultLast = result;
      result = newResult;
    }
    return result;
  }
  function dropPerformedTexBrushingInternal$lambda(it) {
    return unboxChar(it) !== 125;
  }
  function dropPerformedTexBrushingInternal(string) {
    var result = StringBuilder_init();
    var currentPosition = 0;
    while (currentPosition < string.length) {
      var index = findAnyOf(string, listOf('\\textcolor{'), currentPosition);
      if (index != null) {
        var startIndex = currentPosition;
        var endIndex = index.first;
        result.append_gw00v9$(string.substring(startIndex, endIndex));
        currentPosition = index.first + index.second.length | 0;
        currentPosition = skipFromRemainingExpressionWhile(dropPerformedTexBrushingInternal$lambda, string, currentPosition) + 1 | 0;
        var newCurrentPosition = skipFromRemainingExpressionWhileClosingBracketNotFound('}', '{', string, currentPosition);
        var startIndex_0 = currentPosition;
        result.append_gw00v9$(string.substring(startIndex_0, newCurrentPosition));
        currentPosition = newCurrentPosition + 1 | 0;
      }
       else {
        var startIndex_1 = currentPosition;
        result.append_gw00v9$(string.substring(startIndex_1));
        break;
      }
    }
    return result.toString();
  }
  _.createCompiledConfigurationFromExpressionSubstitutionsAndParams = createCompiledConfigurationFromExpressionSubstitutionsAndParams_JS;
  _.createConfigurationFromRulePacksAndParams = createConfigurationFromRulePacksAndParams_JS;
  _.getSubstitutionsByRulePacks = getSubstitutionsByRulePacks_JS;
  _.stringToExpression = stringToExpression_JS;
  _.structureStringToExpression = structureStringToExpression_JS;
  _.expressionToString = expressionToString_JS;
  _.expressionToTexString = expressionToTexString_JS;
  _.expressionToStructureString = expressionToStructureString_JS;
  _.expressionSubstitutionFromStrings = expressionSubstitutionFromStrings;
  _.expressionSubstitutionFromStructureStrings = expressionSubstitutionFromStructureStrings_JS;
  _.findApplicableSubstitutionsInSelectedPlace = findApplicableSubstitutionsInSelectedPlace_JS;
  _.findSubstitutionPlacesInExpression = findSubstitutionPlacesInExpression;
  _.applySubstitution = applySubstitution;
  _.generateTask = generateTask;
  _.checkSolutionInTex = checkSolutionInTex_JS;
  _.getParsedExpressionByMathML = getParsedExpressionByMathML;
  _.checkFactsInMathML = checkFactsInMathML;
  _.getUserLogInPlainText = getUserLogInPlainText;
  _.getUserLogInJson = getUserLogInJson;
  _.getAllLogInPlainText = getAllLogInPlainText;
  _.getAllLogInJson = getAllLogInJson;
  _.encryptSolution = encryptSolution;
  _.encryptResult = encryptResult;
  _.compareWithoutSubstitutions = compareWithoutSubstitutions;
  var package$api = _.api || (_.api = {});
  package$api.createConfigurationFromRulePacksAndParams_79na2b$ = createConfigurationFromRulePacksAndParams;
  package$api.getSubstitutionsByRulePacks_kand9s$ = getSubstitutionsByRulePacks;
  package$api.getAllAlgebraSubstitutions = getAllAlgebraSubstitutions;
  package$api.getArithmeticPositiveAdditionSubstitutions = getArithmeticPositiveAdditionSubstitutions;
  package$api.getArithmeticAdditionSubstitutions = getArithmeticAdditionSubstitutions;
  package$api.getArithmeticMultiplicationSubstitutions = getArithmeticMultiplicationSubstitutions;
  package$api.getArithmeticDivisionSubstitutions = getArithmeticDivisionSubstitutions;
  package$api.getArithmeticPowSubstitutions = getArithmeticPowSubstitutions;
  package$api.getArithmeticPowExtensionSubstitutions = getArithmeticPowExtensionSubstitutions;
  package$api.getShortMultiplicationSubstitutions = getShortMultiplicationSubstitutions;
  package$api.getLogarithmSubstitutions = getLogarithmSubstitutions;
  package$api.getFactorialSubstitutions = getFactorialSubstitutions;
  package$api.getCombinatoricsSubstitutions = getCombinatoricsSubstitutions;
  package$api.getTrigonometrySubstitutions = getTrigonometrySubstitutions;
  package$api.getTrigonometryZkSubstitutions = getTrigonometryZkSubstitutions;
  package$api.getTrigonometryCompleteTgCtgSubstitutions = getTrigonometryCompleteTgCtgSubstitutions;
  package$api.getSetBaseSubstitutions = getSetBaseSubstitutions;
  package$api.getSetAbsorptionLawSubstitutions = getSetAbsorptionLawSubstitutions;
  package$api.getSetResolutionSubstitutions = getSetResolutionSubstitutions;
  package$api.getPhysicsNuclearSubstitutions = getPhysicsNuclearSubstitutions;
  package$api.getPhysicsCircleMovingSubstitutions = getPhysicsCircleMovingSubstitutions;
  package$api.getPhysicsMolecularSubstitutions = getPhysicsMolecularSubstitutions;
  package$api.getPhysicsSimpleMovingSubstitutions = getPhysicsSimpleMovingSubstitutions;
  package$api.getPhysicsElectrodynamicsSubstitutions = getPhysicsElectrodynamicsSubstitutions;
  package$api.normalizeExpressionToUsualForm_4hv65v$ = normalizeExpressionToUsualForm;
  package$api.compareWithoutSubstitutions_ic33gh$ = compareWithoutSubstitutions_0;
  package$api.compareByPattern_fxceps$ = compareByPattern;
  package$api.compareWithoutSubstitutions_atx8px$ = compareWithoutSubstitutions_1;
  package$api.compareByPattern_atx8px$ = compareByPattern_0;
  package$api.compareWithoutSubstitutionsStructureStrings_atx8px$ = compareWithoutSubstitutionsStructureStrings;
  package$api.stringToExpression_y630ta$ = stringToExpression;
  package$api.expressionToString_tvfpvg$ = expressionToString;
  package$api.expressionToTexString_tvfpvg$ = expressionToTexString;
  package$api.structureStringToExpression_69c2cy$ = structureStringToExpression;
  package$api.expressionToStructureString_6718cy$ = expressionToStructureString;
  package$api.stringToStructureString_y630ta$ = stringToStructureString;
  package$api.stringToExpressionStructurePattern_69c2cy$ = stringToExpressionStructurePattern;
  package$api.investigateIfExpressionFormIsStructureString_61zpoe$ = investigateIfExpressionFormIsStructureString;
  package$api.generateTask_ufm96r$ = generateTask_0;
  package$api.generateTaskInJSON_ny8vwh$ = generateTaskInJSON;
  package$api.generateTaskByStructureStringsSubstitutionsInJSON_ny8vwh$ = generateTaskByStructureStringsSubstitutionsInJSON;
  package$api.optGenerateSimpleComputationRule_8b70w7$ = optGenerateSimpleComputationRule;
  package$api.expressionSubstitutionFromStrings_9cao15$ = expressionSubstitutionFromStrings_0;
  package$api.expressionSubstitutionFromStructureStrings_aiibik$ = expressionSubstitutionFromStructureStrings;
  package$api.findSubstitutionPlacesInExpression_333i8d$ = findSubstitutionPlacesInExpression_0;
  package$api.applySubstitution_g1mkoe$ = applySubstitution_0;
  package$api.createCompiledConfigurationFromExpressionSubstitutionsAndParams_aatmta$ = createCompiledConfigurationFromExpressionSubstitutionsAndParams;
  package$api.findApplicableSubstitutionsInSelectedPlace_fe1uu9$ = findApplicableSubstitutionsInSelectedPlace;
  package$api.applySubstitutionInSelectedPlace_m5nb0p$ = applySubstitutionInSelectedPlace;
  package$api.findLowestSubtreeTopOfSelectedNodesInExpression_3skgjp$ = findLowestSubtreeTopOfSelectedNodesInExpression;
  package$api.SubstitutionPlaceOfflineData = SubstitutionPlaceOfflineData;
  package$api.findSubstitutionPlacesCoordinatesInExpressionJSON_yb6h17$ = findSubstitutionPlacesCoordinatesInExpressionJSON;
  package$api.findStructureStringsSubstitutionPlacesCoordinatesInExpressionJSON_yb6h17$ = findStructureStringsSubstitutionPlacesCoordinatesInExpressionJSON;
  package$api.applyExpressionBySubstitutionPlaceCoordinates_wumftt$ = applyExpressionBySubstitutionPlaceCoordinates;
  package$api.applyExpressionByStructureStringsSubstitutionPlaceCoordinates_wumftt$ = applyExpressionByStructureStringsSubstitutionPlaceCoordinates;
  package$api.checkSolutionInTex_1eteoc$ = checkSolutionInTex;
  var package$baseoperations = _.baseoperations || (_.baseoperations = {});
  package$baseoperations.BaseNumber = BaseNumber;
  package$baseoperations.BaseOperationDefinitionWithDomain = BaseOperationDefinitionWithDomain;
  Object.defineProperty(ComputationType, 'COMPLEX', {
    get: ComputationType$COMPLEX_getInstance
  });
  Object.defineProperty(ComputationType, 'DOUBLE', {
    get: ComputationType$DOUBLE_getInstance
  });
  package$baseoperations.ComputationType = ComputationType;
  Object.defineProperty(BaseOperationsComputation, 'Companion', {
    get: BaseOperationsComputation$Companion_getInstance
  });
  package$baseoperations.BaseOperationsComputation = BaseOperationsComputation;
  package$baseoperations.BaseOperationsDefinition = BaseOperationsDefinition;
  package$baseoperations.BaseOperationsDefinitions = BaseOperationsDefinitions;
  Object.defineProperty(BaseSimpleNumbersComputation, 'Companion', {
    get: BaseSimpleNumbersComputation$Companion_getInstance
  });
  package$baseoperations.BaseSimpleNumbersComputation = BaseSimpleNumbersComputation;
  Object.defineProperty(ComplexBaseOperation, 'Companion', {
    get: ComplexBaseOperation$Companion_getInstance
  });
  package$baseoperations.ComplexBaseOperation = ComplexBaseOperation;
  Object.defineProperty(DoubleBaseOperation, 'Companion', {
    get: DoubleBaseOperation$Companion_getInstance
  });
  package$baseoperations.DoubleBaseOperation = DoubleBaseOperation;
  Object.defineProperty(DomainSegment, 'Companion', {
    get: DomainSegment$Companion_getInstance
  });
  package$baseoperations.DomainSegment = DomainSegment;
  Object.defineProperty(DefinitionDomain, 'Companion', {
    get: DefinitionDomain$Companion_getInstance
  });
  package$baseoperations.DefinitionDomain = DefinitionDomain;
  package$baseoperations.EmptyDomainException = EmptyDomainException;
  package$baseoperations.AnalyticallyDefinedDomain = AnalyticallyDefinedDomain;
  Object.defineProperty(package$baseoperations, 'DomainAll', {
    get: function () {
      return DomainAll;
    }
  });
  Object.defineProperty(package$baseoperations, 'DomainNil', {
    get: function () {
      return DomainNil;
    }
  });
  package$baseoperations.MultivariateDefinitionDomain = MultivariateDefinitionDomain;
  package$baseoperations.Segment = Segment;
  package$baseoperations.SegmentsUnion = SegmentsUnion;
  package$baseoperations.VariableProperties = VariableProperties;
  package$baseoperations.PointGenerator = PointGenerator;
  var package$config = _.config || (_.config = {});
  package$config.CheckedFactColor = CheckedFactColor;
  package$config.CheckedFactAccentuation = CheckedFactAccentuation;
  Object.defineProperty(CheckingKeyWords, 'Companion', {
    get: CheckingKeyWords$Companion_getInstance
  });
  package$config.CheckingKeyWords = CheckingKeyWords;
  Object.defineProperty(ComparisonType, 'LEFT_MORE_OR_EQUAL', {
    get: ComparisonType$LEFT_MORE_OR_EQUAL_getInstance
  });
  Object.defineProperty(ComparisonType, 'LEFT_LESS_OR_EQUAL', {
    get: ComparisonType$LEFT_LESS_OR_EQUAL_getInstance
  });
  Object.defineProperty(ComparisonType, 'EQUAL', {
    get: ComparisonType$EQUAL_getInstance
  });
  Object.defineProperty(ComparisonType, 'LEFT_MORE', {
    get: ComparisonType$LEFT_MORE_getInstance
  });
  Object.defineProperty(ComparisonType, 'LEFT_LESS', {
    get: ComparisonType$LEFT_LESS_getInstance
  });
  package$config.ComparisonType = ComparisonType;
  package$config.strictComparison_ohxo0h$ = strictComparison;
  package$config.valueOfComparisonType_61zpoe$ = valueOfComparisonType;
  package$config.valueFromMathMLString_61zpoe$ = valueFromMathMLString;
  package$config.getAllComparisonTypeMathML = getAllComparisonTypeMathML;
  package$config.ComparisonSettings = ComparisonSettings;
  package$config.GradientDescentComparisonConfiguration = GradientDescentComparisonConfiguration;
  package$config.CompiledConfiguration = CompiledConfiguration;
  Object.defineProperty(ErrorLevel, 'INFO', {
    get: ErrorLevel$INFO_getInstance
  });
  Object.defineProperty(ErrorLevel, 'WARNING', {
    get: ErrorLevel$WARNING_getInstance
  });
  Object.defineProperty(ErrorLevel, 'ERROR', {
    get: ErrorLevel$ERROR_getInstance
  });
  Object.defineProperty(ErrorLevel, 'FATAL_ERROR', {
    get: ErrorLevel$FATAL_ERROR_getInstance
  });
  package$config.ErrorLevel = ErrorLevel;
  package$config.ConfigurationError = ConfigurationError;
  package$config.FactTransformationRule = FactTransformationRule;
  package$config.FactsLogicConfiguration = FactsLogicConfiguration;
  Object.defineProperty(StringDefinitionType, 'BINARY_OPERATION', {
    get: StringDefinitionType$BINARY_OPERATION_getInstance
  });
  Object.defineProperty(StringDefinitionType, 'UNARY_LEFT_OPERATION', {
    get: StringDefinitionType$UNARY_LEFT_OPERATION_getInstance
  });
  Object.defineProperty(StringDefinitionType, 'UNARY_RIGHT_OPERATION', {
    get: StringDefinitionType$UNARY_RIGHT_OPERATION_getInstance
  });
  Object.defineProperty(StringDefinitionType, 'FUNCTION', {
    get: StringDefinitionType$FUNCTION_getInstance
  });
  package$config.StringDefinitionType = StringDefinitionType;
  Object.defineProperty(FunctionIdentifier, 'Companion', {
    get: FunctionIdentifier$Companion_getInstance
  });
  package$config.FunctionIdentifier = FunctionIdentifier;
  package$config.FunctionProperties = FunctionProperties;
  package$config.FunctionStringDefinition = FunctionStringDefinition;
  package$config.FunctionDefinition = FunctionDefinition;
  package$config.TreeTransformationRule = TreeTransformationRule;
  package$config.FunctionConfiguration = FunctionConfiguration;
  package$config.VariableReplacementRule = VariableReplacementRule;
  package$config.VariableConfiguration = VariableConfiguration;
  var package$expressiontree = _.expressiontree || (_.expressiontree = {});
  package$expressiontree.containsDifferentiation_l19yqr$ = containsDifferentiation;
  package$expressiontree.diff_83etus$ = diff;
  Object.defineProperty(package$expressiontree, 'unlimitedWeight', {
    get: function () {
      return unlimitedWeight;
    }
  });
  package$expressiontree.buildDiffNode_yfr0in$ = buildDiffNode;
  package$expressiontree.calcSinCosDomain_e779oy$ = calcSinCosDomain;
  Object.defineProperty(package$expressiontree, 'knownOps', {
    get: function () {
      return knownOps;
    }
  });
  Object.defineProperty(package$expressiontree, 'knownOpsAssociation', {
    get: function () {
      return knownOpsAssociation;
    }
  });
  package$expressiontree.DomainCalculator = DomainCalculator;
  package$expressiontree.ParserError = ParserError;
  package$expressiontree.GeneralError = GeneralError;
  package$expressiontree.ExpressionComporator = ExpressionComporator;
  package$expressiontree.getComparingDirection_t8h94i$ = getComparingDirection;
  Object.defineProperty(NodeType, 'FUNCTION', {
    get: NodeType$FUNCTION_getInstance
  });
  Object.defineProperty(NodeType, 'VARIABLE', {
    get: NodeType$VARIABLE_getInstance
  });
  Object.defineProperty(NodeType, 'EMPTY', {
    get: NodeType$EMPTY_getInstance
  });
  Object.defineProperty(NodeType, 'ERROR', {
    get: NodeType$ERROR_getInstance
  });
  package$expressiontree.NodeType = NodeType;
  package$expressiontree.NodeValue = NodeValue;
  package$expressiontree.ExpressionStrictureIdentifier = ExpressionStrictureIdentifier;
  package$expressiontree.ExpressionNode = ExpressionNode;
  package$expressiontree.ExpressionNodeConstructor = ExpressionNodeConstructor;
  package$expressiontree.normalizeExpressionsForComparison_rng7ig$ = normalizeExpressionsForComparison;
  package$expressiontree.subtractionTree_rng7ig$ = subtractionTree;
  package$expressiontree.divisionTree_rng7ig$ = divisionTree;
  package$expressiontree.addRootNodeToExpression_6718cy$ = addRootNodeToExpression;
  Object.defineProperty(package$expressiontree, 'PARENT_BRACKETS_EXPANSION', {
    get: function () {
      return PARENT_BRACKETS_EXPANSION;
    }
  });
  Object.defineProperty(package$expressiontree, 'REDUCE_FRACTION', {
    get: function () {
      return REDUCE_FRACTION;
    }
  });
  package$expressiontree.nodeIdsPositionsMap_9mvhws$ = nodeIdsPositionsMap;
  package$expressiontree.nodeIdsToNodeLinksInSameOrder_o132aw$ = nodeIdsToNodeLinksInSameOrder;
  package$expressiontree.findLowestSubtreeTopOfNodes_4sw5sy$ = findLowestSubtreeTopOfNodes;
  package$expressiontree.findLowestSubtreeWithNodes_yr6xck$ = findLowestSubtreeWithNodes;
  package$expressiontree.cloneWithoutSelectedNodes_kdwlv0$ = cloneWithoutSelectedNodes;
  package$expressiontree.SubstitutionSelectionData = SubstitutionSelectionData;
  package$expressiontree.SubstitutionApplication = SubstitutionApplication;
  package$expressiontree.simpleCommutativeOperationSelectionHandling_9330xr$ = simpleCommutativeOperationSelectionHandling;
  package$expressiontree.fillSubstitutionSelectionData_9330xr$ = fillSubstitutionSelectionData;
  package$expressiontree.findConfiguredSubstitutionsApplications_cdlxsa$ = findConfiguredSubstitutionsApplications;
  package$expressiontree.generateParentBracketsExpansionSubstitution_9330xr$ = generateParentBracketsExpansionSubstitution;
  package$expressiontree.generateMinusInOutBracketsSubstitution_9330xr$ = generateMinusInOutBracketsSubstitution;
  package$expressiontree.generatePermutationSubstitutions_5rlcje$ = generatePermutationSubstitutions;
  package$expressiontree.ExpressionStrictureIdentifierCounter = ExpressionStrictureIdentifierCounter;
  package$expressiontree.generateReduceArithmeticSubstitutions_d9zsof$ = generateReduceArithmeticSubstitutions;
  package$expressiontree.generateReduceFractionSubstitutions_d9zsof$ = generateReduceFractionSubstitutions;
  package$expressiontree.getOperandsFrom2ArgsNode_j00fd2$ = getOperandsFrom2ArgsNode;
  package$expressiontree.getMultipliersFromNode_vnu17z$ = getMultipliersFromNode;
  package$expressiontree.handleAdditiveNodeAsReductionPart_6zj4xr$ = handleAdditiveNodeAsReductionPart;
  package$expressiontree.generateZeroComputationSubstitutions_5rlcje$ = generateZeroComputationSubstitutions;
  package$expressiontree.generateOpeningBracketsSubstitutions_5rlcje$ = generateOpeningBracketsSubstitutions;
  package$expressiontree.generateSimpleComputationSubstitutions_5rlcje$ = generateSimpleComputationSubstitutions;
  package$expressiontree.generateNumberTransformationSubstitutions_5rlcje$ = generateNumberTransformationSubstitutions;
  package$expressiontree.generateComplicatingExtensionSubstitutions_5rlcje$ = generateComplicatingExtensionSubstitutions;
  package$expressiontree.applySubstitution_bs6wez$ = applySubstitution_1;
  package$expressiontree.generateFormIndependentSubstitutionsBySelectedNodes_5rlcje$ = generateFormIndependentSubstitutionsBySelectedNodes;
  package$expressiontree.generateFormDependentSubstitutionsBySelectedNodes_cdlxsa$ = generateFormDependentSubstitutionsBySelectedNodes;
  package$expressiontree.generateFormDependentSubstitutionsBySelectedNodesWithExpressionSimplifications_qwwddr$ = generateFormDependentSubstitutionsBySelectedNodesWithExpressionSimplifications;
  package$expressiontree.generateSubstitutionsBySelectedNodes_5rlcje$ = generateSubstitutionsBySelectedNodes;
  package$expressiontree.ExpressionStructurePart = ExpressionStructurePart;
  package$expressiontree.FunctionCondition = FunctionCondition;
  package$expressiontree.FunctionsCondition = FunctionsCondition;
  Object.defineProperty(NumberIntervalType, 'NATURAL', {
    get: NumberIntervalType$NATURAL_getInstance
  });
  Object.defineProperty(NumberIntervalType, 'INTEGER', {
    get: NumberIntervalType$INTEGER_getInstance
  });
  Object.defineProperty(NumberIntervalType, 'REAL', {
    get: NumberIntervalType$REAL_getInstance
  });
  package$expressiontree.NumberIntervalType = NumberIntervalType;
  package$expressiontree.NumberInterval = NumberInterval;
  package$expressiontree.NumberCondition = NumberCondition;
  package$expressiontree.VariableCondition = VariableCondition;
  package$expressiontree.VariablesCondition = VariablesCondition;
  package$expressiontree.ChildrenCondition = ChildrenCondition;
  package$expressiontree.ExpressionStructureConditionNode = ExpressionStructureConditionNode;
  package$expressiontree.checkExpressionStructure_fxceps$ = checkExpressionStructure;
  package$expressiontree.ExpressionStructureConditionConstructor = ExpressionStructureConditionConstructor;
  Object.defineProperty(package$expressiontree, 'additionalFactUsedVarName', {
    get: function () {
      return additionalFactUsedVarName;
    }
  });
  Object.defineProperty(SubstitutionInstanceVarType, 'EXPR_VAR', {
    get: SubstitutionInstanceVarType$EXPR_VAR_getInstance
  });
  Object.defineProperty(SubstitutionInstanceVarType, 'EXPR_FUNC', {
    get: SubstitutionInstanceVarType$EXPR_FUNC_getInstance
  });
  Object.defineProperty(SubstitutionInstanceVarType, 'COMPARABLE_VAR', {
    get: SubstitutionInstanceVarType$COMPARABLE_VAR_getInstance
  });
  Object.defineProperty(SubstitutionInstanceVarType, 'INFO', {
    get: SubstitutionInstanceVarType$INFO_getInstance
  });
  package$expressiontree.SubstitutionInstanceVarType = SubstitutionInstanceVarType;
  package$expressiontree.SubstitutionInstanceVar = SubstitutionInstanceVar;
  package$expressiontree.VarNamesTimeStorage = VarNamesTimeStorage;
  package$expressiontree.MatchedNode = MatchedNode;
  package$expressiontree.SubstitutionInstance = SubstitutionInstance;
  package$expressiontree.SubstitutionPlace = SubstitutionPlace;
  Object.defineProperty(ExpressionSubstitution, 'Companion', {
    get: ExpressionSubstitution$Companion_getInstance
  });
  package$expressiontree.ExpressionSubstitution = ExpressionSubstitution;
  package$expressiontree.applyAllFunctionSubstitutions_eeptyd$ = applyAllFunctionSubstitutions;
  package$expressiontree.applyAllSubstitutions_ueg7ax$ = applyAllSubstitutions;
  package$expressiontree.applyAllImmediateSubstitutions_w5a5qi$ = applyAllImmediateSubstitutions;
  package$expressiontree.ExpressionTask = ExpressionTask;
  package$expressiontree.generateExpressionTask_ufm96r$ = generateExpressionTask;
  Object.defineProperty(MathMlTagTreeNode$Type, 'EXPRESSION_PART_STRING', {
    get: MathMlTagTreeNode$Type$EXPRESSION_PART_STRING_getInstance
  });
  Object.defineProperty(MathMlTagTreeNode$Type, 'MATH_ML_FUNCTION', {
    get: MathMlTagTreeNode$Type$MATH_ML_FUNCTION_getInstance
  });
  Object.defineProperty(MathMlTagTreeNode$Type, 'BRACKET_FUNCTION', {
    get: MathMlTagTreeNode$Type$BRACKET_FUNCTION_getInstance
  });
  Object.defineProperty(MathMlTagTreeNode$Type, 'NAME', {
    get: MathMlTagTreeNode$Type$NAME_getInstance
  });
  Object.defineProperty(MathMlTagTreeNode$Type, 'OPERATION', {
    get: MathMlTagTreeNode$Type$OPERATION_getInstance
  });
  MathMlTagTreeNode.Type = MathMlTagTreeNode$Type;
  Object.defineProperty(MathMlTagTreeNode$TexArgumentType, 'USUAL', {
    get: MathMlTagTreeNode$TexArgumentType$USUAL_getInstance
  });
  Object.defineProperty(MathMlTagTreeNode$TexArgumentType, 'UNDERLINED', {
    get: MathMlTagTreeNode$TexArgumentType$UNDERLINED_getInstance
  });
  Object.defineProperty(MathMlTagTreeNode$TexArgumentType, 'POW', {
    get: MathMlTagTreeNode$TexArgumentType$POW_getInstance
  });
  MathMlTagTreeNode.TexArgumentType = MathMlTagTreeNode$TexArgumentType;
  package$expressiontree.MathMlTagTreeNode = MathMlTagTreeNode;
  package$expressiontree.swap_e9uf6z$ = swap;
  Object.defineProperty(ExpressionParserNode$Type, 'FUNCTION', {
    get: ExpressionParserNode$Type$FUNCTION_getInstance
  });
  Object.defineProperty(ExpressionParserNode$Type, 'VARIABLE', {
    get: ExpressionParserNode$Type$VARIABLE_getInstance
  });
  Object.defineProperty(ExpressionParserNode$Type, 'BINARY_OPERATION', {
    get: ExpressionParserNode$Type$BINARY_OPERATION_getInstance
  });
  Object.defineProperty(ExpressionParserNode$Type, 'UNARY_OPERATION', {
    get: ExpressionParserNode$Type$UNARY_OPERATION_getInstance
  });
  ExpressionParserNode.Type = ExpressionParserNode$Type;
  package$expressiontree.ExpressionParserNode = ExpressionParserNode;
  Object.defineProperty(ExpressionTreeParser$TokenParserState, 'UNDEFINED', {
    get: ExpressionTreeParser$TokenParserState$UNDEFINED_getInstance
  });
  Object.defineProperty(ExpressionTreeParser$TokenParserState, 'UNARY_OPERATION', {
    get: ExpressionTreeParser$TokenParserState$UNARY_OPERATION_getInstance
  });
  Object.defineProperty(ExpressionTreeParser$TokenParserState, 'BINARY_OPERATION', {
    get: ExpressionTreeParser$TokenParserState$BINARY_OPERATION_getInstance
  });
  Object.defineProperty(ExpressionTreeParser$TokenParserState, 'NUMBER', {
    get: ExpressionTreeParser$TokenParserState$NUMBER_getInstance
  });
  Object.defineProperty(ExpressionTreeParser$TokenParserState, 'NAME', {
    get: ExpressionTreeParser$TokenParserState$NAME_getInstance
  });
  Object.defineProperty(ExpressionTreeParser$TokenParserState, 'NAME_BREAK', {
    get: ExpressionTreeParser$TokenParserState$NAME_BREAK_getInstance
  });
  Object.defineProperty(ExpressionTreeParser$TokenParserState, 'COMMA', {
    get: ExpressionTreeParser$TokenParserState$COMMA_getInstance
  });
  ExpressionTreeParser.TokenParserState = ExpressionTreeParser$TokenParserState;
  Object.defineProperty(ExpressionTreeParser, 'Companion', {
    get: ExpressionTreeParser$Companion_getInstance
  });
  package$expressiontree.ExpressionTreeParser = ExpressionTreeParser;
  package$expressiontree.ExpressionTreeAnalyzer = ExpressionTreeAnalyzer;
  package$expressiontree.shouldTakeLog_6718cy$ = shouldTakeLog;
  package$expressiontree.getLog_4hv65v$ = getLog;
  package$expressiontree.alwaysPositiveFunction_6718cy$ = alwaysPositiveFunction;
  package$expressiontree.difference_jv1oz7$ = difference;
  package$expressiontree.ratio_jv1oz7$ = ratio;
  package$expressiontree.alwaysPositive_4hv65v$ = alwaysPositive;
  package$expressiontree.gradientDescentComparison_pufmpq$ = gradientDescentComparison;
  Object.defineProperty(package$expressiontree, 'TREE_COMPUTATION_RULES_PRIORITY', {
    get: function () {
      return TREE_COMPUTATION_RULES_PRIORITY;
    }
  });
  Object.defineProperty(package$expressiontree, 'TREE_COMPUTATION_DEFAULT', {
    get: function () {
      return TREE_COMPUTATION_DEFAULT;
    }
  });
  package$expressiontree.SimpleComputationRuleParams = SimpleComputationRuleParams;
  Object.defineProperty(package$expressiontree, 'simpleComputationRuleParamsDefault', {
    get: function () {
      return simpleComputationRuleParamsDefault;
    }
  });
  Object.defineProperty(package$expressiontree, 'simpleComputationRuleParamsNoLimits', {
    get: function () {
      return simpleComputationRuleParamsNoLimits;
    }
  });
  package$expressiontree.calcComplexity_l19yqr$ = calcComplexity;
  package$expressiontree.computeNodeIfPossible_l19yqr$ = computeNodeIfPossible;
  package$expressiontree.computeNodeIfSimple_ukmeis$ = computeNodeIfSimple;
  package$expressiontree.tenPowToMakeZ_e56afh$ = tenPowToMakeZ;
  Object.defineProperty(ComparableTransformationPartType, 'EXPRESSION', {
    get: ComparableTransformationPartType$EXPRESSION_getInstance
  });
  Object.defineProperty(ComparableTransformationPartType, 'EXPRESSION_COMPARISON', {
    get: ComparableTransformationPartType$EXPRESSION_COMPARISON_getInstance
  });
  Object.defineProperty(ComparableTransformationPartType, 'MAIN_LINE_AND_NODE', {
    get: ComparableTransformationPartType$MAIN_LINE_AND_NODE_getInstance
  });
  Object.defineProperty(ComparableTransformationPartType, 'MAIN_LINE_OR_NODE', {
    get: ComparableTransformationPartType$MAIN_LINE_OR_NODE_getInstance
  });
  Object.defineProperty(ComparableTransformationPartType, 'EXPRESSION_CHAIN', {
    get: ComparableTransformationPartType$EXPRESSION_CHAIN_getInstance
  });
  Object.defineProperty(ComparableTransformationPartType, 'RULE', {
    get: ComparableTransformationPartType$RULE_getInstance
  });
  Object.defineProperty(ComparableTransformationPartType, 'RULE_POINTER', {
    get: ComparableTransformationPartType$RULE_POINTER_getInstance
  });
  Object.defineProperty(ComparableTransformationPartType, 'EMPTY', {
    get: ComparableTransformationPartType$EMPTY_getInstance
  });
  var package$factstransformations = _.factstransformations || (_.factstransformations = {});
  package$factstransformations.ComparableTransformationPartType = ComparableTransformationPartType;
  package$factstransformations.ComparableTransformationsPart = ComparableTransformationsPart;
  package$factstransformations.ComparisonResult = ComparisonResult;
  package$factstransformations.MainChainPart = MainChainPart;
  package$factstransformations.MainLineNode = MainLineNode;
  Object.defineProperty(Expression, 'Companion', {
    get: Expression$Companion_getInstance
  });
  package$factstransformations.Expression = Expression;
  package$factstransformations.emptyExpression = emptyExpression;
  package$factstransformations.ExpressionChain = ExpressionChain;
  Object.defineProperty(ExpressionComparison, 'Companion', {
    get: ExpressionComparison$Companion_getInstance
  });
  package$factstransformations.ExpressionComparison = ExpressionComparison;
  package$factstransformations.RulePointer = RulePointer;
  package$factstransformations.Rule = Rule;
  package$factstransformations.MainChain = MainChain;
  Object.defineProperty(MainLineAndNode, 'Companion', {
    get: MainLineAndNode$Companion_getInstance
  });
  package$factstransformations.MainLineAndNode = MainLineAndNode;
  Object.defineProperty(MainLineOrNode, 'Companion', {
    get: MainLineOrNode$Companion_getInstance
  });
  package$factstransformations.MainLineOrNode = MainLineOrNode;
  package$factstransformations.getInFactsFromMainLineNode_dviugo$ = getInFactsFromMainLineNode;
  package$factstransformations.getOutFactsFromMainLineNode_dviugo$ = getOutFactsFromMainLineNode;
  package$factstransformations.parsePartsFromIdentifier_yhp8gb$ = parsePartsFromIdentifier;
  package$factstransformations.parseFromFactIdentifier_yhp8gb$ = parseFromFactIdentifier;
  package$factstransformations.normalizeFactsForComparison_mfkl64$ = normalizeFactsForComparison;
  package$factstransformations.factWrapperForCheckingTransformations_7e4k2x$ = factWrapperForCheckingTransformations;
  package$factstransformations.checkTransformationChain_brt3cf$ = checkTransformationChain;
  package$factstransformations.FactConstructorViewer = FactConstructorViewer;
  package$factstransformations.FactComporator = FactComporator;
  Object.defineProperty(SubstitutionDirection, 'LEFT_TO_RIGHT', {
    get: SubstitutionDirection$LEFT_TO_RIGHT_getInstance
  });
  Object.defineProperty(SubstitutionDirection, 'RIGHT_TO_LEFT', {
    get: SubstitutionDirection$RIGHT_TO_LEFT_getInstance
  });
  Object.defineProperty(SubstitutionDirection, 'ALL_TO_ALL', {
    get: SubstitutionDirection$ALL_TO_ALL_getInstance
  });
  package$factstransformations.SubstitutionDirection = SubstitutionDirection;
  package$factstransformations.toUserString_55low8$ = toUserString;
  package$factstransformations.FactSubstitutionPlace = FactSubstitutionPlace;
  package$factstransformations.FactSubstitution = FactSubstitution;
  package$factstransformations.emptyFactSubstitution = emptyFactSubstitution;
  TransformationChainParser.SemanticRangeShift = TransformationChainParser$SemanticRangeShift;
  package$factstransformations.TransformationChainParser = TransformationChainParser;
  Object.defineProperty(MessageType, 'USER', {
    get: MessageType$USER_getInstance
  });
  Object.defineProperty(MessageType, 'TECHNICAL', {
    get: MessageType$TECHNICAL_getInstance
  });
  Object.defineProperty(MessageType, 'ALL', {
    get: MessageType$ALL_getInstance
  });
  var package$logs = _.logs || (_.logs = {});
  package$logs.MessageType = MessageType;
  package$logs.LazyMessage = LazyMessage;
  package$logs.LazyLog = LazyLog;
  Object.defineProperty(package$logs, 'log', {
    get: function () {
      return log_1;
    }
  });
  var package$mainpoints = _.mainpoints || (_.mainpoints = {});
  package$mainpoints.checkFactsInMathML_flvft8$ = checkFactsInMathML_0;
  package$mainpoints.replaceSpaceMathMLAliases_61zpoe$ = replaceSpaceMathMLAliases;
  Object.defineProperty(package$mainpoints, 'spaceRegex', {
    get: function () {
      return spaceRegex;
    }
  });
  package$mainpoints.deleteUnsupportedMathMLTags_61zpoe$ = deleteUnsupportedMathMLTags;
  package$mainpoints.correctMathMlTagsAccordingToBracketsFromEnd_61zpoe$ = correctMathMlTagsAccordingToBracketsFromEnd;
  package$mainpoints.specificMathMlSystemReplacements_61zpoe$ = specificMathMlSystemReplacements;
  package$mainpoints.addErrorStringToMathMLSolution_6hosri$ = addErrorStringToMathMLSolution;
  package$mainpoints.deleteErrorStringFromMathMLSolution_kwv3np$ = deleteErrorStringFromMathMLSolution;
  Object.defineProperty(package$mainpoints, 'unsupportedTagListMathML', {
    get: function () {
      return unsupportedTagListMathML;
    }
  });
  Object.defineProperty(package$mainpoints, 'underliningStartMathML', {
    get: function () {
      return underliningStartMathML;
    }
  });
  Object.defineProperty(package$mainpoints, 'underliningEndMathML', {
    get: function () {
      return underliningEndMathML;
    }
  });
  package$mainpoints.TexVerificationResult = TexVerificationResult;
  package$mainpoints.checkFactsInTex_58f4d7$ = checkFactsInTex;
  package$mainpoints.deleteUnsupportedTags_61zpoe$ = deleteUnsupportedTags;
  package$mainpoints.compiledConfigurationBySettings_oxdwhe$ = compiledConfigurationBySettings;
  package$mainpoints.combineSolutionRoot_5lze7j$ = combineSolutionRoot;
  package$mainpoints.pairsFromString_61zpoe$ = pairsFromString;
  package$mainpoints.pairsStringIntFromString_61zpoe$ = pairsStringIntFromString;
  package$mainpoints.additionalFactsFromItsIdentifiers_9qfmsk$ = additionalFactsFromItsIdentifiers;
  Object.defineProperty(package$mainpoints, 'configSeparator', {
    get: function () {
      return configSeparator;
    }
  });
  Object.defineProperty(package$mainpoints, 'errorPrefix', {
    get: function () {
      return errorPrefix;
    }
  });
  Object.defineProperty(package$mainpoints, 'syntaxErrorPrefix', {
    get: function () {
      return syntaxErrorPrefix;
    }
  });
  Object.defineProperty(CageHolder, 'Companion', {
    get: CageHolder$Companion_getInstance
  });
  var package$numbers = _.numbers || (_.numbers = {});
  package$numbers.CageHolder = CageHolder;
  Object.defineProperty(Form, 'ALGEBRAIC', {
    get: Form$ALGEBRAIC_getInstance
  });
  Object.defineProperty(Form, 'TRIGONOMETRIC', {
    get: Form$TRIGONOMETRIC_getInstance
  });
  package$numbers.Form = Form;
  package$numbers.toComplex_s8ev3n$ = toComplex;
  package$numbers.toComplex_yrwdxr$ = toComplex_0;
  package$numbers.toComplexOrNull_pdl1vz$ = toComplexOrNull;
  package$numbers.toComplex_pdl1vz$ = toComplex_1;
  Object.defineProperty(Complex, 'Companion', {
    get: Complex$Companion_getInstance
  });
  package$numbers.Complex_init_yjmvug$ = Complex_init;
  package$numbers.Complex = Complex;
  Object.defineProperty(LineSegmentHolder, 'Companion', {
    get: LineSegmentHolder$Companion_getInstance
  });
  package$numbers.LineSegmentHolder = LineSegmentHolder;
  package$numbers.toReal_s8ev3n$ = toReal;
  package$numbers.toReal_yrwdxr$ = toReal_0;
  package$numbers.toRealOrNull_pdl1vz$ = toRealOrNull;
  Object.defineProperty(Real, 'Companion', {
    get: Real$Companion_getInstance
  });
  package$numbers.Real_init_za3lpa$ = Real_init;
  package$numbers.Real = Real;
  var package$optimizerutils = _.optimizerutils || (_.optimizerutils = {});
  package$optimizerutils.InequalityApproximateSolver = InequalityApproximateSolver;
  Object.defineProperty(Case, 'ONE_DIMENSIONAL_POLYNOMIAL', {
    get: Case$ONE_DIMENSIONAL_POLYNOMIAL_getInstance
  });
  Object.defineProperty(Case, 'NONE', {
    get: Case$NONE_getInstance
  });
  package$optimizerutils.Case = Case;
  package$optimizerutils.SpecialCaseSolver = SpecialCaseSolver;
  package$optimizerutils.CompressedNodeDouble = CompressedNodeDouble;
  package$optimizerutils.OptimizerUtils = OptimizerUtils;
  package$optimizerutils.VariableInfo = VariableInfo;
  package$optimizerutils.CompressedNode = CompressedNode;
  package$optimizerutils.DomainPointGenerator = DomainPointGenerator;
  var package$platformdependent = _.platformdependent || (_.platformdependent = {});
  Object.defineProperty(package$platformdependent, 'random', {
    get: function () {
      return random;
    }
  });
  package$platformdependent.defaultRandom = defaultRandom;
  package$platformdependent.random_lu1900$ = random_0;
  package$platformdependent.randomInt_vux9f0$ = randomInt;
  package$platformdependent.abs_za3lpa$ = abs;
  package$platformdependent.toStringWithMinLength_c38nye$ = toStringWithMinLength;
  package$platformdependent.escapeCharacters_bm4lxs$ = escapeCharacters;
  package$platformdependent.escapeBackSlash_bm4lxs$ = escapeBackSlash;
  package$platformdependent.toShortString_yrwdxr$ = toShortString;
  var package$standartlibextensions = _.standartlibextensions || (_.standartlibextensions = {});
  package$standartlibextensions.abs_yrwdxr$ = abs_0;
  package$standartlibextensions.isNumberValuesEqual_puj7f4$ = isNumberValuesEqual;
  package$standartlibextensions.isLowerCaseLetter_myv2d0$ = isLowerCaseLetter;
  package$standartlibextensions.isUpperCaseLetter_myv2d0$ = isUpperCaseLetter;
  package$standartlibextensions.isLetter_myv2d0$ = isLetter;
  package$standartlibextensions.isLatinLetter_myv2d0$ = isLatinLetter;
  package$standartlibextensions.isLetterOrUnderscore_myv2d0$ = isLetterOrUnderscore;
  package$standartlibextensions.isDigit_myv2d0$ = isDigit;
  package$standartlibextensions.isLetterOrDigit_myv2d0$ = isLetterOrDigit;
  package$standartlibextensions.isLetterOrDigitOrUnderscore_myv2d0$ = isLetterOrDigitOrUnderscore;
  package$standartlibextensions.isNamePart_myv2d0$ = isNamePart;
  package$standartlibextensions.isNameOrNumberPart_myv2d0$ = isNameOrNumberPart;
  package$standartlibextensions.isNumberPart_myv2d0$ = isNumberPart;
  package$standartlibextensions.isOpenBracket_myv2d0$ = isOpenBracket;
  package$standartlibextensions.isCloseBracket_myv2d0$ = isCloseBracket;
  package$standartlibextensions.isTexArgumentsSeparator_myv2d0$ = isTexArgumentsSeparator;
  package$standartlibextensions.isBracket_myv2d0$ = isBracket;
  package$standartlibextensions.isUnarySignPart_s8itvh$ = isUnarySignPart;
  package$standartlibextensions.isBinarySignPart_1t0m1w$ = isBinarySignPart;
  package$standartlibextensions.isSign_5kkrc7$ = isSign;
  package$standartlibextensions.texStringPrefiltering_61zpoe$ = texStringPrefiltering;
  package$standartlibextensions.remainingExpressionStartsWith_rjan26$ = remainingExpressionStartsWith;
  package$standartlibextensions.readFromRemainingExpressionWhile_josn5q$ = readFromRemainingExpressionWhile;
  package$standartlibextensions.skipFromRemainingExpressionWhile_josn5q$ = skipFromRemainingExpressionWhile;
  package$standartlibextensions.skipFromRemainingExpressionWhileClosingTagNotFound_rjan26$ = skipFromRemainingExpressionWhileClosingTagNotFound;
  package$standartlibextensions.getBracketLevelChangeBeforeClosingTag_rjan26$ = getBracketLevelChangeBeforeClosingTag;
  package$standartlibextensions.findFirstNotInTagNotInMtext_bm4lxs$ = findFirstNotInTagNotInMtext;
  package$standartlibextensions.skipClosingTags_bm4lxs$ = skipClosingTags;
  package$standartlibextensions.selectPlacesForColoringByFragment_3m52m6$ = selectPlacesForColoringByFragment;
  package$standartlibextensions.findClosestPlaceToTargetOnTheSameLevel_yib5kn$ = findClosestPlaceToTargetOnTheSameLevel;
  package$standartlibextensions.skipFromRemainingExpressionWhileClosingBracketNotFound_ibifho$ = skipFromRemainingExpressionWhileClosingBracketNotFound;
  package$standartlibextensions.getIndexOfFirstBracketsValueEnd_cdtk8u$ = getIndexOfFirstBracketsValueEnd;
  package$standartlibextensions.NamedList = NamedList;
  package$standartlibextensions.splitStringByBracketsOnTopLevel_lmm34u$ = splitStringByBracketsOnTopLevel;
  package$standartlibextensions.splitBySubstringOnTopLevel_lu3ofv$ = splitBySubstringOnTopLevel;
  package$standartlibextensions.readOpenTagStringIfItPresent_bm4lxs$ = readOpenTagStringIfItPresent;
  package$standartlibextensions.trimmedMathML_pdl1vz$ = trimmedMathML;
  package$standartlibextensions.getTagAttributes_61zpoe$ = getTagAttributes;
  package$standartlibextensions.removeNewLinesFromExpression_61zpoe$ = removeNewLinesFromExpression;
  package$standartlibextensions.findNewLinePlaces_61zpoe$ = findNewLinePlaces;
  Object.defineProperty(package$standartlibextensions, 'mtable', {
    get: function () {
      return mtable;
    }
  });
  Object.defineProperty(package$standartlibextensions, 'mfenced', {
    get: function () {
      return mfenced;
    }
  });
  Object.defineProperty(package$standartlibextensions, 'closing', {
    get: function () {
      return closing;
    }
  });
  Object.defineProperty(package$standartlibextensions, 'newLineMspace', {
    get: function () {
      return newLineMspace;
    }
  });
  Object.defineProperty(package$standartlibextensions, 'newWhiteSpace', {
    get: function () {
      return newWhiteSpace;
    }
  });
  Object.defineProperty(package$standartlibextensions, 'openCommentMathML', {
    get: function () {
      return openCommentMathML;
    }
  });
  Object.defineProperty(package$standartlibextensions, 'openCommentShort', {
    get: function () {
      return openCommentShort;
    }
  });
  Object.defineProperty(package$standartlibextensions, 'closeCommentMathML', {
    get: function () {
      return closeCommentMathML;
    }
  });
  Object.defineProperty(package$standartlibextensions, 'closeCommentShort', {
    get: function () {
      return closeCommentShort;
    }
  });
  package$standartlibextensions.TransformationsPart = TransformationsPart;
  package$standartlibextensions.StringPart = StringPart;
  package$standartlibextensions.containsAny_k9a7eh$ = containsAny;
  package$standartlibextensions.containsAny_7wfnu2$ = containsAny_0;
  package$standartlibextensions.Letter = Letter;
  Object.defineProperty(package$standartlibextensions, 'lettersData', {
    get: function () {
      return lettersData;
    }
  });
  Object.defineProperty(package$standartlibextensions, 'texToUnicode', {
    get: function () {
      return texToUnicode;
    }
  });
  Object.defineProperty(package$standartlibextensions, 'unicodeToTex', {
    get: function () {
      return unicodeToTex;
    }
  });
  Object.defineProperty(package$standartlibextensions, 'texOpenBracket', {
    get: function () {
      return texOpenBracket;
    }
  });
  Object.defineProperty(package$standartlibextensions, 'texCloseBracket', {
    get: function () {
      return texCloseBracket;
    }
  });
  var package$visualization = _.visualization || (_.visualization = {});
  package$visualization.ColoringTask = ColoringTask;
  package$visualization.setBackgroundColorMathMl_puj7f4$ = setBackgroundColorMathMl;
  package$visualization.brushMathMl_hk0giz$ = brushMathMl;
  package$visualization.dropPerformedMathMLBrushing_61zpoe$ = dropPerformedMathMLBrushing;
  package$visualization.dropPerformedMathMLBrushingInternal_61zpoe$ = dropPerformedMathMLBrushingInternal;
  package$visualization.transformationPartsToLog_dviugo$ = transformationPartsToLog;
  package$visualization.transformationPartsToLog_gypy7n$ = transformationPartsToLog_0;
  package$visualization.transformationPartsToLog_7nna50$ = transformationPartsToLog_1;
  package$visualization.transformationPartsToLog_qlr0df$ = transformationPartsToLog_2;
  package$visualization.setBackgroundColorTex_puj7f4$ = setBackgroundColorTex;
  package$visualization.brushTex_hk0giz$ = brushTex;
  package$visualization.dropPerformedTexBrushing_61zpoe$ = dropPerformedTexBrushing;
  package$visualization.dropPerformedTexBrushingInternal_61zpoe$ = dropPerformedTexBrushingInternal;
  MainLineNode.prototype.isSolutionForVariables_axkv0l$ = MainChainPart.prototype.isSolutionForVariables_axkv0l$;
  Expression.prototype.isSolutionForVariables_axkv0l$ = MainChainPart.prototype.isSolutionForVariables_axkv0l$;
  ExpressionComparison.prototype.isSolutionForVariables_axkv0l$ = MainChainPart.prototype.isSolutionForVariables_axkv0l$;
  RulePointer.prototype.isSolutionForVariables_axkv0l$ = MainChainPart.prototype.isSolutionForVariables_axkv0l$;
  Rule.prototype.isSolutionForVariables_axkv0l$ = MainChainPart.prototype.isSolutionForVariables_axkv0l$;
  MainLineAndNode.prototype.isEmpty = MainLineNode.prototype.isEmpty;
  MainLineAndNode.prototype.isSolutionForVariables_axkv0l$ = MainLineNode.prototype.isSolutionForVariables_axkv0l$;
  MainLineOrNode.prototype.isEmpty = MainLineNode.prototype.isEmpty;
  MainLineOrNode.prototype.isSolutionForVariables_axkv0l$ = MainLineNode.prototype.isSolutionForVariables_axkv0l$;
  DomainAll = new DefinitionDomain(emptySet(), void 0, setOf(DomainSegment$Companion_getInstance().inclusive_lu1900$(kotlin_js_internal_DoubleCompanionObject.NEGATIVE_INFINITY, kotlin_js_internal_DoubleCompanionObject.POSITIVE_INFINITY)));
  DomainNil = new DefinitionDomain(emptySet(), void 0, emptySet());
  unlimitedWeight = 10000.0;
  knownOps = listOf_0([new BaseOperationDefinitionWithDomain('+', DomainAll, listOf_0([DomainAll, DomainAll]), knownOps$lambda), new BaseOperationDefinitionWithDomain('-', DomainAll, listOf_0([DomainAll, DomainAll]), knownOps$lambda_0), new BaseOperationDefinitionWithDomain('', DomainAll, listOf(DomainAll), knownOps$lambda_1), new BaseOperationDefinitionWithDomain('*', DomainAll, listOf_0([DomainAll, DomainAll]), knownOps$lambda_2), new BaseOperationDefinitionWithDomain('/', DomainAll, listOf_0([DomainAll, DomainAll.except_yqxtqz$(new Float64Array([0.0]))]), knownOps$lambda_3), new BaseOperationDefinitionWithDomain('sin', DefinitionDomain$Companion_getInstance().inclusive_lu1900$(-1.0, 1.0), listOf(DomainAll), knownOps$lambda_4), new BaseOperationDefinitionWithDomain('cos', DefinitionDomain$Companion_getInstance().inclusive_lu1900$(-1.0, 1.0), listOf(DomainAll), knownOps$lambda_5)]);
  var $receiver = knownOps;
  var capacity = coerceAtLeast(mapCapacity(collectionSizeOrDefault($receiver, 10)), 16);
  var destination = LinkedHashMap_init(capacity);
  var tmp$;
  tmp$ = $receiver.iterator();
  while (tmp$.hasNext()) {
    var element = tmp$.next();
    destination.put_xwzc9p$(element.baseOp, element);
  }
  knownOpsAssociation = destination;
  PARENT_BRACKETS_EXPANSION = 'ParentBracketsExpansion';
  REDUCE_FRACTION = 'ReduceFraction';
  additionalFactUsedVarName = 'AFU';
  TREE_COMPUTATION_RULES_PRIORITY = 5;
  TREE_COMPUTATION_DEFAULT = 'SimpleComputation';
  simpleComputationRuleParamsDefault = new SimpleComputationRuleParams();
  simpleComputationRuleParamsNoLimits = new SimpleComputationRuleParams(setOf('SimpleComputationUniversity'), true);
  log_1 = new LazyLog();
  spaceRegex = Regex_init('&#x200\\d;');
  unsupportedTagListMathML = listOf_0(['mstyle', 'menclose', 'mpadded']);
  underliningStartMathML = '<menclose mathcolor="#7F0000" notation="bottom">';
  underliningEndMathML = '<\/menclose>';
  configSeparator = ';;;';
  errorPrefix = 'Error';
  syntaxErrorPrefix = 'Syntax';
  random = Random.Default;
  mtable = 'mtable';
  mfenced = 'mfenced';
  closing = '<\/>';
  newLineMspace = '<mspace linebreak="newline"/>';
  newWhiteSpace = '<mo>&#xA0;<\/mo>';
  openCommentMathML = '<mo>/<\/mo><mo>*<\/mo>';
  openCommentShort = '/*';
  closeCommentMathML = '<mo>*<\/mo><mo>/<\/mo>';
  closeCommentShort = '*/';
  lettersData = listOf_0([new Letter(945, 945, '\\alpha', '&#x3B1;'), new Letter(946, 946, '\\beta', '&#x3B2;'), new Letter(947, 947, '\\gamma', '&#x3B3;'), new Letter(960, 960, '\\pi', '&#x3C0;'), new Letter(969, 969, '\\omega', '&#x3C9;')]);
  var $receiver_0 = lettersData;
  var capacity_0 = coerceAtLeast(mapCapacity(collectionSizeOrDefault($receiver_0, 10)), 16);
  var destination_0 = LinkedHashMap_init(capacity_0);
  var tmp$_0;
  tmp$_0 = $receiver_0.iterator();
  while (tmp$_0.hasNext()) {
    var element_0 = tmp$_0.next();
    destination_0.put_xwzc9p$(element_0.tex, String.fromCharCode(unboxChar(element_0.unicode)));
  }
  texToUnicode = destination_0;
  var $receiver_1 = lettersData;
  var capacity_1 = coerceAtLeast(mapCapacity(collectionSizeOrDefault($receiver_1, 10)), 16);
  var destination_1 = LinkedHashMap_init(capacity_1);
  var tmp$_1;
  tmp$_1 = $receiver_1.iterator();
  while (tmp$_1.hasNext()) {
    var element_1 = tmp$_1.next();
    destination_1.put_xwzc9p$(String.fromCharCode(unboxChar(element_1.unicode)), element_1.tex);
  }
  unicodeToTex = destination_1;
  texOpenBracket = '\\left(';
  texCloseBracket = '\\right)';
  coloringEnd = '<\/mrow>';
  coloringBoldHeaderStartGeneral = ' mathvariant="bold" mathcolor="#';
  coloringBoldHeaderStart = '<mrow mathvariant="bold" mathcolor="#';
  coloringBoldStartLength = 45;
  coloringHeaderStartGeneral = ' mathcolor="#';
  coloringHeaderStart = '<mrow mathcolor="#';
  coloringStartLength = 26;
  boldHeaderStartGeneral = ' mathvariant="bold"';
  boldHeaderStart = '<mrow mathvariant="bold"';
  boldStartLength = 25;
  coloringEndLength = coloringEnd.length;
  coloringOffset = coloringStartLength + coloringEndLength | 0;
  underlining = '<mi>_<\/mi>';
  Kotlin.defineModule('twf-kotlin-lib', _);
  return _;
}(typeof this['twf-kotlin-lib'] === 'undefined' ? {} : this['twf-kotlin-lib'], kotlin);
